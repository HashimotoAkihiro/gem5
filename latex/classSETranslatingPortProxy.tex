\hypertarget{classSETranslatingPortProxy}{
\section{クラス SETranslatingPortProxy}
\label{classSETranslatingPortProxy}\index{SETranslatingPortProxy@{SETranslatingPortProxy}}
}


{\ttfamily \#include $<$se\_\-translating\_\-port\_\-proxy.hh$>$}SETranslatingPortProxyに対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classSETranslatingPortProxy}
\end{center}
\end{figure}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afe}{AllocType} \{ \hyperlink{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afeae1a8e8cd4807ad56b76df10995885c33}{Always}, 
\hyperlink{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afea7e83d9961aaf0904a80ba6bbfd6c4bcc}{Never}, 
\hyperlink{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afea5567507a742ffde8d91a85cccb511d16}{NextPage}
 \}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classSETranslatingPortProxy_a53496e09221903975c88c46e55e99d73}{SETranslatingPortProxy} (\hyperlink{classMasterPort}{MasterPort} \&port, \hyperlink{classProcess}{Process} $\ast$p, \hyperlink{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afe}{AllocType} alloc)
\item 
virtual \hyperlink{classSETranslatingPortProxy_a4e9827ea13aa7de2eb20fb37cf6d0edb}{$\sim$SETranslatingPortProxy} ()
\item 
bool \hyperlink{classSETranslatingPortProxy_aca06672df50af8d578c89cfe876c91ee}{tryReadBlob} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, uint8\_\-t $\ast$p, int size) const 
\item 
bool \hyperlink{classSETranslatingPortProxy_a0f56f41d9a37cca029fb3159d3561e5c}{tryWriteBlob} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, uint8\_\-t $\ast$p, int size) const 
\item 
bool \hyperlink{classSETranslatingPortProxy_aa7b620f0665adb8f264d5a197cd34962}{tryMemsetBlob} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, uint8\_\-t val, int size) const 
\item 
bool \hyperlink{classSETranslatingPortProxy_a7388a80b5c85481ecf18bac69ea2fc34}{tryWriteString} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, const char $\ast$str) const 
\item 
bool \hyperlink{classSETranslatingPortProxy_a566bb321a4a4657816925b1421a8abfa}{tryReadString} (std::string \&str, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr) const 
\item 
virtual void \hyperlink{classSETranslatingPortProxy_a5580fe869fe8ffcffe2660eaa2c6276a}{readBlob} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, uint8\_\-t $\ast$p, int size) const 
\item 
virtual void \hyperlink{classSETranslatingPortProxy_ad2a72c978fca534c6afc8b0f6ac2fe19}{writeBlob} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, uint8\_\-t $\ast$p, int size) const 
\item 
virtual void \hyperlink{classSETranslatingPortProxy_ab8c719f72992ac0e0b2b9a2c464a1456}{memsetBlob} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, uint8\_\-t val, int size) const 
\item 
void \hyperlink{classSETranslatingPortProxy_a6b750ce66a82c7f9576c4fcde9bb7f54}{writeString} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, const char $\ast$str) const 
\item 
void \hyperlink{classSETranslatingPortProxy_a31157b758c97adefcb8b93b6d5587dda}{readString} (std::string \&str, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr) const 
\end{DoxyCompactItemize}
\subsection*{Private 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPageTable}{PageTable} $\ast$ \hyperlink{classSETranslatingPortProxy_ad14ffa23ad731f6003755b643f999049}{pTable}
\item 
\hyperlink{classProcess}{Process} $\ast$ \hyperlink{classSETranslatingPortProxy_a075e3da8f2570b13cecbbffca7e30d1a}{process}
\item 
\hyperlink{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afe}{AllocType} \hyperlink{classSETranslatingPortProxy_ad9ee84803e18a7cadad835ecc996515f}{allocating}
\end{DoxyCompactItemize}


\subsection{列挙型}
\hypertarget{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afe}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!AllocType@{AllocType}}
\index{AllocType@{AllocType}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{AllocType}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf AllocType}}}
\label{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afe}
\begin{Desc}
\item[列挙型の値: ]\par
\begin{description}
\index{Always@{Always}!SETranslatingPortProxy@{SETranslatingPortProxy}}\index{SETranslatingPortProxy@{SETranslatingPortProxy}!Always@{Always}}\item[{\em 
\hypertarget{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afeae1a8e8cd4807ad56b76df10995885c33}{
Always}
\label{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afeae1a8e8cd4807ad56b76df10995885c33}
}]\index{Never@{Never}!SETranslatingPortProxy@{SETranslatingPortProxy}}\index{SETranslatingPortProxy@{SETranslatingPortProxy}!Never@{Never}}\item[{\em 
\hypertarget{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afea7e83d9961aaf0904a80ba6bbfd6c4bcc}{
Never}
\label{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afea7e83d9961aaf0904a80ba6bbfd6c4bcc}
}]\index{NextPage@{NextPage}!SETranslatingPortProxy@{SETranslatingPortProxy}}\index{SETranslatingPortProxy@{SETranslatingPortProxy}!NextPage@{NextPage}}\item[{\em 
\hypertarget{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afea5567507a742ffde8d91a85cccb511d16}{
NextPage}
\label{classSETranslatingPortProxy_ac60b92a362d833ef83dd912047a36afea5567507a742ffde8d91a85cccb511d16}
}]\end{description}
\end{Desc}




\begin{DoxyCode}
71                    {
72         Always,
73         Never,
74         NextPage
75     };
\end{DoxyCode}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classSETranslatingPortProxy_a53496e09221903975c88c46e55e99d73}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{SETranslatingPortProxy}]{\setlength{\rightskip}{0pt plus 5cm}{\bf SETranslatingPortProxy} ({\bf MasterPort} \& {\em port}, \/  {\bf Process} $\ast$ {\em p}, \/  {\bf AllocType} {\em alloc})}}
\label{classSETranslatingPortProxy_a53496e09221903975c88c46e55e99d73}



\begin{DoxyCode}
59     : PortProxy(port, p->system->cacheLineSize()), pTable(p->pTable),
60       process(p), allocating(alloc)
61 { }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a4e9827ea13aa7de2eb20fb37cf6d0edb}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!$\sim$SETranslatingPortProxy@{$\sim$SETranslatingPortProxy}}
\index{$\sim$SETranslatingPortProxy@{$\sim$SETranslatingPortProxy}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{$\sim$SETranslatingPortProxy}]{\setlength{\rightskip}{0pt plus 5cm}$\sim${\bf SETranslatingPortProxy} ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSETranslatingPortProxy_a4e9827ea13aa7de2eb20fb37cf6d0edb}



\begin{DoxyCode}
64 { }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classSETranslatingPortProxy_ab8c719f72992ac0e0b2b9a2c464a1456}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!memsetBlob@{memsetBlob}}
\index{memsetBlob@{memsetBlob}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{memsetBlob}]{\setlength{\rightskip}{0pt plus 5cm}void memsetBlob ({\bf Addr} {\em addr}, \/  uint8\_\-t {\em v}, \/  int {\em size}) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSETranslatingPortProxy_ab8c719f72992ac0e0b2b9a2c464a1456}
Fill size bytes starting at addr with byte value val. 

\hyperlink{classPortProxy_ad68c64ee0acd471129b53bbfd59a2f9a}{PortProxy}を再定義しています。


\begin{DoxyCode}
154 {
155     if (!tryMemsetBlob(addr, val, size))
156         fatal("memsetBlob(0x%x, ...) failed", addr);
157 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a5580fe869fe8ffcffe2660eaa2c6276a}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!readBlob@{readBlob}}
\index{readBlob@{readBlob}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{readBlob}]{\setlength{\rightskip}{0pt plus 5cm}void readBlob ({\bf Addr} {\em addr}, \/  uint8\_\-t $\ast$ {\em p}, \/  int {\em size}) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSETranslatingPortProxy_a5580fe869fe8ffcffe2660eaa2c6276a}
Read size bytes memory at address and store in p. 

\hyperlink{classPortProxy_ad63586ad1fa7fd707ea7e03665c25502}{PortProxy}を再定義しています。


\begin{DoxyCode}
86 {
87     if (!tryReadBlob(addr, p, size))
88         fatal("readBlob(0x%x, ...) failed", addr);
89 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a31157b758c97adefcb8b93b6d5587dda}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!readString@{readString}}
\index{readString@{readString}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{readString}]{\setlength{\rightskip}{0pt plus 5cm}void readString (std::string \& {\em str}, \/  {\bf Addr} {\em addr}) const}}
\label{classSETranslatingPortProxy_a31157b758c97adefcb8b93b6d5587dda}



\begin{DoxyCode}
212 {
213     if (!tryReadString(str, addr))
214         fatal("readString(0x%x, ...) failed", addr);
215 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_aa7b620f0665adb8f264d5a197cd34962}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!tryMemsetBlob@{tryMemsetBlob}}
\index{tryMemsetBlob@{tryMemsetBlob}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{tryMemsetBlob}]{\setlength{\rightskip}{0pt plus 5cm}bool tryMemsetBlob ({\bf Addr} {\em addr}, \/  uint8\_\-t {\em val}, \/  int {\em size}) const}}
\label{classSETranslatingPortProxy_aa7b620f0665adb8f264d5a197cd34962}



\begin{DoxyCode}
132 {
133     for (ChunkGenerator gen(addr, size, VMPageSize); !gen.done(); gen.next()) {
134         Addr paddr;
135 
136         if (!pTable->translate(gen.addr(), paddr)) {
137             if (allocating == Always) {
138                 process->allocateMem(roundDown(gen.addr(), VMPageSize),
139                                      VMPageSize);
140                 pTable->translate(gen.addr(), paddr);
141             } else {
142                 return false;
143             }
144         }
145 
146         PortProxy::memsetBlob(paddr, val, gen.size());
147     }
148 
149     return true;
150 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_aca06672df50af8d578c89cfe876c91ee}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!tryReadBlob@{tryReadBlob}}
\index{tryReadBlob@{tryReadBlob}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{tryReadBlob}]{\setlength{\rightskip}{0pt plus 5cm}bool tryReadBlob ({\bf Addr} {\em addr}, \/  uint8\_\-t $\ast$ {\em p}, \/  int {\em size}) const}}
\label{classSETranslatingPortProxy_aca06672df50af8d578c89cfe876c91ee}



\begin{DoxyCode}
68 {
69     int prevSize = 0;
70 
71     for (ChunkGenerator gen(addr, size, VMPageSize); !gen.done(); gen.next()) {
72         Addr paddr;
73 
74         if (!pTable->translate(gen.addr(),paddr))
75             return false;
76 
77         PortProxy::readBlob(paddr, p + prevSize, gen.size());
78         prevSize += gen.size();
79     }
80 
81     return true;
82 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a566bb321a4a4657816925b1421a8abfa}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!tryReadString@{tryReadString}}
\index{tryReadString@{tryReadString}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{tryReadString}]{\setlength{\rightskip}{0pt plus 5cm}bool tryReadString (std::string \& {\em str}, \/  {\bf Addr} {\em addr}) const}}
\label{classSETranslatingPortProxy_a566bb321a4a4657816925b1421a8abfa}



\begin{DoxyCode}
189 {
190     uint8_t c;
191 
192     Addr vaddr = addr;
193 
194     while (true) {
195         Addr paddr;
196 
197         if (!pTable->translate(vaddr++, paddr))
198             return false;
199 
200         PortProxy::readBlob(paddr, &c, 1);
201         if (c == '\0')
202             break;
203 
204         str += c;
205     }
206 
207     return true;
208 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a0f56f41d9a37cca029fb3159d3561e5c}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!tryWriteBlob@{tryWriteBlob}}
\index{tryWriteBlob@{tryWriteBlob}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{tryWriteBlob}]{\setlength{\rightskip}{0pt plus 5cm}bool tryWriteBlob ({\bf Addr} {\em addr}, \/  uint8\_\-t $\ast$ {\em p}, \/  int {\em size}) const}}
\label{classSETranslatingPortProxy_a0f56f41d9a37cca029fb3159d3561e5c}



\begin{DoxyCode}
94 {
95     int prevSize = 0;
96 
97     for (ChunkGenerator gen(addr, size, VMPageSize); !gen.done(); gen.next()) {
98         Addr paddr;
99 
100         if (!pTable->translate(gen.addr(), paddr)) {
101             if (allocating == Always) {
102                 process->allocateMem(roundDown(gen.addr(), VMPageSize),
103                                      VMPageSize);
104             } else if (allocating == NextPage) {
105                 // check if we've accessed the next page on the stack
106                 if (!process->fixupStackFault(gen.addr()))
107                     panic("Page table fault when accessing virtual address %#x "
108                             "during functional write\n", gen.addr());
109             } else {
110                 return false;
111             }
112             pTable->translate(gen.addr(), paddr);
113         }
114 
115         PortProxy::writeBlob(paddr, p + prevSize, gen.size());
116         prevSize += gen.size();
117     }
118 
119     return true;
120 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a7388a80b5c85481ecf18bac69ea2fc34}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!tryWriteString@{tryWriteString}}
\index{tryWriteString@{tryWriteString}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{tryWriteString}]{\setlength{\rightskip}{0pt plus 5cm}bool tryWriteString ({\bf Addr} {\em addr}, \/  const char $\ast$ {\em str}) const}}
\label{classSETranslatingPortProxy_a7388a80b5c85481ecf18bac69ea2fc34}



\begin{DoxyCode}
162 {
163     uint8_t c;
164 
165     Addr vaddr = addr;
166 
167     do {
168         c = *str++;
169         Addr paddr;
170 
171         if (!pTable->translate(vaddr++, paddr))
172             return false;
173 
174         PortProxy::writeBlob(paddr, &c, 1);
175     } while (c);
176 
177     return true;
178 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_ad2a72c978fca534c6afc8b0f6ac2fe19}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!writeBlob@{writeBlob}}
\index{writeBlob@{writeBlob}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{writeBlob}]{\setlength{\rightskip}{0pt plus 5cm}void writeBlob ({\bf Addr} {\em addr}, \/  uint8\_\-t $\ast$ {\em p}, \/  int {\em size}) const\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classSETranslatingPortProxy_ad2a72c978fca534c6afc8b0f6ac2fe19}
Write size bytes from p to address. 

\hyperlink{classPortProxy_af68c0d93cdb9ff9c4df789c4c9029709}{PortProxy}を再定義しています。


\begin{DoxyCode}
125 {
126     if (!tryWriteBlob(addr, p, size))
127         fatal("writeBlob(0x%x, ...) failed", addr);
128 }
\end{DoxyCode}
\hypertarget{classSETranslatingPortProxy_a6b750ce66a82c7f9576c4fcde9bb7f54}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!writeString@{writeString}}
\index{writeString@{writeString}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{writeString}]{\setlength{\rightskip}{0pt plus 5cm}void writeString ({\bf Addr} {\em addr}, \/  const char $\ast$ {\em str}) const}}
\label{classSETranslatingPortProxy_a6b750ce66a82c7f9576c4fcde9bb7f54}



\begin{DoxyCode}
182 {
183     if (!tryWriteString(addr, str))
184         fatal("writeString(0x%x, ...) failed", addr);
185 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classSETranslatingPortProxy_ad9ee84803e18a7cadad835ecc996515f}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!allocating@{allocating}}
\index{allocating@{allocating}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{allocating}]{\setlength{\rightskip}{0pt plus 5cm}{\bf AllocType} {\bf allocating}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSETranslatingPortProxy_ad9ee84803e18a7cadad835ecc996515f}
\hypertarget{classSETranslatingPortProxy_a075e3da8f2570b13cecbbffca7e30d1a}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!process@{process}}
\index{process@{process}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{process}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Process}$\ast$ {\bf process}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSETranslatingPortProxy_a075e3da8f2570b13cecbbffca7e30d1a}
\hypertarget{classSETranslatingPortProxy_ad14ffa23ad731f6003755b643f999049}{
\index{SETranslatingPortProxy@{SETranslatingPortProxy}!pTable@{pTable}}
\index{pTable@{pTable}!SETranslatingPortProxy@{SETranslatingPortProxy}}
\subsubsection[{pTable}]{\setlength{\rightskip}{0pt plus 5cm}{\bf PageTable}$\ast$ {\bf pTable}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSETranslatingPortProxy_ad14ffa23ad731f6003755b643f999049}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
mem/\hyperlink{se__translating__port__proxy_8hh}{se\_\-translating\_\-port\_\-proxy.hh}\item 
mem/\hyperlink{se__translating__port__proxy_8cc}{se\_\-translating\_\-port\_\-proxy.cc}\end{DoxyCompactItemize}
