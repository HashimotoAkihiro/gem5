\hypertarget{intmath_8hh}{
\section{base/intmath.hh}
\label{intmath_8hh}\index{base/intmath.hh@{base/intmath.hh}}
}
{\ttfamily \#include $<$cassert$>$}\par
{\ttfamily \#include \char`\"{}base/misc.hh\char`\"{}}\par
{\ttfamily \#include \char`\"{}base/types.hh\char`\"{}}\par
\subsection*{関数}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{intmath_8hh_a10cb95b0267273bc74bad625fd898a7a}{prevPrime} (int n)
\item 
{\footnotesize template$<$class T $>$ }\\bool \hyperlink{intmath_8hh_af3bac294b8a9bea0d769d31d69359d5b}{isPrime} (T n)
\item 
{\footnotesize template$<$class T $>$ }\\T \hyperlink{intmath_8hh_aedf2d3ae8ea4c0cad7f3b129194079f9}{leastSigBit} (T n)
\item 
{\footnotesize template$<$class T $>$ }\\bool \hyperlink{intmath_8hh_aa73a8269f3cc1853f96c7a9210f61f0e}{isPowerOf2} (T n)
\item 
uint64\_\-t \hyperlink{intmath_8hh_a4e6a30fd4eed8d942ab7fa676da00e69}{power} (\hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} n, \hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} e)
\item 
int \hyperlink{intmath_8hh_ad61f5307b84292529da332fee695614e}{floorLog2} (unsigned x)
\item 
int \hyperlink{intmath_8hh_a9796f3c77e4ea692eff841b1b0ffd3c5}{floorLog2} (unsigned long x)
\item 
int \hyperlink{intmath_8hh_a1aef59a86a50b9a145dde96ae65c21b7}{floorLog2} (unsigned long long x)
\item 
int \hyperlink{intmath_8hh_abd19f55c0889d4497e80d04c592a5a3f}{floorLog2} (int x)
\item 
int \hyperlink{intmath_8hh_aaa5523260849f943356b4ae7955d1384}{floorLog2} (long x)
\item 
int \hyperlink{intmath_8hh_a74b8ca802c979ca07b3f7bdddca9264d}{floorLog2} (long long x)
\item 
{\footnotesize template$<$class T $>$ }\\int \hyperlink{intmath_8hh_a0ec4eaea50888f737b803dc9427614bf}{ceilLog2} (T n)
\item 
{\footnotesize template$<$class T $>$ }\\T \hyperlink{intmath_8hh_a9486f78f0d06687602e134537d9bfe3a}{floorPow2} (T n)
\item 
{\footnotesize template$<$class T $>$ }\\T \hyperlink{intmath_8hh_a334dc85c238ca64b4e9658e05cec6cba}{ceilPow2} (T n)
\item 
{\footnotesize template$<$class T , class U $>$ }\\T \hyperlink{intmath_8hh_ae842b412d3570df97a944085b8f85850}{divCeil} (const T \&a, const U \&b)
\item 
{\footnotesize template$<$class T $>$ }\\T \hyperlink{intmath_8hh_a4d254a89b294890f6ce3a474f4e8c6c7}{roundUp} (T val, int align)
\item 
{\footnotesize template$<$class T $>$ }\\T \hyperlink{intmath_8hh_a343c19b0ae885d5f3c7960987096e9d5}{roundDown} (T val, int align)
\item 
bool \hyperlink{intmath_8hh_ab7ca9ee391118aafe6f3cf7df4fa5de3}{isHex} (char c)
\item 
bool \hyperlink{intmath_8hh_a6c0f35ebd0c531065480e2de41c0adff}{isOct} (char c)
\item 
bool \hyperlink{intmath_8hh_a8b463f338b8712a8914d9f8f6cf45db8}{isDec} (char c)
\item 
int \hyperlink{intmath_8hh_a3219427263826ba5f1080f2abe2c3cb9}{hex2Int} (char c)
\end{DoxyCompactItemize}


\subsection{関数}
\hypertarget{intmath_8hh_a0ec4eaea50888f737b803dc9427614bf}{
\index{intmath.hh@{intmath.hh}!ceilLog2@{ceilLog2}}
\index{ceilLog2@{ceilLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{ceilLog2}]{\setlength{\rightskip}{0pt plus 5cm}int ceilLog2 (T {\em n})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a0ec4eaea50888f737b803dc9427614bf}



\begin{DoxyCode}
175 {
176     if (n == 1)
177         return 0;
178 
179     return floorLog2(n - (T)1) + 1;
180 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a334dc85c238ca64b4e9658e05cec6cba}{
\index{intmath.hh@{intmath.hh}!ceilPow2@{ceilPow2}}
\index{ceilPow2@{ceilPow2}!intmath.hh@{intmath.hh}}
\subsubsection[{ceilPow2}]{\setlength{\rightskip}{0pt plus 5cm}T ceilPow2 (T {\em n})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a334dc85c238ca64b4e9658e05cec6cba}



\begin{DoxyCode}
192 {
193     return (T)1 << ceilLog2(n);
194 }
\end{DoxyCode}
\hypertarget{intmath_8hh_ae842b412d3570df97a944085b8f85850}{
\index{intmath.hh@{intmath.hh}!divCeil@{divCeil}}
\index{divCeil@{divCeil}!intmath.hh@{intmath.hh}}
\subsubsection[{divCeil}]{\setlength{\rightskip}{0pt plus 5cm}T divCeil (const T \& {\em a}, \/  const U \& {\em b})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_ae842b412d3570df97a944085b8f85850}



\begin{DoxyCode}
199 {
200     return (a + b - 1) / b;
201 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a74b8ca802c979ca07b3f7bdddca9264d}{
\index{intmath.hh@{intmath.hh}!floorLog2@{floorLog2}}
\index{floorLog2@{floorLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorLog2}]{\setlength{\rightskip}{0pt plus 5cm}int floorLog2 (long long {\em x})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a74b8ca802c979ca07b3f7bdddca9264d}



\begin{DoxyCode}
167 {
168     assert(x > 0);
169     return floorLog2((unsigned long long)x);
170 }
\end{DoxyCode}
\hypertarget{intmath_8hh_aaa5523260849f943356b4ae7955d1384}{
\index{intmath.hh@{intmath.hh}!floorLog2@{floorLog2}}
\index{floorLog2@{floorLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorLog2}]{\setlength{\rightskip}{0pt plus 5cm}int floorLog2 (long {\em x})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_aaa5523260849f943356b4ae7955d1384}



\begin{DoxyCode}
160 {
161     assert(x > 0);
162     return floorLog2((unsigned long)x);
163 }
\end{DoxyCode}
\hypertarget{intmath_8hh_abd19f55c0889d4497e80d04c592a5a3f}{
\index{intmath.hh@{intmath.hh}!floorLog2@{floorLog2}}
\index{floorLog2@{floorLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorLog2}]{\setlength{\rightskip}{0pt plus 5cm}int floorLog2 (int {\em x})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_abd19f55c0889d4497e80d04c592a5a3f}



\begin{DoxyCode}
153 {
154     assert(x > 0);
155     return floorLog2((unsigned)x);
156 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a1aef59a86a50b9a145dde96ae65c21b7}{
\index{intmath.hh@{intmath.hh}!floorLog2@{floorLog2}}
\index{floorLog2@{floorLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorLog2}]{\setlength{\rightskip}{0pt plus 5cm}int floorLog2 (unsigned long long {\em x})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a1aef59a86a50b9a145dde96ae65c21b7}



\begin{DoxyCode}
136 {
137     assert(x > 0);
138 
139     int y = 0;
140 
141     if (x & ULL(0xffffffff00000000)) { y += 32; x >>= 32; }
142     if (x & ULL(0x00000000ffff0000)) { y += 16; x >>= 16; }
143     if (x & ULL(0x000000000000ff00)) { y +=  8; x >>=  8; }
144     if (x & ULL(0x00000000000000f0)) { y +=  4; x >>=  4; }
145     if (x & ULL(0x000000000000000c)) { y +=  2; x >>=  2; }
146     if (x & ULL(0x0000000000000002)) { y +=  1; }
147 
148     return y;
149 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a9796f3c77e4ea692eff841b1b0ffd3c5}{
\index{intmath.hh@{intmath.hh}!floorLog2@{floorLog2}}
\index{floorLog2@{floorLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorLog2}]{\setlength{\rightskip}{0pt plus 5cm}int floorLog2 (unsigned long {\em x})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a9796f3c77e4ea692eff841b1b0ffd3c5}



\begin{DoxyCode}
117 {
118     assert(x > 0);
119 
120     int y = 0;
121 
122 #if defined(__LP64__)
123     if (x & ULL(0xffffffff00000000)) { y += 32; x >>= 32; }
124 #endif
125     if (x & 0xffff0000) { y += 16; x >>= 16; }
126     if (x & 0x0000ff00) { y +=  8; x >>=  8; }
127     if (x & 0x000000f0) { y +=  4; x >>=  4; }
128     if (x & 0x0000000c) { y +=  2; x >>=  2; }
129     if (x & 0x00000002) { y +=  1; }
130 
131     return y;
132 }
\end{DoxyCode}
\hypertarget{intmath_8hh_ad61f5307b84292529da332fee695614e}{
\index{intmath.hh@{intmath.hh}!floorLog2@{floorLog2}}
\index{floorLog2@{floorLog2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorLog2}]{\setlength{\rightskip}{0pt plus 5cm}int floorLog2 (unsigned {\em x})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_ad61f5307b84292529da332fee695614e}



\begin{DoxyCode}
101 {
102     assert(x > 0);
103 
104     int y = 0;
105 
106     if (x & 0xffff0000) { y += 16; x >>= 16; }
107     if (x & 0x0000ff00) { y +=  8; x >>=  8; }
108     if (x & 0x000000f0) { y +=  4; x >>=  4; }
109     if (x & 0x0000000c) { y +=  2; x >>=  2; }
110     if (x & 0x00000002) { y +=  1; }
111 
112     return y;
113 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a9486f78f0d06687602e134537d9bfe3a}{
\index{intmath.hh@{intmath.hh}!floorPow2@{floorPow2}}
\index{floorPow2@{floorPow2}!intmath.hh@{intmath.hh}}
\subsubsection[{floorPow2}]{\setlength{\rightskip}{0pt plus 5cm}T floorPow2 (T {\em n})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a9486f78f0d06687602e134537d9bfe3a}



\begin{DoxyCode}
185 {
186     return (T)1 << floorLog2(n);
187 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a3219427263826ba5f1080f2abe2c3cb9}{
\index{intmath.hh@{intmath.hh}!hex2Int@{hex2Int}}
\index{hex2Int@{hex2Int}!intmath.hh@{intmath.hh}}
\subsubsection[{hex2Int}]{\setlength{\rightskip}{0pt plus 5cm}int hex2Int (char {\em c})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a3219427263826ba5f1080f2abe2c3cb9}



\begin{DoxyCode}
241 {
242   if (c >= '0' && c <= '9')
243     return (c - '0');
244 
245   if (c >= 'A' && c <= 'F')
246     return (c - 'A') + 10;
247 
248   if (c >= 'a' && c <= 'f')
249     return (c - 'a') + 10;
250 
251   return 0;
252 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a8b463f338b8712a8914d9f8f6cf45db8}{
\index{intmath.hh@{intmath.hh}!isDec@{isDec}}
\index{isDec@{isDec}!intmath.hh@{intmath.hh}}
\subsubsection[{isDec}]{\setlength{\rightskip}{0pt plus 5cm}bool isDec (char {\em c})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a8b463f338b8712a8914d9f8f6cf45db8}



\begin{DoxyCode}
235 {
236     return c >= '0' && c <= '9';
237 }
\end{DoxyCode}
\hypertarget{intmath_8hh_ab7ca9ee391118aafe6f3cf7df4fa5de3}{
\index{intmath.hh@{intmath.hh}!isHex@{isHex}}
\index{isHex@{isHex}!intmath.hh@{intmath.hh}}
\subsubsection[{isHex}]{\setlength{\rightskip}{0pt plus 5cm}bool isHex (char {\em c})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_ab7ca9ee391118aafe6f3cf7df4fa5de3}



\begin{DoxyCode}
221 {
222     return (c >= '0' && c <= '9') ||
223         (c >= 'A' && c <= 'F') ||
224         (c >= 'a' && c <= 'f');
225 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a6c0f35ebd0c531065480e2de41c0adff}{
\index{intmath.hh@{intmath.hh}!isOct@{isOct}}
\index{isOct@{isOct}!intmath.hh@{intmath.hh}}
\subsubsection[{isOct}]{\setlength{\rightskip}{0pt plus 5cm}bool isOct (char {\em c})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a6c0f35ebd0c531065480e2de41c0adff}



\begin{DoxyCode}
229 {
230     return c >= '0' && c <= '7';
231 }
\end{DoxyCode}
\hypertarget{intmath_8hh_aa73a8269f3cc1853f96c7a9210f61f0e}{
\index{intmath.hh@{intmath.hh}!isPowerOf2@{isPowerOf2}}
\index{isPowerOf2@{isPowerOf2}!intmath.hh@{intmath.hh}}
\subsubsection[{isPowerOf2}]{\setlength{\rightskip}{0pt plus 5cm}bool isPowerOf2 (T {\em n})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_aa73a8269f3cc1853f96c7a9210f61f0e}



\begin{DoxyCode}
74 {
75     return n != 0 && leastSigBit(n) == n;
76 }
\end{DoxyCode}
\hypertarget{intmath_8hh_af3bac294b8a9bea0d769d31d69359d5b}{
\index{intmath.hh@{intmath.hh}!isPrime@{isPrime}}
\index{isPrime@{isPrime}!intmath.hh@{intmath.hh}}
\subsubsection[{isPrime}]{\setlength{\rightskip}{0pt plus 5cm}bool isPrime (T {\em n})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_af3bac294b8a9bea0d769d31d69359d5b}



\begin{DoxyCode}
46 {
47     T i;
48 
49     if (n == 2 || n == 3)
50         return true;
51 
52     // Don't try every odd number to prove if it is a prime.
53     // Toggle between every 2nd and 4th number.
54     // (This is because every 6th odd number is divisible by 3.)
55     for (i = 5; i*i <= n; i += 6) {
56         if (((n % i) == 0 ) || ((n % (i + 2)) == 0) ) {
57             return false;
58         }
59     }
60 
61     return true;
62 }
\end{DoxyCode}
\hypertarget{intmath_8hh_aedf2d3ae8ea4c0cad7f3b129194079f9}{
\index{intmath.hh@{intmath.hh}!leastSigBit@{leastSigBit}}
\index{leastSigBit@{leastSigBit}!intmath.hh@{intmath.hh}}
\subsubsection[{leastSigBit}]{\setlength{\rightskip}{0pt plus 5cm}T leastSigBit (T {\em n})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_aedf2d3ae8ea4c0cad7f3b129194079f9}



\begin{DoxyCode}
67 {
68     return n & ~(n - 1);
69 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a4e6a30fd4eed8d942ab7fa676da00e69}{
\index{intmath.hh@{intmath.hh}!power@{power}}
\index{power@{power}!intmath.hh@{intmath.hh}}
\subsubsection[{power}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t power ({\bf uint32\_\-t} {\em n}, \/  {\bf uint32\_\-t} {\em e})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a4e6a30fd4eed8d942ab7fa676da00e69}



\begin{DoxyCode}
80 {
81     if (e > 20)
82         warn("Warning, power() function is quite slow for large exponents\n");
83 
84     if (e == 0)
85         return 1;
86 
87     uint64_t result = n;
88     uint64_t old_result = 0;
89     for (int x = 1; x < e; x++) {
90         old_result = result;
91         result *= n;
92         if (old_result > result)
93             warn("power() overflowed!\n");
94     }
95     return result;
96 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a10cb95b0267273bc74bad625fd898a7a}{
\index{intmath.hh@{intmath.hh}!prevPrime@{prevPrime}}
\index{prevPrime@{prevPrime}!intmath.hh@{intmath.hh}}
\subsubsection[{prevPrime}]{\setlength{\rightskip}{0pt plus 5cm}int prevPrime (int {\em n})}}
\label{intmath_8hh_a10cb95b0267273bc74bad625fd898a7a}



\begin{DoxyCode}
36 {
37     int decr;
38 
39     // If the number is even, let's start with the previous odd number.
40     if (!(n & 1))
41         --n;
42 
43     // Lets test for divisibility by 3.  Then we will be able to easily
44     // avoid numbers that are divisible by 3 in the future.
45     decr = n % 3;
46     if (decr == 0) {
47         n -= 2;
48         decr = 2;
49     }
50     else if (decr == 1)
51         decr = 4;
52 
53     for (;;) {
54         if (isPrime(n))
55             return n;
56         n -= decr;
57         // Toggle between 2 and 4 to prevent trying numbers that are known
58         // to be divisible by 3.
59         decr = 6 - decr;
60     }
61 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a343c19b0ae885d5f3c7960987096e9d5}{
\index{intmath.hh@{intmath.hh}!roundDown@{roundDown}}
\index{roundDown@{roundDown}!intmath.hh@{intmath.hh}}
\subsubsection[{roundDown}]{\setlength{\rightskip}{0pt plus 5cm}T roundDown (T {\em val}, \/  int {\em align})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a343c19b0ae885d5f3c7960987096e9d5}



\begin{DoxyCode}
214 {
215     T mask = (T)align - 1;
216     return val & ~mask;
217 }
\end{DoxyCode}
\hypertarget{intmath_8hh_a4d254a89b294890f6ce3a474f4e8c6c7}{
\index{intmath.hh@{intmath.hh}!roundUp@{roundUp}}
\index{roundUp@{roundUp}!intmath.hh@{intmath.hh}}
\subsubsection[{roundUp}]{\setlength{\rightskip}{0pt plus 5cm}T roundUp (T {\em val}, \/  int {\em align})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{intmath_8hh_a4d254a89b294890f6ce3a474f4e8c6c7}



\begin{DoxyCode}
206 {
207     T mask = (T)align - 1;
208     return (val + mask) & ~mask;
209 }
\end{DoxyCode}
