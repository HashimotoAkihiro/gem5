<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス Tru64</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス Tru64</h1><!-- doxytag: class="Tru64" --><!-- doxytag: inherits="OperatingSystem" -->
<p><code>#include &lt;<a class="el" href="kern_2tru64_2tru64_8hh_source.html">tru64.hh</a>&gt;</code></p>
<div class="dynheader">
Tru64に対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classTru64.gif" usemap="#Tru64_map" alt=""/>
  <map id="Tru64_map" name="Tru64_map">
<area href="classOperatingSystem.html" alt="OperatingSystem" shape="rect" coords="118,0,226,24"/>
<area href="classAlphaTru64.html" alt="AlphaTru64" shape="rect" coords="0,112,108,136"/>
<area href="classTru64__F64.html" alt="Tru64_F64" shape="rect" coords="118,112,226,136"/>
<area href="classTru64__PreF64.html" alt="Tru64_PreF64" shape="rect" coords="236,112,344,136"/>
</map>
 </div>
</div>

<p><a href="classTru64-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>構成</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1cpu__info.html">cpu_info</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For getsysinfo() GSI_CPU_INFO option.  <a href="structTru64_1_1cpu__info.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1dirent.html">dirent</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For getdirentries().  <a href="structTru64_1_1dirent.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1F64__statfs.html">F64_statfs</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For statfs().  <a href="structTru64_1_1F64__statfs.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1nxm__config__info.html">nxm_config_info</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structTru64_1_1nxm__config__info.html" title="nxm_config_info">nxm_config_info</a>  <a href="structTru64_1_1nxm__config__info.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1nxm__sched__state.html">nxm_sched_state</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1nxm__shared.html">nxm_shared</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="structTru64_1_1nxm__shared.html" title="nxm_shared.">nxm_shared</a>.  <a href="structTru64_1_1nxm__shared.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1nxm__task__attr.html">nxm_task_attr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Task attribute structure.  <a href="structTru64_1_1nxm__task__attr.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1nxm__thread__attr.html">nxm_thread_attr</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread attributes.  <a href="structTru64_1_1nxm__thread__attr.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1pre__F64__statfs.html">pre_F64_statfs</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For old <a class="el" href="classTru64.html">Tru64</a> v4.x statfs().  <a href="structTru64_1_1pre__F64__statfs.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1quad.html">quad</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1rlimit.html">rlimit</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Limit struct for getrlimit/setrlimit.  <a href="structTru64_1_1rlimit.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1rusage.html">rusage</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For getrusage().  <a href="structTru64_1_1rusage.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1sigcontext.html">sigcontext</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For sigreturn().  <a href="structTru64_1_1sigcontext.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1tbl__sysinfo.html">tbl_sysinfo</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For table().  <a href="structTru64_1_1tbl__sysinfo.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1timeval.html">timeval</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For gettimeofday.  <a href="structTru64_1_1timeval.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1ushared__state.html">ushared_state</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread state shared between user &amp; kernel.  <a href="structTru64_1_1ushared__state.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1utsname.html">utsname</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Interface struct for uname().  <a href="structTru64_1_1utsname.html#_details">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structTru64_1_1vm__stack.html">vm_stack</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For stack_create.  <a href="structTru64_1_1vm__stack.html#_details">[詳細]</a><br/></td></tr>
<tr><td colspan="2"><h2>Public 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="classTru64.html#a68c01102755fc7d1c810bb0b0635fa90a7fff089a9b1eae0e9e60e82d7ab27b03">KERN_NOT_RECEIVER</a> =  7, 
<a class="el" href="classTru64.html#a68c01102755fc7d1c810bb0b0635fa90ae5ac70379d7d014f8f37ba0ee504f35c">KERN_NOT_IN_SET</a> =  12
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Return values for nxm calls. </p>
 <a href="classTru64.html#a68c01102755fc7d1c810bb0b0635fa90">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1">nxm_slot_state_t</a> { <a class="el" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1a50b7d030b516364e6a36300e54aedf42">NXM_SLOT_AVAIL</a>, 
<a class="el" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1ac7fa50c98e9a7cf0683966b0d6a6104e">NXM_SLOT_BOUND</a>, 
<a class="el" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1af2d76554995e1f7f2990e8deb0e444e5">NXM_SLOT_UNBOUND</a>, 
<a class="el" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1aa29b88969e5bd1d58b5a3340c872c8ad">NXM_SLOT_EMPTY</a>
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>nxm_slot_state_t. </p>
 <a href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a047f3ab687492e1d75f613e182664384">nxm_thread_type</a> { <a class="el" href="classTru64.html#a047f3ab687492e1d75f613e182664384a3ac97f98b04f22186a86480ad5fa471d">NXM_TYPE_SCS</a> =  0, 
<a class="el" href="classTru64.html#a047f3ab687492e1d75f613e182664384a1d6a136a94a41d702244a74edccdb312">NXM_TYPE_VP</a> =  1, 
<a class="el" href="classTru64.html#a047f3ab687492e1d75f613e182664384a94b977628442e840a44dd81fdeb105ae">NXM_TYPE_MANAGER</a> =  2
 }</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>For nxm_thread_create. </p>
 <a href="classTru64.html#a047f3ab687492e1d75f613e182664384">[詳細]</a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#ae770e87ab143e8ad7feaf75b78a89718">sigset_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signal set.  <a href="#ae770e87ab143e8ad7feaf75b78a89718"></a><br/></td></tr>
<tr><td colspan="2"><div class="groupHeader"></div></td></tr>
<tr><td colspan="2"><div class="groupText"><p><a class="anchor" id="amgrpd41d8cd98f00b204e9800998ecf8427e"></a> </p>
<br/><br/></div></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a186ea1339bffb378854987065835afe3">size_t</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Basic <a class="el" href="classTru64.html">Tru64</a> types.  <a href="#a186ea1339bffb378854987065835afe3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a2cb84cf5f02a29b7e8f237ff151a9225">off_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a772a435921844488d52ef4df39b3e702">nlink_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef int32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#abf62b93d918a43f0c5ee0ab777b1c3ef">dev_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#af2306308627701b66dc6f3babe821ab4">uid_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#aa7352f1065fe606194d792e2b292cf83">gid_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a3346b04b0420b32ccf6b706551b70762">time_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#af8f4385bb42836d1e3ad4fea9d71d1b9">mode_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#aed4e918b44240739869c4bdb1c4787a9">ino_t</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="structTru64_1_1quad.html">quad</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#abcb767738eec58d41562764284835524">fsid_t</a></td></tr>
<tr><td colspan="2"><h2>Static Public メソッド</h2></td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classTru64.html#ab39f4973592abe61638b8b998bc5691d">copyOutStatfsBuf</a> (<a class="el" href="classSETranslatingPortProxy.html">SETranslatingPortProxy</a> &amp;mem, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr, <a class="el" href="kern_2tru64_2tru64_8hh.html#a1a8529336c3f2704cb49ee2cd97412a8">global_statfs</a> *host)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a2e7bba81ca6d880e6cbf4e1db6100a68">getdirentriesFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Target getdirentries() handler.  <a href="#a2e7bba81ca6d880e6cbf4e1db6100a68"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a368f998d81d17c06f2fb1639683f8302">sigreturnFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Target sigreturn() handler.  <a href="#a368f998d81d17c06f2fb1639683f8302"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#ac6e3676ee42b0ad6a609f36f0cf654bb">stack_createFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create a stack region for a thread.  <a href="#ac6e3676ee42b0ad6a609f36f0cf654bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a7393c42ceaadfe69e71c4cab0d059968">nxm_task_initFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a83da5f99bb14ade814d1509f55d1db1b">init_thread_context</a> (<a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="structTru64_1_1nxm__thread__attr.html">Tru64::nxm_thread_attr</a> *attrp, uint64_t uniq_val)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize thread context.  <a href="#a83da5f99bb14ade814d1509f55d1db1b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a56167e2aed868ff95f0864b9075adab1">nxm_thread_createFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create thread.  <a href="#a56167e2aed868ff95f0864b9075adab1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a7d672681a6c03ce2f3d8e64b159d23d7">nxm_idleFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread idle call (like yield()).  <a href="#a7d672681a6c03ce2f3d8e64b159d23d7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a05e8a076d0c534c96b680a3661fc9003">nxm_thread_blockFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Block thread.  <a href="#a05e8a076d0c534c96b680a3661fc9003"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#ad497f5d8e1f57340b73ad9ea52b88dd3">nxm_blockFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">block.  <a href="#ad497f5d8e1f57340b73ad9ea52b88dd3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#abdd09a9b9645e7199d23afbdae212ef6">nxm_unblockFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unblock thread.  <a href="#abdd09a9b9645e7199d23afbdae212ef6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a447627b7d2862dbc933f4d4a4433cd4c">swtch_priFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classSwitch.html">Switch</a> thread priority.  <a href="#a447627b7d2862dbc933f4d4a4433cd4c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#aaef9d5f33173de4f6d2875193eb83d7a">activate_waiting_context</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, bool activate_all=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a029c70f7b96e2ccaa00ea5252875de90">m5_lock_mutex</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">M5 hacked-up lock acquire.  <a href="#a029c70f7b96e2ccaa00ea5252875de90"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#ac965ae70992f9a6f184c1e6f177e3b5b">m5_unlock_mutex</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">M5 unlock call.  <a href="#ac965ae70992f9a6f184c1e6f177e3b5b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a5a1fd874973f006aecd51e98ce0b6579">m5_mutex_lockFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Lock acquire syscall handler.  <a href="#a5a1fd874973f006aecd51e98ce0b6579"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#aa8d051ea34736b976895f70df5f48b9d">m5_mutex_trylockFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Try lock (non-blocking).  <a href="#aa8d051ea34736b976895f70df5f48b9d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a13ce77bfaa709faa1a3006cea0465959">m5_mutex_unlockFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Unlock syscall handler.  <a href="#a13ce77bfaa709faa1a3006cea0465959"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#acfc803d4984b3037abb896038e4f6fc1">m5_cond_signalFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Signal ocndition.  <a href="#acfc803d4984b3037abb896038e4f6fc1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a0553f30a35d45bbc6ba7fd2120332c9c">m5_cond_broadcastFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wake up all processes waiting on the condition variable.  <a href="#a0553f30a35d45bbc6ba7fd2120332c9c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a2c38b28b551cfcfe04f70cbfbff3a55e">m5_cond_waitFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Wait on a condition.  <a href="#a2c38b28b551cfcfe04f70cbfbff3a55e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a56f0a437d8a86b1220497375406a3f78">m5_thread_exitFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thread exit.  <a href="#a56f0a437d8a86b1220497375406a3f78"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a82607daf4ef0639e0013656b0c861927">indirectSyscallFunc</a> (<a class="el" href="classSyscallDesc.html">SyscallDesc</a> *desc, int callnum, <a class="el" href="classLiveProcess.html">LiveProcess</a> *process, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Indirect syscall invocation (call #0).  <a href="#a82607daf4ef0639e0013656b0c861927"></a><br/></td></tr>
<tr><td colspan="2"><h2>Static Public 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a1a19d4c9718c9a4ad5fa2e48271fccc9">_SYS_NMLN</a> = 32</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Length of strings in struct <a class="el" href="structTru64_1_1utsname.html" title="Interface struct for uname().">utsname</a> (plus 1 for null char).  <a href="#a1a19d4c9718c9a4ad5fa2e48271fccc9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a284276950ab5fbb4ed5432a4fe77c0b4">NXM_TASK_INIT_VP</a> = 2</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For nxm_task_init.  <a href="#a284276950ab5fbb4ed5432a4fe77c0b4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#aad01339e89106fdf68f57ef118956fa9">hostname</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The target system's hostname.  <a href="#aad01339e89106fdf68f57ef118956fa9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static const int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classTru64.html#a42f5e6243e70c3d99afed9a0ab5ac3c1">NXM_LIB_VERSION</a> = 301003</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">NXM library version stamp.  <a href="#a42f5e6243e70c3d99afed9a0ab5ac3c1"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p>This class encapsulates the types, structures, constants, functions, and syscall-number mappings specific to the Alpha <a class="el" href="classTru64.html">Tru64</a> syscall interface. </p>
<hr/><h2>型定義</h2>
<a class="anchor" id="abf62b93d918a43f0c5ee0ab777b1c3ef"></a><!-- doxytag: member="Tru64::dev_t" ref="abf62b93d918a43f0c5ee0ab777b1c3ef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int32_t <a class="el" href="classTru64.html#abf62b93d918a43f0c5ee0ab777b1c3ef">dev_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abcb767738eec58d41562764284835524"></a><!-- doxytag: member="Tru64::fsid_t" ref="abcb767738eec58d41562764284835524" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="structTru64_1_1quad.html">quad</a> <a class="el" href="structTru64_1_1quad.html">fsid_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa7352f1065fe606194d792e2b292cf83"></a><!-- doxytag: member="Tru64::gid_t" ref="aa7352f1065fe606194d792e2b292cf83" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classTru64.html#aa7352f1065fe606194d792e2b292cf83">gid_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aed4e918b44240739869c4bdb1c4787a9"></a><!-- doxytag: member="Tru64::ino_t" ref="aed4e918b44240739869c4bdb1c4787a9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classTru64.html#aed4e918b44240739869c4bdb1c4787a9">ino_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af8f4385bb42836d1e3ad4fea9d71d1b9"></a><!-- doxytag: member="Tru64::mode_t" ref="af8f4385bb42836d1e3ad4fea9d71d1b9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classTru64.html#af8f4385bb42836d1e3ad4fea9d71d1b9">mode_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a772a435921844488d52ef4df39b3e702"></a><!-- doxytag: member="Tru64::nlink_t" ref="a772a435921844488d52ef4df39b3e702" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint16_t <a class="el" href="classTru64.html#a772a435921844488d52ef4df39b3e702">nlink_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2cb84cf5f02a29b7e8f237ff151a9225"></a><!-- doxytag: member="Tru64::off_t" ref="a2cb84cf5f02a29b7e8f237ff151a9225" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint64_t <a class="el" href="classTru64.html#a2cb84cf5f02a29b7e8f237ff151a9225">off_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae770e87ab143e8ad7feaf75b78a89718"></a><!-- doxytag: member="Tru64::sigset_t" ref="ae770e87ab143e8ad7feaf75b78a89718" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint64_t <a class="el" href="classTru64.html#ae770e87ab143e8ad7feaf75b78a89718">sigset_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Signal set. </p>

</div>
</div>
<a class="anchor" id="a186ea1339bffb378854987065835afe3"></a><!-- doxytag: member="Tru64::size_t" ref="a186ea1339bffb378854987065835afe3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef uint64_t <a class="el" href="classTru64.html#a186ea1339bffb378854987065835afe3">size_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Basic <a class="el" href="classTru64.html">Tru64</a> types. </p>

</div>
</div>
<a class="anchor" id="a3346b04b0420b32ccf6b706551b70762"></a><!-- doxytag: member="Tru64::time_t" ref="a3346b04b0420b32ccf6b706551b70762" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classTru64.html#a3346b04b0420b32ccf6b706551b70762">time_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af2306308627701b66dc6f3babe821ab4"></a><!-- doxytag: member="Tru64::uid_t" ref="af2306308627701b66dc6f3babe821ab4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classTru64.html#af2306308627701b66dc6f3babe821ab4">uid_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>列挙型</h2>
<a class="anchor" id="a68c01102755fc7d1c810bb0b0635fa90"></a><!-- doxytag: member="Tru64::@72" ref="a68c01102755fc7d1c810bb0b0635fa90" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return values for nxm calls. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a68c01102755fc7d1c810bb0b0635fa90a7fff089a9b1eae0e9e60e82d7ab27b03"></a><!-- doxytag: member="KERN_NOT_RECEIVER" ref="a68c01102755fc7d1c810bb0b0635fa90a7fff089a9b1eae0e9e60e82d7ab27b03" args="" -->KERN_NOT_RECEIVER</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a68c01102755fc7d1c810bb0b0635fa90ae5ac70379d7d014f8f37ba0ee504f35c"></a><!-- doxytag: member="KERN_NOT_IN_SET" ref="a68c01102755fc7d1c810bb0b0635fa90ae5ac70379d7d014f8f37ba0ee504f35c" args="" -->KERN_NOT_IN_SET</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00267"></a>00267          {
<a name="l00268"></a>00268         <a class="code" href="classTru64.html#a68c01102755fc7d1c810bb0b0635fa90a7fff089a9b1eae0e9e60e82d7ab27b03">KERN_NOT_RECEIVER</a> = 7,
<a name="l00269"></a>00269         <a class="code" href="classTru64.html#a68c01102755fc7d1c810bb0b0635fa90ae5ac70379d7d014f8f37ba0ee504f35c">KERN_NOT_IN_SET</a> = 12
<a name="l00270"></a>00270     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8fb8339baae435616a985ef0d3fa6af1"></a><!-- doxytag: member="Tru64::nxm_slot_state_t" ref="a8fb8339baae435616a985ef0d3fa6af1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1">nxm_slot_state_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>nxm_slot_state_t. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a8fb8339baae435616a985ef0d3fa6af1a50b7d030b516364e6a36300e54aedf42"></a><!-- doxytag: member="NXM_SLOT_AVAIL" ref="a8fb8339baae435616a985ef0d3fa6af1a50b7d030b516364e6a36300e54aedf42" args="" -->NXM_SLOT_AVAIL</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8fb8339baae435616a985ef0d3fa6af1ac7fa50c98e9a7cf0683966b0d6a6104e"></a><!-- doxytag: member="NXM_SLOT_BOUND" ref="a8fb8339baae435616a985ef0d3fa6af1ac7fa50c98e9a7cf0683966b0d6a6104e" args="" -->NXM_SLOT_BOUND</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8fb8339baae435616a985ef0d3fa6af1af2d76554995e1f7f2990e8deb0e444e5"></a><!-- doxytag: member="NXM_SLOT_UNBOUND" ref="a8fb8339baae435616a985ef0d3fa6af1af2d76554995e1f7f2990e8deb0e444e5" args="" -->NXM_SLOT_UNBOUND</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8fb8339baae435616a985ef0d3fa6af1aa29b88969e5bd1d58b5a3340c872c8ad"></a><!-- doxytag: member="NXM_SLOT_EMPTY" ref="a8fb8339baae435616a985ef0d3fa6af1aa29b88969e5bd1d58b5a3340c872c8ad" args="" -->NXM_SLOT_EMPTY</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00351"></a>00351                           {
<a name="l00352"></a>00352         <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1a50b7d030b516364e6a36300e54aedf42">NXM_SLOT_AVAIL</a>,
<a name="l00353"></a>00353         <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1ac7fa50c98e9a7cf0683966b0d6a6104e">NXM_SLOT_BOUND</a>,
<a name="l00354"></a>00354         <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1af2d76554995e1f7f2990e8deb0e444e5">NXM_SLOT_UNBOUND</a>,
<a name="l00355"></a>00355         <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1aa29b88969e5bd1d58b5a3340c872c8ad">NXM_SLOT_EMPTY</a>
<a name="l00356"></a>00356     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a047f3ab687492e1d75f613e182664384"></a><!-- doxytag: member="Tru64::nxm_thread_type" ref="a047f3ab687492e1d75f613e182664384" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classTru64.html#a047f3ab687492e1d75f613e182664384">nxm_thread_type</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>For nxm_thread_create. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a047f3ab687492e1d75f613e182664384a3ac97f98b04f22186a86480ad5fa471d"></a><!-- doxytag: member="NXM_TYPE_SCS" ref="a047f3ab687492e1d75f613e182664384a3ac97f98b04f22186a86480ad5fa471d" args="" -->NXM_TYPE_SCS</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a047f3ab687492e1d75f613e182664384a1d6a136a94a41d702244a74edccdb312"></a><!-- doxytag: member="NXM_TYPE_VP" ref="a047f3ab687492e1d75f613e182664384a1d6a136a94a41d702244a74edccdb312" args="" -->NXM_TYPE_VP</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a047f3ab687492e1d75f613e182664384a94b977628442e840a44dd81fdeb105ae"></a><!-- doxytag: member="NXM_TYPE_MANAGER" ref="a047f3ab687492e1d75f613e182664384a94b977628442e840a44dd81fdeb105ae" args="" -->NXM_TYPE_MANAGER</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00369"></a>00369                          {
<a name="l00370"></a>00370         <a class="code" href="classTru64.html#a047f3ab687492e1d75f613e182664384a3ac97f98b04f22186a86480ad5fa471d">NXM_TYPE_SCS</a>    = 0,
<a name="l00371"></a>00371         <a class="code" href="classTru64.html#a047f3ab687492e1d75f613e182664384a1d6a136a94a41d702244a74edccdb312">NXM_TYPE_VP</a>             = 1,
<a name="l00372"></a>00372         <a class="code" href="classTru64.html#a047f3ab687492e1d75f613e182664384a94b977628442e840a44dd81fdeb105ae">NXM_TYPE_MANAGER</a>        = 2
<a name="l00373"></a>00373     };
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="aaef9d5f33173de4f6d2875193eb83d7a"></a><!-- doxytag: member="Tru64::activate_waiting_context" ref="aaef9d5f33173de4f6d2875193eb83d7a" args="(Addr uaddr, LiveProcess *process, bool activate_all=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int activate_waiting_context </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>uaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>activate_all</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Activate thread context waiting on a channel. Just activate one by default. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00914"></a>00914     {
<a name="l00915"></a>00915         <span class="keyword">using namespace </span>std;
<a name="l00916"></a>00916 
<a name="l00917"></a>00917         <span class="keywordtype">int</span> num_activated = 0;
<a name="l00918"></a>00918 
<a name="l00919"></a>00919         list&lt;Process::WaitRec&gt;::iterator <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = process-&gt;<a class="code" href="classProcess.html#a8af61364ae9c966602b3b5ec1c0f7f09">waitList</a>.begin();
<a name="l00920"></a>00920         list&lt;Process::WaitRec&gt;::iterator end = process-&gt;<a class="code" href="classProcess.html#a8af61364ae9c966602b3b5ec1c0f7f09">waitList</a>.end();
<a name="l00921"></a>00921 
<a name="l00922"></a>00922         <span class="keywordflow">while</span> (i != end &amp;&amp; (num_activated == 0 || activate_all)) {
<a name="l00923"></a>00923             <span class="keywordflow">if</span> (i-&gt;waitChan == uaddr) {
<a name="l00924"></a>00924                 <span class="comment">// found waiting process: make it active</span>
<a name="l00925"></a>00925                 <a class="code" href="classThreadContext.html">ThreadContext</a> *newCtx = i-&gt;waitingContext;
<a name="l00926"></a>00926                 assert(newCtx-&gt;<a class="code" href="classThreadContext.html#adfba9b39542cba955a02b8ff3ba023a9">status</a>() == <a class="code" href="classThreadContext.html#a67a0db04d321a74b7e7fcfd3f1a3f70ba13bd6ff4bd5714ccc293f6802aacb40d">ThreadContext::Suspended</a>);
<a name="l00927"></a>00927                 newCtx-&gt;<a class="code" href="classThreadContext.html#a9270160e6cce25ded6999f6e4e60a3ed">activate</a>();
<a name="l00928"></a>00928 
<a name="l00929"></a>00929                 <span class="comment">// get rid of this record</span>
<a name="l00930"></a>00930                 i = process-&gt;<a class="code" href="classProcess.html#a8af61364ae9c966602b3b5ec1c0f7f09">waitList</a>.erase(i);
<a name="l00931"></a>00931 
<a name="l00932"></a>00932                 ++num_activated;
<a name="l00933"></a>00933             } <span class="keywordflow">else</span> {
<a name="l00934"></a>00934                 ++i;
<a name="l00935"></a>00935             }
<a name="l00936"></a>00936         }
<a name="l00937"></a>00937 
<a name="l00938"></a>00938         <span class="keywordflow">return</span> num_activated;
<a name="l00939"></a>00939     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab39f4973592abe61638b8b998bc5691d"></a><!-- doxytag: member="Tru64::copyOutStatfsBuf" ref="ab39f4973592abe61638b8b998bc5691d" args="(SETranslatingPortProxy &amp;mem, Addr addr, global_statfs *host)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void copyOutStatfsBuf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSETranslatingPortProxy.html">SETranslatingPortProxy</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>mem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="kern_2tru64_2tru64_8hh.html#a1a8529336c3f2704cb49ee2cd97412a8">global_statfs</a> *&nbsp;</td>
          <td class="paramname"> <em>host</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Helper function to convert a host statfs buffer to a target statfs buffer. Also copies the target buffer out to the simulated memory space. Used by statfs() and fstatfs(). </p>

<p><a class="el" href="classTru64__F64.html#ab39f4973592abe61638b8b998bc5691d">Tru64_F64</a>, と <a class="el" href="classTru64__PreF64.html#ab39f4973592abe61638b8b998bc5691d">Tru64_PreF64</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00402"></a>00402     {
<a name="l00403"></a>00403         <span class="keyword">using namespace </span>TheISA;
<a name="l00404"></a>00404 
<a name="l00405"></a>00405         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;T&gt;</a> tgt(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>);
<a name="l00406"></a>00406 
<a name="l00407"></a>00407 <span class="preprocessor">#if defined(__OpenBSD__) || defined(__APPLE__) || defined(__FreeBSD__)</span>
<a name="l00408"></a>00408 <span class="preprocessor"></span>        tgt-&gt;f_type = 0;
<a name="l00409"></a>00409 <span class="preprocessor">#else</span>
<a name="l00410"></a>00410 <span class="preprocessor"></span>        tgt-&gt;f_type = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_type);
<a name="l00411"></a>00411 <span class="preprocessor">#endif</span>
<a name="l00412"></a>00412 <span class="preprocessor"></span>        tgt-&gt;f_bsize = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_bsize);
<a name="l00413"></a>00413         tgt-&gt;f_blocks = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_blocks);
<a name="l00414"></a>00414         tgt-&gt;f_bfree = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_bfree);
<a name="l00415"></a>00415         tgt-&gt;f_bavail = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_bavail);
<a name="l00416"></a>00416         tgt-&gt;f_files = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_files);
<a name="l00417"></a>00417         tgt-&gt;f_ffree = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(host-&gt;f_ffree);
<a name="l00418"></a>00418 
<a name="l00419"></a>00419         <span class="comment">// Is this as string normally?</span>
<a name="l00420"></a>00420         memcpy(&amp;tgt-&gt;f_fsid, &amp;host-&gt;f_fsid, <span class="keyword">sizeof</span>(host-&gt;f_fsid));
<a name="l00421"></a>00421 
<a name="l00422"></a>00422         tgt.copyOut(mem);
<a name="l00423"></a>00423     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2e7bba81ca6d880e6cbf4e1db6100a68"></a><!-- doxytag: member="Tru64::getdirentriesFunc" ref="a2e7bba81ca6d880e6cbf4e1db6100a68" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> getdirentriesFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Target getdirentries() handler. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00434"></a>00434     {
<a name="l00435"></a>00435         <span class="keyword">using namespace </span>TheISA;
<a name="l00436"></a>00436 
<a name="l00437"></a>00437 <span class="preprocessor">#if defined(__APPLE__) || defined(__CYGWIN__)</span>
<a name="l00438"></a>00438 <span class="preprocessor"></span>        <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;getdirent not implemented on cygwin!&quot;</span>);
<a name="l00439"></a>00439 <span class="preprocessor">#else</span>
<a name="l00440"></a>00440 <span class="preprocessor"></span>        <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00441"></a>00441         <span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#a87001e8063b8b1b5dc88f5a4b43b2a5a">fd</a> = process-&gt;<a class="code" href="classProcess.html#ac7bb7ef35884d6fb4a2c02f167ab7679">sim_fd</a>(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00442"></a>00442         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> tgt_buf = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00443"></a>00443         <span class="keywordtype">int</span> tgt_nbytes = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00444"></a>00444         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> tgt_basep = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00445"></a>00445 
<a name="l00446"></a>00446         <span class="keywordtype">char</span> * <span class="keyword">const</span> host_buf = <span class="keyword">new</span> <span class="keywordtype">char</span>[tgt_nbytes];
<a name="l00447"></a>00447 
<a name="l00448"></a>00448         <span class="comment">// just pass basep through uninterpreted.</span>
<a name="l00449"></a>00449         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;int64_t&gt;</a> basep(tgt_basep);
<a name="l00450"></a>00450         basep.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00451"></a>00451         <span class="keywordtype">long</span> host_basep = (<a class="code" href="classTru64.html#a2cb84cf5f02a29b7e8f237ff151a9225">off_t</a>)<a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>((int64_t)*basep);
<a name="l00452"></a>00452         <span class="keywordtype">int</span> host_result = getdirentries(fd, host_buf, tgt_nbytes, &amp;host_basep);
<a name="l00453"></a>00453 
<a name="l00454"></a>00454         <span class="comment">// check for error</span>
<a name="l00455"></a>00455         <span class="keywordflow">if</span> (host_result &lt; 0) {
<a name="l00456"></a>00456             <span class="keyword">delete</span> [] host_buf;
<a name="l00457"></a>00457             <span class="keywordflow">return</span> -errno;
<a name="l00458"></a>00458         }
<a name="l00459"></a>00459 
<a name="l00460"></a>00460         <span class="comment">// no error: copy results back to target space</span>
<a name="l00461"></a>00461         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> tgt_buf_ptr = tgt_buf;
<a name="l00462"></a>00462         <span class="keywordtype">char</span> *host_buf_ptr = host_buf;
<a name="l00463"></a>00463         <span class="keywordtype">char</span> *host_buf_end = host_buf + host_result;
<a name="l00464"></a>00464         <span class="keywordflow">while</span> (host_buf_ptr &lt; host_buf_end) {
<a name="l00465"></a>00465             <a class="code" href="kern_2tru64_2tru64_8hh.html#ae8a7ba972c525e3d137846c7f1d0a1d5">global_dirent</a> *host_dp = (<a class="code" href="kern_2tru64_2tru64_8hh.html#ae8a7ba972c525e3d137846c7f1d0a1d5">global_dirent</a> *)host_buf_ptr;
<a name="l00466"></a>00466             <span class="keywordtype">int</span> namelen = strlen(host_dp-&gt;d_name);
<a name="l00467"></a>00467 
<a name="l00468"></a>00468             <span class="comment">// Actual size includes padded string rounded up for alignment.</span>
<a name="l00469"></a>00469             <span class="comment">// Subtract 256 for dummy char array in Tru64::dirent definition.</span>
<a name="l00470"></a>00470             <span class="comment">// Add 1 to namelen for terminating null char.</span>
<a name="l00471"></a>00471             <span class="keywordtype">int</span> tgt_bufsize = <span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1dirent.html" title="For getdirentries().">Tru64::dirent</a>) - 256 + <a class="code" href="intmath_8hh.html#a4d254a89b294890f6ce3a474f4e8c6c7">roundUp</a>(namelen+1, 8);
<a name="l00472"></a>00472             <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::dirent&gt;</a> tgt_dp(tgt_buf_ptr, tgt_bufsize);
<a name="l00473"></a>00473             tgt_dp-&gt;d_ino = host_dp-&gt;d_ino;
<a name="l00474"></a>00474             tgt_dp-&gt;d_reclen = tgt_bufsize;
<a name="l00475"></a>00475             tgt_dp-&gt;d_namlen = namelen;
<a name="l00476"></a>00476             strcpy(tgt_dp-&gt;d_name, host_dp-&gt;d_name);
<a name="l00477"></a>00477             tgt_dp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00478"></a>00478 
<a name="l00479"></a>00479             tgt_buf_ptr += tgt_bufsize;
<a name="l00480"></a>00480             host_buf_ptr += host_dp-&gt;d_reclen;
<a name="l00481"></a>00481         }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483         <span class="keyword">delete</span> [] host_buf;
<a name="l00484"></a>00484 
<a name="l00485"></a>00485         *basep = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>((int64_t)host_basep);
<a name="l00486"></a>00486         basep.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00487"></a>00487 
<a name="l00488"></a>00488         <span class="keywordflow">return</span> tgt_buf_ptr - tgt_buf;
<a name="l00489"></a>00489 <span class="preprocessor">#endif</span>
<a name="l00490"></a>00490 <span class="preprocessor"></span>    }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a82607daf4ef0639e0013656b0c861927"></a><!-- doxytag: member="Tru64::indirectSyscallFunc" ref="a82607daf4ef0639e0013656b0c861927" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> indirectSyscallFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Indirect syscall invocation (call #0). </p>

<p><div class="fragment"><pre class="fragment"><a name="l01100"></a>01100     {
<a name="l01101"></a>01101         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l01102"></a>01102         <span class="keywordtype">int</span> new_callnum = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01103"></a>01103 
<a name="l01104"></a>01104         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; 5; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>)
<a name="l01105"></a>01105             process-&gt;<a class="code" href="classLiveProcess.html#a0f596ddb560a15ade4257db3a6c9dd44">setSyscallArg</a>(tc, <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>, process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l01106"></a>01106 
<a name="l01107"></a>01107 
<a name="l01108"></a>01108         <a class="code" href="classSyscallDesc.html">SyscallDesc</a> *new_desc = process-&gt;<a class="code" href="classLiveProcess.html#a478f396f8895ef7728d26866a00121d7">getDesc</a>(new_callnum);
<a name="l01109"></a>01109         <span class="keywordflow">if</span> (desc == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>)
<a name="l01110"></a>01110             <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Syscall %d out of range&quot;</span>, callnum);
<a name="l01111"></a>01111 
<a name="l01112"></a>01112         new_desc-&gt;<a class="code" href="classSyscallDesc.html#a8a1b93297498c16444130f7ce9a12304" title="Emulate the syscall. Public interface for calling through funcPtr.">doSyscall</a>(new_callnum, process, tc);
<a name="l01113"></a>01113 
<a name="l01114"></a>01114         <span class="keywordflow">return</span> 0;
<a name="l01115"></a>01115     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a83da5f99bb14ade814d1509f55d1db1b"></a><!-- doxytag: member="Tru64::init_thread_context" ref="a83da5f99bb14ade814d1509f55d1db1b" args="(LiveProcess *process, ThreadContext *tc, Tru64::nxm_thread_attr *attrp, uint64_t uniq_val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void init_thread_context </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structTru64_1_1nxm__thread__attr.html">Tru64::nxm_thread_attr</a> *&nbsp;</td>
          <td class="paramname"> <em>attrp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>uniq_val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize thread context. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00694"></a>00694     {
<a name="l00695"></a>00695         <span class="keyword">using namespace </span>TheISA;
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         tc-&gt;<a class="code" href="classThreadContext.html#ae0375c0a094eeb6fe8f73db4393d4ceb">clearArchRegs</a>();
<a name="l00698"></a>00698 
<a name="l00699"></a>00699         process-&gt;<a class="code" href="classLiveProcess.html#a0f596ddb560a15ade4257db3a6c9dd44">setSyscallArg</a>(tc, 0, <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;<a class="code" href="structTru64_1_1nxm__thread__attr.html#a6c91caa556776951bbcfb885487bb2e3" title="Initial register values.">registers</a>.<a class="code" href="structTru64_1_1nxm__thread__attr.html#adafeae317d72d102ea18f6cdbbdee4db" title="a0">a0</a>));
<a name="l00700"></a>00700         tc-&gt;<a class="code" href="classThreadContext.html#a995ac11ab79af59e135d473df10c72da">setIntReg</a>(27<span class="comment">/*t12*/</span>, <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;<a class="code" href="structTru64_1_1nxm__thread__attr.html#a6c91caa556776951bbcfb885487bb2e3" title="Initial register values.">registers</a>.<a class="code" href="structTru64_1_1nxm__thread__attr.html#a37cc15f96d8bac81ed087fc247a0c5a0" title="pc">pc</a>));
<a name="l00701"></a>00701         tc-&gt;<a class="code" href="classThreadContext.html#a995ac11ab79af59e135d473df10c72da">setIntReg</a>(<a class="code" href="namespaceAlphaISA.html#a344fcaf70f4d9d6fe84dc5eda59e49eb">TheISA::StackPointerReg</a>, <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;<a class="code" href="structTru64_1_1nxm__thread__attr.html#a6c91caa556776951bbcfb885487bb2e3" title="Initial register values.">registers</a>.<a class="code" href="structTru64_1_1nxm__thread__attr.html#acd6941efd501803089091f06f1967f7d" title="sp">sp</a>));
<a name="l00702"></a>00702         tc-&gt;<a class="code" href="classThreadContext.html#a2987c1ff22ebdf6cdf354a31462bdbfb">setMiscRegNoEffect</a>(<a class="code" href="namespaceAlphaISA.html#a1e522017e015d4c7efd6b2360143aa67ac7d1563911c3c3cbd38713677fce2991">AlphaISA::MISCREG_UNIQ</a>, uniq_val);
<a name="l00703"></a>00703 
<a name="l00704"></a>00704         tc-&gt;<a class="code" href="classThreadContext.html#a1aaca26c0732d2191edbde1477d7ec13">pcState</a>(<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;<a class="code" href="structTru64_1_1nxm__thread__attr.html#a6c91caa556776951bbcfb885487bb2e3" title="Initial register values.">registers</a>.<a class="code" href="structTru64_1_1nxm__thread__attr.html#a37cc15f96d8bac81ed087fc247a0c5a0" title="pc">pc</a>));
<a name="l00705"></a>00705 
<a name="l00706"></a>00706         tc-&gt;<a class="code" href="classThreadContext.html#a9270160e6cce25ded6999f6e4e60a3ed">activate</a>();
<a name="l00707"></a>00707     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0553f30a35d45bbc6ba7fd2120332c9c"></a><!-- doxytag: member="Tru64::m5_cond_broadcastFunc" ref="a0553f30a35d45bbc6ba7fd2120332c9c" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_cond_broadcastFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wake up all processes waiting on the condition variable. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01051"></a>01051     {
<a name="l01052"></a>01052         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l01053"></a>01053         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> cond_addr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01054"></a>01054 
<a name="l01055"></a>01055         <a class="code" href="classTru64.html#aaef9d5f33173de4f6d2875193eb83d7a">activate_waiting_context</a>(cond_addr, process, <span class="keyword">true</span>);
<a name="l01056"></a>01056 
<a name="l01057"></a>01057         <span class="keywordflow">return</span> 0;
<a name="l01058"></a>01058     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acfc803d4984b3037abb896038e4f6fc1"></a><!-- doxytag: member="Tru64::m5_cond_signalFunc" ref="acfc803d4984b3037abb896038e4f6fc1" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_cond_signalFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Signal ocndition. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01037"></a>01037     {
<a name="l01038"></a>01038         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l01039"></a>01039         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> cond_addr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01040"></a>01040 
<a name="l01041"></a>01041         <span class="comment">// Wake up one process waiting on the condition variable.</span>
<a name="l01042"></a>01042         <a class="code" href="classTru64.html#aaef9d5f33173de4f6d2875193eb83d7a">activate_waiting_context</a>(cond_addr, process);
<a name="l01043"></a>01043 
<a name="l01044"></a>01044         <span class="keywordflow">return</span> 0;
<a name="l01045"></a>01045     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2c38b28b551cfcfe04f70cbfbff3a55e"></a><!-- doxytag: member="Tru64::m5_cond_waitFunc" ref="a2c38b28b551cfcfe04f70cbfbff3a55e" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_cond_waitFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Wait on a condition. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01064"></a>01064     {
<a name="l01065"></a>01065         <span class="keyword">using namespace </span>TheISA;
<a name="l01066"></a>01066 
<a name="l01067"></a>01067         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l01068"></a>01068         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> cond_addr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01069"></a>01069         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> lock_addr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01070"></a>01070         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;uint64_t&gt;</a> condp(cond_addr);
<a name="l01071"></a>01071         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;uint64_t&gt;</a> lockp(lock_addr);
<a name="l01072"></a>01072 
<a name="l01073"></a>01073         <span class="comment">// user is supposed to acquire lock before entering</span>
<a name="l01074"></a>01074         lockp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l01075"></a>01075         assert(<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(*lockp) != 0);
<a name="l01076"></a>01076 
<a name="l01077"></a>01077         <a class="code" href="classTru64.html#ac965ae70992f9a6f184c1e6f177e3b5b" title="M5 unlock call.">m5_unlock_mutex</a>(lock_addr, process, tc);
<a name="l01078"></a>01078 
<a name="l01079"></a>01079         process-&gt;<a class="code" href="classProcess.html#a8af61364ae9c966602b3b5ec1c0f7f09">waitList</a>.push_back(<a class="code" href="structProcess_1_1WaitRec.html">Process::WaitRec</a>(cond_addr, tc));
<a name="l01080"></a>01080         tc-&gt;<a class="code" href="classThreadContext.html#af2ae27d19d77b0301484ac488d97d37b" title="Set the status to Suspended.">suspend</a>();
<a name="l01081"></a>01081 
<a name="l01082"></a>01082         <span class="keywordflow">return</span> 0;
<a name="l01083"></a>01083     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a029c70f7b96e2ccaa00ea5252875de90"></a><!-- doxytag: member="Tru64::m5_lock_mutex" ref="a029c70f7b96e2ccaa00ea5252875de90" args="(Addr uaddr, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void m5_lock_mutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>uaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>M5 hacked-up lock acquire. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00944"></a>00944     {
<a name="l00945"></a>00945         <span class="keyword">using namespace </span>TheISA;
<a name="l00946"></a>00946 
<a name="l00947"></a>00947         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;uint64_t&gt;</a> lockp(uaddr);
<a name="l00948"></a>00948 
<a name="l00949"></a>00949         lockp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00950"></a>00950 
<a name="l00951"></a>00951         <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(*lockp) == 0) {
<a name="l00952"></a>00952             <span class="comment">// lock is free: grab it</span>
<a name="l00953"></a>00953             *lockp = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(1);
<a name="l00954"></a>00954             lockp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00955"></a>00955         } <span class="keywordflow">else</span> {
<a name="l00956"></a>00956             <span class="comment">// lock is busy: disable until free</span>
<a name="l00957"></a>00957             process-&gt;<a class="code" href="classProcess.html#a8af61364ae9c966602b3b5ec1c0f7f09">waitList</a>.push_back(<a class="code" href="structProcess_1_1WaitRec.html">Process::WaitRec</a>(uaddr, tc));
<a name="l00958"></a>00958             tc-&gt;<a class="code" href="classThreadContext.html#af2ae27d19d77b0301484ac488d97d37b" title="Set the status to Suspended.">suspend</a>();
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5a1fd874973f006aecd51e98ce0b6579"></a><!-- doxytag: member="Tru64::m5_mutex_lockFunc" ref="a5a1fd874973f006aecd51e98ce0b6579" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_mutex_lockFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Lock acquire syscall handler. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00985"></a>00985     {
<a name="l00986"></a>00986         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00987"></a>00987         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989         <a class="code" href="classTru64.html#a029c70f7b96e2ccaa00ea5252875de90" title="M5 hacked-up lock acquire.">m5_lock_mutex</a>(uaddr, process, tc);
<a name="l00990"></a>00990 
<a name="l00991"></a>00991         <span class="comment">// Return 0 since we will always return to the user with the lock</span>
<a name="l00992"></a>00992         <span class="comment">// acquired.  We will just keep the context inactive until that is</span>
<a name="l00993"></a>00993         <span class="comment">// true.</span>
<a name="l00994"></a>00994         <span class="keywordflow">return</span> 0;
<a name="l00995"></a>00995     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa8d051ea34736b976895f70df5f48b9d"></a><!-- doxytag: member="Tru64::m5_mutex_trylockFunc" ref="aa8d051ea34736b976895f70df5f48b9d" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_mutex_trylockFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Try lock (non-blocking). </p>

<p><div class="fragment"><pre class="fragment"><a name="l01001"></a>01001     {
<a name="l01002"></a>01002         <span class="keyword">using namespace </span>TheISA;
<a name="l01003"></a>01003 
<a name="l01004"></a>01004         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l01005"></a>01005         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01006"></a>01006         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;uint64_t&gt;</a> lockp(uaddr);
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         lockp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l01009"></a>01009 
<a name="l01010"></a>01010         <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(*lockp) == 0) {
<a name="l01011"></a>01011             <span class="comment">// lock is free: grab it</span>
<a name="l01012"></a>01012             *lockp = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(1);
<a name="l01013"></a>01013             lockp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l01014"></a>01014             <span class="keywordflow">return</span> 0;
<a name="l01015"></a>01015         } <span class="keywordflow">else</span> {
<a name="l01016"></a>01016             <span class="keywordflow">return</span> 1;
<a name="l01017"></a>01017         }
<a name="l01018"></a>01018     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a13ce77bfaa709faa1a3006cea0465959"></a><!-- doxytag: member="Tru64::m5_mutex_unlockFunc" ref="a13ce77bfaa709faa1a3006cea0465959" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_mutex_unlockFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unlock syscall handler. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01024"></a>01024     {
<a name="l01025"></a>01025         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l01026"></a>01026         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         <a class="code" href="classTru64.html#ac965ae70992f9a6f184c1e6f177e3b5b" title="M5 unlock call.">m5_unlock_mutex</a>(uaddr, process, tc);
<a name="l01029"></a>01029 
<a name="l01030"></a>01030         <span class="keywordflow">return</span> 0;
<a name="l01031"></a>01031     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56f0a437d8a86b1220497375406a3f78"></a><!-- doxytag: member="Tru64::m5_thread_exitFunc" ref="a56f0a437d8a86b1220497375406a3f78" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> m5_thread_exitFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Thread exit. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01089"></a>01089     {
<a name="l01090"></a>01090         assert(tc-&gt;<a class="code" href="classThreadContext.html#adfba9b39542cba955a02b8ff3ba023a9">status</a>() == <a class="code" href="classThreadContext.html#a67a0db04d321a74b7e7fcfd3f1a3f70ba26bd8444261cc58df7a86753c79d2520">ThreadContext::Active</a>);
<a name="l01091"></a>01091         tc-&gt;<a class="code" href="classThreadContext.html#a1cf6e868fcd49300a04acd0cae4fd142" title="Set the status to Halted.">halt</a>();
<a name="l01092"></a>01092 
<a name="l01093"></a>01093         <span class="keywordflow">return</span> 0;
<a name="l01094"></a>01094     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac965ae70992f9a6f184c1e6f177e3b5b"></a><!-- doxytag: member="Tru64::m5_unlock_mutex" ref="ac965ae70992f9a6f184c1e6f177e3b5b" args="(Addr uaddr, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void m5_unlock_mutex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>uaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>M5 unlock call. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00965"></a>00965     {
<a name="l00966"></a>00966         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;uint64_t&gt;</a> lockp(uaddr);
<a name="l00967"></a>00967 
<a name="l00968"></a>00968         lockp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00969"></a>00969         assert(*lockp != 0);
<a name="l00970"></a>00970 
<a name="l00971"></a>00971         <span class="comment">// Check for a process waiting on the lock.</span>
<a name="l00972"></a>00972         <span class="keywordtype">int</span> num_waiting = <a class="code" href="classTru64.html#aaef9d5f33173de4f6d2875193eb83d7a">activate_waiting_context</a>(uaddr, process);
<a name="l00973"></a>00973 
<a name="l00974"></a>00974         <span class="comment">// clear lock field if no waiting context is taking over the lock</span>
<a name="l00975"></a>00975         <span class="keywordflow">if</span> (num_waiting == 0) {
<a name="l00976"></a>00976             *lockp = 0;
<a name="l00977"></a>00977             lockp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00978"></a>00978         }
<a name="l00979"></a>00979     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad497f5d8e1f57340b73ad9ea52b88dd3"></a><!-- doxytag: member="Tru64::nxm_blockFunc" ref="ad497f5d8e1f57340b73ad9ea52b88dd3" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> nxm_blockFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>block. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00857"></a>00857     {
<a name="l00858"></a>00858         <span class="keyword">using namespace </span>std;
<a name="l00859"></a>00859 
<a name="l00860"></a>00860         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00861"></a>00861         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00862"></a>00862         uint64_t <a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a> = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00863"></a>00863         uint64_t secs = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00864"></a>00864         uint64_t usecs = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00865"></a>00865         uint64_t <a class="code" href="namespacem5_1_1debug.html#a9ceb38153d5c0f156fbeada6dc00ff4f">flags</a> = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00866"></a>00866 
<a name="l00867"></a>00867         <a class="code" href="classBaseCPU.html">BaseCPU</a> *cpu = tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>();
<a name="l00868"></a>00868 
<a name="l00869"></a>00869         cout &lt;&lt; cpu-&gt;name() &lt;&lt; <span class="stringliteral">&quot;: nxm_block &quot;</span>
<a name="l00870"></a>00870              &lt;&lt; hex &lt;&lt; uaddr &lt;&lt; dec &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; val
<a name="l00871"></a>00871              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; secs &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; usecs
<a name="l00872"></a>00872              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags &lt;&lt; endl;
<a name="l00873"></a>00873 
<a name="l00874"></a>00874         <span class="keywordflow">return</span> 0;
<a name="l00875"></a>00875     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7d672681a6c03ce2f3d8e64b159d23d7"></a><!-- doxytag: member="Tru64::nxm_idleFunc" ref="a7d672681a6c03ce2f3d8e64b159d23d7" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> nxm_idleFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Thread idle call (like yield()). </p>

<p><div class="fragment"><pre class="fragment"><a name="l00829"></a>00829     {
<a name="l00830"></a>00830         <span class="keywordflow">return</span> 0;
<a name="l00831"></a>00831     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7393c42ceaadfe69e71c4cab0d059968"></a><!-- doxytag: member="Tru64::nxm_task_initFunc" ref="a7393c42ceaadfe69e71c4cab0d059968" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> nxm_task_initFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This call sets up the interface between the user and kernel schedulers by creating a shared-memory region. The shared memory region has several structs, some global, some per-RAD, some per-VP. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00579"></a>00579     {
<a name="l00580"></a>00580         <span class="keyword">using namespace </span>std;
<a name="l00581"></a>00581         <span class="keyword">using namespace </span>TheISA;
<a name="l00582"></a>00582 
<a name="l00583"></a>00583         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00584"></a>00584         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_task_attr&gt;</a>
<a name="l00585"></a>00585             attrp(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00586"></a>00586         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Addr&gt;</a> configptr_ptr(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00587"></a>00587 
<a name="l00588"></a>00588         attrp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00589"></a>00589 
<a name="l00590"></a>00590         <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;nxm_version) != <a class="code" href="classTru64.html#a42f5e6243e70c3d99afed9a0ab5ac3c1" title="NXM library version stamp.">NXM_LIB_VERSION</a>) {
<a name="l00591"></a>00591             cerr &lt;&lt; <span class="stringliteral">&quot;nxm_task_init: thread library version mismatch! &quot;</span>
<a name="l00592"></a>00592                  &lt;&lt; <span class="stringliteral">&quot;got &quot;</span> &lt;&lt; attrp-&gt;nxm_version
<a name="l00593"></a>00593                  &lt;&lt; <span class="stringliteral">&quot;, expected &quot;</span> &lt;&lt; <a class="code" href="classTru64.html#a42f5e6243e70c3d99afed9a0ab5ac3c1" title="NXM library version stamp.">NXM_LIB_VERSION</a> &lt;&lt; endl;
<a name="l00594"></a>00594             abort();
<a name="l00595"></a>00595         }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597         <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;flags) != <a class="code" href="classTru64.html#a284276950ab5fbb4ed5432a4fe77c0b4" title="For nxm_task_init.">Tru64::NXM_TASK_INIT_VP</a>) {
<a name="l00598"></a>00598             cerr &lt;&lt; <span class="stringliteral">&quot;nxm_task_init: bad flag value &quot;</span> &lt;&lt; attrp-&gt;flags
<a name="l00599"></a>00599                  &lt;&lt; <span class="stringliteral">&quot; (expected &quot;</span> &lt;&lt; <a class="code" href="classTru64.html#a284276950ab5fbb4ed5432a4fe77c0b4" title="For nxm_task_init.">Tru64::NXM_TASK_INIT_VP</a> &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;
<a name="l00600"></a>00600             abort();
<a name="l00601"></a>00601         }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> base_addr = 0x12000; <span class="comment">// was 0x3f0000000LL;</span>
<a name="l00604"></a>00604         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> cur_addr = base_addr; <span class="comment">// next addresses to use</span>
<a name="l00605"></a>00605         <span class="comment">// first comes the config_info struct</span>
<a name="l00606"></a>00606         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> config_addr = cur_addr;
<a name="l00607"></a>00607         cur_addr += <span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1nxm__config__info.html" title="nxm_config_info">Tru64::nxm_config_info</a>);
<a name="l00608"></a>00608         <span class="comment">// next comes the per-cpu state vector</span>
<a name="l00609"></a>00609         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> slot_state_addr = cur_addr;
<a name="l00610"></a>00610         <span class="keywordtype">int</span> slot_state_size =
<a name="l00611"></a>00611             process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>() * <span class="keyword">sizeof</span>(<a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1" title="nxm_slot_state_t.">Tru64::nxm_slot_state_t</a>);
<a name="l00612"></a>00612         cur_addr += slot_state_size;
<a name="l00613"></a>00613         <span class="comment">// now the per-RAD state struct (we only support one RAD)</span>
<a name="l00614"></a>00614         cur_addr = 0x14000;     <span class="comment">// bump up addr for alignment</span>
<a name="l00615"></a>00615         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> rad_state_addr = cur_addr;
<a name="l00616"></a>00616         <span class="keywordtype">int</span> rad_state_size =
<a name="l00617"></a>00617             (<span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1nxm__shared.html" title="nxm_shared.">Tru64::nxm_shared</a>)
<a name="l00618"></a>00618              + (process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>()-1) * <span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1nxm__sched__state.html">Tru64::nxm_sched_state</a>));
<a name="l00619"></a>00619         cur_addr += rad_state_size;
<a name="l00620"></a>00620 
<a name="l00621"></a>00621         <span class="comment">// now initialize a config_info struct and copy it out to user space</span>
<a name="l00622"></a>00622         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_config_info&gt;</a> config(config_addr);
<a name="l00623"></a>00623 
<a name="l00624"></a>00624         config-&gt;nxm_nslots_per_rad = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>());
<a name="l00625"></a>00625         config-&gt;nxm_nrads = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(1);    <span class="comment">// only one RAD in our system!</span>
<a name="l00626"></a>00626         config-&gt;nxm_slot_state = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(slot_state_addr);
<a name="l00627"></a>00627         config-&gt;nxm_rad[0] = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(rad_state_addr);
<a name="l00628"></a>00628 
<a name="l00629"></a>00629         <span class="comment">// initialize the slot_state array and copy it out</span>
<a name="l00630"></a>00630         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_slot_state_t&gt;</a> slot_state(slot_state_addr,
<a name="l00631"></a>00631                                                            slot_state_size);
<a name="l00632"></a>00632         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>(); ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00633"></a>00633             <span class="comment">// CPU 0 is bound to the calling process; all others are available</span>
<a name="l00634"></a>00634             <span class="comment">// XXX this code should have an endian conversion, but I don&apos;t think</span>
<a name="l00635"></a>00635             <span class="comment">// it works anyway</span>
<a name="l00636"></a>00636             slot_state[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] =
<a name="l00637"></a>00637                 (<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> == 0) ? <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1ac7fa50c98e9a7cf0683966b0d6a6104e">Tru64::NXM_SLOT_BOUND</a> : <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1a50b7d030b516364e6a36300e54aedf42">Tru64::NXM_SLOT_AVAIL</a>;
<a name="l00638"></a>00638         }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640         <span class="comment">// same for the per-RAD &quot;shared&quot; struct.  Note that we need to</span>
<a name="l00641"></a>00641         <span class="comment">// allocate extra bytes for the per-VP array which is embedded at</span>
<a name="l00642"></a>00642         <span class="comment">// the end.</span>
<a name="l00643"></a>00643         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_shared&gt;</a> rad_state(rad_state_addr,
<a name="l00644"></a>00644                                                     rad_state_size);
<a name="l00645"></a>00645 
<a name="l00646"></a>00646         rad_state-&gt;nxm_callback = attrp-&gt;nxm_callback;
<a name="l00647"></a>00647         rad_state-&gt;nxm_version = attrp-&gt;nxm_version;
<a name="l00648"></a>00648         rad_state-&gt;nxm_uniq_offset = attrp-&gt;nxm_uniq_offset;
<a name="l00649"></a>00649         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>(); ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00650"></a>00650             <a class="code" href="structTru64_1_1nxm__sched__state.html">Tru64::nxm_sched_state</a> *ssp = &amp;rad_state-&gt;nxm_ss[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>];
<a name="l00651"></a>00651             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a84a273d642c19957017a87b1f54031e6" title="thread signal mask">sigmask</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00652"></a>00652             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a9c53d1e3c0bc3d8be6911f0f232a7079" title="thread pending mask">sig</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00653"></a>00653             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#ac8bf36fe0577cba66bccda3a6f7e80a4" title="shared flags">flags</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00654"></a>00654             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#aabbd9f971cb4aa1bd714e3f22cd35654" title="thread&amp;#39;s cancelation state">cancel_state</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00655"></a>00655             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#ab1f77590928da984017362cd8114956a" title="scheduler&amp;#39;s synchronous signals">nxm_ssig</a> = 0;
<a name="l00656"></a>00656             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#aebeca6fcbee8c6e89bdb8f64f661eda1" title="scheduler state / slot">nxm_bits</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00657"></a>00657             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#a1edf25e35f3eb9bddad20dec442db246" title="quantum count-down value">nxm_quantum</a> = attrp-&gt;nxm_quantum;
<a name="l00658"></a>00658             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#a9291f98fb828769c72a7342ac8b1432a" title="quantum reset value">nxm_set_quantum</a> = attrp-&gt;nxm_quantum;
<a name="l00659"></a>00659             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#aa46cf99f11765db5dcd6ea3d6f276d02" title="syscall state">nxm_sysevent</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00660"></a>00660 
<a name="l00661"></a>00661             <span class="keywordflow">if</span> (<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> == 0) {
<a name="l00662"></a>00662                 uint64_t uniq = tc-&gt;<a class="code" href="classThreadContext.html#a93c9c97261cb7289d5976b8222f70c4c">readMiscRegNoEffect</a>(<a class="code" href="namespaceAlphaISA.html#a1e522017e015d4c7efd6b2360143aa67ac7d1563911c3c3cbd38713677fce2991">AlphaISA::MISCREG_UNIQ</a>);
<a name="l00663"></a>00663                 ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a7e2b56424c95350d108ff8d0fab23b48" title="out-of-line state">pth_id</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(uniq + <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;nxm_uniq_offset));
<a name="l00664"></a>00664                 ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a1d8e8613bfc82fdd41b1a9cecff3a8c8" title="scheduler active">nxm_active</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(uniq | 1);
<a name="l00665"></a>00665             }
<a name="l00666"></a>00666             <span class="keywordflow">else</span> {
<a name="l00667"></a>00667                 ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a7e2b56424c95350d108ff8d0fab23b48" title="out-of-line state">pth_id</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00668"></a>00668                 ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a1d8e8613bfc82fdd41b1a9cecff3a8c8" title="scheduler active">nxm_active</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(0);
<a name="l00669"></a>00669             }
<a name="l00670"></a>00670         }
<a name="l00671"></a>00671 
<a name="l00672"></a>00672         <span class="comment">//</span>
<a name="l00673"></a>00673         <span class="comment">// copy pointer to shared config area out to user</span>
<a name="l00674"></a>00674         <span class="comment">//</span>
<a name="l00675"></a>00675         *configptr_ptr = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(config_addr);
<a name="l00676"></a>00676 
<a name="l00677"></a>00677         <span class="comment">// Register this as a valid address range with the process</span>
<a name="l00678"></a>00678         base_addr = <a class="code" href="intmath_8hh.html#a343c19b0ae885d5f3c7960987096e9d5">roundDown</a>(base_addr, <a class="code" href="namespaceAlphaISA.html#a06fc87d81c62e9abb8790b6e5713c55babe0c83362ff9a394bc07b0e26f089b83">VMPageSize</a>);
<a name="l00679"></a>00679         <span class="keywordtype">int</span> size = cur_addr - base_addr;
<a name="l00680"></a>00680         process-&gt;<a class="code" href="classProcess.html#aaebf8af407502fcc035e598795f77089">allocateMem</a>(base_addr, <a class="code" href="intmath_8hh.html#a4d254a89b294890f6ce3a474f4e8c6c7">roundUp</a>(size, <a class="code" href="namespaceAlphaISA.html#a06fc87d81c62e9abb8790b6e5713c55babe0c83362ff9a394bc07b0e26f089b83">VMPageSize</a>));
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         config.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00683"></a>00683         slot_state.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00684"></a>00684         rad_state.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00685"></a>00685         configptr_ptr.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00686"></a>00686 
<a name="l00687"></a>00687         <span class="keywordflow">return</span> 0;
<a name="l00688"></a>00688     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05e8a076d0c534c96b680a3661fc9003"></a><!-- doxytag: member="Tru64::nxm_thread_blockFunc" ref="a05e8a076d0c534c96b680a3661fc9003" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> nxm_thread_blockFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Block thread. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00837"></a>00837     {
<a name="l00838"></a>00838         <span class="keyword">using namespace </span>std;
<a name="l00839"></a>00839 
<a name="l00840"></a>00840         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00841"></a>00841         uint64_t tid = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00842"></a>00842         uint64_t secs = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00843"></a>00843         uint64_t <a class="code" href="namespacem5_1_1debug.html#a9ceb38153d5c0f156fbeada6dc00ff4f">flags</a> = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00844"></a>00844         uint64_t action = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00845"></a>00845         uint64_t usecs = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00846"></a>00846 
<a name="l00847"></a>00847         cout &lt;&lt; tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;name() &lt;&lt; <span class="stringliteral">&quot;: nxm_thread_block &quot;</span> &lt;&lt; tid &lt;&lt; <span class="stringliteral">&quot; &quot;</span>
<a name="l00848"></a>00848              &lt;&lt; secs &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; action &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; usecs &lt;&lt; endl;
<a name="l00849"></a>00849 
<a name="l00850"></a>00850         <span class="keywordflow">return</span> 0;
<a name="l00851"></a>00851     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56167e2aed868ff95f0864b9075adab1"></a><!-- doxytag: member="Tru64::nxm_thread_createFunc" ref="a56167e2aed868ff95f0864b9075adab1" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> nxm_thread_createFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create thread. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00713"></a>00713     {
<a name="l00714"></a>00714         <span class="keyword">using namespace </span>std;
<a name="l00715"></a>00715         <span class="keyword">using namespace </span>TheISA;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00718"></a>00718         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_thread_attr&gt;</a>
<a name="l00719"></a>00719             attrp(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00720"></a>00720         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;uint64_t&gt;</a> kidp(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00721"></a>00721         <span class="keywordtype">int</span> thread_index = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00722"></a>00722 
<a name="l00723"></a>00723         <span class="comment">// get attribute args</span>
<a name="l00724"></a>00724         attrp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00725"></a>00725 
<a name="l00726"></a>00726         <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;version) != <a class="code" href="classTru64.html#a42f5e6243e70c3d99afed9a0ab5ac3c1" title="NXM library version stamp.">NXM_LIB_VERSION</a>) {
<a name="l00727"></a>00727             cerr &lt;&lt; <span class="stringliteral">&quot;nxm_thread_create: thread library version mismatch! &quot;</span>
<a name="l00728"></a>00728                  &lt;&lt; <span class="stringliteral">&quot;got &quot;</span> &lt;&lt; attrp-&gt;version
<a name="l00729"></a>00729                  &lt;&lt; <span class="stringliteral">&quot;, expected &quot;</span> &lt;&lt; <a class="code" href="classTru64.html#a42f5e6243e70c3d99afed9a0ab5ac3c1" title="NXM library version stamp.">NXM_LIB_VERSION</a> &lt;&lt; endl;
<a name="l00730"></a>00730             abort();
<a name="l00731"></a>00731         }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733         <span class="keywordflow">if</span> (thread_index &lt; 0 || thread_index &gt; process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>()) {
<a name="l00734"></a>00734             cerr &lt;&lt; <span class="stringliteral">&quot;nxm_thread_create: bad thread index &quot;</span> &lt;&lt; thread_index
<a name="l00735"></a>00735                  &lt;&lt; endl;
<a name="l00736"></a>00736             abort();
<a name="l00737"></a>00737         }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739         <span class="comment">// On a real machine, the per-RAD shared structure is in</span>
<a name="l00740"></a>00740         <span class="comment">// shared memory, so both the user and kernel can get at it.</span>
<a name="l00741"></a>00741         <span class="comment">// We don&apos;t have that luxury, so we just copy it in and then</span>
<a name="l00742"></a>00742         <span class="comment">// back out again.</span>
<a name="l00743"></a>00743         <span class="keywordtype">int</span> rad_state_size =
<a name="l00744"></a>00744             (<span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1nxm__shared.html" title="nxm_shared.">Tru64::nxm_shared</a>) +
<a name="l00745"></a>00745              (process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>()-1) * <span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1nxm__sched__state.html">Tru64::nxm_sched_state</a>));
<a name="l00746"></a>00746 
<a name="l00747"></a>00747         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_shared&gt;</a> rad_state(0x14000,
<a name="l00748"></a>00748                                                     rad_state_size);
<a name="l00749"></a>00749         rad_state.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00750"></a>00750 
<a name="l00751"></a>00751         uint64_t uniq_val = <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;pthid) - <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(rad_state-&gt;nxm_uniq_offset);
<a name="l00752"></a>00752 
<a name="l00753"></a>00753         <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;type) == <a class="code" href="classTru64.html#a047f3ab687492e1d75f613e182664384a94b977628442e840a44dd81fdeb105ae">Tru64::NXM_TYPE_MANAGER</a>) {
<a name="l00754"></a>00754             <span class="comment">// DEC pthreads seems to always create one of these (in</span>
<a name="l00755"></a>00755             <span class="comment">// addition to N application threads), but we don&apos;t use it,</span>
<a name="l00756"></a>00756             <span class="comment">// so don&apos;t bother creating it.</span>
<a name="l00757"></a>00757 
<a name="l00758"></a>00758             <span class="comment">// This is supposed to be a port number.  Make something up.</span>
<a name="l00759"></a>00759             *kidp = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(99);
<a name="l00760"></a>00760             kidp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00761"></a>00761 
<a name="l00762"></a>00762             <span class="keywordflow">return</span> 0;
<a name="l00763"></a>00763         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(attrp-&gt;type) == <a class="code" href="classTru64.html#a047f3ab687492e1d75f613e182664384a1d6a136a94a41d702244a74edccdb312">Tru64::NXM_TYPE_VP</a>) {
<a name="l00764"></a>00764             <span class="comment">// A real &quot;virtual processor&quot; kernel thread.  Need to fork</span>
<a name="l00765"></a>00765             <span class="comment">// this thread on another CPU.</span>
<a name="l00766"></a>00766             <a class="code" href="structTru64_1_1nxm__sched__state.html">Tru64::nxm_sched_state</a> *ssp = &amp;rad_state-&gt;nxm_ss[thread_index];
<a name="l00767"></a>00767 
<a name="l00768"></a>00768             <span class="keywordflow">if</span> (<a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a1d8e8613bfc82fdd41b1a9cecff3a8c8" title="scheduler active">nxm_active</a>) != 0)
<a name="l00769"></a>00769                 <span class="keywordflow">return</span> (<span class="keywordtype">int</span>) <a class="code" href="classTru64.html#a68c01102755fc7d1c810bb0b0635fa90a7fff089a9b1eae0e9e60e82d7ab27b03">Tru64::KERN_NOT_RECEIVER</a>;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a7e2b56424c95350d108ff8d0fab23b48" title="out-of-line state">pth_id</a> = attrp-&gt;pthid;
<a name="l00772"></a>00772             ssp-&gt;<a class="code" href="structTru64_1_1nxm__sched__state.html#abff28b82019b9db3f64738a3048d0a46" title="state own by user thread">nxm_u</a>.<a class="code" href="structTru64_1_1ushared__state.html#a1d8e8613bfc82fdd41b1a9cecff3a8c8" title="scheduler active">nxm_active</a> = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(uniq_val | 1);
<a name="l00773"></a>00773 
<a name="l00774"></a>00774             rad_state.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00775"></a>00775 
<a name="l00776"></a>00776             <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> slot_state_addr = 0x12000 + <span class="keyword">sizeof</span>(<a class="code" href="structTru64_1_1nxm__config__info.html" title="nxm_config_info">Tru64::nxm_config_info</a>);
<a name="l00777"></a>00777             <span class="keywordtype">int</span> slot_state_size =
<a name="l00778"></a>00778                 process-&gt;<a class="code" href="classProcess.html#ac5c70b967092e10582ce2f165e174890">numCpus</a>() * <span class="keyword">sizeof</span>(<a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1" title="nxm_slot_state_t.">Tru64::nxm_slot_state_t</a>);
<a name="l00779"></a>00779 
<a name="l00780"></a>00780             <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::nxm_slot_state_t&gt;</a>
<a name="l00781"></a>00781                 slot_state(slot_state_addr,
<a name="l00782"></a>00782                            slot_state_size);
<a name="l00783"></a>00783 
<a name="l00784"></a>00784             slot_state.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00785"></a>00785 
<a name="l00786"></a>00786             <span class="keywordflow">if</span> (slot_state[thread_index] != <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1a50b7d030b516364e6a36300e54aedf42">Tru64::NXM_SLOT_AVAIL</a>) {
<a name="l00787"></a>00787                 cerr &lt;&lt; <span class="stringliteral">&quot;nxm_thread_createFunc: requested VP slot &quot;</span>
<a name="l00788"></a>00788                      &lt;&lt; thread_index &lt;&lt; <span class="stringliteral">&quot; not available!&quot;</span> &lt;&lt; endl;
<a name="l00789"></a>00789                 <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;&quot;</span>);
<a name="l00790"></a>00790             }
<a name="l00791"></a>00791 
<a name="l00792"></a>00792             <span class="comment">// XXX This should have an endian conversion but I think this code</span>
<a name="l00793"></a>00793             <span class="comment">// doesn&apos;t work anyway</span>
<a name="l00794"></a>00794             slot_state[thread_index] = <a class="code" href="classTru64.html#a8fb8339baae435616a985ef0d3fa6af1ac7fa50c98e9a7cf0683966b0d6a6104e">Tru64::NXM_SLOT_BOUND</a>;
<a name="l00795"></a>00795 
<a name="l00796"></a>00796             slot_state.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00797"></a>00797 
<a name="l00798"></a>00798             <span class="comment">// Find a free simulator thread context.</span>
<a name="l00799"></a>00799             <a class="code" href="classThreadContext.html">ThreadContext</a> *tc = process-&gt;<a class="code" href="classProcess.html#ac26b4f23be05f684886e00f4f7526a0e">findFreeContext</a>();
<a name="l00800"></a>00800             <span class="keywordflow">if</span> (tc) {
<a name="l00801"></a>00801                 <span class="comment">// inactive context... grab it</span>
<a name="l00802"></a>00802                 <a class="code" href="classTru64.html#a83da5f99bb14ade814d1509f55d1db1b" title="Initialize thread context.">init_thread_context</a>(process, tc, attrp, uniq_val);
<a name="l00803"></a>00803 
<a name="l00804"></a>00804                 <span class="comment">// This is supposed to be a port number, but we&apos;ll try</span>
<a name="l00805"></a>00805                 <span class="comment">// and get away with just sticking the thread index</span>
<a name="l00806"></a>00806                 <span class="comment">// here.</span>
<a name="l00807"></a>00807                 *kidp = <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(thread_index);
<a name="l00808"></a>00808                 kidp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00809"></a>00809 
<a name="l00810"></a>00810                 <span class="keywordflow">return</span> 0;
<a name="l00811"></a>00811             }
<a name="l00812"></a>00812 
<a name="l00813"></a>00813             <span class="comment">// fell out of loop... no available inactive context</span>
<a name="l00814"></a>00814             cerr &lt;&lt; <span class="stringliteral">&quot;nxm_thread_create: no idle contexts available.&quot;</span> &lt;&lt; endl;
<a name="l00815"></a>00815             abort();
<a name="l00816"></a>00816         } <span class="keywordflow">else</span> {
<a name="l00817"></a>00817             cerr &lt;&lt; <span class="stringliteral">&quot;nxm_thread_create: can&apos;t handle thread type &quot;</span>
<a name="l00818"></a>00818                  &lt;&lt; attrp-&gt;type &lt;&lt; endl;
<a name="l00819"></a>00819             abort();
<a name="l00820"></a>00820         }
<a name="l00821"></a>00821 
<a name="l00822"></a>00822         <span class="keywordflow">return</span> 0;
<a name="l00823"></a>00823     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abdd09a9b9645e7199d23afbdae212ef6"></a><!-- doxytag: member="Tru64::nxm_unblockFunc" ref="abdd09a9b9645e7199d23afbdae212ef6" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> nxm_unblockFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Unblock thread. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00881"></a>00881     {
<a name="l00882"></a>00882         <span class="keyword">using namespace </span>std;
<a name="l00883"></a>00883 
<a name="l00884"></a>00884         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00885"></a>00885         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> uaddr = process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index);
<a name="l00886"></a>00886 
<a name="l00887"></a>00887         cout &lt;&lt; tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;name() &lt;&lt; <span class="stringliteral">&quot;: nxm_unblock &quot;</span>
<a name="l00888"></a>00888              &lt;&lt; hex &lt;&lt; uaddr &lt;&lt; dec &lt;&lt; endl;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="keywordflow">return</span> 0;
<a name="l00891"></a>00891     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a368f998d81d17c06f2fb1639683f8302"></a><!-- doxytag: member="Tru64::sigreturnFunc" ref="a368f998d81d17c06f2fb1639683f8302" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> sigreturnFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Target sigreturn() handler. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00496"></a>00496     {
<a name="l00497"></a>00497         <span class="keyword">using namespace </span>TheISA;
<a name="l00498"></a>00498 
<a name="l00499"></a>00499         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00500"></a>00500         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::sigcontext&gt;</a> sc(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00501"></a>00501 
<a name="l00502"></a>00502         sc.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00503"></a>00503 
<a name="l00504"></a>00504         <span class="comment">// Restore state from sigcontext structure.</span>
<a name="l00505"></a>00505         <span class="comment">// Note that we&apos;ll advance PC &lt;- NPC before the end of the cycle,</span>
<a name="l00506"></a>00506         <span class="comment">// so we need to restore the desired PC into NPC.</span>
<a name="l00507"></a>00507         <span class="comment">// The current regs-&gt;pc will get clobbered.</span>
<a name="l00508"></a>00508         <a class="code" href="namespaceAlphaISA.html#af780de49982ecf691215cac9b9dfc615">PCState</a> <a class="code" href="inorder__dyn__inst_8cc.html#a0c864f905330c0fe3ecc683b7bf8b793">pc</a> = tc-&gt;<a class="code" href="classThreadContext.html#a1aaca26c0732d2191edbde1477d7ec13">pcState</a>();
<a name="l00509"></a>00509         pc.npc(<a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(sc-&gt;sc_pc));
<a name="l00510"></a>00510         tc-&gt;<a class="code" href="classThreadContext.html#a1aaca26c0732d2191edbde1477d7ec13">pcState</a>(pc);
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; 31; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00513"></a>00513             tc-&gt;<a class="code" href="classThreadContext.html#a995ac11ab79af59e135d473df10c72da">setIntReg</a>(<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>, <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(sc-&gt;sc_regs[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]));
<a name="l00514"></a>00514             tc-&gt;<a class="code" href="classThreadContext.html#a8f0c8b07cd1c4a6019a5b3922689d1db">setFloatRegBits</a>(<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>, <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(sc-&gt;sc_fpregs[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]));
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         tc-&gt;<a class="code" href="classThreadContext.html#a2987c1ff22ebdf6cdf354a31462bdbfb">setMiscRegNoEffect</a>(<a class="code" href="namespaceAlphaISA.html#a1e522017e015d4c7efd6b2360143aa67a015a601dd43bbdcfc4010fd4b4ab8489">AlphaISA::MISCREG_FPCR</a>, <a class="code" href="namespaceBigEndianGuest.html#a10c3370b6af5a1216a2a64c0d379f788">htog</a>(sc-&gt;sc_fpcr));
<a name="l00518"></a>00518 
<a name="l00519"></a>00519         <span class="keywordflow">return</span> 0;
<a name="l00520"></a>00520     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac6e3676ee42b0ad6a609f36f0cf654bb"></a><!-- doxytag: member="Tru64::stack_createFunc" ref="ac6e3676ee42b0ad6a609f36f0cf654bb" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> stack_createFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create a stack region for a thread. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00531"></a>00531     {
<a name="l00532"></a>00532         <span class="keyword">using namespace </span>TheISA;
<a name="l00533"></a>00533 
<a name="l00534"></a>00534         <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#ae6714ce3c5ef82205cecbd410556edf3">index</a> = 0;
<a name="l00535"></a>00535         <a class="code" href="classTypedBufferArg.html">TypedBufferArg&lt;Tru64::vm_stack&gt;</a> argp(process-&gt;<a class="code" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">getSyscallArg</a>(tc, index));
<a name="l00536"></a>00536 
<a name="l00537"></a>00537         argp.copyIn(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00538"></a>00538 
<a name="l00539"></a>00539         <span class="keywordtype">int</span> stack_size =
<a name="l00540"></a>00540             <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(argp-&gt;rsize) + <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(argp-&gt;ysize) + <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(argp-&gt;gsize);
<a name="l00541"></a>00541 
<a name="l00542"></a>00542         <span class="comment">// if the user chose an address, just let them have it.  Otherwise</span>
<a name="l00543"></a>00543         <span class="comment">// pick one for them.</span>
<a name="l00544"></a>00544         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> stack_base = <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(argp-&gt;address);
<a name="l00545"></a>00545 
<a name="l00546"></a>00546         <span class="keywordflow">if</span> (stack_base == 0) {
<a name="l00547"></a>00547             stack_base = process-&gt;<a class="code" href="classProcess.html#a55a3705006af6c58cba9f9a23ba89864">next_thread_stack_base</a>;
<a name="l00548"></a>00548             process-&gt;<a class="code" href="classProcess.html#a55a3705006af6c58cba9f9a23ba89864">next_thread_stack_base</a> -= stack_size;
<a name="l00549"></a>00549         }
<a name="l00550"></a>00550 
<a name="l00551"></a>00551         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> rounded_stack_base = <a class="code" href="intmath_8hh.html#a343c19b0ae885d5f3c7960987096e9d5">roundDown</a>(stack_base, <a class="code" href="namespaceAlphaISA.html#a06fc87d81c62e9abb8790b6e5713c55babe0c83362ff9a394bc07b0e26f089b83">VMPageSize</a>);
<a name="l00552"></a>00552         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> rounded_stack_size = <a class="code" href="intmath_8hh.html#a4d254a89b294890f6ce3a474f4e8c6c7">roundUp</a>(stack_size, <a class="code" href="namespaceAlphaISA.html#a06fc87d81c62e9abb8790b6e5713c55babe0c83362ff9a394bc07b0e26f089b83">VMPageSize</a>);
<a name="l00553"></a>00553 
<a name="l00554"></a>00554         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(SyscallVerbose,
<a name="l00555"></a>00555                 <span class="stringliteral">&quot;stack_create: allocating stack @ %#x size %#x &quot;</span>
<a name="l00556"></a>00556                 <span class="stringliteral">&quot;(rounded from %#x, %#x)\n&quot;</span>,
<a name="l00557"></a>00557                 rounded_stack_base, rounded_stack_size,
<a name="l00558"></a>00558                 stack_base, stack_size);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560         <span class="comment">// map memory</span>
<a name="l00561"></a>00561         process-&gt;<a class="code" href="classProcess.html#aaebf8af407502fcc035e598795f77089">allocateMem</a>(rounded_stack_base, rounded_stack_size);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563         argp-&gt;address = <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">gtoh</a>(rounded_stack_base);
<a name="l00564"></a>00564         argp.copyOut(tc-&gt;<a class="code" href="classThreadContext.html#a840e8764d04f2a3fb061c56738f3a874">getMemProxy</a>());
<a name="l00565"></a>00565 
<a name="l00566"></a>00566         <span class="keywordflow">return</span> 0;
<a name="l00567"></a>00567     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a447627b7d2862dbc933f4d4a4433cd4c"></a><!-- doxytag: member="Tru64::swtch_priFunc" ref="a447627b7d2862dbc933f4d4a4433cd4c" args="(SyscallDesc *desc, int callnum, LiveProcess *process, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="classSyscallReturn.html">SyscallReturn</a> swtch_priFunc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>callnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLiveProcess.html">LiveProcess</a> *&nbsp;</td>
          <td class="paramname"> <em>process</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classSwitch.html">Switch</a> thread priority. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00897"></a>00897     {
<a name="l00898"></a>00898         <span class="comment">// Attempts to switch to another runnable thread (if there is</span>
<a name="l00899"></a>00899         <span class="comment">// one).  Returns false if there are no other threads to run</span>
<a name="l00900"></a>00900         <span class="comment">// (i.e., the thread can reasonably spin-wait) or true if there</span>
<a name="l00901"></a>00901         <span class="comment">// are other threads.</span>
<a name="l00902"></a>00902         <span class="comment">//</span>
<a name="l00903"></a>00903         <span class="comment">// Since we assume at most one &quot;kernel&quot; thread per CPU, it&apos;s</span>
<a name="l00904"></a>00904         <span class="comment">// always safe to return false here.</span>
<a name="l00905"></a>00905         <span class="keywordflow">return</span> 0; <span class="comment">//false;</span>
<a name="l00906"></a>00906     }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a1a19d4c9718c9a4ad5fa2e48271fccc9"></a><!-- doxytag: member="Tru64::_SYS_NMLN" ref="a1a19d4c9718c9a4ad5fa2e48271fccc9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="classTru64.html#a1a19d4c9718c9a4ad5fa2e48271fccc9">_SYS_NMLN</a> = 32<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Length of strings in struct <a class="el" href="structTru64_1_1utsname.html" title="Interface struct for uname().">utsname</a> (plus 1 for null char). </p>

<p><a class="el" href="classOperatingSystem.html#a1a19d4c9718c9a4ad5fa2e48271fccc9">OperatingSystem</a>を再定義しています。</p>

</div>
</div>
<a class="anchor" id="aad01339e89106fdf68f57ef118956fa9"></a><!-- doxytag: member="Tru64::hostname" ref="aad01339e89106fdf68f57ef118956fa9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="classTru64.html#aad01339e89106fdf68f57ef118956fa9">hostname</a><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The target system's hostname. </p>

</div>
</div>
<a class="anchor" id="a42f5e6243e70c3d99afed9a0ab5ac3c1"></a><!-- doxytag: member="Tru64::NXM_LIB_VERSION" ref="a42f5e6243e70c3d99afed9a0ab5ac3c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="classTru64.html#a42f5e6243e70c3d99afed9a0ab5ac3c1">NXM_LIB_VERSION</a> = 301003<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>NXM library version stamp. </p>

</div>
</div>
<a class="anchor" id="a284276950ab5fbb4ed5432a4fe77c0b4"></a><!-- doxytag: member="Tru64::NXM_TASK_INIT_VP" ref="a284276950ab5fbb4ed5432a4fe77c0b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const int <a class="el" href="classTru64.html#a284276950ab5fbb4ed5432a4fe77c0b4">NXM_TASK_INIT_VP</a> = 2<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>For nxm_task_init. </p>
<p>initial thread is VP </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>kern/tru64/<a class="el" href="kern_2tru64_2tru64_8hh_source.html">tru64.hh</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
