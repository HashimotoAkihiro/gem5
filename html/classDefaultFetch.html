<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス テンプレート DefaultFetch&lt; Impl &gt;</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス テンプレート DefaultFetch&lt; Impl &gt;</h1><!-- doxytag: class="DefaultFetch" -->
<p><code>#include &lt;<a class="el" href="fetch_8hh_source.html">fetch.hh</a>&gt;</code></p>

<p><a href="classDefaultFetch-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>構成</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch_1_1FetchTranslation.html">FetchTranslation</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch_1_1FinishTranslationEvent.html">FinishTranslationEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structDefaultFetch_1_1Stalls.html">Stalls</a></td></tr>
<tr><td colspan="2"><h2>Public 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515e">FetchStatus</a> { <a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520">Active</a>, 
<a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a> { <br/>
&nbsp;&nbsp;<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca718b7867aa13dd84937c83334380edee">Fetching</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca8c49adf6da5f507150d403610c684877">TrapPending</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16">QuiescePending</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a>, 
<a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caadf72b4e66cdfa8a56beab05bb411da6">NoGoodAddr</a>
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3">FetchPriority</a> { <br/>
&nbsp;&nbsp;<a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3ae01d52cbe97a50e79f4195cd27b3185b">SingleThread</a>, 
<a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a5c08841de48c15133dd26a4d9d740a11">RoundRobin</a>, 
<a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a070f4c50ffea5accaf5f88606fc088a8">Branch</a>, 
<a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a7608065caa4249ff47a58c32d6f3c531">IQ</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a4cc572b5087c4e67104941ee638a8512">LSQ</a>
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef Impl::CPUPol&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a87d662eaeb9eab249d671b63cb4ba11a">CPUPol</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef Impl::DynInst&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ab741745c86a14c765b999c11167636d9">DynInst</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef Impl::DynInstPtr&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef Impl::O3CPU&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a44622cf06940413482836cb62931ac3f">O3CPU</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef CPUPol::FetchStruct&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef CPUPol::TimeStruct&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ab7dd3632ef639702a5c6e7c2c3a2f82a">TimeStruct</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef TheISA::MachInst&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4617f528417b8f55f809ae0988284c9b">MachInst</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef TheISA::ExtMachInst&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a5605d4fc727eae9e595325c90c0ec108">ExtMachInst</a></td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a96cb569fd8ae5efebb8e7716f435d9d2">DefaultFetch</a> (<a class="el" href="classDefaultFetch.html#a44622cf06940413482836cb62931ac3f">O3CPU</a> *_cpu, DerivO3CPUParams *params)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4dc637449366fcdfc4e764cdf12d9b11">regStats</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aa2dab17a363fd4307274d579796adcf7">regProbePoints</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aa9fe72c29dff746fa7023a15c1134ada">setTimeBuffer</a> (<a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt; *time_buffer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aab96bdacf8bd420402cbb543f994e054">setActiveThreads</a> (<a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt; *at_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ad1be90519aa7737ddf8e41de079a5ea9">setFetchQueue</a> (<a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a> &gt; *fq_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a31d4cbdab16d4ff8d6bc7f84ece727da">startupStage</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a29cb5a4f98063ce6e9210eacbdb35298">recvRetry</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a3dc029c2e87eb911352b82ff15c86236">processCacheCompletion</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a8f020d3237536fe007fc488c4125c5d8">drainResume</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0240eb42fa57fe5d3788093f62b77347">drainSanityCheck</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#adf5473c18a3d7c1e88c4a2072bce5526">isDrained</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a8674059ce345e23aac5086b2c3e24a43">takeOverFrom</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ad1c01dde67aa909bd829896f6f587502">drainStall</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a040cbeac7187b0b8cdb1242d3f5aa179">wakeFromQuiesce</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ae16ceb7406a5afe4ea9a39fd12931d32">squash</a> (const TheISA::PCState &amp;newPC, const <a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> seq_num, <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> squashInst, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a873dd91783f9efb4a590aded1f70d6b0">tick</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#af77f2bf38a75182c65e633b9fdf295d2">checkSignalsAndUpdate</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a77759cf15b084e00a9e4e8ca810a0be7">fetch</a> (bool &amp;status_change)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0c451948a0050595e5d23f57866f2797">fetchBufferAlignPC</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr)</td></tr>
<tr><td colspan="2"><h2>Public 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TheISA::Decoder *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a> [Impl::MaxThreads]</td></tr>
<tr><td colspan="2"><h2>Private メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ada2a699094bc420f977abf2a17ed14c8">resetStage</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a03ce24cba34d3da5948f54e10f8710a9">switchToActive</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a8ef9d48876d3014250c97bfba41a42cd">switchToInactive</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a033e8df655743382b3cb870600f70f82">lookupAndUpdateNextPC</a> (<a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> &amp;inst, TheISA::PCState &amp;<a class="el" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a2ede53ea19a95876fd2418fcc329ef9a">fetchCacheLine</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> vaddr, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ac7dca7de206b6388e989a53b56634ad4">finishTranslation</a> (<a class="el" href="classRefCountingPtr.html">Fault</a> fault, <a class="el" href="classRequest.html">RequestPtr</a> mem_req)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0949b3c8e74ae282010e2a8698525c72">checkInterrupt</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a9c960f5de0fbb0511596cba5039660a3">doSquash</a> (const TheISA::PCState &amp;newPC, const <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> squashInst, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#acddf0ab1e13108e3626da3743de398b8">squashFromDecode</a> (const TheISA::PCState &amp;newPC, const <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> squashInst, const <a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> seq_num, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a6ba4f2f95d991f5be818dabf7500feed">checkStall</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515e">FetchStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ac244c54ec94dd5e1d886dfd022752ec8">updateFetchStatus</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a9c38c3c5f6bb4a7c1919ca7d3d4e12dc">buildInst</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid, <a class="el" href="classRefCountingPtr.html">StaticInstPtr</a> staticInst, <a class="el" href="classRefCountingPtr.html">StaticInstPtr</a> curMacroop, TheISA::PCState thisPC, TheISA::PCState nextPC, bool trace)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4a20466270bc79a695af63ea67a35576">getFetchingThread</a> (<a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3">FetchPriority</a> &amp;fetch_priority)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a8aab9cacbc483081596b13ecd5192eb5">roundRobin</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4aff2ae442aa43bcb382774f7c429030">iqCount</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a2cce05272516009508e173f69d7d37df">lsqCount</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#adbe8a1ec70863059cb0e121edc864a14">branchCount</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a80cf75d186616b207a78a162498d1012">pipelineIcacheAccesses</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ab3fa3c541f25b65e1b61d7290712e507">profileStall</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515e">FetchStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3">FetchPriority</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classProbePointArg.html">ProbePointArg</a>&lt; <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a853ac5048dfdbba414f6f8186dd11afd">ppFetch</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch.html#a44622cf06940413482836cb62931ac3f">O3CPU</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ae99c54a9c8f1e218b86afcee348c54fc">fromRename</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a9a2f350be647ebfb6567172812db491a">fetchQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a5283adcc786817de9adc5a4601aa3a6f">toDecode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBPredUnit.html">BPredUnit</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">TheISA::PCState&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">StaticInstPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDefaultFetch_1_1Stalls.html">Stalls</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a2ef45e1e2bd510cfb43c0a03a6ab3f1c">decodeToFetchDelay</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ae97f1fdea38bf1719a7d45a15f3dcd5c">renameToFetchDelay</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a986e734c1e66dc0be1723ade04d06d4b">iewToFetchDelay</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4b0344f5703ba5770b42602c6df63340">commitToFetchDelay</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a9fb9a70efc5e29795473f1f92c082063">fetchBufferMask</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a924f2775385b2e5ac3008db4b8305c2b">fetchBuffer</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ae1475755791765b8e6f6a8bb091e273e">Counter</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a1848d938e5258a2a79298169e43efde5">lastIcacheStall</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a6f81783998429ac4a3e8b75a5d5d12d4">numFetchingThreads</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ac4dd16b14420d21b5704350fbbcefd04">threadFetched</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4004484fff11512f43124243e7eac71a">issuePipelinedIfetch</a> [Impl::MaxThreads]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDefaultFetch_1_1FinishTranslationEvent.html">FinishTranslationEvent</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a2b9328bdb1a6898bfae824981cd64311">icacheStallCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#af0e3fa228032036d2022ed9e2a3612b6">fetchedInsts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aaca0646636cde96795aed6beb2942975">fetchedBranches</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ae5c954036e76b5cc5a82cf7f17d4d5ed">predictedBranches</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a9699b5489dd499e832651b96f95b5d19">fetchCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ae1b92a3469ac6b00fddd788b71f64c9a">fetchSquashCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a9b08d665534d5e7d5b8134c4af16881d">fetchTlbCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a8af716ad2a53a409640347226078591c">fetchIdleCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0501ffad4abed98618a6cf0ba9c3599b">fetchBlockedCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0a77b8544fea92003669cdc78a46eea5">fetchMiscStallCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#ad09f9a8597b6f2c627b5c116d85ea375">fetchPendingDrainCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#aaa3b110a1f8e4fb7c88676a2ee836a06">fetchNoActiveThreadStallCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a5a80cd5375f1281e64f0dd318cc761d2">fetchPendingTrapStallCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a8be39e4ea9ed9168227dc6efced55f3f">fetchPendingQuiesceStallCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a85ea1666f596116bc53a277b388d39d7">fetchIcacheWaitRetryStallCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a0ead660daa133edcd64ac552d473ebba">fetchedCacheLines</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#af5ce6113f31fddaab758b8fb025600bc">fetchIcacheSquashes</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#afe07cb06e5135b2305320fa11fda71af">fetchTlbSquashes</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Distribution.html">Stats::Distribution</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4793a4a8857c13e7812b1c37c6df761b">fetchNisnDist</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a4b942e4ec6b8c1d29a1c96e901ea71dd">idleRate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#abceba4006d416e352df47f692b589bc3">branchRate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDefaultFetch.html#a7656c6cac3b62fa389148c650a5d127a">fetchRate</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<h3>template&lt;class Impl&gt;<br/>
 class DefaultFetch&lt; Impl &gt;</h3>

<p><a class="el" href="classDefaultFetch.html">DefaultFetch</a> class handles both single threaded and SMT fetch. Its width is specified by the parameters; each cycle it tries to fetch that many instructions. It supports using a branch predictor to predict direction and targets. It supports the idling functionality of the CPU by indicating to the CPU when it is active and inactive. </p>
<hr/><h2>型定義</h2>
<a class="anchor" id="a87d662eaeb9eab249d671b63cb4ba11a"></a><!-- doxytag: member="DefaultFetch::CPUPol" ref="a87d662eaeb9eab249d671b63cb4ba11a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef Impl::CPUPol <a class="el" href="classDefaultFetch.html#a87d662eaeb9eab249d671b63cb4ba11a">CPUPol</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Typedefs from Impl. </p>

</div>
</div>
<a class="anchor" id="ab741745c86a14c765b999c11167636d9"></a><!-- doxytag: member="DefaultFetch::DynInst" ref="ab741745c86a14c765b999c11167636d9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef Impl::DynInst <a class="el" href="classDefaultFetch.html#ab741745c86a14c765b999c11167636d9">DynInst</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a028ce10889c5f6450239d9e9a7347976"></a><!-- doxytag: member="DefaultFetch::DynInstPtr" ref="a028ce10889c5f6450239d9e9a7347976" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef Impl::DynInstPtr <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5605d4fc727eae9e595325c90c0ec108"></a><!-- doxytag: member="DefaultFetch::ExtMachInst" ref="a5605d4fc727eae9e595325c90c0ec108" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef TheISA::ExtMachInst <a class="el" href="classDefaultFetch.html#a5605d4fc727eae9e595325c90c0ec108">ExtMachInst</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3aac8607069f16898ef53cfaa2d97aeb"></a><!-- doxytag: member="DefaultFetch::FetchStruct" ref="a3aac8607069f16898ef53cfaa2d97aeb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef CPUPol::FetchStruct <a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Typedefs from the CPU policy. </p>

</div>
</div>
<a class="anchor" id="a4617f528417b8f55f809ae0988284c9b"></a><!-- doxytag: member="DefaultFetch::MachInst" ref="a4617f528417b8f55f809ae0988284c9b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef TheISA::MachInst <a class="el" href="classDefaultFetch.html#a4617f528417b8f55f809ae0988284c9b">MachInst</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Typedefs from ISA. </p>

</div>
</div>
<a class="anchor" id="a44622cf06940413482836cb62931ac3f"></a><!-- doxytag: member="DefaultFetch::O3CPU" ref="a44622cf06940413482836cb62931ac3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef Impl::O3CPU <a class="el" href="classDefaultFetch.html#a44622cf06940413482836cb62931ac3f">O3CPU</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab7dd3632ef639702a5c6e7c2c3a2f82a"></a><!-- doxytag: member="DefaultFetch::TimeStruct" ref="ab7dd3632ef639702a5c6e7c2c3a2f82a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef CPUPol::TimeStruct <a class="el" href="structTimeStruct.html">TimeStruct</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>列挙型</h2>
<a class="anchor" id="a818d5f50fdcec74a1a445b4fa8b760e3"></a><!-- doxytag: member="DefaultFetch::FetchPriority" ref="a818d5f50fdcec74a1a445b4fa8b760e3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3">FetchPriority</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fetching Policy, Add new policies here. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a818d5f50fdcec74a1a445b4fa8b760e3ae01d52cbe97a50e79f4195cd27b3185b"></a><!-- doxytag: member="SingleThread" ref="a818d5f50fdcec74a1a445b4fa8b760e3ae01d52cbe97a50e79f4195cd27b3185b" args="" -->SingleThread</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a818d5f50fdcec74a1a445b4fa8b760e3a5c08841de48c15133dd26a4d9d740a11"></a><!-- doxytag: member="RoundRobin" ref="a818d5f50fdcec74a1a445b4fa8b760e3a5c08841de48c15133dd26a4d9d740a11" args="" -->RoundRobin</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a818d5f50fdcec74a1a445b4fa8b760e3a070f4c50ffea5accaf5f88606fc088a8"></a><!-- doxytag: member="Branch" ref="a818d5f50fdcec74a1a445b4fa8b760e3a070f4c50ffea5accaf5f88606fc088a8" args="" -->Branch</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a818d5f50fdcec74a1a445b4fa8b760e3a7608065caa4249ff47a58c32d6f3c531"></a><!-- doxytag: member="IQ" ref="a818d5f50fdcec74a1a445b4fa8b760e3a7608065caa4249ff47a58c32d6f3c531" args="" -->IQ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a818d5f50fdcec74a1a445b4fa8b760e3a4cc572b5087c4e67104941ee638a8512"></a><!-- doxytag: member="LSQ" ref="a818d5f50fdcec74a1a445b4fa8b760e3a4cc572b5087c4e67104941ee638a8512" args="" -->LSQ</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00177"></a>00177                        {
<a name="l00178"></a>00178         <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3ae01d52cbe97a50e79f4195cd27b3185b">SingleThread</a>,
<a name="l00179"></a>00179         <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a5c08841de48c15133dd26a4d9d740a11">RoundRobin</a>,
<a name="l00180"></a>00180         <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a070f4c50ffea5accaf5f88606fc088a8">Branch</a>,
<a name="l00181"></a>00181         <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a7608065caa4249ff47a58c32d6f3c531">IQ</a>,
<a name="l00182"></a>00182         <a class="code" href="classLSQ.html">LSQ</a>
<a name="l00183"></a>00183     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a64605db3d589dcf77a170612ff89515e"></a><!-- doxytag: member="DefaultFetch::FetchStatus" ref="a64605db3d589dcf77a170612ff89515e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515e">FetchStatus</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Overall fetch status. Used to determine if the CPU can deschedule itsef due to a lack of activity. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520"></a><!-- doxytag: member="Active" ref="a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520" args="" -->Active</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6"></a><!-- doxytag: member="Inactive" ref="a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6" args="" -->Inactive</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00155"></a>00155                      {
<a name="l00156"></a>00156         <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520">Active</a>,
<a name="l00157"></a>00157         <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>
<a name="l00158"></a>00158     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2739961013a00cede621d4d72f2173c"></a><!-- doxytag: member="DefaultFetch::ThreadStatus" ref="ae2739961013a00cede621d4d72f2173c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Individual thread status. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb"></a><!-- doxytag: member="Running" ref="ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb" args="" -->Running</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19"></a><!-- doxytag: member="Idle" ref="ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19" args="" -->Idle</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7"></a><!-- doxytag: member="Squashing" ref="ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7" args="" -->Squashing</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30"></a><!-- doxytag: member="Blocked" ref="ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30" args="" -->Blocked</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca718b7867aa13dd84937c83334380edee"></a><!-- doxytag: member="Fetching" ref="ae2739961013a00cede621d4d72f2173ca718b7867aa13dd84937c83334380edee" args="" -->Fetching</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca8c49adf6da5f507150d403610c684877"></a><!-- doxytag: member="TrapPending" ref="ae2739961013a00cede621d4d72f2173ca8c49adf6da5f507150d403610c684877" args="" -->TrapPending</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16"></a><!-- doxytag: member="QuiescePending" ref="ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16" args="" -->QuiescePending</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33"></a><!-- doxytag: member="ItlbWait" ref="ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33" args="" -->ItlbWait</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852"></a><!-- doxytag: member="IcacheWaitResponse" ref="ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852" args="" -->IcacheWaitResponse</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3"></a><!-- doxytag: member="IcacheWaitRetry" ref="ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3" args="" -->IcacheWaitRetry</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e"></a><!-- doxytag: member="IcacheAccessComplete" ref="ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e" args="" -->IcacheAccessComplete</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173caadf72b4e66cdfa8a56beab05bb411da6"></a><!-- doxytag: member="NoGoodAddr" ref="ae2739961013a00cede621d4d72f2173caadf72b4e66cdfa8a56beab05bb411da6" args="" -->NoGoodAddr</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00161"></a>00161                       {
<a name="l00162"></a>00162         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>,
<a name="l00163"></a>00163         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>,
<a name="l00164"></a>00164         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>,
<a name="l00165"></a>00165         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>,
<a name="l00166"></a>00166         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca718b7867aa13dd84937c83334380edee">Fetching</a>,
<a name="l00167"></a>00167         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca8c49adf6da5f507150d403610c684877">TrapPending</a>,
<a name="l00168"></a>00168         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16">QuiescePending</a>,
<a name="l00169"></a>00169         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a>,
<a name="l00170"></a>00170         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>,
<a name="l00171"></a>00171         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a>,
<a name="l00172"></a>00172         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a>,
<a name="l00173"></a>00173         <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caadf72b4e66cdfa8a56beab05bb411da6">NoGoodAddr</a>
<a name="l00174"></a>00174     };
</pre></div></p>

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="a96cb569fd8ae5efebb8e7716f435d9d2"></a><!-- doxytag: member="DefaultFetch::DefaultFetch" ref="a96cb569fd8ae5efebb8e7716f435d9d2" args="(O3CPU *_cpu, DerivO3CPUParams *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch.html">DefaultFetch</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDefaultFetch.html#a44622cf06940413482836cb62931ac3f">O3CPU</a> *&nbsp;</td>
          <td class="paramname"> <em>_cpu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DerivO3CPUParams *&nbsp;</td>
          <td class="paramname"> <em>params</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classDefaultFetch.html">DefaultFetch</a> constructor. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00079"></a>00079     : <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>(_cpu),
<a name="l00080"></a>00080       <a class="code" href="classDefaultFetch.html#a2ef45e1e2bd510cfb43c0a03a6ab3f1c">decodeToFetchDelay</a>(params-&gt;decodeToFetchDelay),
<a name="l00081"></a>00081       <a class="code" href="classDefaultFetch.html#ae97f1fdea38bf1719a7d45a15f3dcd5c">renameToFetchDelay</a>(params-&gt;renameToFetchDelay),
<a name="l00082"></a>00082       <a class="code" href="classDefaultFetch.html#a986e734c1e66dc0be1723ade04d06d4b">iewToFetchDelay</a>(params-&gt;iewToFetchDelay),
<a name="l00083"></a>00083       <a class="code" href="classDefaultFetch.html#a4b0344f5703ba5770b42602c6df63340">commitToFetchDelay</a>(params-&gt;commitToFetchDelay),
<a name="l00084"></a>00084       <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>(params-&gt;fetchWidth),
<a name="l00085"></a>00085       <a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a>(<a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>),
<a name="l00086"></a>00086       <a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a>(<a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>),
<a name="l00087"></a>00087       <a class="code" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a>(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;cacheLineSize()),
<a name="l00088"></a>00088       <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>(params-&gt;fetchBufferSize),
<a name="l00089"></a>00089       <a class="code" href="classDefaultFetch.html#a9fb9a70efc5e29795473f1f92c082063">fetchBufferMask</a>(<a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a> - 1),
<a name="l00090"></a>00090       <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>(params-&gt;numThreads),
<a name="l00091"></a>00091       <a class="code" href="classDefaultFetch.html#a6f81783998429ac4a3e8b75a5d5d12d4">numFetchingThreads</a>(params-&gt;smtNumFetchingThreads),
<a name="l00092"></a>00092       <a class="code" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a>(<span class="keyword">this</span>)
<a name="l00093"></a>00093 {
<a name="l00094"></a>00094     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a> &gt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">Impl::MaxThreads</a>)
<a name="l00095"></a>00095         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;numThreads (%d) is larger than compiled limit (%d),\n&quot;</span>
<a name="l00096"></a>00096               <span class="stringliteral">&quot;\tincrease MaxThreads in src/cpu/o3/impl.hh\n&quot;</span>,
<a name="l00097"></a>00097               <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>, static_cast&lt;int&gt;(<a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">Impl::MaxThreads</a>));
<a name="l00098"></a>00098     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a> &gt; Impl::MaxWidth)
<a name="l00099"></a>00099         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;fetchWidth (%d) is larger than compiled limit (%d),\n&quot;</span>
<a name="l00100"></a>00100              <span class="stringliteral">&quot;\tincrease MaxWidth in src/cpu/o3/impl.hh\n&quot;</span>,
<a name="l00101"></a>00101              <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>, static_cast&lt;int&gt;(Impl::MaxWidth));
<a name="l00102"></a>00102     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a> &gt; <a class="code" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a>)
<a name="l00103"></a>00103         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;fetch buffer size (%u bytes) is greater than the cache &quot;</span>
<a name="l00104"></a>00104               <span class="stringliteral">&quot;block size (%u bytes)\n&quot;</span>, <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>, <a class="code" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a>);
<a name="l00105"></a>00105     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a> % <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>)
<a name="l00106"></a>00106         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;cache block (%u bytes) is not a multiple of the &quot;</span>
<a name="l00107"></a>00107               <span class="stringliteral">&quot;fetch buffer (%u bytes)\n&quot;</span>, <a class="code" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a>, fetchBufferSize);
<a name="l00108"></a>00108 
<a name="l00109"></a>00109     std::string policy = params-&gt;smtFetchPolicy;
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <span class="comment">// Convert string to lowercase</span>
<a name="l00112"></a>00112     std::transform(policy.begin(), policy.end(), policy.begin(),
<a name="l00113"></a>00113                    (int(*)(int)) tolower);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="comment">// Figure out fetch policy</span>
<a name="l00116"></a>00116     <span class="keywordflow">if</span> (policy == <span class="stringliteral">&quot;singlethread&quot;</span>) {
<a name="l00117"></a>00117         <a class="code" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a> = <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3ae01d52cbe97a50e79f4195cd27b3185b">SingleThread</a>;
<a name="l00118"></a>00118         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a> &gt; 1)
<a name="l00119"></a>00119             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Invalid Fetch Policy for a SMT workload.&quot;</span>);
<a name="l00120"></a>00120     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (policy == <span class="stringliteral">&quot;roundrobin&quot;</span>) {
<a name="l00121"></a>00121         <a class="code" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a> = <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a5c08841de48c15133dd26a4d9d740a11">RoundRobin</a>;
<a name="l00122"></a>00122         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch policy set to Round Robin\n&quot;</span>);
<a name="l00123"></a>00123     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (policy == <span class="stringliteral">&quot;branch&quot;</span>) {
<a name="l00124"></a>00124         <a class="code" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a> = <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a070f4c50ffea5accaf5f88606fc088a8">Branch</a>;
<a name="l00125"></a>00125         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch policy set to Branch Count\n&quot;</span>);
<a name="l00126"></a>00126     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (policy == <span class="stringliteral">&quot;iqcount&quot;</span>) {
<a name="l00127"></a>00127         <a class="code" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a> = <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a7608065caa4249ff47a58c32d6f3c531">IQ</a>;
<a name="l00128"></a>00128         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch policy set to IQ count\n&quot;</span>);
<a name="l00129"></a>00129     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (policy == <span class="stringliteral">&quot;lsqcount&quot;</span>) {
<a name="l00130"></a>00130         <a class="code" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a> = <a class="code" href="classLSQ.html">LSQ</a>;
<a name="l00131"></a>00131         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch policy set to LSQ count\n&quot;</span>);
<a name="l00132"></a>00132     } <span class="keywordflow">else</span> {
<a name="l00133"></a>00133         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Invalid Fetch Policy. Options Are: {SingleThread,&quot;</span>
<a name="l00134"></a>00134               <span class="stringliteral">&quot; RoundRobin,LSQcount,IQcount}\n&quot;</span>);
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="comment">// Get the size of an instruction.</span>
<a name="l00138"></a>00138     <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a> = <span class="keyword">sizeof</span>(<a class="code" href="namespaceAlphaISA.html#a301c22ea09fa33dcfe6ddf22f203699c">TheISA::MachInst</a>);
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">Impl::MaxThreads</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00141"></a>00141         <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00142"></a>00142         <a class="code" href="classDefaultFetch.html#a924f2775385b2e5ac3008db4b8305c2b">fetchBuffer</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00143"></a>00143         <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = 0;
<a name="l00144"></a>00144         <a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = <span class="keyword">false</span>;
<a name="l00145"></a>00145     }
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a> = params-&gt;branchPred;
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = 0; tid &lt; <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; tid++) {
<a name="l00150"></a>00150         <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid] = <span class="keyword">new</span> TheISA::Decoder;
<a name="l00151"></a>00151         <span class="comment">// Create space to buffer the cache line data,</span>
<a name="l00152"></a>00152         <span class="comment">// which may not hold the entire cache line.</span>
<a name="l00153"></a>00153         <a class="code" href="classDefaultFetch.html#a924f2775385b2e5ac3008db4b8305c2b">fetchBuffer</a>[tid] = <span class="keyword">new</span> uint8_t[fetchBufferSize];
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="adbe8a1ec70863059cb0e121edc864a14"></a><!-- doxytag: member="DefaultFetch::branchCount" ref="adbe8a1ec70863059cb0e121edc864a14" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> branchCount </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the appropriate thread to fetch using the branch count policy. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01570"></a>01570 {
<a name="l01571"></a>01571 <span class="preprocessor">#if 0</span>
<a name="l01572"></a>01572 <span class="preprocessor"></span>    <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> thread = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l01573"></a>01573     assert(thread != <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end());
<a name="l01574"></a>01574     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *thread;
<a name="l01575"></a>01575 <span class="preprocessor">#endif</span>
<a name="l01576"></a>01576 <span class="preprocessor"></span>
<a name="l01577"></a>01577     <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Branch Count Fetch policy unimplemented\n&quot;</span>);
<a name="l01578"></a>01578     <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01579"></a>01579 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c38c3c5f6bb4a7c1919ca7d3d4e12dc"></a><!-- doxytag: member="DefaultFetch::buildInst" ref="a9c38c3c5f6bb4a7c1919ca7d3d4e12dc" args="(ThreadID tid, StaticInstPtr staticInst, StaticInstPtr curMacroop, TheISA::PCState thisPC, TheISA::PCState nextPC, bool trace)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Impl::DynInstPtr buildInst </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">StaticInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>staticInst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">StaticInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>curMacroop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TheISA::PCState&nbsp;</td>
          <td class="paramname"> <em>thisPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TheISA::PCState&nbsp;</td>
          <td class="paramname"> <em>nextPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>trace</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01090"></a>01090 {
<a name="l01091"></a>01091     <span class="comment">// Get a sequence number.</span>
<a name="l01092"></a>01092     <a class="code" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> seq = <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;getAndIncrementInstSeq();
<a name="l01093"></a>01093 
<a name="l01094"></a>01094     <span class="comment">// Create a new DynInst from the instruction fetched.</span>
<a name="l01095"></a>01095     <a class="code" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> instruction =
<a name="l01096"></a>01096         <span class="keyword">new</span> <a class="code" href="classDefaultFetch.html#ab741745c86a14c765b999c11167636d9">DynInst</a>(staticInst, curMacroop, thisPC, nextPC, seq, <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>);
<a name="l01097"></a>01097     instruction-&gt;setTid(tid);
<a name="l01098"></a>01098 
<a name="l01099"></a>01099     instruction-&gt;setASID(tid);
<a name="l01100"></a>01100 
<a name="l01101"></a>01101     instruction-&gt;setThreadState(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;thread[tid]);
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Instruction PC %#x (%d) created &quot;</span>
<a name="l01104"></a>01104             <span class="stringliteral">&quot;[sn:%lli].\n&quot;</span>, tid, thisPC.instAddr(),
<a name="l01105"></a>01105             thisPC.microPC(), seq);
<a name="l01106"></a>01106 
<a name="l01107"></a>01107     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Instruction is: %s\n&quot;</span>, tid,
<a name="l01108"></a>01108             instruction-&gt;staticInst-&gt;
<a name="l01109"></a>01109             disassemble(thisPC.instAddr()));
<a name="l01110"></a>01110 
<a name="l01111"></a>01111 <span class="preprocessor">#if TRACING_ON</span>
<a name="l01112"></a>01112 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (trace) {
<a name="l01113"></a>01113         instruction-&gt;traceData =
<a name="l01114"></a>01114             <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;getTracer()-&gt;getInstRecord(<a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>(), <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;tcBase(tid),
<a name="l01115"></a>01115                     instruction-&gt;staticInst, thisPC, curMacroop);
<a name="l01116"></a>01116     }
<a name="l01117"></a>01117 <span class="preprocessor">#else</span>
<a name="l01118"></a>01118 <span class="preprocessor"></span>    instruction-&gt;traceData = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l01119"></a>01119 <span class="preprocessor">#endif</span>
<a name="l01120"></a>01120 <span class="preprocessor"></span>
<a name="l01121"></a>01121     <span class="comment">// Add instruction to the CPU&apos;s list of instructions.</span>
<a name="l01122"></a>01122     instruction-&gt;setInstListIt(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;addInst(instruction));
<a name="l01123"></a>01123 
<a name="l01124"></a>01124     <span class="comment">// Write the instruction to the first slot in the queue</span>
<a name="l01125"></a>01125     <span class="comment">// that heads to decode.</span>
<a name="l01126"></a>01126     assert(<a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> &lt; <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>);
<a name="l01127"></a>01127     <a class="code" href="classDefaultFetch.html#a5283adcc786817de9adc5a4601aa3a6f">toDecode</a>-&gt;insts[<a class="code" href="classDefaultFetch.html#a5283adcc786817de9adc5a4601aa3a6f">toDecode</a>-&gt;<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>++] = instruction;
<a name="l01128"></a>01128 
<a name="l01129"></a>01129     <span class="comment">// Keep track of if we can take an interrupt at this boundary</span>
<a name="l01130"></a>01130     <a class="code" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a>[tid] = instruction-&gt;isDelayedCommit();
<a name="l01131"></a>01131 
<a name="l01132"></a>01132     <span class="keywordflow">return</span> instruction;
<a name="l01133"></a>01133 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0949b3c8e74ae282010e2a8698525c72"></a><!-- doxytag: member="DefaultFetch::checkInterrupt" ref="a0949b3c8e74ae282010e2a8698525c72" args="(Addr pc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkInterrupt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>pc</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classCheck.html">Check</a> if an interrupt is pending and that we need to handle </p>

<p><div class="fragment"><pre class="fragment"><a name="l00302"></a>00302     {
<a name="l00303"></a>00303         <span class="keywordflow">return</span> (<a class="code" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a> &amp;&amp; (THE_ISA != ALPHA_ISA || !(<a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a> &amp; 0x3)));
<a name="l00304"></a>00304     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af77f2bf38a75182c65e633b9fdf295d2"></a><!-- doxytag: member="DefaultFetch::checkSignalsAndUpdate" ref="af77f2bf38a75182c65e633b9fdf295d2" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkSignalsAndUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks all input signals and updates the status as necessary. </p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>: Returns if the status has changed due to input signals. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00943"></a>00943 {
<a name="l00944"></a>00944     <span class="comment">// Update the per thread stall statuses.</span>
<a name="l00945"></a>00945     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeBlock[tid]) {
<a name="l00946"></a>00946         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a8bd8acc41e5baa0bb18c0f0f6a78020e">decode</a> = <span class="keyword">true</span>;
<a name="l00947"></a>00947     }
<a name="l00948"></a>00948 
<a name="l00949"></a>00949     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeUnblock[tid]) {
<a name="l00950"></a>00950         assert(<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].decode);
<a name="l00951"></a>00951         assert(!<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeBlock[tid]);
<a name="l00952"></a>00952         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a8bd8acc41e5baa0bb18c0f0f6a78020e">decode</a> = <span class="keyword">false</span>;
<a name="l00953"></a>00953     }
<a name="l00954"></a>00954 
<a name="l00955"></a>00955     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ae99c54a9c8f1e218b86afcee348c54fc">fromRename</a>-&gt;renameBlock[tid]) {
<a name="l00956"></a>00956         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a5e8e124987c56967514ad546a9f9c09b">rename</a> = <span class="keyword">true</span>;
<a name="l00957"></a>00957     }
<a name="l00958"></a>00958 
<a name="l00959"></a>00959     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ae99c54a9c8f1e218b86afcee348c54fc">fromRename</a>-&gt;renameUnblock[tid]) {
<a name="l00960"></a>00960         assert(<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].rename);
<a name="l00961"></a>00961         assert(!<a class="code" href="classDefaultFetch.html#ae99c54a9c8f1e218b86afcee348c54fc">fromRename</a>-&gt;renameBlock[tid]);
<a name="l00962"></a>00962         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a5e8e124987c56967514ad546a9f9c09b">rename</a> = <span class="keyword">false</span>;
<a name="l00963"></a>00963     }
<a name="l00964"></a>00964 
<a name="l00965"></a>00965     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a>-&gt;iewBlock[tid]) {
<a name="l00966"></a>00966         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a69f40ab12e9825ce316dfa72651a7404">iew</a> = <span class="keyword">true</span>;
<a name="l00967"></a>00967     }
<a name="l00968"></a>00968 
<a name="l00969"></a>00969     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a>-&gt;iewUnblock[tid]) {
<a name="l00970"></a>00970         assert(<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].iew);
<a name="l00971"></a>00971         assert(!<a class="code" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a>-&gt;iewBlock[tid]);
<a name="l00972"></a>00972         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a69f40ab12e9825ce316dfa72651a7404">iew</a> = <span class="keyword">false</span>;
<a name="l00973"></a>00973     }
<a name="l00974"></a>00974 
<a name="l00975"></a>00975     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitBlock[tid]) {
<a name="l00976"></a>00976         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#ad7d6b839c43385b5fffdf2beaff214ec">commit</a> = <span class="keyword">true</span>;
<a name="l00977"></a>00977     }
<a name="l00978"></a>00978 
<a name="l00979"></a>00979     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitUnblock[tid]) {
<a name="l00980"></a>00980         assert(<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].commit);
<a name="l00981"></a>00981         assert(!<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitBlock[tid]);
<a name="l00982"></a>00982         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#ad7d6b839c43385b5fffdf2beaff214ec">commit</a> = <span class="keyword">false</span>;
<a name="l00983"></a>00983     }
<a name="l00984"></a>00984 
<a name="l00985"></a>00985     <span class="comment">// Check squash signals from commit.</span>
<a name="l00986"></a>00986     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].squash) {
<a name="l00987"></a>00987 
<a name="l00988"></a>00988         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%u]: Squashing instructions due to squash &quot;</span>
<a name="l00989"></a>00989                 <span class="stringliteral">&quot;from commit.\n&quot;</span>,tid);
<a name="l00990"></a>00990         <span class="comment">// In any case, squash.</span>
<a name="l00991"></a>00991         <a class="code" href="classDefaultFetch.html#ae16ceb7406a5afe4ea9a39fd12931d32">squash</a>(<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].pc,
<a name="l00992"></a>00992                <a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].doneSeqNum,
<a name="l00993"></a>00993                <a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].squashInst, tid);
<a name="l00994"></a>00994 
<a name="l00995"></a>00995         <span class="comment">// If it was a branch mispredict on a control instruction, update the</span>
<a name="l00996"></a>00996         <span class="comment">// branch predictor with that instruction, otherwise just kill the</span>
<a name="l00997"></a>00997         <span class="comment">// invalid state we generated in after sequence number</span>
<a name="l00998"></a>00998         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].mispredictInst &amp;&amp;
<a name="l00999"></a>00999             <a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].mispredictInst-&gt;isControl()) {
<a name="l01000"></a>01000             <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#af62f441ad740da2cd987637cfa87dfe5">squash</a>(<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].doneSeqNum,
<a name="l01001"></a>01001                               <a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].pc,
<a name="l01002"></a>01002                               <a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].branchTaken,
<a name="l01003"></a>01003                               tid);
<a name="l01004"></a>01004         } <span class="keywordflow">else</span> {
<a name="l01005"></a>01005             <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#af62f441ad740da2cd987637cfa87dfe5">squash</a>(<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].doneSeqNum,
<a name="l01006"></a>01006                               tid);
<a name="l01007"></a>01007         }
<a name="l01008"></a>01008 
<a name="l01009"></a>01009         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01010"></a>01010     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].doneSeqNum) {
<a name="l01011"></a>01011         <span class="comment">// Update the branch predictor if it wasn&apos;t a squashed instruction</span>
<a name="l01012"></a>01012         <span class="comment">// that was broadcasted.</span>
<a name="l01013"></a>01013         <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#a6e4be480aeb0d4acfb352802ab73a3df">update</a>(<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].doneSeqNum, tid);
<a name="l01014"></a>01014     }
<a name="l01015"></a>01015 
<a name="l01016"></a>01016     <span class="comment">// Check ROB squash signals from commit.</span>
<a name="l01017"></a>01017     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[tid].robSquashing) {
<a name="l01018"></a>01018         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%u]: ROB is still squashing.\n&quot;</span>, tid);
<a name="l01019"></a>01019 
<a name="l01020"></a>01020         <span class="comment">// Continue to squash.</span>
<a name="l01021"></a>01021         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>;
<a name="l01022"></a>01022 
<a name="l01023"></a>01023         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01024"></a>01024     }
<a name="l01025"></a>01025 
<a name="l01026"></a>01026     <span class="comment">// Check squash signals from decode.</span>
<a name="l01027"></a>01027     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].squash) {
<a name="l01028"></a>01028         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%u]: Squashing instructions due to squash &quot;</span>
<a name="l01029"></a>01029                 <span class="stringliteral">&quot;from decode.\n&quot;</span>,tid);
<a name="l01030"></a>01030 
<a name="l01031"></a>01031         <span class="comment">// Update the branch predictor.</span>
<a name="l01032"></a>01032         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].branchMispredict) {
<a name="l01033"></a>01033             <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#af62f441ad740da2cd987637cfa87dfe5">squash</a>(<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].doneSeqNum,
<a name="l01034"></a>01034                               <a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].nextPC,
<a name="l01035"></a>01035                               <a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].branchTaken,
<a name="l01036"></a>01036                               tid);
<a name="l01037"></a>01037         } <span class="keywordflow">else</span> {
<a name="l01038"></a>01038             <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#af62f441ad740da2cd987637cfa87dfe5">squash</a>(<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].doneSeqNum,
<a name="l01039"></a>01039                               tid);
<a name="l01040"></a>01040         }
<a name="l01041"></a>01041 
<a name="l01042"></a>01042         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>) {
<a name="l01043"></a>01043 
<a name="l01044"></a>01044             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Squashing from decode with PC = %s\n&quot;</span>,
<a name="l01045"></a>01045                 <a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].nextPC);
<a name="l01046"></a>01046             <span class="comment">// Squash unless we&apos;re already squashing</span>
<a name="l01047"></a>01047             <a class="code" href="classDefaultFetch.html#acddf0ab1e13108e3626da3743de398b8">squashFromDecode</a>(<a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].nextPC,
<a name="l01048"></a>01048                              <a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].squashInst,
<a name="l01049"></a>01049                              <a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a>-&gt;decodeInfo[tid].doneSeqNum,
<a name="l01050"></a>01050                              tid);
<a name="l01051"></a>01051 
<a name="l01052"></a>01052             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01053"></a>01053         }
<a name="l01054"></a>01054     }
<a name="l01055"></a>01055 
<a name="l01056"></a>01056     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a6ba4f2f95d991f5be818dabf7500feed">checkStall</a>(tid) &amp;&amp;
<a name="l01057"></a>01057         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a> &amp;&amp;
<a name="l01058"></a>01058         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a> &amp;&amp;
<a name="l01059"></a>01059         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a> &amp;&amp;
<a name="l01060"></a>01060         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16">QuiescePending</a>) {
<a name="l01061"></a>01061         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Setting to blocked\n&quot;</span>,tid);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>;
<a name="l01064"></a>01064 
<a name="l01065"></a>01065         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01066"></a>01066     }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a> ||
<a name="l01069"></a>01069         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>) {
<a name="l01070"></a>01070         <span class="comment">// Switch status to running if fetch isn&apos;t being told to block or</span>
<a name="l01071"></a>01071         <span class="comment">// squash this cycle.</span>
<a name="l01072"></a>01072         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Done squashing, switching to running.\n&quot;</span>,
<a name="l01073"></a>01073                 tid);
<a name="l01074"></a>01074 
<a name="l01075"></a>01075         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>;
<a name="l01076"></a>01076 
<a name="l01077"></a>01077         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01078"></a>01078     }
<a name="l01079"></a>01079 
<a name="l01080"></a>01080     <span class="comment">// If we&apos;ve reached this point, we have not gotten any signals that</span>
<a name="l01081"></a>01081     <span class="comment">// cause fetch to change its status.  Fetch remains the same as before.</span>
<a name="l01082"></a>01082     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01083"></a>01083 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6ba4f2f95d991f5be818dabf7500feed"></a><!-- doxytag: member="DefaultFetch::checkStall" ref="a6ba4f2f95d991f5be818dabf7500feed" args="(ThreadID tid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks if a thread is stalled. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00792"></a>00792 {
<a name="l00793"></a>00793     <span class="keywordtype">bool</span> ret_val = <span class="keyword">false</span>;
<a name="l00794"></a>00794 
<a name="l00795"></a>00795     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;contextSwitch) {
<a name="l00796"></a>00796         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;[tid:%i]: Stalling for a context switch.\n&quot;</span>,tid);
<a name="l00797"></a>00797         ret_val = <span class="keyword">true</span>;
<a name="l00798"></a>00798     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="namespacem5_1_1simulate.html#a125fb26cebcc172aca2d13dbf5a2f73c">drain</a>) {
<a name="l00799"></a>00799         assert(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;isDraining());
<a name="l00800"></a>00800         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;[tid:%i]: Drain stall detected.\n&quot;</span>,tid);
<a name="l00801"></a>00801         ret_val = <span class="keyword">true</span>;
<a name="l00802"></a>00802     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].decode) {
<a name="l00803"></a>00803         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;[tid:%i]: Stall from Decode stage detected.\n&quot;</span>,tid);
<a name="l00804"></a>00804         ret_val = <span class="keyword">true</span>;
<a name="l00805"></a>00805     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].rename) {
<a name="l00806"></a>00806         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;[tid:%i]: Stall from Rename stage detected.\n&quot;</span>,tid);
<a name="l00807"></a>00807         ret_val = <span class="keyword">true</span>;
<a name="l00808"></a>00808     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].iew) {
<a name="l00809"></a>00809         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;[tid:%i]: Stall from IEW stage detected.\n&quot;</span>,tid);
<a name="l00810"></a>00810         ret_val = <span class="keyword">true</span>;
<a name="l00811"></a>00811     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].commit) {
<a name="l00812"></a>00812         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;[tid:%i]: Stall from Commit stage detected.\n&quot;</span>,tid);
<a name="l00813"></a>00813         ret_val = <span class="keyword">true</span>;
<a name="l00814"></a>00814     }
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     <span class="keywordflow">return</span> ret_val;
<a name="l00817"></a>00817 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c960f5de0fbb0511596cba5039660a3"></a><!-- doxytag: member="DefaultFetch::doSquash" ref="a9c960f5de0fbb0511596cba5039660a3" args="(const TheISA::PCState &amp;newPC, const DynInstPtr squashInst, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void doSquash </td>
          <td>(</td>
          <td class="paramtype">const TheISA::PCState &amp;&nbsp;</td>
          <td class="paramname"> <em>newPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>squashInst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Squashes a specific thread and resets the PC. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00728"></a>00728 {
<a name="l00729"></a>00729     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Squashing, setting PC to: %s.\n&quot;</span>,
<a name="l00730"></a>00730             tid, newPC);
<a name="l00731"></a>00731 
<a name="l00732"></a>00732     <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid] = newPC;
<a name="l00733"></a>00733     <a class="code" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a>[tid] = 0;
<a name="l00734"></a>00734     <span class="keywordflow">if</span> (squashInst &amp;&amp; squashInst-&gt;pcState().instAddr() == newPC.instAddr())
<a name="l00735"></a>00735         <a class="code" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[tid] = squashInst-&gt;macroop;
<a name="l00736"></a>00736     <span class="keywordflow">else</span>
<a name="l00737"></a>00737         <a class="code" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00738"></a>00738     <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;reset();
<a name="l00739"></a>00739 
<a name="l00740"></a>00740     <span class="comment">// Clear the icache miss if it&apos;s outstanding.</span>
<a name="l00741"></a>00741     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>) {
<a name="l00742"></a>00742         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Squashing outstanding Icache miss.\n&quot;</span>,
<a name="l00743"></a>00743                 tid);
<a name="l00744"></a>00744         <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00745"></a>00745     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a>) {
<a name="l00746"></a>00746         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Squashing outstanding ITLB miss.\n&quot;</span>,
<a name="l00747"></a>00747                 tid);
<a name="l00748"></a>00748         <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00749"></a>00749     }
<a name="l00750"></a>00750 
<a name="l00751"></a>00751     <span class="comment">// Get rid of the retrying packet if it was from this thread.</span>
<a name="l00752"></a>00752     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> == tid) {
<a name="l00753"></a>00753         assert(<a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a>);
<a name="l00754"></a>00754         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a>) {
<a name="l00755"></a>00755             <span class="keyword">delete</span> <a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a>-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>;
<a name="l00756"></a>00756             <span class="keyword">delete</span> <a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a>;
<a name="l00757"></a>00757         }
<a name="l00758"></a>00758         <a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a> = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00759"></a>00759         <a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> = <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l00760"></a>00760     }
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>;
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="comment">// microops are being squashed, it is not known wheather the</span>
<a name="l00765"></a>00765     <span class="comment">// youngest non-squashed microop was  marked delayed commit</span>
<a name="l00766"></a>00766     <span class="comment">// or not. Setting the flag to true ensures that the</span>
<a name="l00767"></a>00767     <span class="comment">// interrupts are not handled when they cannot be, though</span>
<a name="l00768"></a>00768     <span class="comment">// some opportunities to handle interrupts may be missed.</span>
<a name="l00769"></a>00769     <a class="code" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a>[tid] = <span class="keyword">true</span>;
<a name="l00770"></a>00770 
<a name="l00771"></a>00771     ++<a class="code" href="classDefaultFetch.html#ae1b92a3469ac6b00fddd788b71f64c9a">fetchSquashCycles</a>;
<a name="l00772"></a>00772 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8f020d3237536fe007fc488c4125c5d8"></a><!-- doxytag: member="DefaultFetch::drainResume" ref="a8f020d3237536fe007fc488c4125c5d8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drainResume </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Resume after a drain. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00421"></a>00421 {
<a name="l00422"></a>00422     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">Impl::MaxThreads</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>)
<a name="l00423"></a>00423         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="namespacem5_1_1simulate.html#a125fb26cebcc172aca2d13dbf5a2f73c">drain</a> = <span class="keyword">false</span>;
<a name="l00424"></a>00424 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0240eb42fa57fe5d3788093f62b77347"></a><!-- doxytag: member="DefaultFetch::drainSanityCheck" ref="a0240eb42fa57fe5d3788093f62b77347" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drainSanityCheck </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform sanity checks after a drain. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00429"></a>00429 {
<a name="l00430"></a>00430     assert(<a class="code" href="classDefaultFetch.html#adf5473c18a3d7c1e88c4a2072bce5526">isDrained</a>());
<a name="l00431"></a>00431     assert(<a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a> == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>);
<a name="l00432"></a>00432     assert(<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> == <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>);
<a name="l00433"></a>00433     assert(!<a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a>);
<a name="l00434"></a>00434     assert(!<a class="code" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a>);
<a name="l00435"></a>00435 
<a name="l00436"></a>00436     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00437"></a>00437         assert(!<a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]);
<a name="l00438"></a>00438         assert(!<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].decode);
<a name="l00439"></a>00439         assert(!<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].rename);
<a name="l00440"></a>00440         assert(!<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].iew);
<a name="l00441"></a>00441         assert(!<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].commit);
<a name="l00442"></a>00442         assert(<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a> || <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="namespacem5_1_1simulate.html#a125fb26cebcc172aca2d13dbf5a2f73c">drain</a>);
<a name="l00443"></a>00443     }
<a name="l00444"></a>00444 
<a name="l00445"></a>00445     <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#a0240eb42fa57fe5d3788093f62b77347">drainSanityCheck</a>();
<a name="l00446"></a>00446 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad1c01dde67aa909bd829896f6f587502"></a><!-- doxytag: member="DefaultFetch::drainStall" ref="ad1c01dde67aa909bd829896f6f587502" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void drainStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stall the fetch stage after reaching a safe drain point.</p>
<p>The CPU uses this method to stop fetching instructions from a thread that has been drained. The drain stall is different from all other stalls in that it is signaled instantly from the commit stage (without the normal communication delay) when it has reached a safe point to drain from. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00483"></a>00483 {
<a name="l00484"></a>00484     assert(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;isDraining());
<a name="l00485"></a>00485     assert(!<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="namespacem5_1_1simulate.html#a125fb26cebcc172aca2d13dbf5a2f73c">drain</a>);
<a name="l00486"></a>00486     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Drain, <span class="stringliteral">&quot;%i: Thread drained.\n&quot;</span>, tid);
<a name="l00487"></a>00487     <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#af29f0db645517864849f52e686f40bf6">drain</a> = <span class="keyword">true</span>;
<a name="l00488"></a>00488 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a77759cf15b084e00a9e4e8ca810a0be7"></a><!-- doxytag: member="DefaultFetch::fetch" ref="a77759cf15b084e00a9e4e8ca810a0be7" args="(bool &amp;status_change)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fetch </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>status_change</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Does the actual fetching of instructions and passing them on to the next stage. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>status_change</em>&nbsp;</td><td><a class="el" href="classDefaultFetch.html#a77759cf15b084e00a9e4e8ca810a0be7">fetch()</a> sets this variable if there was a status change (ie switching to IcacheMissStall). </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l01138"></a>01138 {
<a name="l01140"></a>01140     <span class="comment">// Start actual fetch</span>
<a name="l01142"></a>01142 <span class="comment"></span>    <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = <a class="code" href="classDefaultFetch.html#a4a20466270bc79a695af63ea67a35576">getFetchingThread</a>(<a class="code" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a>);
<a name="l01143"></a>01143 
<a name="l01144"></a>01144     assert(!<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;switchedOut());
<a name="l01145"></a>01145 
<a name="l01146"></a>01146     <span class="keywordflow">if</span> (tid == <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>) {
<a name="l01147"></a>01147         <span class="comment">// Breaks looping condition in tick()</span>
<a name="l01148"></a>01148         <a class="code" href="classDefaultFetch.html#ac4dd16b14420d21b5704350fbbcefd04">threadFetched</a> = <a class="code" href="classDefaultFetch.html#a6f81783998429ac4a3e8b75a5d5d12d4">numFetchingThreads</a>;
<a name="l01149"></a>01149 
<a name="l01150"></a>01150         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a> == 1) {  <span class="comment">// @todo Per-thread stats</span>
<a name="l01151"></a>01151             <a class="code" href="classDefaultFetch.html#ab3fa3c541f25b65e1b61d7290712e507">profileStall</a>(0);
<a name="l01152"></a>01152         }
<a name="l01153"></a>01153 
<a name="l01154"></a>01154         <span class="keywordflow">return</span>;
<a name="l01155"></a>01155     }
<a name="l01156"></a>01156 
<a name="l01157"></a>01157     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Attempting to fetch from [tid:%i]\n&quot;</span>, tid);
<a name="l01158"></a>01158 
<a name="l01159"></a>01159     <span class="comment">// The current PC.</span>
<a name="l01160"></a>01160     <a class="code" href="namespaceAlphaISA.html#af780de49982ecf691215cac9b9dfc615">TheISA::PCState</a> thisPC = <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid];
<a name="l01161"></a>01161 
<a name="l01162"></a>01162     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> pcOffset = <a class="code" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a>[tid];
<a name="l01163"></a>01163     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchAddr = (thisPC.instAddr() + pcOffset) &amp; BaseCPU::PCMask;
<a name="l01164"></a>01164 
<a name="l01165"></a>01165     <span class="keywordtype">bool</span> inRom = <a class="code" href="base_2types_8hh.html#a01ec7071d9749218cc83949b3f93cd9b">isRomMicroPC</a>(thisPC.microPC());
<a name="l01166"></a>01166 
<a name="l01167"></a>01167     <span class="comment">// If returning from the delay of a cache miss, then update the status</span>
<a name="l01168"></a>01168     <span class="comment">// to running, otherwise do the cache access.  Possibly move this up</span>
<a name="l01169"></a>01169     <span class="comment">// to tick() function.</span>
<a name="l01170"></a>01170     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a>) {
<a name="l01171"></a>01171         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Icache miss is complete.\n&quot;</span>, tid);
<a name="l01172"></a>01172 
<a name="l01173"></a>01173         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>;
<a name="l01174"></a>01174         status_change = <span class="keyword">true</span>;
<a name="l01175"></a>01175     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>) {
<a name="l01176"></a>01176         <span class="comment">// Align the fetch PC so its at the start of a fetch buffer segment.</span>
<a name="l01177"></a>01177         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferBlockPC = <a class="code" href="classDefaultFetch.html#a0c451948a0050595e5d23f57866f2797">fetchBufferAlignPC</a>(fetchAddr);
<a name="l01178"></a>01178 
<a name="l01179"></a>01179         <span class="comment">// If buffer is no longer valid or fetchAddr has moved to point</span>
<a name="l01180"></a>01180         <span class="comment">// to the next cache block, AND we have no remaining ucode</span>
<a name="l01181"></a>01181         <span class="comment">// from a macro-op, then start fetch from icache.</span>
<a name="l01182"></a>01182         <span class="keywordflow">if</span> (!(<a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[tid] &amp;&amp; fetchBufferBlockPC == <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid])
<a name="l01183"></a>01183             &amp;&amp; !inRom &amp;&amp; !<a class="code" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[tid]) {
<a name="l01184"></a>01184             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Attempting to translate and read &quot;</span>
<a name="l01185"></a>01185                     <span class="stringliteral">&quot;instruction, starting at PC %s.\n&quot;</span>, tid, thisPC);
<a name="l01186"></a>01186 
<a name="l01187"></a>01187             <a class="code" href="classDefaultFetch.html#a2ede53ea19a95876fd2418fcc329ef9a">fetchCacheLine</a>(fetchAddr, tid, thisPC.instAddr());
<a name="l01188"></a>01188 
<a name="l01189"></a>01189             <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>)
<a name="l01190"></a>01190                 ++<a class="code" href="classDefaultFetch.html#a2b9328bdb1a6898bfae824981cd64311">icacheStallCycles</a>;
<a name="l01191"></a>01191             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a>)
<a name="l01192"></a>01192                 ++<a class="code" href="classDefaultFetch.html#a9b08d665534d5e7d5b8134c4af16881d">fetchTlbCycles</a>;
<a name="l01193"></a>01193             <span class="keywordflow">else</span>
<a name="l01194"></a>01194                 ++<a class="code" href="classDefaultFetch.html#a0a77b8544fea92003669cdc78a46eea5">fetchMiscStallCycles</a>;
<a name="l01195"></a>01195             <span class="keywordflow">return</span>;
<a name="l01196"></a>01196         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((<a class="code" href="classDefaultFetch.html#a0949b3c8e74ae282010e2a8698525c72">checkInterrupt</a>(thisPC.instAddr()) &amp;&amp; !<a class="code" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a>[tid])) {
<a name="l01197"></a>01197             <span class="comment">// Stall CPU if an interrupt is posted and we&apos;re not issuing</span>
<a name="l01198"></a>01198             <span class="comment">// an delayed commit micro-op currently (delayed commit instructions</span>
<a name="l01199"></a>01199             <span class="comment">// are not interruptable by interrupts, only faults)</span>
<a name="l01200"></a>01200             ++<a class="code" href="classDefaultFetch.html#a0a77b8544fea92003669cdc78a46eea5">fetchMiscStallCycles</a>;
<a name="l01201"></a>01201             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is stalled!\n&quot;</span>, tid);
<a name="l01202"></a>01202             <span class="keywordflow">return</span>;
<a name="l01203"></a>01203         }
<a name="l01204"></a>01204     } <span class="keywordflow">else</span> {
<a name="l01205"></a>01205         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>) {
<a name="l01206"></a>01206             ++<a class="code" href="classDefaultFetch.html#a8af716ad2a53a409640347226078591c">fetchIdleCycles</a>;
<a name="l01207"></a>01207             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is idle!\n&quot;</span>, tid);
<a name="l01208"></a>01208         }
<a name="l01209"></a>01209 
<a name="l01210"></a>01210         <span class="comment">// Status is Idle, so fetch should do nothing.</span>
<a name="l01211"></a>01211         <span class="keywordflow">return</span>;
<a name="l01212"></a>01212     }
<a name="l01213"></a>01213 
<a name="l01214"></a>01214     ++<a class="code" href="classDefaultFetch.html#a9699b5489dd499e832651b96f95b5d19">fetchCycles</a>;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216     <a class="code" href="namespaceAlphaISA.html#af780de49982ecf691215cac9b9dfc615">TheISA::PCState</a> nextPC = thisPC;
<a name="l01217"></a>01217 
<a name="l01218"></a>01218     <a class="code" href="classRefCountingPtr.html">StaticInstPtr</a> staticInst = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l01219"></a>01219     <a class="code" href="classRefCountingPtr.html">StaticInstPtr</a> curMacroop = <a class="code" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[tid];
<a name="l01220"></a>01220 
<a name="l01221"></a>01221     <span class="comment">// If the read of the first instruction was successful, then grab the</span>
<a name="l01222"></a>01222     <span class="comment">// instructions from the rest of the cache line and put them into the</span>
<a name="l01223"></a>01223     <span class="comment">// queue heading to decode.</span>
<a name="l01224"></a>01224 
<a name="l01225"></a>01225     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Adding instructions to queue to &quot;</span>
<a name="l01226"></a>01226             <span class="stringliteral">&quot;decode.\n&quot;</span>, tid);
<a name="l01227"></a>01227 
<a name="l01228"></a>01228     <span class="comment">// Need to keep track of whether or not a predicted branch</span>
<a name="l01229"></a>01229     <span class="comment">// ended this fetch block.</span>
<a name="l01230"></a>01230     <span class="keywordtype">bool</span> predictedBranch = <span class="keyword">false</span>;
<a name="l01231"></a>01231 
<a name="l01232"></a>01232     <a class="code" href="namespaceAlphaISA.html#a301c22ea09fa33dcfe6ddf22f203699c">TheISA::MachInst</a> *cacheInsts =
<a name="l01233"></a>01233         <span class="keyword">reinterpret_cast&lt;</span><a class="code" href="namespaceAlphaISA.html#a301c22ea09fa33dcfe6ddf22f203699c">TheISA::MachInst</a> *<span class="keyword">&gt;</span>(<a class="code" href="classDefaultFetch.html#a924f2775385b2e5ac3008db4b8305c2b">fetchBuffer</a>[tid]);
<a name="l01234"></a>01234 
<a name="l01235"></a>01235     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> numInsts = <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a> / <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a>;
<a name="l01236"></a>01236     <span class="keywordtype">unsigned</span> blkOffset = (fetchAddr - <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid]) / <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a>;
<a name="l01237"></a>01237 
<a name="l01238"></a>01238     <span class="comment">// Loop through instruction memory from the cache.</span>
<a name="l01239"></a>01239     <span class="comment">// Keep issuing while fetchWidth is available and branch is not</span>
<a name="l01240"></a>01240     <span class="comment">// predicted taken</span>
<a name="l01241"></a>01241     <span class="keywordflow">while</span> (<a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> &lt; <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a> &amp;&amp; !predictedBranch) {
<a name="l01242"></a>01242 
<a name="l01243"></a>01243         <span class="comment">// We need to process more memory if we aren&apos;t going to get a</span>
<a name="l01244"></a>01244         <span class="comment">// StaticInst from the rom, the current macroop, or what&apos;s already</span>
<a name="l01245"></a>01245         <span class="comment">// in the decoder.</span>
<a name="l01246"></a>01246         <span class="keywordtype">bool</span> needMem = !inRom &amp;&amp; !curMacroop &amp;&amp;
<a name="l01247"></a>01247             !<a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;instReady();
<a name="l01248"></a>01248         fetchAddr = (thisPC.instAddr() + pcOffset) &amp; BaseCPU::PCMask;
<a name="l01249"></a>01249         <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferBlockPC = <a class="code" href="classDefaultFetch.html#a0c451948a0050595e5d23f57866f2797">fetchBufferAlignPC</a>(fetchAddr);
<a name="l01250"></a>01250 
<a name="l01251"></a>01251         <span class="keywordflow">if</span> (needMem) {
<a name="l01252"></a>01252             <span class="comment">// If buffer is no longer valid or fetchAddr has moved to point</span>
<a name="l01253"></a>01253             <span class="comment">// to the next cache block then start fetch from icache.</span>
<a name="l01254"></a>01254             <span class="keywordflow">if</span> (!<a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[tid] ||
<a name="l01255"></a>01255                 fetchBufferBlockPC != <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid])
<a name="l01256"></a>01256                 <span class="keywordflow">break</span>;
<a name="l01257"></a>01257 
<a name="l01258"></a>01258             <span class="keywordflow">if</span> (blkOffset &gt;= numInsts) {
<a name="l01259"></a>01259                 <span class="comment">// We need to process more memory, but we&apos;ve run out of the</span>
<a name="l01260"></a>01260                 <span class="comment">// current block.</span>
<a name="l01261"></a>01261                 <span class="keywordflow">break</span>;
<a name="l01262"></a>01262             }
<a name="l01263"></a>01263 
<a name="l01264"></a>01264             <span class="keywordflow">if</span> (<a class="code" href="alpha_2isa__traits_8hh.html#aae21ac6833454e7ead9810c372658afc">ISA_HAS_DELAY_SLOT</a> &amp;&amp; pcOffset == 0) {
<a name="l01265"></a>01265                 <span class="comment">// Walk past any annulled delay slot instructions.</span>
<a name="l01266"></a>01266                 <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> pcAddr = thisPC.instAddr() &amp; BaseCPU::PCMask;
<a name="l01267"></a>01267                 <span class="keywordflow">while</span> (fetchAddr != pcAddr &amp;&amp; blkOffset &lt; numInsts) {
<a name="l01268"></a>01268                     blkOffset++;
<a name="l01269"></a>01269                     fetchAddr += <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a>;
<a name="l01270"></a>01270                 }
<a name="l01271"></a>01271                 <span class="keywordflow">if</span> (blkOffset &gt;= numInsts)
<a name="l01272"></a>01272                     <span class="keywordflow">break</span>;
<a name="l01273"></a>01273             }
<a name="l01274"></a>01274 
<a name="l01275"></a>01275             <a class="code" href="classDefaultFetch.html#a4617f528417b8f55f809ae0988284c9b">MachInst</a> inst = <a class="code" href="namespaceBigEndianGuest.html#adb51b41dd17278558edf419359f52de6">TheISA::gtoh</a>(cacheInsts[blkOffset]);
<a name="l01276"></a>01276             <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;moreBytes(thisPC, fetchAddr, inst);
<a name="l01277"></a>01277 
<a name="l01278"></a>01278             <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;needMoreBytes()) {
<a name="l01279"></a>01279                 blkOffset++;
<a name="l01280"></a>01280                 fetchAddr += <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a>;
<a name="l01281"></a>01281                 pcOffset += <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a>;
<a name="l01282"></a>01282             }
<a name="l01283"></a>01283         }
<a name="l01284"></a>01284 
<a name="l01285"></a>01285         <span class="comment">// Extract as many instructions and/or microops as we can from</span>
<a name="l01286"></a>01286         <span class="comment">// the memory we&apos;ve processed so far.</span>
<a name="l01287"></a>01287         <span class="keywordflow">do</span> {
<a name="l01288"></a>01288             <span class="keywordflow">if</span> (!(curMacroop || inRom)) {
<a name="l01289"></a>01289                 <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;instReady()) {
<a name="l01290"></a>01290                     staticInst = <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;decode(thisPC);
<a name="l01291"></a>01291 
<a name="l01292"></a>01292                     <span class="comment">// Increment stat of fetched instructions.</span>
<a name="l01293"></a>01293                     ++<a class="code" href="classDefaultFetch.html#af0e3fa228032036d2022ed9e2a3612b6">fetchedInsts</a>;
<a name="l01294"></a>01294 
<a name="l01295"></a>01295                     <span class="keywordflow">if</span> (staticInst-&gt;isMacroop()) {
<a name="l01296"></a>01296                         curMacroop = staticInst;
<a name="l01297"></a>01297                     } <span class="keywordflow">else</span> {
<a name="l01298"></a>01298                         pcOffset = 0;
<a name="l01299"></a>01299                     }
<a name="l01300"></a>01300                 } <span class="keywordflow">else</span> {
<a name="l01301"></a>01301                     <span class="comment">// We need more bytes for this instruction so blkOffset and</span>
<a name="l01302"></a>01302                     <span class="comment">// pcOffset will be updated</span>
<a name="l01303"></a>01303                     <span class="keywordflow">break</span>;
<a name="l01304"></a>01304                 }
<a name="l01305"></a>01305             }
<a name="l01306"></a>01306             <span class="comment">// Whether we&apos;re moving to a new macroop because we&apos;re at the</span>
<a name="l01307"></a>01307             <span class="comment">// end of the current one, or the branch predictor incorrectly</span>
<a name="l01308"></a>01308             <span class="comment">// thinks we are...</span>
<a name="l01309"></a>01309             <span class="keywordtype">bool</span> newMacro = <span class="keyword">false</span>;
<a name="l01310"></a>01310             <span class="keywordflow">if</span> (curMacroop || inRom) {
<a name="l01311"></a>01311                 <span class="keywordflow">if</span> (inRom) {
<a name="l01312"></a>01312                     staticInst = <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;microcodeRom.fetchMicroop(
<a name="l01313"></a>01313                             thisPC.microPC(), curMacroop);
<a name="l01314"></a>01314                 } <span class="keywordflow">else</span> {
<a name="l01315"></a>01315                     staticInst = curMacroop-&gt;fetchMicroop(thisPC.microPC());
<a name="l01316"></a>01316                 }
<a name="l01317"></a>01317                 newMacro |= staticInst-&gt;isLastMicroop();
<a name="l01318"></a>01318             }
<a name="l01319"></a>01319 
<a name="l01320"></a>01320             <a class="code" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> instruction =
<a name="l01321"></a>01321                 <a class="code" href="classDefaultFetch.html#a9c38c3c5f6bb4a7c1919ca7d3d4e12dc">buildInst</a>(tid, staticInst, curMacroop,
<a name="l01322"></a>01322                           thisPC, nextPC, <span class="keyword">true</span>);
<a name="l01323"></a>01323 
<a name="l01324"></a>01324             <a class="code" href="classDefaultFetch.html#a853ac5048dfdbba414f6f8186dd11afd">ppFetch</a>-&gt;<a class="code" href="classProbePointArg.html#a558191a8c66a37ace08feb713c5d4931" title="called at the ProbePoint call site, passes arg to each listener.">notify</a>(instruction);
<a name="l01325"></a>01325             <a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a>++;
<a name="l01326"></a>01326 
<a name="l01327"></a>01327 <span class="preprocessor">#if TRACING_ON</span>
<a name="l01328"></a>01328 <span class="preprocessor"></span>            <span class="keywordflow">if</span> (<a class="code" href="trace_8hh.html#af76c9f7776aade1bf9d7dfa8a0c6b341">DTRACE</a>(O3PipeView)) {
<a name="l01329"></a>01329                 instruction-&gt;fetchTick = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l01330"></a>01330             }
<a name="l01331"></a>01331 <span class="preprocessor">#endif</span>
<a name="l01332"></a>01332 <span class="preprocessor"></span>
<a name="l01333"></a>01333             nextPC = thisPC;
<a name="l01334"></a>01334 
<a name="l01335"></a>01335             <span class="comment">// If we&apos;re branching after this instruction, quite fetching</span>
<a name="l01336"></a>01336             <span class="comment">// from the same block then.</span>
<a name="l01337"></a>01337             predictedBranch |= thisPC.branching();
<a name="l01338"></a>01338             predictedBranch |=
<a name="l01339"></a>01339                 <a class="code" href="classDefaultFetch.html#a033e8df655743382b3cb870600f70f82">lookupAndUpdateNextPC</a>(instruction, nextPC);
<a name="l01340"></a>01340             <span class="keywordflow">if</span> (predictedBranch) {
<a name="l01341"></a>01341                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Branch detected with PC = %s\n&quot;</span>, thisPC);
<a name="l01342"></a>01342             }
<a name="l01343"></a>01343 
<a name="l01344"></a>01344             newMacro |= thisPC.instAddr() != nextPC.instAddr();
<a name="l01345"></a>01345 
<a name="l01346"></a>01346             <span class="comment">// Move to the next instruction, unless we have a branch.</span>
<a name="l01347"></a>01347             thisPC = nextPC;
<a name="l01348"></a>01348             inRom = <a class="code" href="base_2types_8hh.html#a01ec7071d9749218cc83949b3f93cd9b">isRomMicroPC</a>(thisPC.microPC());
<a name="l01349"></a>01349 
<a name="l01350"></a>01350             <span class="keywordflow">if</span> (newMacro) {
<a name="l01351"></a>01351                 fetchAddr = thisPC.instAddr() &amp; BaseCPU::PCMask;
<a name="l01352"></a>01352                 blkOffset = (fetchAddr - <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid]) / <a class="code" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a>;
<a name="l01353"></a>01353                 pcOffset = 0;
<a name="l01354"></a>01354                 curMacroop = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l01355"></a>01355             }
<a name="l01356"></a>01356 
<a name="l01357"></a>01357             <span class="keywordflow">if</span> (instruction-&gt;isQuiesce()) {
<a name="l01358"></a>01358                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,
<a name="l01359"></a>01359                         <span class="stringliteral">&quot;Quiesce instruction encountered, halting fetch!&quot;</span>);
<a name="l01360"></a>01360                 <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16">QuiescePending</a>;
<a name="l01361"></a>01361                 status_change = <span class="keyword">true</span>;
<a name="l01362"></a>01362                 <span class="keywordflow">break</span>;
<a name="l01363"></a>01363             }
<a name="l01364"></a>01364         } <span class="keywordflow">while</span> ((curMacroop || <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;instReady()) &amp;&amp;
<a name="l01365"></a>01365                  <a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> &lt; <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>);
<a name="l01366"></a>01366     }
<a name="l01367"></a>01367 
<a name="l01368"></a>01368     <span class="keywordflow">if</span> (predictedBranch) {
<a name="l01369"></a>01369         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Done fetching, predicted branch &quot;</span>
<a name="l01370"></a>01370                 <span class="stringliteral">&quot;instruction encountered.\n&quot;</span>, tid);
<a name="l01371"></a>01371     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> &gt;= <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>) {
<a name="l01372"></a>01372         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Done fetching, reached fetch bandwidth &quot;</span>
<a name="l01373"></a>01373                 <span class="stringliteral">&quot;for this cycle.\n&quot;</span>, tid);
<a name="l01374"></a>01374     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (blkOffset &gt;= <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>) {
<a name="l01375"></a>01375         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Done fetching, reached the end of the&quot;</span>
<a name="l01376"></a>01376                 <span class="stringliteral">&quot;fetch buffer.\n&quot;</span>, tid);
<a name="l01377"></a>01377     }
<a name="l01378"></a>01378 
<a name="l01379"></a>01379     <a class="code" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[tid] = curMacroop;
<a name="l01380"></a>01380     <a class="code" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a>[tid] = pcOffset;
<a name="l01381"></a>01381 
<a name="l01382"></a>01382     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> &gt; 0) {
<a name="l01383"></a>01383         <a class="code" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">true</span>;
<a name="l01384"></a>01384     }
<a name="l01385"></a>01385 
<a name="l01386"></a>01386     <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid] = thisPC;
<a name="l01387"></a>01387 
<a name="l01388"></a>01388     <span class="comment">// pipeline a fetch if we&apos;re crossing a fetch buffer boundary and not in</span>
<a name="l01389"></a>01389     <span class="comment">// a state that would preclude fetching</span>
<a name="l01390"></a>01390     fetchAddr = (thisPC.instAddr() + pcOffset) &amp; BaseCPU::PCMask;
<a name="l01391"></a>01391     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferBlockPC = <a class="code" href="classDefaultFetch.html#a0c451948a0050595e5d23f57866f2797">fetchBufferAlignPC</a>(fetchAddr);
<a name="l01392"></a>01392     <a class="code" href="classDefaultFetch.html#a4004484fff11512f43124243e7eac71a">issuePipelinedIfetch</a>[tid] = fetchBufferBlockPC != <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid] &amp;&amp;
<a name="l01393"></a>01393         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a> &amp;&amp;
<a name="l01394"></a>01394         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a> &amp;&amp;
<a name="l01395"></a>01395         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a> &amp;&amp;
<a name="l01396"></a>01396         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16">QuiescePending</a> &amp;&amp;
<a name="l01397"></a>01397         !curMacroop;
<a name="l01398"></a>01398 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0c451948a0050595e5d23f57866f2797"></a><!-- doxytag: member="DefaultFetch::fetchBufferAlignPC" ref="a0c451948a0050595e5d23f57866f2797" args="(Addr addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferAlignPC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Align a PC to the start of a fetch buffer block. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00351"></a>00351     {
<a name="l00352"></a>00352         <span class="keywordflow">return</span> (<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> &amp; ~(<a class="code" href="classDefaultFetch.html#a9fb9a70efc5e29795473f1f92c082063">fetchBufferMask</a>));
<a name="l00353"></a>00353     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2ede53ea19a95876fd2418fcc329ef9a"></a><!-- doxytag: member="DefaultFetch::fetchCacheLine" ref="a2ede53ea19a95876fd2418fcc329ef9a" args="(Addr vaddr, ThreadID tid, Addr pc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool fetchCacheLine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>pc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fetches the cache line that contains the fetch PC. Returns any fault that happened. Puts the data into the class variable fetchBuffer, which may not hold the entire fetched cache line. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>vaddr</em>&nbsp;</td><td>The memory address that is being fetched from. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ret_fault</em>&nbsp;</td><td>The fault reference that will be set to the result of the icache access. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tid</em>&nbsp;</td><td>Thread id. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pc</em>&nbsp;</td><td>The actual PC of the current instruction. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Any fault that occured. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00572"></a>00572 {
<a name="l00573"></a>00573     <a class="code" href="classRefCountingPtr.html">Fault</a> fault = <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00574"></a>00574 
<a name="l00575"></a>00575     assert(!<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;switchedOut());
<a name="l00576"></a>00576 
<a name="l00577"></a>00577     <span class="comment">// @todo: not sure if these should block translation.</span>
<a name="l00578"></a>00578     <span class="comment">//AlphaDep</span>
<a name="l00579"></a>00579     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a>) {
<a name="l00580"></a>00580         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i] Can&apos;t fetch cache line, cache blocked\n&quot;</span>,
<a name="l00581"></a>00581                 tid);
<a name="l00582"></a>00582         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00583"></a>00583     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0949b3c8e74ae282010e2a8698525c72">checkInterrupt</a>(<a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>) &amp;&amp; !<a class="code" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a>[tid]) {
<a name="l00584"></a>00584         <span class="comment">// Hold off fetch from getting new instructions when:</span>
<a name="l00585"></a>00585         <span class="comment">// Cache is blocked, or</span>
<a name="l00586"></a>00586         <span class="comment">// while an interrupt is pending and we&apos;re not in PAL mode, or</span>
<a name="l00587"></a>00587         <span class="comment">// fetch is switched out.</span>
<a name="l00588"></a>00588         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i] Can&apos;t fetch cache line, interrupt pending\n&quot;</span>,
<a name="l00589"></a>00589                 tid);
<a name="l00590"></a>00590         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00591"></a>00591     }
<a name="l00592"></a>00592 
<a name="l00593"></a>00593     <span class="comment">// Align the fetch address to the start of a fetch buffer segment.</span>
<a name="l00594"></a>00594     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferBlockPC = <a class="code" href="classDefaultFetch.html#a0c451948a0050595e5d23f57866f2797">fetchBufferAlignPC</a>(<a class="code" href="namespaceMipsISA.html#ac78d9788b3f9a366df64485c9afaf1b1">vaddr</a>);
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i] Fetching cache line %#x for addr %#x\n&quot;</span>,
<a name="l00597"></a>00597             tid, fetchBufferBlockPC, <a class="code" href="namespaceMipsISA.html#ac78d9788b3f9a366df64485c9afaf1b1">vaddr</a>);
<a name="l00598"></a>00598 
<a name="l00599"></a>00599     <span class="comment">// Setup the memReq to do a read of the first instruction&apos;s address.</span>
<a name="l00600"></a>00600     <span class="comment">// Set the appropriate read size and flags as well.</span>
<a name="l00601"></a>00601     <span class="comment">// Build request here.</span>
<a name="l00602"></a>00602     <a class="code" href="classRequest.html">RequestPtr</a> mem_req =
<a name="l00603"></a>00603         <span class="keyword">new</span> <a class="code" href="classRequest.html">Request</a>(tid, fetchBufferBlockPC, <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>,
<a name="l00604"></a>00604                     <a class="code" href="classRequest.html#a1137c9aff3d0aa2d9c0fafeb06ec7bc3">Request::INST_FETCH</a>, <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;instMasterId(), <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>,
<a name="l00605"></a>00605                     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;thread[tid]-&gt;contextId(), tid);
<a name="l00606"></a>00606 
<a name="l00607"></a>00607     mem_req-&gt;<a class="code" href="classRequest.html#a7abf15d67b3fbd53236fde58eecb3f34">taskId</a>(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;taskId());
<a name="l00608"></a>00608 
<a name="l00609"></a>00609     <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = mem_req;
<a name="l00610"></a>00610 
<a name="l00611"></a>00611     <span class="comment">// Initiate translation of the icache block</span>
<a name="l00612"></a>00612     <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a>;
<a name="l00613"></a>00613     FetchTranslation *trans = <span class="keyword">new</span> FetchTranslation(<span class="keyword">this</span>);
<a name="l00614"></a>00614     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;itb-&gt;translateTiming(mem_req, <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;thread[tid]-&gt;getTC(),
<a name="l00615"></a>00615                               trans, <a class="code" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911a31b7313c05d32519f3869a3de8be95e6">BaseTLB::Execute</a>);
<a name="l00616"></a>00616     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00617"></a>00617 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7dca7de206b6388e989a53b56634ad4"></a><!-- doxytag: member="DefaultFetch::finishTranslation" ref="ac7dca7de206b6388e989a53b56634ad4" args="(Fault fault, RequestPtr mem_req)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void finishTranslation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">Fault</a>&nbsp;</td>
          <td class="paramname"> <em>fault</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>mem_req</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00622"></a>00622 {
<a name="l00623"></a>00623     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = mem_req-&gt;<a class="code" href="classRequest.html#afc38d04c77e7b5fc3bbb0dd00fc87742">threadId</a>();
<a name="l00624"></a>00624     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferBlockPC = mem_req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>();
<a name="l00625"></a>00625 
<a name="l00626"></a>00626     assert(!<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;switchedOut());
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="comment">// Wake up CPU if it was idle</span>
<a name="l00629"></a>00629     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;wakeCPU();
<a name="l00630"></a>00630 
<a name="l00631"></a>00631     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a> || mem_req != <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] ||
<a name="l00632"></a>00632         mem_req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>() != <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid]-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>()) {
<a name="l00633"></a>00633         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i] Ignoring itlb completed after squash\n&quot;</span>,
<a name="l00634"></a>00634                 tid);
<a name="l00635"></a>00635         ++<a class="code" href="classDefaultFetch.html#afe07cb06e5135b2305320fa11fda71af">fetchTlbSquashes</a>;
<a name="l00636"></a>00636         <span class="keyword">delete</span> mem_req;
<a name="l00637"></a>00637         <span class="keywordflow">return</span>;
<a name="l00638"></a>00638     }
<a name="l00639"></a>00639 
<a name="l00640"></a>00640 
<a name="l00641"></a>00641     <span class="comment">// If translation was successful, attempt to read the icache block.</span>
<a name="l00642"></a>00642     <span class="keywordflow">if</span> (fault == <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>) {
<a name="l00643"></a>00643         <span class="comment">// Check that we&apos;re not going off into random memory</span>
<a name="l00644"></a>00644         <span class="comment">// If we have, just wait around for commit to squash something and put</span>
<a name="l00645"></a>00645         <span class="comment">// us on the right track</span>
<a name="l00646"></a>00646         <span class="keywordflow">if</span> (!<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;system-&gt;isMemAddr(mem_req-&gt;<a class="code" href="classRequest.html#a744ef11a5afe9d3651ce5f954259cb43">getPaddr</a>())) {
<a name="l00647"></a>00647             <a class="code" href="base_2misc_8hh.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;Address %#x is outside of physical memory, stopping fetch\n&quot;</span>,
<a name="l00648"></a>00648                     mem_req-&gt;<a class="code" href="classRequest.html#a744ef11a5afe9d3651ce5f954259cb43">getPaddr</a>());
<a name="l00649"></a>00649             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caadf72b4e66cdfa8a56beab05bb411da6">NoGoodAddr</a>;
<a name="l00650"></a>00650             <span class="keyword">delete</span> mem_req;
<a name="l00651"></a>00651             <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00652"></a>00652             <span class="keywordflow">return</span>;
<a name="l00653"></a>00653         }
<a name="l00654"></a>00654 
<a name="l00655"></a>00655         <span class="comment">// Build packet here.</span>
<a name="l00656"></a>00656         <a class="code" href="classPacket.html">PacketPtr</a> data_pkt = <span class="keyword">new</span> <a class="code" href="classPacket.html">Packet</a>(mem_req, <a class="code" href="classMemCmd.html#a2afce0a47a93eee73a314d53e4890153a96120c772a9cb695fe62ca81ec93a53b">MemCmd::ReadReq</a>);
<a name="l00657"></a>00657         data_pkt-&gt;<a class="code" href="classPacket.html#ae02c6b2e23b2a5b138c85fcf91fd818d">dataDynamicArray</a>(<span class="keyword">new</span> uint8_t[<a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>]);
<a name="l00658"></a>00658 
<a name="l00659"></a>00659         <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid] = fetchBufferBlockPC;
<a name="l00660"></a>00660         <a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[tid] = <span class="keyword">false</span>;
<a name="l00661"></a>00661         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch: Doing instruction read.\n&quot;</span>);
<a name="l00662"></a>00662 
<a name="l00663"></a>00663         <a class="code" href="classDefaultFetch.html#a0ead660daa133edcd64ac552d473ebba">fetchedCacheLines</a>++;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665         <span class="comment">// Access the cache.</span>
<a name="l00666"></a>00666         <span class="keywordflow">if</span> (!<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;getInstPort().sendTimingReq(data_pkt)) {
<a name="l00667"></a>00667             assert(<a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a> == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>);
<a name="l00668"></a>00668             assert(<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> == <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>);
<a name="l00669"></a>00669             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i] Out of MSHRs!\n&quot;</span>, tid);
<a name="l00670"></a>00670 
<a name="l00671"></a>00671             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a>;
<a name="l00672"></a>00672             <a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a> = data_pkt;
<a name="l00673"></a>00673             <a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> = tid;
<a name="l00674"></a>00674             <a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a> = <span class="keyword">true</span>;
<a name="l00675"></a>00675         } <span class="keywordflow">else</span> {
<a name="l00676"></a>00676             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Doing Icache access.\n&quot;</span>, tid);
<a name="l00677"></a>00677             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;[tid:%i]: Activity: Waiting on I-cache &quot;</span>
<a name="l00678"></a>00678                     <span class="stringliteral">&quot;response.\n&quot;</span>, tid);
<a name="l00679"></a>00679             <a class="code" href="classDefaultFetch.html#a1848d938e5258a2a79298169e43efde5">lastIcacheStall</a>[tid] = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00680"></a>00680             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>;
<a name="l00681"></a>00681         }
<a name="l00682"></a>00682     } <span class="keywordflow">else</span> {
<a name="l00683"></a>00683         <span class="keywordflow">if</span> (!(<a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> &lt; <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>)) {
<a name="l00684"></a>00684             assert(!<a class="code" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l00685"></a>00685             <a class="code" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a>.<a class="code" href="classDefaultFetch_1_1FinishTranslationEvent.html#a82a42da62f864cd0227ac4b7596709a7">setFault</a>(fault);
<a name="l00686"></a>00686             <a class="code" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a>.<a class="code" href="classDefaultFetch_1_1FinishTranslationEvent.html#aa90c345490b78a0a0d46cbdd6e4d61a6">setReq</a>(mem_req);
<a name="l00687"></a>00687             <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;schedule(<a class="code" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a>,
<a name="l00688"></a>00688                           <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;clockEdge(<a class="code" href="classCycles.html">Cycles</a>(1)));
<a name="l00689"></a>00689             <span class="keywordflow">return</span>;
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i] Got back req with addr %#x but expected %#x\n&quot;</span>,
<a name="l00692"></a>00692                 tid, mem_req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>(), <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid]-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>());
<a name="l00693"></a>00693         <span class="comment">// Translation faulted, icache request won&apos;t be sent.</span>
<a name="l00694"></a>00694         <span class="keyword">delete</span> mem_req;
<a name="l00695"></a>00695         <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         <span class="comment">// Send the fault to commit.  This thread will not do anything</span>
<a name="l00698"></a>00698         <span class="comment">// until commit handles the fault.  The only other way it can</span>
<a name="l00699"></a>00699         <span class="comment">// wake up is if a squash comes along and changes the PC.</span>
<a name="l00700"></a>00700         <a class="code" href="namespaceAlphaISA.html#af780de49982ecf691215cac9b9dfc615">TheISA::PCState</a> fetchPC = <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid];
<a name="l00701"></a>00701 
<a name="l00702"></a>00702         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Translation faulted, building noop.\n&quot;</span>, tid);
<a name="l00703"></a>00703         <span class="comment">// We will use a nop in ordier to carry the fault.</span>
<a name="l00704"></a>00704         <a class="code" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> instruction = <a class="code" href="classDefaultFetch.html#a9c38c3c5f6bb4a7c1919ca7d3d4e12dc">buildInst</a>(tid,
<a name="l00705"></a>00705                 <a class="code" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[tid]-&gt;decode(<a class="code" href="namespaceAlphaISA.html#a8d1e39e0ea757dcc9725c6ccd81dd4c4">TheISA::NoopMachInst</a>, fetchPC.instAddr()),
<a name="l00706"></a>00706                 <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>, fetchPC, fetchPC, <span class="keyword">false</span>);
<a name="l00707"></a>00707 
<a name="l00708"></a>00708         instruction-&gt;setPredTarg(fetchPC);
<a name="l00709"></a>00709         instruction-&gt;fault = fault;
<a name="l00710"></a>00710         <a class="code" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">true</span>;
<a name="l00711"></a>00711 
<a name="l00712"></a>00712         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity this cycle.\n&quot;</span>);
<a name="l00713"></a>00713         <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;activityThisCycle();
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca8c49adf6da5f507150d403610c684877">TrapPending</a>;
<a name="l00716"></a>00716 
<a name="l00717"></a>00717         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Blocked, need to handle the trap.\n&quot;</span>, tid);
<a name="l00718"></a>00718         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: fault (%s) detected @ PC %s.\n&quot;</span>,
<a name="l00719"></a>00719                 tid, fault-&gt;name(), <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid]);
<a name="l00720"></a>00720     }
<a name="l00721"></a>00721     <a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> = <a class="code" href="classDefaultFetch.html#ac244c54ec94dd5e1d886dfd022752ec8">updateFetchStatus</a>();
<a name="l00722"></a>00722 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a20466270bc79a695af63ea67a35576"></a><!-- doxytag: member="DefaultFetch::getFetchingThread" ref="a4a20466270bc79a695af63ea67a35576" args="(FetchPriority &amp;fetch_priority)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> getFetchingThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3">FetchPriority</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>fetch_priority</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the appropriate thread to fetch, given the fetch policy. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01431"></a>01431 {
<a name="l01432"></a>01432     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a> &gt; 1) {
<a name="l01433"></a>01433         <span class="keywordflow">switch</span> (fetch_priority) {
<a name="l01434"></a>01434 
<a name="l01435"></a>01435           <span class="keywordflow">case</span> <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3ae01d52cbe97a50e79f4195cd27b3185b">SingleThread</a>:
<a name="l01436"></a>01436             <span class="keywordflow">return</span> 0;
<a name="l01437"></a>01437 
<a name="l01438"></a>01438           <span class="keywordflow">case</span> <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a5c08841de48c15133dd26a4d9d740a11">RoundRobin</a>:
<a name="l01439"></a>01439             <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#a8aab9cacbc483081596b13ecd5192eb5">roundRobin</a>();
<a name="l01440"></a>01440 
<a name="l01441"></a>01441           <span class="keywordflow">case</span> <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a7608065caa4249ff47a58c32d6f3c531">IQ</a>:
<a name="l01442"></a>01442             <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#a4aff2ae442aa43bcb382774f7c429030">iqCount</a>();
<a name="l01443"></a>01443 
<a name="l01444"></a>01444           <span class="keywordflow">case</span> <a class="code" href="classLSQ.html">LSQ</a>:
<a name="l01445"></a>01445             <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#a2cce05272516009508e173f69d7d37df">lsqCount</a>();
<a name="l01446"></a>01446 
<a name="l01447"></a>01447           <span class="keywordflow">case</span> <a class="code" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3a070f4c50ffea5accaf5f88606fc088a8">Branch</a>:
<a name="l01448"></a>01448             <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#adbe8a1ec70863059cb0e121edc864a14">branchCount</a>();
<a name="l01449"></a>01449 
<a name="l01450"></a>01450           <span class="keywordflow">default</span>:
<a name="l01451"></a>01451             <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01452"></a>01452         }
<a name="l01453"></a>01453     } <span class="keywordflow">else</span> {
<a name="l01454"></a>01454         <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> thread = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l01455"></a>01455         <span class="keywordflow">if</span> (thread == <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end()) {
<a name="l01456"></a>01456             <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01457"></a>01457         }
<a name="l01458"></a>01458 
<a name="l01459"></a>01459         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *thread;
<a name="l01460"></a>01460 
<a name="l01461"></a>01461         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l01462"></a>01462             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a> ||
<a name="l01463"></a>01463             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>) {
<a name="l01464"></a>01464             <span class="keywordflow">return</span> tid;
<a name="l01465"></a>01465         } <span class="keywordflow">else</span> {
<a name="l01466"></a>01466             <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01467"></a>01467         }
<a name="l01468"></a>01468     }
<a name="l01469"></a>01469 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4aff2ae442aa43bcb382774f7c429030"></a><!-- doxytag: member="DefaultFetch::iqCount" ref="a4aff2ae442aa43bcb382774f7c429030" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> iqCount </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the appropriate thread to fetch using the IQ count policy. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01505"></a>01505 {
<a name="l01506"></a>01506     std::priority_queue&lt;unsigned&gt; PQ;
<a name="l01507"></a>01507     std::map&lt;unsigned, ThreadID&gt; threadMap;
<a name="l01508"></a>01508 
<a name="l01509"></a>01509     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l01510"></a>01510     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> end = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end();
<a name="l01511"></a>01511 
<a name="l01512"></a>01512     <span class="keywordflow">while</span> (threads != end) {
<a name="l01513"></a>01513         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *threads++;
<a name="l01514"></a>01514         <span class="keywordtype">unsigned</span> <a class="code" href="classDefaultFetch.html#a4aff2ae442aa43bcb382774f7c429030">iqCount</a> = <a class="code" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a>-&gt;iewInfo[tid].iqCount;
<a name="l01515"></a>01515 
<a name="l01516"></a>01516         PQ.push(iqCount);
<a name="l01517"></a>01517         threadMap[iqCount] = tid;
<a name="l01518"></a>01518     }
<a name="l01519"></a>01519 
<a name="l01520"></a>01520     <span class="keywordflow">while</span> (!PQ.empty()) {
<a name="l01521"></a>01521         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> high_pri = threadMap[PQ.top()];
<a name="l01522"></a>01522 
<a name="l01523"></a>01523         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l01524"></a>01524             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a> ||
<a name="l01525"></a>01525             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>)
<a name="l01526"></a>01526             <span class="keywordflow">return</span> high_pri;
<a name="l01527"></a>01527         <span class="keywordflow">else</span>
<a name="l01528"></a>01528             PQ.pop();
<a name="l01529"></a>01529 
<a name="l01530"></a>01530     }
<a name="l01531"></a>01531 
<a name="l01532"></a>01532     <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01533"></a>01533 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adf5473c18a3d7c1e88c4a2072bce5526"></a><!-- doxytag: member="DefaultFetch::isDrained" ref="adf5473c18a3d7c1e88c4a2072bce5526" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isDrained </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Has the stage drained? </p>

<p><div class="fragment"><pre class="fragment"><a name="l00451"></a>00451 {
<a name="l00452"></a>00452     <span class="comment">/* Make sure that threads are either idle of that the commit stage</span>
<a name="l00453"></a>00453 <span class="comment">     * has signaled that draining has completed by setting the drain</span>
<a name="l00454"></a>00454 <span class="comment">     * stall flag. This effectively forces the pipeline to be disabled</span>
<a name="l00455"></a>00455 <span class="comment">     * until the whole system is drained (simulation may continue to</span>
<a name="l00456"></a>00456 <span class="comment">     * drain other components).</span>
<a name="l00457"></a>00457 <span class="comment">     */</span>
<a name="l00458"></a>00458     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00459"></a>00459         <span class="keywordflow">if</span> (!(<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a> ||
<a name="l00460"></a>00460               (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a> &amp;&amp; <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="namespacem5_1_1simulate.html#a125fb26cebcc172aca2d13dbf5a2f73c">drain</a>)))
<a name="l00461"></a>00461             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00462"></a>00462     }
<a name="l00463"></a>00463 
<a name="l00464"></a>00464     <span class="comment">/* The pipeline might start up again in the middle of the drain</span>
<a name="l00465"></a>00465 <span class="comment">     * cycle if the finish translation event is scheduled, so make</span>
<a name="l00466"></a>00466 <span class="comment">     * sure that&apos;s not the case.</span>
<a name="l00467"></a>00467 <span class="comment">     */</span>
<a name="l00468"></a>00468     <span class="keywordflow">return</span> !<a class="code" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>();
<a name="l00469"></a>00469 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a033e8df655743382b3cb870600f70f82"></a><!-- doxytag: member="DefaultFetch::lookupAndUpdateNextPC" ref="a033e8df655743382b3cb870600f70f82" args="(DynInstPtr &amp;inst, TheISA::PCState &amp;pc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lookupAndUpdateNextPC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>inst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TheISA::PCState &amp;&nbsp;</td>
          <td class="paramname"> <em>pc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Looks up in the branch predictor to see if the next PC should be either next PC+=MachInst or a branch target. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>next_PC</em>&nbsp;</td><td>Next PC variable passed in by reference. It is expected to be set to the current PC; it will be updated with what the next PC will be. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>next_NPC</em>&nbsp;</td><td>Used for ISAs which use delay slots. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Whether or not a branch was predicted as taken. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00530"></a>00530 {
<a name="l00531"></a>00531     <span class="comment">// Do branch prediction check here.</span>
<a name="l00532"></a>00532     <span class="comment">// A bit of a misnomer...next_PC is actually the current PC until</span>
<a name="l00533"></a>00533     <span class="comment">// this function updates it.</span>
<a name="l00534"></a>00534     <span class="keywordtype">bool</span> predict_taken;
<a name="l00535"></a>00535 
<a name="l00536"></a>00536     <span class="keywordflow">if</span> (!inst-&gt;isControl()) {
<a name="l00537"></a>00537         <a class="code" href="namespaceAlphaISA.html#add1b209af0281827d9ac0a67747a3bf7">TheISA::advancePC</a>(nextPC, inst-&gt;staticInst);
<a name="l00538"></a>00538         inst-&gt;setPredTarg(nextPC);
<a name="l00539"></a>00539         inst-&gt;setPredTaken(<span class="keyword">false</span>);
<a name="l00540"></a>00540         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00541"></a>00541     }
<a name="l00542"></a>00542 
<a name="l00543"></a>00543     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = inst-&gt;threadNumber;
<a name="l00544"></a>00544     predict_taken = <a class="code" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a>-&gt;<a class="code" href="classBPredUnit.html#a9d2ad862133709eece4bf864fe378282">predict</a>(inst-&gt;staticInst, inst-&gt;seqNum,
<a name="l00545"></a>00545                                         nextPC, tid);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="keywordflow">if</span> (predict_taken) {
<a name="l00548"></a>00548         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: [sn:%i]:  Branch predicted to be taken to %s.\n&quot;</span>,
<a name="l00549"></a>00549                 tid, inst-&gt;seqNum, nextPC);
<a name="l00550"></a>00550     } <span class="keywordflow">else</span> {
<a name="l00551"></a>00551         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: [sn:%i]:Branch predicted to be not taken.\n&quot;</span>,
<a name="l00552"></a>00552                 tid, inst-&gt;seqNum);
<a name="l00553"></a>00553     }
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: [sn:%i] Branch predicted to go to %s.\n&quot;</span>,
<a name="l00556"></a>00556             tid, inst-&gt;seqNum, nextPC);
<a name="l00557"></a>00557     inst-&gt;setPredTarg(nextPC);
<a name="l00558"></a>00558     inst-&gt;setPredTaken(predict_taken);
<a name="l00559"></a>00559 
<a name="l00560"></a>00560     ++<a class="code" href="classDefaultFetch.html#aaca0646636cde96795aed6beb2942975">fetchedBranches</a>;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562     <span class="keywordflow">if</span> (predict_taken) {
<a name="l00563"></a>00563         ++<a class="code" href="classDefaultFetch.html#ae5c954036e76b5cc5a82cf7f17d4d5ed">predictedBranches</a>;
<a name="l00564"></a>00564     }
<a name="l00565"></a>00565 
<a name="l00566"></a>00566     <span class="keywordflow">return</span> predict_taken;
<a name="l00567"></a>00567 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2cce05272516009508e173f69d7d37df"></a><!-- doxytag: member="DefaultFetch::lsqCount" ref="a2cce05272516009508e173f69d7d37df" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> lsqCount </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the appropriate thread to fetch using the <a class="el" href="classLSQ.html">LSQ</a> count policy. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01538"></a>01538 {
<a name="l01539"></a>01539     std::priority_queue&lt;unsigned&gt; PQ;
<a name="l01540"></a>01540     std::map&lt;unsigned, ThreadID&gt; threadMap;
<a name="l01541"></a>01541 
<a name="l01542"></a>01542     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l01543"></a>01543     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> end = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end();
<a name="l01544"></a>01544 
<a name="l01545"></a>01545     <span class="keywordflow">while</span> (threads != end) {
<a name="l01546"></a>01546         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *threads++;
<a name="l01547"></a>01547         <span class="keywordtype">unsigned</span> ldstqCount = <a class="code" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a>-&gt;iewInfo[tid].ldstqCount;
<a name="l01548"></a>01548 
<a name="l01549"></a>01549         PQ.push(ldstqCount);
<a name="l01550"></a>01550         threadMap[ldstqCount] = tid;
<a name="l01551"></a>01551     }
<a name="l01552"></a>01552 
<a name="l01553"></a>01553     <span class="keywordflow">while</span> (!PQ.empty()) {
<a name="l01554"></a>01554         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> high_pri = threadMap[PQ.top()];
<a name="l01555"></a>01555 
<a name="l01556"></a>01556         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l01557"></a>01557             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a> ||
<a name="l01558"></a>01558             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>)
<a name="l01559"></a>01559             <span class="keywordflow">return</span> high_pri;
<a name="l01560"></a>01560         <span class="keywordflow">else</span>
<a name="l01561"></a>01561             PQ.pop();
<a name="l01562"></a>01562     }
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01565"></a>01565 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37627d5d5bba7f4a8690c71c2ab3cb07"></a><!-- doxytag: member="DefaultFetch::name" ref="a37627d5d5bba7f4a8690c71c2ab3cb07" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the name of fetch. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00160"></a>00160 {
<a name="l00161"></a>00161     <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;name() + <span class="stringliteral">&quot;.fetch&quot;</span>;
<a name="l00162"></a>00162 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a80cf75d186616b207a78a162498d1012"></a><!-- doxytag: member="DefaultFetch::pipelineIcacheAccesses" ref="a80cf75d186616b207a78a162498d1012" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pipelineIcacheAccesses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pipeline the next I-cache access to the current one. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01584"></a>01584 {
<a name="l01585"></a>01585     <span class="keywordflow">if</span> (!<a class="code" href="classDefaultFetch.html#a4004484fff11512f43124243e7eac71a">issuePipelinedIfetch</a>[tid]) {
<a name="l01586"></a>01586         <span class="keywordflow">return</span>;
<a name="l01587"></a>01587     }
<a name="l01588"></a>01588 
<a name="l01589"></a>01589     <span class="comment">// The next PC to access.</span>
<a name="l01590"></a>01590     <a class="code" href="namespaceAlphaISA.html#af780de49982ecf691215cac9b9dfc615">TheISA::PCState</a> thisPC = <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid];
<a name="l01591"></a>01591 
<a name="l01592"></a>01592     <span class="keywordflow">if</span> (<a class="code" href="base_2types_8hh.html#a01ec7071d9749218cc83949b3f93cd9b">isRomMicroPC</a>(thisPC.microPC())) {
<a name="l01593"></a>01593         <span class="keywordflow">return</span>;
<a name="l01594"></a>01594     }
<a name="l01595"></a>01595 
<a name="l01596"></a>01596     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> pcOffset = <a class="code" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a>[tid];
<a name="l01597"></a>01597     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchAddr = (thisPC.instAddr() + pcOffset) &amp; BaseCPU::PCMask;
<a name="l01598"></a>01598 
<a name="l01599"></a>01599     <span class="comment">// Align the fetch PC so its at the start of a fetch buffer segment.</span>
<a name="l01600"></a>01600     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> fetchBufferBlockPC = <a class="code" href="classDefaultFetch.html#a0c451948a0050595e5d23f57866f2797">fetchBufferAlignPC</a>(fetchAddr);
<a name="l01601"></a>01601 
<a name="l01602"></a>01602     <span class="comment">// Unless buffer already got the block, fetch it from icache.</span>
<a name="l01603"></a>01603     <span class="keywordflow">if</span> (!(<a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[tid] &amp;&amp; fetchBufferBlockPC == <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid])) {
<a name="l01604"></a>01604         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Issuing a pipelined I-cache access, &quot;</span>
<a name="l01605"></a>01605                 <span class="stringliteral">&quot;starting at PC %s.\n&quot;</span>, tid, thisPC);
<a name="l01606"></a>01606 
<a name="l01607"></a>01607         <a class="code" href="classDefaultFetch.html#a2ede53ea19a95876fd2418fcc329ef9a">fetchCacheLine</a>(fetchAddr, tid, thisPC.instAddr());
<a name="l01608"></a>01608     }
<a name="l01609"></a>01609 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3dc029c2e87eb911352b82ff15c86236"></a><!-- doxytag: member="DefaultFetch::processCacheCompletion" ref="a3dc029c2e87eb911352b82ff15c86236" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processCacheCompletion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes cache completion event. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00375"></a>00375 {
<a name="l00376"></a>00376     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#afc38d04c77e7b5fc3bbb0dd00fc87742">threadId</a>();
<a name="l00377"></a>00377 
<a name="l00378"></a>00378     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%u] Waking up from cache miss.\n&quot;</span>, tid);
<a name="l00379"></a>00379     assert(!<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;switchedOut());
<a name="l00380"></a>00380 
<a name="l00381"></a>00381     <span class="comment">// Only change the status if it&apos;s still waiting on the icache access</span>
<a name="l00382"></a>00382     <span class="comment">// to return.</span>
<a name="l00383"></a>00383     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] != <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a> ||
<a name="l00384"></a>00384         pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a> != <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid]) {
<a name="l00385"></a>00385         ++<a class="code" href="classDefaultFetch.html#af5ce6113f31fddaab758b8fb025600bc">fetchIcacheSquashes</a>;
<a name="l00386"></a>00386         <span class="keyword">delete</span> pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>;
<a name="l00387"></a>00387         <span class="keyword">delete</span> pkt;
<a name="l00388"></a>00388         <span class="keywordflow">return</span>;
<a name="l00389"></a>00389     }
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     memcpy(<a class="code" href="classDefaultFetch.html#a924f2775385b2e5ac3008db4b8305c2b">fetchBuffer</a>[tid], pkt-&gt;<a class="code" href="classPacket.html#a5c451baf3f0a89084e79e69bb9061200">getPtr</a>&lt;uint8_t&gt;(), <a class="code" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a>);
<a name="l00392"></a>00392     <a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[tid] = <span class="keyword">true</span>;
<a name="l00393"></a>00393 
<a name="l00394"></a>00394     <span class="comment">// Wake up the CPU (if it went to sleep and was waiting on</span>
<a name="l00395"></a>00395     <span class="comment">// this completion event).</span>
<a name="l00396"></a>00396     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;wakeCPU();
<a name="l00397"></a>00397 
<a name="l00398"></a>00398     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;[tid:%u] Activating fetch due to cache completion\n&quot;</span>,
<a name="l00399"></a>00399             tid);
<a name="l00400"></a>00400 
<a name="l00401"></a>00401     <a class="code" href="classDefaultFetch.html#a03ce24cba34d3da5948f54e10f8710a9">switchToActive</a>();
<a name="l00402"></a>00402 
<a name="l00403"></a>00403     <span class="comment">// Only switch to IcacheAccessComplete if we&apos;re not stalled as well.</span>
<a name="l00404"></a>00404     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a6ba4f2f95d991f5be818dabf7500feed">checkStall</a>(tid)) {
<a name="l00405"></a>00405         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>;
<a name="l00406"></a>00406     } <span class="keywordflow">else</span> {
<a name="l00407"></a>00407         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a>;
<a name="l00408"></a>00408     }
<a name="l00409"></a>00409 
<a name="l00410"></a>00410     pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#ae10871c545a9288b0b1cf05f43d49e19">setAccessLatency</a>();
<a name="l00411"></a>00411     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;ppInstAccessComplete-&gt;notify(pkt);
<a name="l00412"></a>00412     <span class="comment">// Reset the mem req to NULL.</span>
<a name="l00413"></a>00413     <span class="keyword">delete</span> pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>;
<a name="l00414"></a>00414     <span class="keyword">delete</span> pkt;
<a name="l00415"></a>00415     <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00416"></a>00416 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab3fa3c541f25b65e1b61d7290712e507"></a><!-- doxytag: member="DefaultFetch::profileStall" ref="ab3fa3c541f25b65e1b61d7290712e507" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void profileStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Profile the reasons of fetch stall. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01613"></a>01613                                              {
<a name="l01614"></a>01614     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch,<span class="stringliteral">&quot;There are no more threads available to fetch from.\n&quot;</span>);
<a name="l01615"></a>01615 
<a name="l01616"></a>01616     <span class="comment">// @todo Per-thread stats</span>
<a name="l01617"></a>01617 
<a name="l01618"></a>01618     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="namespacem5_1_1simulate.html#a125fb26cebcc172aca2d13dbf5a2f73c">drain</a>) {
<a name="l01619"></a>01619         ++<a class="code" href="classDefaultFetch.html#ad09f9a8597b6f2c627b5c116d85ea375">fetchPendingDrainCycles</a>;
<a name="l01620"></a>01620         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch is waiting for a drain!\n&quot;</span>);
<a name="l01621"></a>01621     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;empty()) {
<a name="l01622"></a>01622         ++<a class="code" href="classDefaultFetch.html#aaa3b110a1f8e4fb7c88676a2ee836a06">fetchNoActiveThreadStallCycles</a>;
<a name="l01623"></a>01623         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Fetch has no active thread!\n&quot;</span>);
<a name="l01624"></a>01624     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>) {
<a name="l01625"></a>01625         ++<a class="code" href="classDefaultFetch.html#a0501ffad4abed98618a6cf0ba9c3599b">fetchBlockedCycles</a>;
<a name="l01626"></a>01626         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is blocked!\n&quot;</span>, tid);
<a name="l01627"></a>01627     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>) {
<a name="l01628"></a>01628         ++<a class="code" href="classDefaultFetch.html#ae1b92a3469ac6b00fddd788b71f64c9a">fetchSquashCycles</a>;
<a name="l01629"></a>01629         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is squashing!\n&quot;</span>, tid);
<a name="l01630"></a>01630     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>) {
<a name="l01631"></a>01631         ++<a class="code" href="classDefaultFetch.html#a2b9328bdb1a6898bfae824981cd64311">icacheStallCycles</a>;
<a name="l01632"></a>01632         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is waiting cache response!\n&quot;</span>,
<a name="l01633"></a>01633                 tid);
<a name="l01634"></a>01634     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2872442035b8be061f050fdf94761d33">ItlbWait</a>) {
<a name="l01635"></a>01635         ++<a class="code" href="classDefaultFetch.html#a9b08d665534d5e7d5b8134c4af16881d">fetchTlbCycles</a>;
<a name="l01636"></a>01636         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is waiting ITLB walk to &quot;</span>
<a name="l01637"></a>01637                 <span class="stringliteral">&quot;finish!\n&quot;</span>, tid);
<a name="l01638"></a>01638     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca8c49adf6da5f507150d403610c684877">TrapPending</a>) {
<a name="l01639"></a>01639         ++<a class="code" href="classDefaultFetch.html#a5a80cd5375f1281e64f0dd318cc761d2">fetchPendingTrapStallCycles</a>;
<a name="l01640"></a>01640         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is waiting for a pending trap!\n&quot;</span>,
<a name="l01641"></a>01641                 tid);
<a name="l01642"></a>01642     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca6dd2239b509a3ed085ad3bddda99cb16">QuiescePending</a>) {
<a name="l01643"></a>01643         ++<a class="code" href="classDefaultFetch.html#a8be39e4ea9ed9168227dc6efced55f3f">fetchPendingQuiesceStallCycles</a>;
<a name="l01644"></a>01644         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is waiting for a pending quiesce &quot;</span>
<a name="l01645"></a>01645                 <span class="stringliteral">&quot;instruction!\n&quot;</span>, tid);
<a name="l01646"></a>01646     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a>) {
<a name="l01647"></a>01647         ++<a class="code" href="classDefaultFetch.html#a85ea1666f596116bc53a277b388d39d7">fetchIcacheWaitRetryStallCycles</a>;
<a name="l01648"></a>01648         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch is waiting for an I-cache retry!\n&quot;</span>,
<a name="l01649"></a>01649                 tid);
<a name="l01650"></a>01650     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caadf72b4e66cdfa8a56beab05bb411da6">NoGoodAddr</a>) {
<a name="l01651"></a>01651             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Fetch predicted non-executable address\n&quot;</span>,
<a name="l01652"></a>01652                     tid);
<a name="l01653"></a>01653     } <span class="keywordflow">else</span> {
<a name="l01654"></a>01654         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Unexpected fetch stall reason (Status: %i).\n&quot;</span>,
<a name="l01655"></a>01655              tid, <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid]);
<a name="l01656"></a>01656     }
<a name="l01657"></a>01657 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a29cb5a4f98063ce6e9210eacbdb35298"></a><!-- doxytag: member="DefaultFetch::recvRetry" ref="a29cb5a4f98063ce6e9210eacbdb35298" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recvRetry </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Handles retrying the fetch access. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01403"></a>01403 {
<a name="l01404"></a>01404     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a> != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l01405"></a>01405         assert(<a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a>);
<a name="l01406"></a>01406         assert(<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> != <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>);
<a name="l01407"></a>01407         assert(<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a>] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2a36c8d85e537909b8fa14af846e48a3">IcacheWaitRetry</a>);
<a name="l01408"></a>01408 
<a name="l01409"></a>01409         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;getInstPort().sendTimingReq(<a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a>)) {
<a name="l01410"></a>01410             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a>] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caa694766f134e9cd81f5ad5b91dedf852">IcacheWaitResponse</a>;
<a name="l01411"></a>01411             <a class="code" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a> = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l01412"></a>01412             <a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> = <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01413"></a>01413             <a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a> = <span class="keyword">false</span>;
<a name="l01414"></a>01414         }
<a name="l01415"></a>01415     } <span class="keywordflow">else</span> {
<a name="l01416"></a>01416         assert(<a class="code" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a> == <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>);
<a name="l01417"></a>01417         <span class="comment">// Access has been squashed since it was sent out.  Just clear</span>
<a name="l01418"></a>01418         <span class="comment">// the cache being blocked.</span>
<a name="l01419"></a>01419         <a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a> = <span class="keyword">false</span>;
<a name="l01420"></a>01420     }
<a name="l01421"></a>01421 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa2dab17a363fd4307274d579796adcf7"></a><!-- doxytag: member="DefaultFetch::regProbePoints" ref="aa2dab17a363fd4307274d579796adcf7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regProbePoints </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Registers probes. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00167"></a>00167 {
<a name="l00168"></a>00168     <a class="code" href="classDefaultFetch.html#a853ac5048dfdbba414f6f8186dd11afd">ppFetch</a> = <span class="keyword">new</span> <a class="code" href="classProbePointArg.html">ProbePointArg&lt;DynInstPtr&gt;</a>(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;getProbeManager(), <span class="stringliteral">&quot;Fetch&quot;</span>);
<a name="l00169"></a>00169 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4dc637449366fcdfc4e764cdf12d9b11"></a><!-- doxytag: member="DefaultFetch::regStats" ref="a4dc637449366fcdfc4e764cdf12d9b11" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regStats </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Registers statistics. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00174"></a>00174 {
<a name="l00175"></a>00175     <a class="code" href="classDefaultFetch.html#a2b9328bdb1a6898bfae824981cd64311">icacheStallCycles</a>
<a name="l00176"></a>00176         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.icacheStallCycles&quot;</span>)
<a name="l00177"></a>00177         .desc(<span class="stringliteral">&quot;Number of cycles fetch is stalled on an Icache miss&quot;</span>)
<a name="l00178"></a>00178         .prereq(<a class="code" href="classDefaultFetch.html#a2b9328bdb1a6898bfae824981cd64311">icacheStallCycles</a>);
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <a class="code" href="classDefaultFetch.html#af0e3fa228032036d2022ed9e2a3612b6">fetchedInsts</a>
<a name="l00181"></a>00181         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.Insts&quot;</span>)
<a name="l00182"></a>00182         .desc(<span class="stringliteral">&quot;Number of instructions fetch has processed&quot;</span>)
<a name="l00183"></a>00183         .prereq(<a class="code" href="classDefaultFetch.html#af0e3fa228032036d2022ed9e2a3612b6">fetchedInsts</a>);
<a name="l00184"></a>00184 
<a name="l00185"></a>00185     <a class="code" href="classDefaultFetch.html#aaca0646636cde96795aed6beb2942975">fetchedBranches</a>
<a name="l00186"></a>00186         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.Branches&quot;</span>)
<a name="l00187"></a>00187         .desc(<span class="stringliteral">&quot;Number of branches that fetch encountered&quot;</span>)
<a name="l00188"></a>00188         .prereq(<a class="code" href="classDefaultFetch.html#aaca0646636cde96795aed6beb2942975">fetchedBranches</a>);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190     <a class="code" href="classDefaultFetch.html#ae5c954036e76b5cc5a82cf7f17d4d5ed">predictedBranches</a>
<a name="l00191"></a>00191         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.predictedBranches&quot;</span>)
<a name="l00192"></a>00192         .desc(<span class="stringliteral">&quot;Number of branches that fetch has predicted taken&quot;</span>)
<a name="l00193"></a>00193         .prereq(<a class="code" href="classDefaultFetch.html#ae5c954036e76b5cc5a82cf7f17d4d5ed">predictedBranches</a>);
<a name="l00194"></a>00194 
<a name="l00195"></a>00195     <a class="code" href="classDefaultFetch.html#a9699b5489dd499e832651b96f95b5d19">fetchCycles</a>
<a name="l00196"></a>00196         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.Cycles&quot;</span>)
<a name="l00197"></a>00197         .desc(<span class="stringliteral">&quot;Number of cycles fetch has run and was not squashing or&quot;</span>
<a name="l00198"></a>00198               <span class="stringliteral">&quot; blocked&quot;</span>)
<a name="l00199"></a>00199         .prereq(<a class="code" href="classDefaultFetch.html#a9699b5489dd499e832651b96f95b5d19">fetchCycles</a>);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     <a class="code" href="classDefaultFetch.html#ae1b92a3469ac6b00fddd788b71f64c9a">fetchSquashCycles</a>
<a name="l00202"></a>00202         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.SquashCycles&quot;</span>)
<a name="l00203"></a>00203         .desc(<span class="stringliteral">&quot;Number of cycles fetch has spent squashing&quot;</span>)
<a name="l00204"></a>00204         .prereq(<a class="code" href="classDefaultFetch.html#ae1b92a3469ac6b00fddd788b71f64c9a">fetchSquashCycles</a>);
<a name="l00205"></a>00205 
<a name="l00206"></a>00206     <a class="code" href="classDefaultFetch.html#a9b08d665534d5e7d5b8134c4af16881d">fetchTlbCycles</a>
<a name="l00207"></a>00207         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.TlbCycles&quot;</span>)
<a name="l00208"></a>00208         .desc(<span class="stringliteral">&quot;Number of cycles fetch has spent waiting for tlb&quot;</span>)
<a name="l00209"></a>00209         .prereq(<a class="code" href="classDefaultFetch.html#a9b08d665534d5e7d5b8134c4af16881d">fetchTlbCycles</a>);
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     <a class="code" href="classDefaultFetch.html#a8af716ad2a53a409640347226078591c">fetchIdleCycles</a>
<a name="l00212"></a>00212         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.IdleCycles&quot;</span>)
<a name="l00213"></a>00213         .desc(<span class="stringliteral">&quot;Number of cycles fetch was idle&quot;</span>)
<a name="l00214"></a>00214         .prereq(<a class="code" href="classDefaultFetch.html#a8af716ad2a53a409640347226078591c">fetchIdleCycles</a>);
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <a class="code" href="classDefaultFetch.html#a0501ffad4abed98618a6cf0ba9c3599b">fetchBlockedCycles</a>
<a name="l00217"></a>00217         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.BlockedCycles&quot;</span>)
<a name="l00218"></a>00218         .desc(<span class="stringliteral">&quot;Number of cycles fetch has spent blocked&quot;</span>)
<a name="l00219"></a>00219         .prereq(<a class="code" href="classDefaultFetch.html#a0501ffad4abed98618a6cf0ba9c3599b">fetchBlockedCycles</a>);
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     <a class="code" href="classDefaultFetch.html#a0ead660daa133edcd64ac552d473ebba">fetchedCacheLines</a>
<a name="l00222"></a>00222         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.CacheLines&quot;</span>)
<a name="l00223"></a>00223         .desc(<span class="stringliteral">&quot;Number of cache lines fetched&quot;</span>)
<a name="l00224"></a>00224         .prereq(<a class="code" href="classDefaultFetch.html#a0ead660daa133edcd64ac552d473ebba">fetchedCacheLines</a>);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <a class="code" href="classDefaultFetch.html#a0a77b8544fea92003669cdc78a46eea5">fetchMiscStallCycles</a>
<a name="l00227"></a>00227         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.MiscStallCycles&quot;</span>)
<a name="l00228"></a>00228         .desc(<span class="stringliteral">&quot;Number of cycles fetch has spent waiting on interrupts, or &quot;</span>
<a name="l00229"></a>00229               <span class="stringliteral">&quot;bad addresses, or out of MSHRs&quot;</span>)
<a name="l00230"></a>00230         .prereq(<a class="code" href="classDefaultFetch.html#a0a77b8544fea92003669cdc78a46eea5">fetchMiscStallCycles</a>);
<a name="l00231"></a>00231 
<a name="l00232"></a>00232     <a class="code" href="classDefaultFetch.html#ad09f9a8597b6f2c627b5c116d85ea375">fetchPendingDrainCycles</a>
<a name="l00233"></a>00233         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.PendingDrainCycles&quot;</span>)
<a name="l00234"></a>00234         .desc(<span class="stringliteral">&quot;Number of cycles fetch has spent waiting on pipes to drain&quot;</span>)
<a name="l00235"></a>00235         .prereq(<a class="code" href="classDefaultFetch.html#ad09f9a8597b6f2c627b5c116d85ea375">fetchPendingDrainCycles</a>);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <a class="code" href="classDefaultFetch.html#aaa3b110a1f8e4fb7c88676a2ee836a06">fetchNoActiveThreadStallCycles</a>
<a name="l00238"></a>00238         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.NoActiveThreadStallCycles&quot;</span>)
<a name="l00239"></a>00239         .desc(<span class="stringliteral">&quot;Number of stall cycles due to no active thread to fetch from&quot;</span>)
<a name="l00240"></a>00240         .prereq(<a class="code" href="classDefaultFetch.html#aaa3b110a1f8e4fb7c88676a2ee836a06">fetchNoActiveThreadStallCycles</a>);
<a name="l00241"></a>00241 
<a name="l00242"></a>00242     <a class="code" href="classDefaultFetch.html#a5a80cd5375f1281e64f0dd318cc761d2">fetchPendingTrapStallCycles</a>
<a name="l00243"></a>00243         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.PendingTrapStallCycles&quot;</span>)
<a name="l00244"></a>00244         .desc(<span class="stringliteral">&quot;Number of stall cycles due to pending traps&quot;</span>)
<a name="l00245"></a>00245         .prereq(<a class="code" href="classDefaultFetch.html#a5a80cd5375f1281e64f0dd318cc761d2">fetchPendingTrapStallCycles</a>);
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <a class="code" href="classDefaultFetch.html#a8be39e4ea9ed9168227dc6efced55f3f">fetchPendingQuiesceStallCycles</a>
<a name="l00248"></a>00248         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.PendingQuiesceStallCycles&quot;</span>)
<a name="l00249"></a>00249         .desc(<span class="stringliteral">&quot;Number of stall cycles due to pending quiesce instructions&quot;</span>)
<a name="l00250"></a>00250         .prereq(<a class="code" href="classDefaultFetch.html#a8be39e4ea9ed9168227dc6efced55f3f">fetchPendingQuiesceStallCycles</a>);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <a class="code" href="classDefaultFetch.html#a85ea1666f596116bc53a277b388d39d7">fetchIcacheWaitRetryStallCycles</a>
<a name="l00253"></a>00253         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.IcacheWaitRetryStallCycles&quot;</span>)
<a name="l00254"></a>00254         .desc(<span class="stringliteral">&quot;Number of stall cycles due to full MSHR&quot;</span>)
<a name="l00255"></a>00255         .prereq(<a class="code" href="classDefaultFetch.html#a85ea1666f596116bc53a277b388d39d7">fetchIcacheWaitRetryStallCycles</a>);
<a name="l00256"></a>00256 
<a name="l00257"></a>00257     <a class="code" href="classDefaultFetch.html#af5ce6113f31fddaab758b8fb025600bc">fetchIcacheSquashes</a>
<a name="l00258"></a>00258         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.IcacheSquashes&quot;</span>)
<a name="l00259"></a>00259         .desc(<span class="stringliteral">&quot;Number of outstanding Icache misses that were squashed&quot;</span>)
<a name="l00260"></a>00260         .prereq(<a class="code" href="classDefaultFetch.html#af5ce6113f31fddaab758b8fb025600bc">fetchIcacheSquashes</a>);
<a name="l00261"></a>00261 
<a name="l00262"></a>00262     <a class="code" href="classDefaultFetch.html#afe07cb06e5135b2305320fa11fda71af">fetchTlbSquashes</a>
<a name="l00263"></a>00263         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.ItlbSquashes&quot;</span>)
<a name="l00264"></a>00264         .desc(<span class="stringliteral">&quot;Number of outstanding ITLB misses that were squashed&quot;</span>)
<a name="l00265"></a>00265         .prereq(<a class="code" href="classDefaultFetch.html#afe07cb06e5135b2305320fa11fda71af">fetchTlbSquashes</a>);
<a name="l00266"></a>00266 
<a name="l00267"></a>00267     <a class="code" href="classDefaultFetch.html#a4793a4a8857c13e7812b1c37c6df761b">fetchNisnDist</a>
<a name="l00268"></a>00268         .<a class="code" href="classStats_1_1Distribution.html#a330a131f9f1614fae623ba309b61a590">init</a>(<span class="comment">/* base value */</span> 0,
<a name="l00269"></a>00269               <span class="comment">/* last value */</span> <a class="code" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a>,
<a name="l00270"></a>00270               <span class="comment">/* bucket size */</span> 1)
<a name="l00271"></a>00271         .name(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.rateDist&quot;</span>)
<a name="l00272"></a>00272         .desc(<span class="stringliteral">&quot;Number of instructions fetched each cycle (Total)&quot;</span>)
<a name="l00273"></a>00273         .flags(<a class="code" href="namespaceStats.html#a148700bbb7b09b1ebb9d6b099155391a">Stats::pdf</a>);
<a name="l00274"></a>00274 
<a name="l00275"></a>00275     <a class="code" href="classDefaultFetch.html#a4b942e4ec6b8c1d29a1c96e901ea71dd">idleRate</a>
<a name="l00276"></a>00276         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.idleRate&quot;</span>)
<a name="l00277"></a>00277         .desc(<span class="stringliteral">&quot;Percent of cycles fetch was idle&quot;</span>)
<a name="l00278"></a>00278         .prereq(<a class="code" href="classDefaultFetch.html#a4b942e4ec6b8c1d29a1c96e901ea71dd">idleRate</a>);
<a name="l00279"></a>00279     <a class="code" href="classDefaultFetch.html#a4b942e4ec6b8c1d29a1c96e901ea71dd">idleRate</a> = <a class="code" href="classDefaultFetch.html#a8af716ad2a53a409640347226078591c">fetchIdleCycles</a> * 100 / <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;numCycles;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281     <a class="code" href="classDefaultFetch.html#abceba4006d416e352df47f692b589bc3">branchRate</a>
<a name="l00282"></a>00282         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.branchRate&quot;</span>)
<a name="l00283"></a>00283         .desc(<span class="stringliteral">&quot;Number of branch fetches per cycle&quot;</span>)
<a name="l00284"></a>00284         .flags(<a class="code" href="namespaceStats.html#a4031dfee086a6a4cf1deea1fff2e0d5c">Stats::total</a>);
<a name="l00285"></a>00285     <a class="code" href="classDefaultFetch.html#abceba4006d416e352df47f692b589bc3">branchRate</a> = <a class="code" href="classDefaultFetch.html#aaca0646636cde96795aed6beb2942975">fetchedBranches</a> / <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;numCycles;
<a name="l00286"></a>00286 
<a name="l00287"></a>00287     <a class="code" href="classDefaultFetch.html#a7656c6cac3b62fa389148c650a5d127a">fetchRate</a>
<a name="l00288"></a>00288         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classDefaultFetch.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.rate&quot;</span>)
<a name="l00289"></a>00289         .desc(<span class="stringliteral">&quot;Number of inst fetches per cycle&quot;</span>)
<a name="l00290"></a>00290         .flags(<a class="code" href="namespaceStats.html#a4031dfee086a6a4cf1deea1fff2e0d5c">Stats::total</a>);
<a name="l00291"></a>00291     <a class="code" href="classDefaultFetch.html#a7656c6cac3b62fa389148c650a5d127a">fetchRate</a> = <a class="code" href="classDefaultFetch.html#af0e3fa228032036d2022ed9e2a3612b6">fetchedInsts</a> / <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;numCycles;
<a name="l00292"></a>00292 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ada2a699094bc420f977abf2a17ed14c8"></a><!-- doxytag: member="DefaultFetch::resetStage" ref="ada2a699094bc420f977abf2a17ed14c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resetStage </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reset this pipeline stage </p>

<p><div class="fragment"><pre class="fragment"><a name="l00339"></a>00339 {
<a name="l00340"></a>00340     <a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> = 0;
<a name="l00341"></a>00341     <a class="code" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a> = <span class="keyword">false</span>;
<a name="l00342"></a>00342     <a class="code" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a> = <span class="keyword">false</span>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344     <a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.clear();
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     <span class="comment">// Setup PC and nextPC with initial state.</span>
<a name="l00347"></a>00347     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = 0; tid &lt; <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; ++tid) {
<a name="l00348"></a>00348         <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>;
<a name="l00349"></a>00349         <a class="code" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[tid] = <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;pcState(tid);
<a name="l00350"></a>00350         <a class="code" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a>[tid] = 0;
<a name="l00351"></a>00351         <a class="code" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00352"></a>00352 
<a name="l00353"></a>00353         <a class="code" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a>[tid] = <span class="keyword">false</span>;
<a name="l00354"></a>00354         <a class="code" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00355"></a>00355 
<a name="l00356"></a>00356         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a8bd8acc41e5baa0bb18c0f0f6a78020e">decode</a> = <span class="keyword">false</span>;
<a name="l00357"></a>00357         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a5e8e124987c56967514ad546a9f9c09b">rename</a> = <span class="keyword">false</span>;
<a name="l00358"></a>00358         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#a69f40ab12e9825ce316dfa72651a7404">iew</a> = <span class="keyword">false</span>;
<a name="l00359"></a>00359         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#ad7d6b839c43385b5fffdf2beaff214ec">commit</a> = <span class="keyword">false</span>;
<a name="l00360"></a>00360         <a class="code" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[tid].<a class="code" href="structDefaultFetch_1_1Stalls.html#af29f0db645517864849f52e686f40bf6">drain</a> = <span class="keyword">false</span>;
<a name="l00361"></a>00361 
<a name="l00362"></a>00362         <a class="code" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[tid] = 0;
<a name="l00363"></a>00363         <a class="code" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[tid] = <span class="keyword">false</span>;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365         <a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.push_back(tid);
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367 
<a name="l00368"></a>00368     <a class="code" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">false</span>;
<a name="l00369"></a>00369     <a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> = <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>;
<a name="l00370"></a>00370 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8aab9cacbc483081596b13ecd5192eb5"></a><!-- doxytag: member="DefaultFetch::roundRobin" ref="a8aab9cacbc483081596b13ecd5192eb5" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> roundRobin </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the appropriate thread to fetch using a round robin policy. </p>

<p><div class="fragment"><pre class="fragment"><a name="l01475"></a>01475 {
<a name="l01476"></a>01476     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> pri_iter = <a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.begin();
<a name="l01477"></a>01477     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> end      = <a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.end();
<a name="l01478"></a>01478 
<a name="l01479"></a>01479     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> high_pri;
<a name="l01480"></a>01480 
<a name="l01481"></a>01481     <span class="keywordflow">while</span> (pri_iter != end) {
<a name="l01482"></a>01482         high_pri = *pri_iter;
<a name="l01483"></a>01483 
<a name="l01484"></a>01484         assert(high_pri &lt;= <a class="code" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>);
<a name="l01485"></a>01485 
<a name="l01486"></a>01486         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l01487"></a>01487             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a> ||
<a name="l01488"></a>01488             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[high_pri] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>) {
<a name="l01489"></a>01489 
<a name="l01490"></a>01490             <a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.erase(pri_iter);
<a name="l01491"></a>01491             <a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.push_back(high_pri);
<a name="l01492"></a>01492 
<a name="l01493"></a>01493             <span class="keywordflow">return</span> high_pri;
<a name="l01494"></a>01494         }
<a name="l01495"></a>01495 
<a name="l01496"></a>01496         pri_iter++;
<a name="l01497"></a>01497     }
<a name="l01498"></a>01498 
<a name="l01499"></a>01499     <span class="keywordflow">return</span> <a class="code" href="base_2types_8hh.html#a192b210a26f038691d0f095d85dc0953">InvalidThreadID</a>;
<a name="l01500"></a>01500 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aab96bdacf8bd420402cbb543f994e054"></a><!-- doxytag: member="DefaultFetch::setActiveThreads" ref="aab96bdacf8bd420402cbb543f994e054" args="(std::list&lt; ThreadID &gt; *at_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setActiveThreads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>at_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets pointer to list of active threads. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00310"></a>00310 {
<a name="l00311"></a>00311     <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a> = at_ptr;
<a name="l00312"></a>00312 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad1be90519aa7737ddf8e41de079a5ea9"></a><!-- doxytag: member="DefaultFetch::setFetchQueue" ref="ad1be90519aa7737ddf8e41de079a5ea9" args="(TimeBuffer&lt; FetchStruct &gt; *fq_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setFetchQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>fq_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets pointer to time buffer used to communicate to the next stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00317"></a>00317 {
<a name="l00318"></a>00318     <a class="code" href="classDefaultFetch.html#a9a2f350be647ebfb6567172812db491a">fetchQueue</a> = fq_ptr;
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     <span class="comment">// Create wire to write information to proper place in fetch queue.</span>
<a name="l00321"></a>00321     <a class="code" href="classDefaultFetch.html#a5283adcc786817de9adc5a4601aa3a6f">toDecode</a> = <a class="code" href="classDefaultFetch.html#a9a2f350be647ebfb6567172812db491a">fetchQueue</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(0);
<a name="l00322"></a>00322 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa9fe72c29dff746fa7023a15c1134ada"></a><!-- doxytag: member="DefaultFetch::setTimeBuffer" ref="aa9fe72c29dff746fa7023a15c1134ada" args="(TimeBuffer&lt; TimeStruct &gt; *time_buffer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setTimeBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>time_buffer</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the main backwards communication time buffer pointer. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <a class="code" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a> = time_buffer;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300     <span class="comment">// Create wires to get information from proper places in time buffer.</span>
<a name="l00301"></a>00301     <a class="code" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a> = <a class="code" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(-<a class="code" href="classDefaultFetch.html#a2ef45e1e2bd510cfb43c0a03a6ab3f1c">decodeToFetchDelay</a>);
<a name="l00302"></a>00302     <a class="code" href="classDefaultFetch.html#ae99c54a9c8f1e218b86afcee348c54fc">fromRename</a> = <a class="code" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(-<a class="code" href="classDefaultFetch.html#ae97f1fdea38bf1719a7d45a15f3dcd5c">renameToFetchDelay</a>);
<a name="l00303"></a>00303     <a class="code" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a> = <a class="code" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(-<a class="code" href="classDefaultFetch.html#a986e734c1e66dc0be1723ade04d06d4b">iewToFetchDelay</a>);
<a name="l00304"></a>00304     <a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a> = <a class="code" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(-<a class="code" href="classDefaultFetch.html#a4b0344f5703ba5770b42602c6df63340">commitToFetchDelay</a>);
<a name="l00305"></a>00305 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae16ceb7406a5afe4ea9a39fd12931d32"></a><!-- doxytag: member="DefaultFetch::squash" ref="ae16ceb7406a5afe4ea9a39fd12931d32" args="(const TheISA::PCState &amp;newPC, const InstSeqNum seq_num, DynInstPtr squashInst, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void squash </td>
          <td>(</td>
          <td class="paramtype">const TheISA::PCState &amp;&nbsp;</td>
          <td class="paramname"> <em>newPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a>&nbsp;</td>
          <td class="paramname"> <em>seq_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>squashInst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Squashes a specific thread and resets the PC. Also tells the CPU to remove any instructions that are not in the <a class="el" href="classROB.html">ROB</a>. The source of this squash should be the commit stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00864"></a>00864 {
<a name="l00865"></a>00865     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%u]: Squash from commit.\n&quot;</span>, tid);
<a name="l00866"></a>00866 
<a name="l00867"></a>00867     <a class="code" href="classDefaultFetch.html#a9c960f5de0fbb0511596cba5039660a3">doSquash</a>(newPC, squashInst, tid);
<a name="l00868"></a>00868 
<a name="l00869"></a>00869     <span class="comment">// Tell the CPU to remove any instructions that are not in the ROB.</span>
<a name="l00870"></a>00870     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;removeInstsNotInROB(tid);
<a name="l00871"></a>00871 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acddf0ab1e13108e3626da3743de398b8"></a><!-- doxytag: member="DefaultFetch::squashFromDecode" ref="acddf0ab1e13108e3626da3743de398b8" args="(const TheISA::PCState &amp;newPC, const DynInstPtr squashInst, const InstSeqNum seq_num, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void squashFromDecode </td>
          <td>(</td>
          <td class="paramtype">const TheISA::PCState &amp;&nbsp;</td>
          <td class="paramname"> <em>newPC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>squashInst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a>&nbsp;</td>
          <td class="paramname"> <em>seq_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Squashes a specific thread and resets the PC. Also tells the CPU to remove any instructions between fetch and decode that should be sqaushed. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00779"></a>00779 {
<a name="l00780"></a>00780     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;[tid:%i]: Squashing from decode.\n&quot;</span>, tid);
<a name="l00781"></a>00781 
<a name="l00782"></a>00782     <a class="code" href="classDefaultFetch.html#a9c960f5de0fbb0511596cba5039660a3">doSquash</a>(newPC, squashInst, tid);
<a name="l00783"></a>00783 
<a name="l00784"></a>00784     <span class="comment">// Tell the CPU to remove any instructions that are in flight between</span>
<a name="l00785"></a>00785     <span class="comment">// fetch and decode.</span>
<a name="l00786"></a>00786     <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;removeInstsUntil(seq_num, tid);
<a name="l00787"></a>00787 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a31d4cbdab16d4ff8d6bc7f84ece727da"></a><!-- doxytag: member="DefaultFetch::startupStage" ref="a31d4cbdab16d4ff8d6bc7f84ece727da" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void startupStage </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00327"></a>00327 {
<a name="l00328"></a>00328     assert(<a class="code" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a>.empty());
<a name="l00329"></a>00329     <a class="code" href="classDefaultFetch.html#ada2a699094bc420f977abf2a17ed14c8">resetStage</a>();
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="comment">// Fetch needs to start fetching instructions at the very beginning,</span>
<a name="l00332"></a>00332     <span class="comment">// so it must start up in active state.</span>
<a name="l00333"></a>00333     <a class="code" href="classDefaultFetch.html#a03ce24cba34d3da5948f54e10f8710a9">switchToActive</a>();
<a name="l00334"></a>00334 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a03ce24cba34d3da5948f54e10f8710a9"></a><!-- doxytag: member="DefaultFetch::switchToActive" ref="a03ce24cba34d3da5948f54e10f8710a9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void switchToActive </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Changes the status of this stage to active, and indicates this to the CPU. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00503"></a>00503 {
<a name="l00504"></a>00504     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> == <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>) {
<a name="l00505"></a>00505         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activating stage.\n&quot;</span>);
<a name="l00506"></a>00506 
<a name="l00507"></a>00507         <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;activateStage(O3CPU::FetchIdx);
<a name="l00508"></a>00508 
<a name="l00509"></a>00509         <a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> = <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520">Active</a>;
<a name="l00510"></a>00510     }
<a name="l00511"></a>00511 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8ef9d48876d3014250c97bfba41a42cd"></a><!-- doxytag: member="DefaultFetch::switchToInactive" ref="a8ef9d48876d3014250c97bfba41a42cd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void switchToInactive </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Changes the status of this stage to inactive, and indicates this to the CPU. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00516"></a>00516 {
<a name="l00517"></a>00517     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> == <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520">Active</a>) {
<a name="l00518"></a>00518         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Deactivating stage.\n&quot;</span>);
<a name="l00519"></a>00519 
<a name="l00520"></a>00520         <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;deactivateStage(O3CPU::FetchIdx);
<a name="l00521"></a>00521 
<a name="l00522"></a>00522         <a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> = <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>;
<a name="l00523"></a>00523     }
<a name="l00524"></a>00524 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8674059ce345e23aac5086b2c3e24a43"></a><!-- doxytag: member="DefaultFetch::takeOverFrom" ref="a8674059ce345e23aac5086b2c3e24a43" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void takeOverFrom </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Takes over from another CPU's thread. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00474"></a>00474 {
<a name="l00475"></a>00475     assert(<a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;getInstPort().isConnected());
<a name="l00476"></a>00476     <a class="code" href="classDefaultFetch.html#ada2a699094bc420f977abf2a17ed14c8">resetStage</a>();
<a name="l00477"></a>00477 
<a name="l00478"></a>00478 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a873dd91783f9efb4a590aded1f70d6b0"></a><!-- doxytag: member="DefaultFetch::tick" ref="a873dd91783f9efb4a590aded1f70d6b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tick </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Ticks the fetch stage, processing all inputs signals and fetching as many instructions as possible. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00876"></a>00876 {
<a name="l00877"></a>00877     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l00878"></a>00878     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> end = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end();
<a name="l00879"></a>00879     <span class="keywordtype">bool</span> status_change = <span class="keyword">false</span>;
<a name="l00880"></a>00880 
<a name="l00881"></a>00881     <a class="code" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">false</span>;
<a name="l00882"></a>00882 
<a name="l00883"></a>00883     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">Impl::MaxThreads</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00884"></a>00884         <a class="code" href="classDefaultFetch.html#a4004484fff11512f43124243e7eac71a">issuePipelinedIfetch</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = <span class="keyword">false</span>;
<a name="l00885"></a>00885     }
<a name="l00886"></a>00886 
<a name="l00887"></a>00887     <span class="keywordflow">while</span> (threads != end) {
<a name="l00888"></a>00888         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *threads++;
<a name="l00889"></a>00889 
<a name="l00890"></a>00890         <span class="comment">// Check the signals for each thread to determine the proper status</span>
<a name="l00891"></a>00891         <span class="comment">// for each thread.</span>
<a name="l00892"></a>00892         <span class="keywordtype">bool</span> updated_status = <a class="code" href="classDefaultFetch.html#af77f2bf38a75182c65e633b9fdf295d2">checkSignalsAndUpdate</a>(tid);
<a name="l00893"></a>00893         status_change =  status_change || updated_status;
<a name="l00894"></a>00894     }
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Running stage.\n&quot;</span>);
<a name="l00897"></a>00897 
<a name="l00898"></a>00898     <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370">FullSystem</a>) {
<a name="l00899"></a>00899         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[0].interruptPending) {
<a name="l00900"></a>00900             <a class="code" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a> = <span class="keyword">true</span>;
<a name="l00901"></a>00901         }
<a name="l00902"></a>00902 
<a name="l00903"></a>00903         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a>-&gt;commitInfo[0].clearInterrupt) {
<a name="l00904"></a>00904             <a class="code" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a> = <span class="keyword">false</span>;
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906     }
<a name="l00907"></a>00907 
<a name="l00908"></a>00908     <span class="keywordflow">for</span> (<a class="code" href="classDefaultFetch.html#ac4dd16b14420d21b5704350fbbcefd04">threadFetched</a> = 0; <a class="code" href="classDefaultFetch.html#ac4dd16b14420d21b5704350fbbcefd04">threadFetched</a> &lt; <a class="code" href="classDefaultFetch.html#a6f81783998429ac4a3e8b75a5d5d12d4">numFetchingThreads</a>;
<a name="l00909"></a>00909          <a class="code" href="classDefaultFetch.html#ac4dd16b14420d21b5704350fbbcefd04">threadFetched</a>++) {
<a name="l00910"></a>00910         <span class="comment">// Fetch each of the actively fetching threads.</span>
<a name="l00911"></a>00911         <a class="code" href="classDefaultFetch.html#a77759cf15b084e00a9e4e8ca810a0be7">fetch</a>(status_change);
<a name="l00912"></a>00912     }
<a name="l00913"></a>00913 
<a name="l00914"></a>00914     <span class="comment">// Record number of instructions fetched this cycle for distribution.</span>
<a name="l00915"></a>00915     <a class="code" href="classDefaultFetch.html#a4793a4a8857c13e7812b1c37c6df761b">fetchNisnDist</a>.<a class="code" href="classStats_1_1DistBase.html#afed4e1e09f566c5aa9e972d8c17b5a27">sample</a>(<a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a>);
<a name="l00916"></a>00916 
<a name="l00917"></a>00917     <span class="keywordflow">if</span> (status_change) {
<a name="l00918"></a>00918         <span class="comment">// Change the fetch stage status if there was a status change.</span>
<a name="l00919"></a>00919         <a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> = <a class="code" href="classDefaultFetch.html#ac244c54ec94dd5e1d886dfd022752ec8">updateFetchStatus</a>();
<a name="l00920"></a>00920     }
<a name="l00921"></a>00921 
<a name="l00922"></a>00922     <span class="comment">// If there was activity this cycle, inform the CPU of it.</span>
<a name="l00923"></a>00923     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> || <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;contextSwitch) {
<a name="l00924"></a>00924         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity this cycle.\n&quot;</span>);
<a name="l00925"></a>00925 
<a name="l00926"></a>00926         <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;activityThisCycle();
<a name="l00927"></a>00927     }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     <span class="comment">// Issue the next I-cache request if possible.</span>
<a name="l00930"></a>00930     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; Impl::MaxThreads; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00931"></a>00931         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a4004484fff11512f43124243e7eac71a">issuePipelinedIfetch</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]) {
<a name="l00932"></a>00932             <a class="code" href="classDefaultFetch.html#a80cf75d186616b207a78a162498d1012">pipelineIcacheAccesses</a>(i);
<a name="l00933"></a>00933         }
<a name="l00934"></a>00934     }
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     <span class="comment">// Reset the number of the instruction we&apos;ve fetched.</span>
<a name="l00937"></a>00937     <a class="code" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a> = 0;
<a name="l00938"></a>00938 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac244c54ec94dd5e1d886dfd022752ec8"></a><!-- doxytag: member="DefaultFetch::updateFetchStatus" ref="ac244c54ec94dd5e1d886dfd022752ec8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch.html">DefaultFetch</a>&lt; Impl &gt;::<a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515e">FetchStatus</a> updateFetchStatus </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Updates overall fetch stage status; to be called at the end of each cycle. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00822"></a>00822 {
<a name="l00823"></a>00823     <span class="comment">//Check Running</span>
<a name="l00824"></a>00824     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l00825"></a>00825     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> end = <a class="code" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end();
<a name="l00826"></a>00826 
<a name="l00827"></a>00827     <span class="keywordflow">while</span> (threads != end) {
<a name="l00828"></a>00828         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *threads++;
<a name="l00829"></a>00829 
<a name="l00830"></a>00830         <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l00831"></a>00831             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a> ||
<a name="l00832"></a>00832             <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a>) {
<a name="l00833"></a>00833 
<a name="l00834"></a>00834             <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> == <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>) {
<a name="l00835"></a>00835                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;[tid:%i]: Activating stage.\n&quot;</span>,tid);
<a name="l00836"></a>00836 
<a name="l00837"></a>00837                 <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[tid] == <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173caff0dbe49b2bc9aee96de6b007b5b826e">IcacheAccessComplete</a>) {
<a name="l00838"></a>00838                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;[tid:%i]: Activating fetch due to cache&quot;</span>
<a name="l00839"></a>00839                             <span class="stringliteral">&quot;completion\n&quot;</span>,tid);
<a name="l00840"></a>00840                 }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842                 <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;activateStage(O3CPU::FetchIdx);
<a name="l00843"></a>00843             }
<a name="l00844"></a>00844 
<a name="l00845"></a>00845             <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520">Active</a>;
<a name="l00846"></a>00846         }
<a name="l00847"></a>00847     }
<a name="l00848"></a>00848 
<a name="l00849"></a>00849     <span class="comment">// Stage is switching from active to inactive, notify CPU of it.</span>
<a name="l00850"></a>00850     <span class="keywordflow">if</span> (<a class="code" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a> == <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea26bd8444261cc58df7a86753c79d2520">Active</a>) {
<a name="l00851"></a>00851         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Deactivating stage.\n&quot;</span>);
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         <a class="code" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a>-&gt;deactivateStage(O3CPU::FetchIdx);
<a name="l00854"></a>00854     }
<a name="l00855"></a>00855 
<a name="l00856"></a>00856     <span class="keywordflow">return</span> <a class="code" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515ea969c924a722daf6334fca64346092ae6">Inactive</a>;
<a name="l00857"></a>00857 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a040cbeac7187b0b8cdb1242d3f5aa179"></a><!-- doxytag: member="DefaultFetch::wakeFromQuiesce" ref="a040cbeac7187b0b8cdb1242d3f5aa179" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void wakeFromQuiesce </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tells fetch to wake up from a quiesce instruction. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00493"></a>00493 {
<a name="l00494"></a>00494     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Waking up from quiesce\n&quot;</span>);
<a name="l00495"></a>00495     <span class="comment">// Hopefully this is safe</span>
<a name="l00496"></a>00496     <span class="comment">// @todo: Allow other threads to wake from quiesce.</span>
<a name="l00497"></a>00497     <a class="code" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[0] = <a class="code" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>;
<a name="l00498"></a>00498 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="aa3fc43283eb7a93d6a41830bbd412681"></a><!-- doxytag: member="DefaultFetch::_status" ref="aa3fc43283eb7a93d6a41830bbd412681" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch.html#a64605db3d589dcf77a170612ff89515e">FetchStatus</a> <a class="el" href="classDefaultFetch.html#aa3fc43283eb7a93d6a41830bbd412681">_status</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fetch status. </p>

</div>
</div>
<a class="anchor" id="af6eaea53db532812052f71bf0380dab5"></a><!-- doxytag: member="DefaultFetch::activeThreads" ref="af6eaea53db532812052f71bf0380dab5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&gt;* <a class="el" href="classDefaultFetch.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List of Active Threads </p>

</div>
</div>
<a class="anchor" id="adee29d0de843b42df1f1caf92d388413"></a><!-- doxytag: member="DefaultFetch::branchPred" ref="adee29d0de843b42df1f1caf92d388413" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBPredUnit.html">BPredUnit</a>* <a class="el" href="classDefaultFetch.html#adee29d0de843b42df1f1caf92d388413">branchPred</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classBPredUnit.html">BPredUnit</a>. </p>

</div>
</div>
<a class="anchor" id="abceba4006d416e352df47f692b589bc3"></a><!-- doxytag: member="DefaultFetch::branchRate" ref="abceba4006d416e352df47f692b589bc3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDefaultFetch.html#abceba4006d416e352df47f692b589bc3">branchRate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of branch fetches per cycle. </p>

</div>
</div>
<a class="anchor" id="a37c69cb65c303fc6e66984fef13f18c6"></a><!-- doxytag: member="DefaultFetch::cacheBlkSize" ref="a37c69cb65c303fc6e66984fef13f18c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classDefaultFetch.html#a37c69cb65c303fc6e66984fef13f18c6">cacheBlkSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classCache.html">Cache</a> block size. </p>

</div>
</div>
<a class="anchor" id="a12a8dc8b9e94659a01ff979d9d98be89"></a><!-- doxytag: member="DefaultFetch::cacheBlocked" ref="a12a8dc8b9e94659a01ff979d9d98be89" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDefaultFetch.html#a12a8dc8b9e94659a01ff979d9d98be89">cacheBlocked</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Is the cache blocked? If so no threads can access it. </p>

</div>
</div>
<a class="anchor" id="a4b0344f5703ba5770b42602c6df63340"></a><!-- doxytag: member="DefaultFetch::commitToFetchDelay" ref="a4b0344f5703ba5770b42602c6df63340" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classDefaultFetch.html#a4b0344f5703ba5770b42602c6df63340">commitToFetchDelay</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Commit to fetch delay. </p>

</div>
</div>
<a class="anchor" id="a1379cf882a12ac6fc9eba5da7c84b18b"></a><!-- doxytag: member="DefaultFetch::cpu" ref="a1379cf882a12ac6fc9eba5da7c84b18b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch.html#a44622cf06940413482836cb62931ac3f">O3CPU</a>* <a class="el" href="classDefaultFetch.html#a1379cf882a12ac6fc9eba5da7c84b18b">cpu</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pointer to the <a class="el" href="namespaceO3CPU.html">O3CPU</a>. </p>

</div>
</div>
<a class="anchor" id="ad59085cbedffbd5bf8cd9eb714041505"></a><!-- doxytag: member="DefaultFetch::decoder" ref="ad59085cbedffbd5bf8cd9eb714041505" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TheISA::Decoder* <a class="el" href="classDefaultFetch.html#ad59085cbedffbd5bf8cd9eb714041505">decoder</a>[Impl::MaxThreads]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The decoder. </p>

</div>
</div>
<a class="anchor" id="a2ef45e1e2bd510cfb43c0a03a6ab3f1c"></a><!-- doxytag: member="DefaultFetch::decodeToFetchDelay" ref="a2ef45e1e2bd510cfb43c0a03a6ab3f1c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classDefaultFetch.html#a2ef45e1e2bd510cfb43c0a03a6ab3f1c">decodeToFetchDelay</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode to fetch delay. </p>

</div>
</div>
<a class="anchor" id="af247386188fbfaba3ea218eff3a771db"></a><!-- doxytag: member="DefaultFetch::delayedCommit" ref="af247386188fbfaba3ea218eff3a771db" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDefaultFetch.html#af247386188fbfaba3ea218eff3a771db">delayedCommit</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Can the fetch stage redirect from an interrupt on this instruction? </p>

</div>
</div>
<a class="anchor" id="a0501ffad4abed98618a6cf0ba9c3599b"></a><!-- doxytag: member="DefaultFetch::fetchBlockedCycles" ref="a0501ffad4abed98618a6cf0ba9c3599b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a0501ffad4abed98618a6cf0ba9c3599b">fetchBlockedCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of cycles spent blocked. </p>

</div>
</div>
<a class="anchor" id="a924f2775385b2e5ac3008db4b8305c2b"></a><!-- doxytag: member="DefaultFetch::fetchBuffer" ref="a924f2775385b2e5ac3008db4b8305c2b" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* <a class="el" href="classDefaultFetch.html#a924f2775385b2e5ac3008db4b8305c2b">fetchBuffer</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The fetch data that is being fetched and buffered. </p>

</div>
</div>
<a class="anchor" id="a9fb9a70efc5e29795473f1f92c082063"></a><!-- doxytag: member="DefaultFetch::fetchBufferMask" ref="a9fb9a70efc5e29795473f1f92c082063" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classDefaultFetch.html#a9fb9a70efc5e29795473f1f92c082063">fetchBufferMask</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mask to align a fetch address to a fetch buffer boundary. </p>

</div>
</div>
<a class="anchor" id="ab4b128217e67bdf9f6a98420b82cacb9"></a><!-- doxytag: member="DefaultFetch::fetchBufferPC" ref="ab4b128217e67bdf9f6a98420b82cacb9" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classDefaultFetch.html#ab4b128217e67bdf9f6a98420b82cacb9">fetchBufferPC</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The PC of the first instruction loaded into the fetch buffer. </p>

</div>
</div>
<a class="anchor" id="ac47806923c3481b83636c4aa03d184f8"></a><!-- doxytag: member="DefaultFetch::fetchBufferSize" ref="ac47806923c3481b83636c4aa03d184f8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classDefaultFetch.html#ac47806923c3481b83636c4aa03d184f8">fetchBufferSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The size of the fetch buffer in bytes. The fetch buffer itself may be smaller than a cache line. </p>

</div>
</div>
<a class="anchor" id="ab6845c7b94805ded9ea7d94b210be51b"></a><!-- doxytag: member="DefaultFetch::fetchBufferValid" ref="ab6845c7b94805ded9ea7d94b210be51b" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDefaultFetch.html#ab6845c7b94805ded9ea7d94b210be51b">fetchBufferValid</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Whether or not the fetch buffer data is valid. </p>

</div>
</div>
<a class="anchor" id="a9699b5489dd499e832651b96f95b5d19"></a><!-- doxytag: member="DefaultFetch::fetchCycles" ref="a9699b5489dd499e832651b96f95b5d19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a9699b5489dd499e832651b96f95b5d19">fetchCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of cycles spent fetching. </p>

</div>
</div>
<a class="anchor" id="aaca0646636cde96795aed6beb2942975"></a><!-- doxytag: member="DefaultFetch::fetchedBranches" ref="aaca0646636cde96795aed6beb2942975" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#aaca0646636cde96795aed6beb2942975">fetchedBranches</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of fetched branches. </p>

</div>
</div>
<a class="anchor" id="a0ead660daa133edcd64ac552d473ebba"></a><!-- doxytag: member="DefaultFetch::fetchedCacheLines" ref="a0ead660daa133edcd64ac552d473ebba" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a0ead660daa133edcd64ac552d473ebba">fetchedCacheLines</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of fetched cache lines. </p>

</div>
</div>
<a class="anchor" id="af0e3fa228032036d2022ed9e2a3612b6"></a><!-- doxytag: member="DefaultFetch::fetchedInsts" ref="af0e3fa228032036d2022ed9e2a3612b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#af0e3fa228032036d2022ed9e2a3612b6">fetchedInsts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of fetched instructions. </p>

</div>
</div>
<a class="anchor" id="af5ce6113f31fddaab758b8fb025600bc"></a><!-- doxytag: member="DefaultFetch::fetchIcacheSquashes" ref="af5ce6113f31fddaab758b8fb025600bc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#af5ce6113f31fddaab758b8fb025600bc">fetchIcacheSquashes</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of outstanding icache accesses that were dropped due to a squash. </p>

</div>
</div>
<a class="anchor" id="a85ea1666f596116bc53a277b388d39d7"></a><!-- doxytag: member="DefaultFetch::fetchIcacheWaitRetryStallCycles" ref="a85ea1666f596116bc53a277b388d39d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a85ea1666f596116bc53a277b388d39d7">fetchIcacheWaitRetryStallCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of stall cycles caused by I-cache wait retrys. </p>

</div>
</div>
<a class="anchor" id="a8af716ad2a53a409640347226078591c"></a><!-- doxytag: member="DefaultFetch::fetchIdleCycles" ref="a8af716ad2a53a409640347226078591c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a8af716ad2a53a409640347226078591c">fetchIdleCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of cycles spent blocked due to other stages in the pipeline. </p>

</div>
</div>
<a class="anchor" id="a0a77b8544fea92003669cdc78a46eea5"></a><!-- doxytag: member="DefaultFetch::fetchMiscStallCycles" ref="a0a77b8544fea92003669cdc78a46eea5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a0a77b8544fea92003669cdc78a46eea5">fetchMiscStallCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of cycles spent in any other state. </p>

</div>
</div>
<a class="anchor" id="a4793a4a8857c13e7812b1c37c6df761b"></a><!-- doxytag: member="DefaultFetch::fetchNisnDist" ref="a4793a4a8857c13e7812b1c37c6df761b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Distribution.html">Stats::Distribution</a> <a class="el" href="classDefaultFetch.html#a4793a4a8857c13e7812b1c37c6df761b">fetchNisnDist</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Distribution of number of instructions fetched each cycle. </p>

</div>
</div>
<a class="anchor" id="aaa3b110a1f8e4fb7c88676a2ee836a06"></a><!-- doxytag: member="DefaultFetch::fetchNoActiveThreadStallCycles" ref="aaa3b110a1f8e4fb7c88676a2ee836a06" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#aaa3b110a1f8e4fb7c88676a2ee836a06">fetchNoActiveThreadStallCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of stall cycles caused by no active threads to run. </p>

</div>
</div>
<a class="anchor" id="afc52fdca94918eaaf908094a80ab63ce"></a><!-- doxytag: member="DefaultFetch::fetchOffset" ref="afc52fdca94918eaaf908094a80ab63ce" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classDefaultFetch.html#afc52fdca94918eaaf908094a80ab63ce">fetchOffset</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad09f9a8597b6f2c627b5c116d85ea375"></a><!-- doxytag: member="DefaultFetch::fetchPendingDrainCycles" ref="ad09f9a8597b6f2c627b5c116d85ea375" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#ad09f9a8597b6f2c627b5c116d85ea375">fetchPendingDrainCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of cycles spent in waiting for drains. </p>

</div>
</div>
<a class="anchor" id="a8be39e4ea9ed9168227dc6efced55f3f"></a><!-- doxytag: member="DefaultFetch::fetchPendingQuiesceStallCycles" ref="a8be39e4ea9ed9168227dc6efced55f3f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a8be39e4ea9ed9168227dc6efced55f3f">fetchPendingQuiesceStallCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of stall cycles caused by pending quiesce instructions. </p>

</div>
</div>
<a class="anchor" id="a5a80cd5375f1281e64f0dd318cc761d2"></a><!-- doxytag: member="DefaultFetch::fetchPendingTrapStallCycles" ref="a5a80cd5375f1281e64f0dd318cc761d2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a5a80cd5375f1281e64f0dd318cc761d2">fetchPendingTrapStallCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of stall cycles caused by pending traps. </p>

</div>
</div>
<a class="anchor" id="aad8c2ca9262308cfdb74cd69cda508f6"></a><!-- doxytag: member="DefaultFetch::fetchPolicy" ref="aad8c2ca9262308cfdb74cd69cda508f6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch.html#a818d5f50fdcec74a1a445b4fa8b760e3">FetchPriority</a> <a class="el" href="classDefaultFetch.html#aad8c2ca9262308cfdb74cd69cda508f6">fetchPolicy</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Fetch policy. </p>

</div>
</div>
<a class="anchor" id="a9a2f350be647ebfb6567172812db491a"></a><!-- doxytag: member="DefaultFetch::fetchQueue" ref="a9a2f350be647ebfb6567172812db491a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a>&gt;* <a class="el" href="classDefaultFetch.html#a9a2f350be647ebfb6567172812db491a">fetchQueue</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Internal fetch instruction queue. </p>

</div>
</div>
<a class="anchor" id="a7656c6cac3b62fa389148c650a5d127a"></a><!-- doxytag: member="DefaultFetch::fetchRate" ref="a7656c6cac3b62fa389148c650a5d127a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDefaultFetch.html#a7656c6cac3b62fa389148c650a5d127a">fetchRate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of instruction fetched per cycle. </p>

</div>
</div>
<a class="anchor" id="ae1b92a3469ac6b00fddd788b71f64c9a"></a><!-- doxytag: member="DefaultFetch::fetchSquashCycles" ref="ae1b92a3469ac6b00fddd788b71f64c9a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#ae1b92a3469ac6b00fddd788b71f64c9a">fetchSquashCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of cycles spent squashing. </p>

</div>
</div>
<a class="anchor" id="a852cb41bf6074487410b49ec9ff53c00"></a><!-- doxytag: member="DefaultFetch::fetchStatus" ref="a852cb41bf6074487410b49ec9ff53c00" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a> <a class="el" href="classDefaultFetch.html#a852cb41bf6074487410b49ec9ff53c00">fetchStatus</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Per-thread status. </p>

</div>
</div>
<a class="anchor" id="a9b08d665534d5e7d5b8134c4af16881d"></a><!-- doxytag: member="DefaultFetch::fetchTlbCycles" ref="a9b08d665534d5e7d5b8134c4af16881d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a9b08d665534d5e7d5b8134c4af16881d">fetchTlbCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of cycles spent waiting for translation </p>

</div>
</div>
<a class="anchor" id="afe07cb06e5135b2305320fa11fda71af"></a><!-- doxytag: member="DefaultFetch::fetchTlbSquashes" ref="afe07cb06e5135b2305320fa11fda71af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#afe07cb06e5135b2305320fa11fda71af">fetchTlbSquashes</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total number of outstanding tlb accesses that were dropped due to a squash. </p>

</div>
</div>
<a class="anchor" id="a89b5ed63a2dba82556b909f343319416"></a><!-- doxytag: member="DefaultFetch::fetchWidth" ref="a89b5ed63a2dba82556b909f343319416" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classDefaultFetch.html#a89b5ed63a2dba82556b909f343319416">fetchWidth</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The width of fetch in instructions. </p>

</div>
</div>
<a class="anchor" id="a7bfa632a0dd4f5a541ceb627255286d3"></a><!-- doxytag: member="DefaultFetch::finishTranslationEvent" ref="a7bfa632a0dd4f5a541ceb627255286d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDefaultFetch_1_1FinishTranslationEvent.html">FinishTranslationEvent</a> <a class="el" href="classDefaultFetch.html#a7bfa632a0dd4f5a541ceb627255286d3">finishTranslationEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classEvent.html">Event</a> used to delay fault generation of translation faults </p>

</div>
</div>
<a class="anchor" id="a0055a92bd94eda21c2641d46ff013dac"></a><!-- doxytag: member="DefaultFetch::fromCommit" ref="a0055a92bd94eda21c2641d46ff013dac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;::wire <a class="el" href="classDefaultFetch.html#a0055a92bd94eda21c2641d46ff013dac">fromCommit</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get commit's information from backwards time buffer. </p>

</div>
</div>
<a class="anchor" id="a1116d028078c70aa1579726747303a55"></a><!-- doxytag: member="DefaultFetch::fromDecode" ref="a1116d028078c70aa1579726747303a55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;::wire <a class="el" href="classDefaultFetch.html#a1116d028078c70aa1579726747303a55">fromDecode</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get decode's information from backwards time buffer. </p>

</div>
</div>
<a class="anchor" id="a6c9093e88770a58dc8853f49a09bbac8"></a><!-- doxytag: member="DefaultFetch::fromIEW" ref="a6c9093e88770a58dc8853f49a09bbac8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;::wire <a class="el" href="classDefaultFetch.html#a6c9093e88770a58dc8853f49a09bbac8">fromIEW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get iew's information from backwards time buffer. </p>

</div>
</div>
<a class="anchor" id="ae99c54a9c8f1e218b86afcee348c54fc"></a><!-- doxytag: member="DefaultFetch::fromRename" ref="ae99c54a9c8f1e218b86afcee348c54fc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;::wire <a class="el" href="classDefaultFetch.html#ae99c54a9c8f1e218b86afcee348c54fc">fromRename</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get rename's information from backwards time buffer. </p>

</div>
</div>
<a class="anchor" id="a2b9328bdb1a6898bfae824981cd64311"></a><!-- doxytag: member="DefaultFetch::icacheStallCycles" ref="a2b9328bdb1a6898bfae824981cd64311" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#a2b9328bdb1a6898bfae824981cd64311">icacheStallCycles</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of cycles stalled due to an icache miss. </p>

</div>
</div>
<a class="anchor" id="a4b942e4ec6b8c1d29a1c96e901ea71dd"></a><!-- doxytag: member="DefaultFetch::idleRate" ref="a4b942e4ec6b8c1d29a1c96e901ea71dd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDefaultFetch.html#a4b942e4ec6b8c1d29a1c96e901ea71dd">idleRate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Rate of how often fetch was idle. </p>

</div>
</div>
<a class="anchor" id="a986e734c1e66dc0be1723ade04d06d4b"></a><!-- doxytag: member="DefaultFetch::iewToFetchDelay" ref="a986e734c1e66dc0be1723ade04d06d4b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classDefaultFetch.html#a986e734c1e66dc0be1723ade04d06d4b">iewToFetchDelay</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>IEW to fetch delay. </p>

</div>
</div>
<a class="anchor" id="a494a9a986bc62c946604f9e9047ad237"></a><!-- doxytag: member="DefaultFetch::instSize" ref="a494a9a986bc62c946604f9e9047ad237" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classDefaultFetch.html#a494a9a986bc62c946604f9e9047ad237">instSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Size of instructions. </p>

</div>
</div>
<a class="anchor" id="a310de3efc6b60f47de5792d2b00d0840"></a><!-- doxytag: member="DefaultFetch::interruptPending" ref="a310de3efc6b60f47de5792d2b00d0840" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDefaultFetch.html#a310de3efc6b60f47de5792d2b00d0840">interruptPending</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks if there is an interrupt pending. If there is, fetch must stop once it is not fetching <a class="el" href="structPAL.html">PAL</a> instructions. </p>

</div>
</div>
<a class="anchor" id="a4004484fff11512f43124243e7eac71a"></a><!-- doxytag: member="DefaultFetch::issuePipelinedIfetch" ref="a4004484fff11512f43124243e7eac71a" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDefaultFetch.html#a4004484fff11512f43124243e7eac71a">issuePipelinedIfetch</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classSet.html">Set</a> to true if a pipelined I-cache request should be issued. </p>

</div>
</div>
<a class="anchor" id="a1848d938e5258a2a79298169e43efde5"></a><!-- doxytag: member="DefaultFetch::lastIcacheStall" ref="a1848d938e5258a2a79298169e43efde5" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ae1475755791765b8e6f6a8bb091e273e">Counter</a> <a class="el" href="classDefaultFetch.html#a1848d938e5258a2a79298169e43efde5">lastIcacheStall</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Icache stall statistics. </p>

</div>
</div>
<a class="anchor" id="a1f84ef3ef8e6b11f3bb9a3a0a6224345"></a><!-- doxytag: member="DefaultFetch::macroop" ref="a1f84ef3ef8e6b11f3bb9a3a0a6224345" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">StaticInstPtr</a> <a class="el" href="classDefaultFetch.html#a1f84ef3ef8e6b11f3bb9a3a0a6224345">macroop</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7b85bc06912a7000a9b27cab60626a7a"></a><!-- doxytag: member="DefaultFetch::memReq" ref="a7b85bc06912a7000a9b27cab60626a7a" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRequest.html">RequestPtr</a> <a class="el" href="classDefaultFetch.html#a7b85bc06912a7000a9b27cab60626a7a">memReq</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Memory request used to access cache. </p>

</div>
</div>
<a class="anchor" id="a6f81783998429ac4a3e8b75a5d5d12d4"></a><!-- doxytag: member="DefaultFetch::numFetchingThreads" ref="a6f81783998429ac4a3e8b75a5d5d12d4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="el" href="classDefaultFetch.html#a6f81783998429ac4a3e8b75a5d5d12d4">numFetchingThreads</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of threads that are actively fetching. </p>

</div>
</div>
<a class="anchor" id="a07c4afd8e6b9ff4bdf20b573a39d1372"></a><!-- doxytag: member="DefaultFetch::numInst" ref="a07c4afd8e6b9ff4bdf20b573a39d1372" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classDefaultFetch.html#a07c4afd8e6b9ff4bdf20b573a39d1372">numInst</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tracks how many instructions has been fetched this cycle. </p>

</div>
</div>
<a class="anchor" id="a88377f855dbf5adeeecb06b5bb821d35"></a><!-- doxytag: member="DefaultFetch::numThreads" ref="a88377f855dbf5adeeecb06b5bb821d35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="el" href="classDefaultFetch.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of threads. </p>

</div>
</div>
<a class="anchor" id="a6e6091c9272a281b8693c0f46279cad0"></a><!-- doxytag: member="DefaultFetch::pc" ref="a6e6091c9272a281b8693c0f46279cad0" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TheISA::PCState <a class="el" href="classDefaultFetch.html#a6e6091c9272a281b8693c0f46279cad0">pc</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a853ac5048dfdbba414f6f8186dd11afd"></a><!-- doxytag: member="DefaultFetch::ppFetch" ref="a853ac5048dfdbba414f6f8186dd11afd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classProbePointArg.html">ProbePointArg</a>&lt;<a class="el" href="classDefaultFetch.html#a028ce10889c5f6450239d9e9a7347976">DynInstPtr</a>&gt;* <a class="el" href="classDefaultFetch.html#a853ac5048dfdbba414f6f8186dd11afd">ppFetch</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="namespaceProbe.html">Probe</a> points. </p>

</div>
</div>
<a class="anchor" id="ae5c954036e76b5cc5a82cf7f17d4d5ed"></a><!-- doxytag: member="DefaultFetch::predictedBranches" ref="ae5c954036e76b5cc5a82cf7f17d4d5ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDefaultFetch.html#ae5c954036e76b5cc5a82cf7f17d4d5ed">predictedBranches</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stat for total number of predicted branches. </p>

</div>
</div>
<a class="anchor" id="a0d967261cbbce522509d85936b8ce786"></a><!-- doxytag: member="DefaultFetch::priorityList" ref="a0d967261cbbce522509d85936b8ce786" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&gt; <a class="el" href="classDefaultFetch.html#a0d967261cbbce522509d85936b8ce786">priorityList</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List that has the threads organized by priority. </p>

</div>
</div>
<a class="anchor" id="ae97f1fdea38bf1719a7d45a15f3dcd5c"></a><!-- doxytag: member="DefaultFetch::renameToFetchDelay" ref="ae97f1fdea38bf1719a7d45a15f3dcd5c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classDefaultFetch.html#ae97f1fdea38bf1719a7d45a15f3dcd5c">renameToFetchDelay</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Rename to fetch delay. </p>

</div>
</div>
<a class="anchor" id="a314ae93c04b3ca96e79e1b1f39a8e478"></a><!-- doxytag: member="DefaultFetch::retryPkt" ref="a314ae93c04b3ca96e79e1b1f39a8e478" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPacket.html">PacketPtr</a> <a class="el" href="classDefaultFetch.html#a314ae93c04b3ca96e79e1b1f39a8e478">retryPkt</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The packet that is waiting to be retried. </p>

</div>
</div>
<a class="anchor" id="a865aaad70625f17392c717930860d386"></a><!-- doxytag: member="DefaultFetch::retryTid" ref="a865aaad70625f17392c717930860d386" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="el" href="classDefaultFetch.html#a865aaad70625f17392c717930860d386">retryTid</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The thread that is waiting on the cache to tell fetch to retry. </p>

</div>
</div>
<a class="anchor" id="ade48cf321f5741ea8e54e071680cacdc"></a><!-- doxytag: member="DefaultFetch::stalls" ref="ade48cf321f5741ea8e54e071680cacdc" args="[Impl::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDefaultFetch_1_1Stalls.html">Stalls</a> <a class="el" href="classDefaultFetch.html#ade48cf321f5741ea8e54e071680cacdc">stalls</a>[Impl::MaxThreads]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tracks which stages are telling fetch to stall. </p>

</div>
</div>
<a class="anchor" id="ac4dd16b14420d21b5704350fbbcefd04"></a><!-- doxytag: member="DefaultFetch::threadFetched" ref="ac4dd16b14420d21b5704350fbbcefd04" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="el" href="classDefaultFetch.html#ac4dd16b14420d21b5704350fbbcefd04">threadFetched</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Thread ID being fetched. </p>

</div>
</div>
<a class="anchor" id="a83f9ee976e732665aeb08dbc19acfd45"></a><!-- doxytag: member="DefaultFetch::timeBuffer" ref="a83f9ee976e732665aeb08dbc19acfd45" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;* <a class="el" href="classDefaultFetch.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classTime.html">Time</a> buffer interface. </p>

</div>
</div>
<a class="anchor" id="a5283adcc786817de9adc5a4601aa3a6f"></a><!-- doxytag: member="DefaultFetch::toDecode" ref="a5283adcc786817de9adc5a4601aa3a6f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="classDefaultFetch.html#a3aac8607069f16898ef53cfaa2d97aeb">FetchStruct</a>&gt;::wire <a class="el" href="classDefaultFetch.html#a5283adcc786817de9adc5a4601aa3a6f">toDecode</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> used to write any information heading to decode. </p>

</div>
</div>
<a class="anchor" id="a2c7e870d4babdac0dc91fc7ffabd0f3d"></a><!-- doxytag: member="DefaultFetch::wroteToTimeBuffer" ref="a2c7e870d4babdac0dc91fc7ffabd0f3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDefaultFetch.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Variable that tracks if fetch has written to the time buffer this cycle. Used to tell CPU if there is activity this cycle. </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>cpu/o3/<a class="el" href="fetch_8hh_source.html">fetch.hh</a></li>
<li>cpu/o3/<a class="el" href="fetch__impl_8hh_source.html">fetch_impl.hh</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
