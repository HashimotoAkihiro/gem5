<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス Timer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="classSp804.html">Sp804</a>::<a class="el" href="classSp804_1_1Timer.html">Timer</a>
  </div>
</div>
<div class="contents">
<h1>クラス Timer</h1><!-- doxytag: class="Sp804::Timer" -->
<p><code>#include &lt;<a class="el" href="timer__sp804_8hh_source.html">timer_sp804.hh</a>&gt;</code></p>

<p><a href="classSp804_1_1Timer-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom">{ <br/>
&nbsp;&nbsp;<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89af1b4cf2000c66476aa951689a85d5843">LoadReg</a> =  0x00, 
<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a2a0562a793d401c2e65bcd4ea5bf7aab">CurrentReg</a> =  0x04, 
<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a794a3f84717e8b4e7c8af89cbe9f7441">ControlReg</a> =  0x08, 
<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89adba6b9695c70b08e0a47bf9b1c0eaeab">IntClear</a> =  0x0C, 
<br/>
&nbsp;&nbsp;<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89abd636a57d30c6af5f7a2eabb4e4258cd">RawISR</a> =  0x10, 
<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a84e908ced233cc8a35eabafa2c2acf93">MaskedISR</a> =  0x14, 
<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a880658e75f8f318562e66aca33089115">BGLoad</a> =  0x18, 
<a class="el" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89aff9abf2b1a689f70a77a18da50c01d9f">Size</a> =  0x20
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a106b41739bf22df3a12501935d39b9f8">BitUnion32</a> (CTRL) Bitfield&lt; 0 &gt; oneShot</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#ab3116a726a55ac899fa28951b13d7453">counterAtZero</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a5e2d72e72192a57c6d3f61a22d1790cc">restartCounter</a> (<a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> val)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a> (std::string __name, <a class="el" href="classSp804.html">Sp804</a> *<a class="el" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>, int int_num, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a6ecbcc960e1c0cd0a0f4c64e7ae58d14">read</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> daddr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a26d6a1d80de386690a8ad73932f83d96">write</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> daddr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a53e036786d17361be4c7320d39c99b84">serialize</a> (std::ostream &amp;os)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#af22e5d6d660b97db37003ac61ac4ee49">unserialize</a> (<a class="el" href="classCheckpoint.html">Checkpoint</a> *cp, const std::string &amp;section)</td></tr>
<tr><td colspan="2"><h2>Public 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Bitfield&lt; 1 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a3952efcfdef8f7aa15b0ebcdbbe4bdd3">timerSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Bitfield&lt; 3, 2 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#afd859e1d86a57cb7711f17ab63ad4646">timerPrescale</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Bitfield&lt; 5 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#aa5de02b5e99e1f995e2f01bf8336e224">intEnable</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Bitfield&lt; 6 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#aa71cecfa28f348244319827543df9e18">timerMode</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Bitfield&lt; 7 &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#ab193f92c9325928a8fbfe941540db1a0">timerEnable</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">EndBitUnion(CTRL) protected <a class="el" href="classSp804.html">Sp804</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a4685f3f9289d179d8e500f7ad5ad20ed">intNum</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CTRL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classSp804_1_1Timer.html">Timer</a>,&amp;Timer::counterAtZero &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a></td></tr>
</table>
<hr/><h2>列挙型</h2>
<a class="anchor" id="a84627a72058502328269676b81780f89"></a><!-- doxytag: member="Sp804::Timer::@46" ref="a84627a72058502328269676b81780f89" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89af1b4cf2000c66476aa951689a85d5843"></a><!-- doxytag: member="LoadReg" ref="a84627a72058502328269676b81780f89af1b4cf2000c66476aa951689a85d5843" args="" -->LoadReg</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89a2a0562a793d401c2e65bcd4ea5bf7aab"></a><!-- doxytag: member="CurrentReg" ref="a84627a72058502328269676b81780f89a2a0562a793d401c2e65bcd4ea5bf7aab" args="" -->CurrentReg</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89a794a3f84717e8b4e7c8af89cbe9f7441"></a><!-- doxytag: member="ControlReg" ref="a84627a72058502328269676b81780f89a794a3f84717e8b4e7c8af89cbe9f7441" args="" -->ControlReg</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89adba6b9695c70b08e0a47bf9b1c0eaeab"></a><!-- doxytag: member="IntClear" ref="a84627a72058502328269676b81780f89adba6b9695c70b08e0a47bf9b1c0eaeab" args="" -->IntClear</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89abd636a57d30c6af5f7a2eabb4e4258cd"></a><!-- doxytag: member="RawISR" ref="a84627a72058502328269676b81780f89abd636a57d30c6af5f7a2eabb4e4258cd" args="" -->RawISR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89a84e908ced233cc8a35eabafa2c2acf93"></a><!-- doxytag: member="MaskedISR" ref="a84627a72058502328269676b81780f89a84e908ced233cc8a35eabafa2c2acf93" args="" -->MaskedISR</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89a880658e75f8f318562e66aca33089115"></a><!-- doxytag: member="BGLoad" ref="a84627a72058502328269676b81780f89a880658e75f8f318562e66aca33089115" args="" -->BGLoad</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a84627a72058502328269676b81780f89aff9abf2b1a689f70a77a18da50c01d9f"></a><!-- doxytag: member="Size" ref="a84627a72058502328269676b81780f89aff9abf2b1a689f70a77a18da50c01d9f" args="" -->Size</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00059"></a>00059              {
<a name="l00060"></a>00060             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89af1b4cf2000c66476aa951689a85d5843">LoadReg</a>    = 0x00,
<a name="l00061"></a>00061             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a2a0562a793d401c2e65bcd4ea5bf7aab">CurrentReg</a> = 0x04,
<a name="l00062"></a>00062             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a794a3f84717e8b4e7c8af89cbe9f7441">ControlReg</a> = 0x08,
<a name="l00063"></a>00063             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89adba6b9695c70b08e0a47bf9b1c0eaeab">IntClear</a>   = 0x0C,
<a name="l00064"></a>00064             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89abd636a57d30c6af5f7a2eabb4e4258cd">RawISR</a>     = 0x10,
<a name="l00065"></a>00065             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a84e908ced233cc8a35eabafa2c2acf93">MaskedISR</a>  = 0x14,
<a name="l00066"></a>00066             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a880658e75f8f318562e66aca33089115">BGLoad</a>     = 0x18,
<a name="l00067"></a>00067             <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89aff9abf2b1a689f70a77a18da50c01d9f">Size</a>       = 0x20
<a name="l00068"></a>00068         };
</pre></div></p>

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="a1ac56319b87382938cc537cd1e58717e"></a><!-- doxytag: member="Sp804::Timer::Timer" ref="a1ac56319b87382938cc537cd1e58717e" args="(std::string __name, Sp804 *parent, int int_num, Tick clock)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSp804_1_1Timer.html">Timer</a> </td>
          <td>(</td>
          <td class="paramtype">std::string&nbsp;</td>
          <td class="paramname"> <em>__name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSp804.html">Sp804</a> *&nbsp;</td>
          <td class="paramname"> <em>parent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>int_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>clock</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00057"></a>00057     : _name(__name), <a class="code" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>(_parent), <a class="code" href="classSp804_1_1Timer.html#a4685f3f9289d179d8e500f7ad5ad20ed">intNum</a>(int_num), <a class="code" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a>(_clock), <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>(0x20),
<a name="l00058"></a>00058       <a class="code" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a>(<span class="keyword">false</span>), <a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a>(<span class="keyword">false</span>), <a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>(0xffffffff), <a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>(<span class="keyword">this</span>)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a106b41739bf22df3a12501935d39b9f8"></a><!-- doxytag: member="Sp804::Timer::BitUnion32" ref="a106b41739bf22df3a12501935d39b9f8" args="(CTRL) Bitfield&lt; 0 &gt; oneShot" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BitUnion32 </td>
          <td>(</td>
          <td class="paramtype">CTRL&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab3116a726a55ac899fa28951b13d7453"></a><!-- doxytag: member="Sp804::Timer::counterAtZero" ref="ab3116a726a55ac899fa28951b13d7453" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void counterAtZero </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called when the counter reaches 0 </p>

<p><div class="fragment"><pre class="fragment"><a name="l00196"></a>00196 {
<a name="l00197"></a>00197     <span class="keywordflow">if</span> (!<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerEnable)
<a name="l00198"></a>00198         <span class="keywordflow">return</span>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;Counter reached zero\n&quot;</span>);
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <a class="code" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a> = <span class="keyword">true</span>;
<a name="l00203"></a>00203     <span class="keywordtype">bool</span> old_pending = <a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a>;
<a name="l00204"></a>00204     <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.intEnable)
<a name="l00205"></a>00205         <a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a> = <span class="keyword">true</span>;
<a name="l00206"></a>00206     <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a> &amp;&amp; !old_pending) {
<a name="l00207"></a>00207         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;-- Causing interrupt\n&quot;</span>);
<a name="l00208"></a>00208         <a class="code" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>-&gt;<a class="code" href="classSp804.html#a2e2266dca56928f63667e994933169ee">gic</a>-&gt;<a class="code" href="classBaseGic.html#ad6b2cb6b9a108c3852cb5a88126e5320">sendInt</a>(<a class="code" href="classSp804_1_1Timer.html#a4685f3f9289d179d8e500f7ad5ad20ed">intNum</a>);
<a name="l00209"></a>00209     }
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.oneShot)
<a name="l00212"></a>00212         <span class="keywordflow">return</span>;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214     <span class="comment">// Free-running</span>
<a name="l00215"></a>00215     <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerMode == 0)
<a name="l00216"></a>00216         <a class="code" href="classSp804_1_1Timer.html#a5e2d72e72192a57c6d3f61a22d1790cc">restartCounter</a>(0xffffffff);
<a name="l00217"></a>00217     <span class="keywordflow">else</span>
<a name="l00218"></a>00218         <a class="code" href="classSp804_1_1Timer.html#a5e2d72e72192a57c6d3f61a22d1790cc">restartCounter</a>(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00219"></a>00219 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37627d5d5bba7f4a8690c71c2ab3cb07"></a><!-- doxytag: member="Sp804::Timer::name" ref="a37627d5d5bba7f4a8690c71c2ab3cb07" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00116"></a>00116 { <span class="keywordflow">return</span> _name; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6ecbcc960e1c0cd0a0f4c64e7ae58d14"></a><!-- doxytag: member="Sp804::Timer::read" ref="a6ecbcc960e1c0cd0a0f4c64e7ae58d14" args="(PacketPtr pkt, Addr daddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void read </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>daddr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Handle read for a single timer </p>

<p><div class="fragment"><pre class="fragment"><a name="l00085"></a>00085 {
<a name="l00086"></a>00086     <span class="keywordflow">switch</span>(daddr) {
<a name="l00087"></a>00087       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89af1b4cf2000c66476aa951689a85d5843">LoadReg</a>:
<a name="l00088"></a>00088         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00089"></a>00089         <span class="keywordflow">break</span>;
<a name="l00090"></a>00090       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a2a0562a793d401c2e65bcd4ea5bf7aab">CurrentReg</a>:
<a name="l00091"></a>00091         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;Event schedule for %d, clock=%d, prescale=%d\n&quot;</span>,
<a name="l00092"></a>00092                 <a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>(), <a class="code" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a>, <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerPrescale);
<a name="l00093"></a>00093         <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> time;
<a name="l00094"></a>00094         time = <a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>() - <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00095"></a>00095         time = time / <a class="code" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a> / <a class="code" href="intmath_8hh.html#a4e6a30fd4eed8d942ab7fa676da00e69">power</a>(16, <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerPrescale);
<a name="l00096"></a>00096         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;-- returning counter at %d\n&quot;</span>, time);
<a name="l00097"></a>00097         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(time);
<a name="l00098"></a>00098         <span class="keywordflow">break</span>;
<a name="l00099"></a>00099       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a794a3f84717e8b4e7c8af89cbe9f7441">ControlReg</a>:
<a name="l00100"></a>00100         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>);
<a name="l00101"></a>00101         <span class="keywordflow">break</span>;
<a name="l00102"></a>00102       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89abd636a57d30c6af5f7a2eabb4e4258cd">RawISR</a>:
<a name="l00103"></a>00103         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(<a class="code" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a>);
<a name="l00104"></a>00104         <span class="keywordflow">break</span>;
<a name="l00105"></a>00105       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a84e908ced233cc8a35eabafa2c2acf93">MaskedISR</a>:
<a name="l00106"></a>00106         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(<a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a>);
<a name="l00107"></a>00107         <span class="keywordflow">break</span>;
<a name="l00108"></a>00108       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a880658e75f8f318562e66aca33089115">BGLoad</a>:
<a name="l00109"></a>00109         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00110"></a>00110         <span class="keywordflow">break</span>;
<a name="l00111"></a>00111       <span class="keywordflow">default</span>:
<a name="l00112"></a>00112         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Tried to read SP804 timer at offset %#x\n&quot;</span>, daddr);
<a name="l00113"></a>00113         <span class="keywordflow">break</span>;
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;Reading %#x from Timer at offset: %#x\n&quot;</span>, pkt-&gt;<a class="code" href="classPacket.html#af6ea056c8af82f08af9fd0d857967f9b">get</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(), daddr);
<a name="l00116"></a>00116 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5e2d72e72192a57c6d3f61a22d1790cc"></a><!-- doxytag: member="Sp804::Timer::restartCounter" ref="a5e2d72e72192a57c6d3f61a22d1790cc" args="(uint32_t val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void restartCounter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>val</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Restart the counter ticking at val </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>val</em>&nbsp;</td><td>the value to start at (pre-16 bit masking if en) </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00175"></a>00175 {
<a name="l00176"></a>00176     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;Resetting counter with value %#x\n&quot;</span>, <a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>);
<a name="l00177"></a>00177     <span class="keywordflow">if</span> (!<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerEnable)
<a name="l00178"></a>00178         <span class="keywordflow">return</span>;
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> time = <a class="code" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a> * <a class="code" href="intmath_8hh.html#a4e6a30fd4eed8d942ab7fa676da00e69">power</a>(16, <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerPrescale);
<a name="l00181"></a>00181     <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerSize)
<a name="l00182"></a>00182         time *= <a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>;
<a name="l00183"></a>00183     <span class="keywordflow">else</span>
<a name="l00184"></a>00184         time *= <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(<a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>,15,0);
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l00187"></a>00187         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;-- Event was already schedule, de-scheduling\n&quot;</span>);
<a name="l00188"></a>00188         <a class="code" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>-&gt;<a class="code" href="classEventManager.html#a720e34da4db679fb3f30b20e55c23605">deschedule</a>(<a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>);
<a name="l00189"></a>00189     }
<a name="l00190"></a>00190     <a class="code" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>-&gt;<a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + time);
<a name="l00191"></a>00191     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;-- Scheduling new event for: %d\n&quot;</span>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + time);
<a name="l00192"></a>00192 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a53e036786d17361be4c7320d39c99b84"></a><!-- doxytag: member="Sp804::Timer::serialize" ref="a53e036786d17361be4c7320d39c99b84" args="(std::ostream &amp;os)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialize </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00223"></a>00223 {
<a name="l00224"></a>00224     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classCheckpoint.html">Checkpoint</a>, <span class="stringliteral">&quot;Serializing Arm Sp804\n&quot;</span>);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226     <a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> control_serial = <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>;
<a name="l00227"></a>00227     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(control_serial);
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a>);
<a name="l00230"></a>00230     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a>);
<a name="l00231"></a>00231     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00232"></a>00232 
<a name="l00233"></a>00233     <span class="keywordtype">bool</span> is_in_event = <a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>();
<a name="l00234"></a>00234     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(is_in_event);
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> event_time;
<a name="l00237"></a>00237     <span class="keywordflow">if</span> (is_in_event){
<a name="l00238"></a>00238         event_time = <a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>();
<a name="l00239"></a>00239         <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(event_time);
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af22e5d6d660b97db37003ac61ac4ee49"></a><!-- doxytag: member="Sp804::Timer::unserialize" ref="af22e5d6d660b97db37003ac61ac4ee49" args="(Checkpoint *cp, const std::string &amp;section)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unserialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheckpoint.html">Checkpoint</a> *&nbsp;</td>
          <td class="paramname"> <em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>section</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00245"></a>00245 {
<a name="l00246"></a>00246     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classCheckpoint.html">Checkpoint</a>, <span class="stringliteral">&quot;Unserializing Arm Sp804\n&quot;</span>);
<a name="l00247"></a>00247 
<a name="l00248"></a>00248     <a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> control_serial;
<a name="l00249"></a>00249     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(control_serial);
<a name="l00250"></a>00250     <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a> = control_serial;
<a name="l00251"></a>00251 
<a name="l00252"></a>00252     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a>);
<a name="l00253"></a>00253     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a>);
<a name="l00254"></a>00254     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00255"></a>00255 
<a name="l00256"></a>00256     <span class="keywordtype">bool</span> is_in_event;
<a name="l00257"></a>00257     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(is_in_event);
<a name="l00258"></a>00258 
<a name="l00259"></a>00259     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> event_time;
<a name="l00260"></a>00260     <span class="keywordflow">if</span> (is_in_event){
<a name="l00261"></a>00261         <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(event_time);
<a name="l00262"></a>00262         <a class="code" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>-&gt;<a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a>, event_time);
<a name="l00263"></a>00263     }
<a name="l00264"></a>00264 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a26d6a1d80de386690a8ad73932f83d96"></a><!-- doxytag: member="Sp804::Timer::write" ref="a26d6a1d80de386690a8ad73932f83d96" args="(PacketPtr pkt, Addr daddr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void write </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>daddr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Handle write for a single timer </p>

<p><div class="fragment"><pre class="fragment"><a name="l00139"></a>00139 {
<a name="l00140"></a>00140     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;Writing %#x to Timer at offset: %#x\n&quot;</span>, pkt-&gt;<a class="code" href="classPacket.html#af6ea056c8af82f08af9fd0d857967f9b">get</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;(), daddr);
<a name="l00141"></a>00141     <span class="keywordflow">switch</span> (daddr) {
<a name="l00142"></a>00142       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89af1b4cf2000c66476aa951689a85d5843">LoadReg</a>:
<a name="l00143"></a>00143         <a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a> = pkt-&gt;<a class="code" href="classPacket.html#af6ea056c8af82f08af9fd0d857967f9b">get</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();
<a name="l00144"></a>00144         <a class="code" href="classSp804_1_1Timer.html#a5e2d72e72192a57c6d3f61a22d1790cc">restartCounter</a>(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00145"></a>00145         <span class="keywordflow">break</span>;
<a name="l00146"></a>00146       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a2a0562a793d401c2e65bcd4ea5bf7aab">CurrentReg</a>:
<a name="l00147"></a>00147         <span class="comment">// Spec says this value can&apos;t be written, but linux writes it anyway</span>
<a name="l00148"></a>00148         <span class="keywordflow">break</span>;
<a name="l00149"></a>00149       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a794a3f84717e8b4e7c8af89cbe9f7441">ControlReg</a>:
<a name="l00150"></a>00150         <span class="keywordtype">bool</span> old_enable;
<a name="l00151"></a>00151         old_enable = <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerEnable;
<a name="l00152"></a>00152         <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a> = pkt-&gt;<a class="code" href="classPacket.html#af6ea056c8af82f08af9fd0d857967f9b">get</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();
<a name="l00153"></a>00153         <span class="keywordflow">if</span> ((old_enable == 0) &amp;&amp; <a class="code" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a>.timerEnable)
<a name="l00154"></a>00154             <a class="code" href="classSp804_1_1Timer.html#a5e2d72e72192a57c6d3f61a22d1790cc">restartCounter</a>(<a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a>);
<a name="l00155"></a>00155         <span class="keywordflow">break</span>;
<a name="l00156"></a>00156       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89adba6b9695c70b08e0a47bf9b1c0eaeab">IntClear</a>:
<a name="l00157"></a>00157         <a class="code" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a> = <span class="keyword">false</span>;
<a name="l00158"></a>00158         <span class="keywordflow">if</span> (<a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a>) {
<a name="l00159"></a>00159             <a class="code" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a> = <span class="keyword">false</span>;
<a name="l00160"></a>00160             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSp804_1_1Timer.html#a1ac56319b87382938cc537cd1e58717e">Timer</a>, <span class="stringliteral">&quot;Clearing interrupt\n&quot;</span>);
<a name="l00161"></a>00161             <a class="code" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a>-&gt;<a class="code" href="classSp804.html#a2e2266dca56928f63667e994933169ee">gic</a>-&gt;<a class="code" href="classBaseGic.html#a969450946c91b2daf6aa8ab1a60aa8c2">clearInt</a>(<a class="code" href="classSp804_1_1Timer.html#a4685f3f9289d179d8e500f7ad5ad20ed">intNum</a>);
<a name="l00162"></a>00162         }
<a name="l00163"></a>00163         <span class="keywordflow">break</span>;
<a name="l00164"></a>00164       <span class="keywordflow">case</span> <a class="code" href="classSp804_1_1Timer.html#a84627a72058502328269676b81780f89a880658e75f8f318562e66aca33089115">BGLoad</a>:
<a name="l00165"></a>00165         <a class="code" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a> = pkt-&gt;<a class="code" href="classPacket.html#af6ea056c8af82f08af9fd0d857967f9b">get</a>&lt;<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&gt;();
<a name="l00166"></a>00166         <span class="keywordflow">break</span>;
<a name="l00167"></a>00167       <span class="keywordflow">default</span>:
<a name="l00168"></a>00168         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Tried to write SP804 timer at offset %#x\n&quot;</span>, daddr);
<a name="l00169"></a>00169         <span class="keywordflow">break</span>;
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a9461588ed360796ba2408cc9e90e0ab8"></a><!-- doxytag: member="Sp804::Timer::clock" ref="a9461588ed360796ba2408cc9e90e0ab8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classSp804_1_1Timer.html#a9461588ed360796ba2408cc9e90e0ab8">clock</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of ticks in a clock input </p>

</div>
</div>
<a class="anchor" id="a8e8d336fe93a134873147e3282e103fb"></a><!-- doxytag: member="Sp804::Timer::control" ref="a8e8d336fe93a134873147e3282e103fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CTRL <a class="el" href="classSp804_1_1Timer.html#a8e8d336fe93a134873147e3282e103fb">control</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Control register as specified above </p>

</div>
</div>
<a class="anchor" id="aa5de02b5e99e1f995e2f01bf8336e224"></a><!-- doxytag: member="Sp804::Timer::intEnable" ref="aa5de02b5e99e1f995e2f01bf8336e224" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bitfield&lt;5&gt; <a class="el" href="classSp804_1_1Timer.html#aa5de02b5e99e1f995e2f01bf8336e224">intEnable</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4685f3f9289d179d8e500f7ad5ad20ed"></a><!-- doxytag: member="Sp804::Timer::intNum" ref="a4685f3f9289d179d8e500f7ad5ad20ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classSp804_1_1Timer.html#a4685f3f9289d179d8e500f7ad5ad20ed">intNum</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of interrupt to cause/clear </p>

</div>
</div>
<a class="anchor" id="a21dfc3b5f848baeba0be506b5b289485"></a><!-- doxytag: member="Sp804::Timer::loadValue" ref="a21dfc3b5f848baeba0be506b5b289485" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classSp804_1_1Timer.html#a21dfc3b5f848baeba0be506b5b289485">loadValue</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Value to load into counter when periodic mode reaches 0 </p>

</div>
</div>
<a class="anchor" id="a0e5173aee1e61e68810b199b498223b8"></a><!-- doxytag: member="Sp804::Timer::parent" ref="a0e5173aee1e61e68810b199b498223b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">EndBitUnion (CTRL) protected <a class="el" href="classSp804.html">Sp804</a>* <a class="el" href="classSp804_1_1Timer.html#a0e5173aee1e61e68810b199b498223b8">parent</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pointer to parent class </p>

</div>
</div>
<a class="anchor" id="af3f4acf42e0f2210078e61204edbab91"></a><!-- doxytag: member="Sp804::Timer::pendingInt" ref="af3f4acf42e0f2210078e61204edbab91" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSp804_1_1Timer.html#af3f4acf42e0f2210078e61204edbab91">pendingInt</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If an interrupt is currently pending. Logical and of CTRL.intEnable and rawInt </p>

</div>
</div>
<a class="anchor" id="a5f9476d82d9f414dccd9b49558d459bc"></a><!-- doxytag: member="Sp804::Timer::rawInt" ref="a5f9476d82d9f414dccd9b49558d459bc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSp804_1_1Timer.html#a5f9476d82d9f414dccd9b49558d459bc">rawInt</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If timer has caused an interrupt. This is irrespective of interrupt enable </p>

</div>
</div>
<a class="anchor" id="ab193f92c9325928a8fbfe941540db1a0"></a><!-- doxytag: member="Sp804::Timer::timerEnable" ref="ab193f92c9325928a8fbfe941540db1a0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bitfield&lt;7&gt; <a class="el" href="classSp804_1_1Timer.html#ab193f92c9325928a8fbfe941540db1a0">timerEnable</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa71cecfa28f348244319827543df9e18"></a><!-- doxytag: member="Sp804::Timer::timerMode" ref="aa71cecfa28f348244319827543df9e18" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bitfield&lt;6&gt; <a class="el" href="classSp804_1_1Timer.html#aa71cecfa28f348244319827543df9e18">timerMode</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afd859e1d86a57cb7711f17ab63ad4646"></a><!-- doxytag: member="Sp804::Timer::timerPrescale" ref="afd859e1d86a57cb7711f17ab63ad4646" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bitfield&lt;3,2&gt; <a class="el" href="classSp804_1_1Timer.html#afd859e1d86a57cb7711f17ab63ad4646">timerPrescale</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3952efcfdef8f7aa15b0ebcdbbe4bdd3"></a><!-- doxytag: member="Sp804::Timer::timerSize" ref="a3952efcfdef8f7aa15b0ebcdbbe4bdd3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Bitfield&lt;1&gt; <a class="el" href="classSp804_1_1Timer.html#a3952efcfdef8f7aa15b0ebcdbbe4bdd3">timerSize</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adc49d182c815493be0b95fda604da5da"></a><!-- doxytag: member="Sp804::Timer::zeroEvent" ref="adc49d182c815493be0b95fda604da5da" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classSp804_1_1Timer.html">Timer</a>, &amp;Timer::counterAtZero&gt; <a class="el" href="classSp804_1_1Timer.html#adc49d182c815493be0b95fda604da5da">zeroEvent</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>dev/arm/<a class="el" href="timer__sp804_8hh_source.html">timer_sp804.hh</a></li>
<li>dev/arm/<a class="el" href="timer__sp804_8cc.html">timer_sp804.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
