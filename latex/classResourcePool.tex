\hypertarget{classResourcePool}{
\section{クラス ResourcePool}
\label{classResourcePool}\index{ResourcePool@{ResourcePool}}
}


{\ttfamily \#include $<$resource\_\-pool.hh$>$}\subsection*{構成}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classResourcePool_1_1ResPoolEvent}{ResPoolEvent}
\end{DoxyCompactItemize}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classResourcePool_a35de859343d36cfc41403577ea3c7de5}{ResPoolEventType} \{ \hyperlink{classResourcePool_a35de859343d36cfc41403577ea3c7de5a060f6b48fe7261f8f20bdcd8debb0c3f}{InstGraduated} =  InOrderCPU::NumCPUEvents, 
\hyperlink{classResourcePool_a35de859343d36cfc41403577ea3c7de5af0747b9517d1d94424ee2430a3d7c44c}{SquashAll}, 
\hyperlink{classResourcePool_a35de859343d36cfc41403577ea3c7de5a86a572ebd39e3afa528248332156c260}{UpdateAfterContextSwitch}, 
\hyperlink{classResourcePool_a35de859343d36cfc41403577ea3c7de5a79935518a3889663d8688b6b01fff051}{Default}
 \}
\item 
enum \hyperlink{classResourcePool_af5077bc20d438add09f07eaf0793f2ac}{ResPoolEventPri} \{ \hyperlink{classResourcePool_af5077bc20d438add09f07eaf0793f2aca4c94c0279b1acc3c2327607fb1acb5ed}{ResPool\_\-Pri} =  InOrderCPU::InOrderCPU\_\-Pri -\/ 5, 
\hyperlink{classResourcePool_af5077bc20d438add09f07eaf0793f2acad56c75651d73b496dd9d12336a0d89ae}{ResGrad\_\-Pri}, 
\hyperlink{classResourcePool_af5077bc20d438add09f07eaf0793f2aca43614fac58ab1f33158827533ea8bb8a}{ResSquash\_\-Pri}
 \}
\item 
typedef \hyperlink{classRefCountingPtr}{InOrderDynInst::DynInstPtr} \hyperlink{classResourcePool_a32d1573770d3d1d96a1741ac80433e33}{DynInstPtr}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classResourcePool_a765bddb90f804d1ddebbc19b3459bb2e}{ResourcePool} (\hyperlink{classInOrderCPU}{InOrderCPU} $\ast$\_\-cpu, \hyperlink{namespaceThePipeline_ab62ca16eeca26566ad2422b5df4943ce}{ThePipeline::Params} $\ast$params)
\item 
virtual \hyperlink{classResourcePool_acba0a0d37ec0b89303d390cdb9e372cf}{$\sim$ResourcePool} ()
\item 
std::string \hyperlink{classResourcePool_aa62b508d2c0e7d9cec12924965276eb5}{name} ()
\item 
std::string \hyperlink{classResourcePool_ac28b6ddca5d1abd76095cffee93aa164}{name} (int res\_\-idx)
\item 
void \hyperlink{classResourcePool_a02fd73d861ef2e4aabb38c0c9ff82947}{init} ()
\item 
void \hyperlink{classResourcePool_a388f572c62279f839ee138a9afbdeeb5}{print} ()
\item 
void \hyperlink{classResourcePool_a4dc637449366fcdfc4e764cdf12d9b11}{regStats} ()
\item 
unsigned \hyperlink{classResourcePool_aa590916e201f046ca64fa621f9e3dc0c}{getResIdx} (const \hyperlink{namespaceThePipeline_a2a7d8e086edbca0402639d3b6b835286}{ThePipeline::ResourceId} \&res\_\-id)
\item 
\hyperlink{classResource}{Resource} $\ast$ \hyperlink{classResourcePool_a70b29b3de5f1fcf1d1a666dd5303250a}{getResource} (int res\_\-idx)
\item 
\hyperlink{classResourceRequest}{ResReqPtr} \hyperlink{classResourcePool_a75ce2cd367c200399a9fd0839d951124}{request} (int res\_\-idx, \hyperlink{classRefCountingPtr}{DynInstPtr} inst)
\item 
void \hyperlink{classResourcePool_a1e6b072b1524df996c37c65f032c0c5e}{squash} (\hyperlink{classRefCountingPtr}{DynInstPtr} inst, int res\_\-idx, \hyperlink{inst__seq_8hh_a258d93d98edaedee089435c19ea2ea2e}{InstSeqNum} done\_\-seq\_\-num, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_a58b8c9f76e422935e05267f75493d722}{squashAll} (\hyperlink{classRefCountingPtr}{DynInstPtr} inst, int stage\_\-num, \hyperlink{inst__seq_8hh_a258d93d98edaedee089435c19ea2ea2e}{InstSeqNum} done\_\-seq\_\-num, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_ae8f7628b42285a715d374b5a04f241e4}{squashDueToMemStall} (\hyperlink{classRefCountingPtr}{DynInstPtr} inst, int stage\_\-num, \hyperlink{inst__seq_8hh_a258d93d98edaedee089435c19ea2ea2e}{InstSeqNum} done\_\-seq\_\-num, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_a687aa4600423bb30ecf3bb1da6cd6000}{activateThread} (\hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_ad11d9216ad92d9036ebf37844cf6e706}{deactivateThread} (\hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_aee7a498a20266fbfbc6aa3f165577b68}{suspendThread} (\hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_a339073618ad3c21c492d64a55ce2e216}{updateAfterContextSwitch} (\hyperlink{classRefCountingPtr}{DynInstPtr} inst, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_a3f5f4da90448a4c3a3c0533881fb3129}{instGraduated} (\hyperlink{inst__seq_8hh_a258d93d98edaedee089435c19ea2ea2e}{InstSeqNum} seq\_\-num, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid)
\item 
void \hyperlink{classResourcePool_abf76d6d245f7d3b17d26ea8dcc0cf36f}{trap} (\hyperlink{classRefCountingPtr}{Fault} fault, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid, \hyperlink{classRefCountingPtr}{DynInstPtr} inst)
\item 
int \hyperlink{classResourcePool_acbd2796a939e932960eb09ec21ce3c3b}{slotsAvail} (int res\_\-idx)
\item 
int \hyperlink{classResourcePool_ac30878605317c199fc4371360bce7e0c}{slotsInUse} (int res\_\-idx)
\item 
void \hyperlink{classResourcePool_a2ab648fcabe96285d025deacd2175cbd}{scheduleEvent} (\hyperlink{classInOrderCPU_aedc081b7a3ef1b1568e62dec4a64c1ca}{InOrderCPU::CPUEventType} e\_\-type, \hyperlink{classRefCountingPtr}{DynInstPtr} inst=NULL, \hyperlink{classCycles}{Cycles} delay=\hyperlink{classCycles}{Cycles}(0), int res\_\-idx=0, \hyperlink{base_2types_8hh_ab39b1a4f9dad884694c7a74ed69e6a6b}{ThreadID} tid=0)
\item 
void \hyperlink{classResourcePool_a3102e3eb3a1648c4c448c0573142fd0b}{unscheduleEvent} (int res\_\-idx, \hyperlink{classRefCountingPtr}{DynInstPtr} inst)
\item 
virtual void \hyperlink{classResourcePool_a86b760932b88a9cebef1df8514818390}{startup} ()
\item 
\hyperlink{classFetchUnit}{FetchUnit} $\ast$ \hyperlink{classResourcePool_a6a12b19003afbeeb3b69b71ced3b2a6e}{getInstUnit} () const 
\item 
\hyperlink{classCacheUnit}{CacheUnit} $\ast$ \hyperlink{classResourcePool_ab2c545b49e59a8de568a4f7a6cbd7d32}{getDataUnit} () const 
\end{DoxyCompactItemize}
\subsection*{Public 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classInOrderCPU}{InOrderCPU} $\ast$ \hyperlink{classResourcePool_a41d682c28d0f49e04393c52815808782}{cpu}
\item 
\hyperlink{classRefCountingPtr}{DynInstPtr} \hyperlink{classResourcePool_a8f57f75c5150b34b12a0d461a8941704}{dummyInst} \mbox{[}\hyperlink{namespaceThePipeline_ac9c0bbe9cf27d93e08ea8ccc4096e633}{ThePipeline::MaxThreads}\mbox{]}
\end{DoxyCompactItemize}
\subsection*{Private 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classFetchUnit}{FetchUnit} $\ast$ \hyperlink{classResourcePool_a693ed6c316127146b1da381cddea5ef9}{instUnit}
\item 
\hyperlink{classCacheUnit}{CacheUnit} $\ast$ \hyperlink{classResourcePool_a35963c6401a395a10f1b0d8eeb84e1ed}{dataUnit}
\item 
\hyperlink{classstd_1_1vector}{std::vector}$<$ \hyperlink{classResource}{Resource} $\ast$ $>$ \hyperlink{classResourcePool_a46a3c49c7a2cc60b053ccc0fecdfc334}{resources}
\item 
\hyperlink{classstd_1_1vector}{std::vector}$<$ int $>$ \hyperlink{classResourcePool_a62c7474a6f50366616afac7a3af89f08}{gradObjects}
\end{DoxyCompactItemize}


\subsection{型定義}
\hypertarget{classResourcePool_a32d1573770d3d1d96a1741ac80433e33}{
\index{ResourcePool@{ResourcePool}!DynInstPtr@{DynInstPtr}}
\index{DynInstPtr@{DynInstPtr}!ResourcePool@{ResourcePool}}
\subsubsection[{DynInstPtr}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf InOrderDynInst::DynInstPtr} {\bf DynInstPtr}}}
\label{classResourcePool_a32d1573770d3d1d96a1741ac80433e33}


\subsection{列挙型}
\hypertarget{classResourcePool_af5077bc20d438add09f07eaf0793f2ac}{
\index{ResourcePool@{ResourcePool}!ResPoolEventPri@{ResPoolEventPri}}
\index{ResPoolEventPri@{ResPoolEventPri}!ResourcePool@{ResourcePool}}
\subsubsection[{ResPoolEventPri}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf ResPoolEventPri}}}
\label{classResourcePool_af5077bc20d438add09f07eaf0793f2ac}
\begin{Desc}
\item[列挙型の値: ]\par
\begin{description}
\index{ResPool\_\-Pri@{ResPool\_\-Pri}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!ResPool\_\-Pri@{ResPool\_\-Pri}}\item[{\em 
\hypertarget{classResourcePool_af5077bc20d438add09f07eaf0793f2aca4c94c0279b1acc3c2327607fb1acb5ed}{
ResPool\_\-Pri}
\label{classResourcePool_af5077bc20d438add09f07eaf0793f2aca4c94c0279b1acc3c2327607fb1acb5ed}
}]\index{ResGrad\_\-Pri@{ResGrad\_\-Pri}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!ResGrad\_\-Pri@{ResGrad\_\-Pri}}\item[{\em 
\hypertarget{classResourcePool_af5077bc20d438add09f07eaf0793f2acad56c75651d73b496dd9d12336a0d89ae}{
ResGrad\_\-Pri}
\label{classResourcePool_af5077bc20d438add09f07eaf0793f2acad56c75651d73b496dd9d12336a0d89ae}
}]\index{ResSquash\_\-Pri@{ResSquash\_\-Pri}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!ResSquash\_\-Pri@{ResSquash\_\-Pri}}\item[{\em 
\hypertarget{classResourcePool_af5077bc20d438add09f07eaf0793f2aca43614fac58ab1f33158827533ea8bb8a}{
ResSquash\_\-Pri}
\label{classResourcePool_af5077bc20d438add09f07eaf0793f2aca43614fac58ab1f33158827533ea8bb8a}
}]\end{description}
\end{Desc}




\begin{DoxyCode}
80                          {
81         ResPool_Pri =  InOrderCPU::InOrderCPU_Pri - 5,
82         ResGrad_Pri,
83         ResSquash_Pri
84     };
\end{DoxyCode}
\hypertarget{classResourcePool_a35de859343d36cfc41403577ea3c7de5}{
\index{ResourcePool@{ResourcePool}!ResPoolEventType@{ResPoolEventType}}
\index{ResPoolEventType@{ResPoolEventType}!ResourcePool@{ResourcePool}}
\subsubsection[{ResPoolEventType}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf ResPoolEventType}}}
\label{classResourcePool_a35de859343d36cfc41403577ea3c7de5}
\begin{Desc}
\item[列挙型の値: ]\par
\begin{description}
\index{InstGraduated@{InstGraduated}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!InstGraduated@{InstGraduated}}\item[{\em 
\hypertarget{classResourcePool_a35de859343d36cfc41403577ea3c7de5a060f6b48fe7261f8f20bdcd8debb0c3f}{
InstGraduated}
\label{classResourcePool_a35de859343d36cfc41403577ea3c7de5a060f6b48fe7261f8f20bdcd8debb0c3f}
}]\index{SquashAll@{SquashAll}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!SquashAll@{SquashAll}}\item[{\em 
\hypertarget{classResourcePool_a35de859343d36cfc41403577ea3c7de5af0747b9517d1d94424ee2430a3d7c44c}{
SquashAll}
\label{classResourcePool_a35de859343d36cfc41403577ea3c7de5af0747b9517d1d94424ee2430a3d7c44c}
}]\index{UpdateAfterContextSwitch@{UpdateAfterContextSwitch}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!UpdateAfterContextSwitch@{UpdateAfterContextSwitch}}\item[{\em 
\hypertarget{classResourcePool_a35de859343d36cfc41403577ea3c7de5a86a572ebd39e3afa528248332156c260}{
UpdateAfterContextSwitch}
\label{classResourcePool_a35de859343d36cfc41403577ea3c7de5a86a572ebd39e3afa528248332156c260}
}]\index{Default@{Default}!ResourcePool@{ResourcePool}}\index{ResourcePool@{ResourcePool}!Default@{Default}}\item[{\em 
\hypertarget{classResourcePool_a35de859343d36cfc41403577ea3c7de5a79935518a3889663d8688b6b01fff051}{
Default}
\label{classResourcePool_a35de859343d36cfc41403577ea3c7de5a79935518a3889663d8688b6b01fff051}
}]\end{description}
\end{Desc}




\begin{DoxyCode}
73                           {
74         InstGraduated = InOrderCPU::NumCPUEvents,
75         SquashAll,
76         UpdateAfterContextSwitch,
77         Default
78     };
\end{DoxyCode}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classResourcePool_a765bddb90f804d1ddebbc19b3459bb2e}{
\index{ResourcePool@{ResourcePool}!ResourcePool@{ResourcePool}}
\index{ResourcePool@{ResourcePool}!ResourcePool@{ResourcePool}}
\subsubsection[{ResourcePool}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ResourcePool} ({\bf InOrderCPU} $\ast$ {\em \_\-cpu}, \/  {\bf ThePipeline::Params} $\ast$ {\em params})}}
\label{classResourcePool_a765bddb90f804d1ddebbc19b3459bb2e}



\begin{DoxyCode}
54     : cpu(_cpu), instUnit(NULL), dataUnit(NULL)
55 {
56     //@todo: use this function to instantiate the resources in resource pool. Thi
      s will help in the
57     //auto-generation of this pipeline model.
58     //ThePipeline::addResources(resources, memObjects);
59 
60     // Declare Resource Objects
61     // name - id - bandwidth - latency - CPU - Parameters
62     // --------------------------------------------------
63     resources.push_back(new FetchSeqUnit("fetch_seq_unit", FetchSeq,
64             StageWidth * 2, 0, _cpu, params));
65 
66     resources.push_back(new TLBUnit("itlb", ITLB, StageWidth, 0, _cpu, params));
67 
68 
69     // Keep track of the instruction fetch unit so we can easily
70     // provide a pointer to it in the CPU.
71     instUnit = new FetchUnit("icache_port", ICache,
72                              StageWidth * MaxThreads, 0, _cpu,
73                              params);
74     resources.push_back(instUnit);
75 
76     resources.push_back(new DecodeUnit("decode_unit", Decode, StageWidth, 0,
77             _cpu, params));
78 
79     resources.push_back(new BranchPredictor("branch_predictor", BPred,
80             StageWidth, 0, _cpu, params));
81 
82     for (int i = 0; i < params->numberOfThreads; i++) {
83         char fbuff_name[20];
84         sprintf(fbuff_name, "fetch_buffer_t%i", i);
85         resources.push_back(new InstBuffer(fbuff_name, FetchBuff + i, 4, 0,
86                 _cpu, params));
87     }
88 
89     resources.push_back(new UseDefUnit("regfile_manager", RegManager,
90             StageWidth * MaxThreads, 0, _cpu, params));
91 
92     resources.push_back(new AGENUnit("agen_unit", AGEN, StageWidth, 0, _cpu,
93             params));
94 
95     resources.push_back(new ExecutionUnit("execution_unit", ExecUnit,
96             StageWidth, 0, _cpu, params));
97 
98     resources.push_back(new MultDivUnit("mult_div_unit", MDU, 5, 0, _cpu,
99             params));
100 
101     resources.push_back(new TLBUnit("dtlb", DTLB, StageWidth, 0, _cpu, params));
102 
103     // Keep track of the data load/store unit so we can easily provide
104     // a pointer to it in the CPU.
105     dataUnit = new CacheUnit("dcache_port", DCache,
106                              StageWidth * MaxThreads, 0, _cpu,
107                              params);
108     resources.push_back(dataUnit);
109 
110     resources.push_back(new GraduationUnit("graduation_unit", Grad,
111             StageWidth * MaxThreads, 0, _cpu, params));
112 }
\end{DoxyCode}
\hypertarget{classResourcePool_acba0a0d37ec0b89303d390cdb9e372cf}{
\index{ResourcePool@{ResourcePool}!$\sim$ResourcePool@{$\sim$ResourcePool}}
\index{$\sim$ResourcePool@{$\sim$ResourcePool}!ResourcePool@{ResourcePool}}
\subsubsection[{$\sim$ResourcePool}]{\setlength{\rightskip}{0pt plus 5cm}$\sim${\bf ResourcePool} ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classResourcePool_acba0a0d37ec0b89303d390cdb9e372cf}



\begin{DoxyCode}
122 {
123     cout << "Deleting resources ..." << endl;
124     
125     for (int i=0; i < resources.size(); i++) {
126         DPRINTF(Resource, "Deleting resource: %s.\n", resources[i]->name());
127         
128         delete resources[i];
129     }    
130 }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classResourcePool_a687aa4600423bb30ecf3bb1da6cd6000}{
\index{ResourcePool@{ResourcePool}!activateThread@{activateThread}}
\index{activateThread@{activateThread}!ResourcePool@{ResourcePool}}
\subsubsection[{activateThread}]{\setlength{\rightskip}{0pt plus 5cm}void activateThread ({\bf ThreadID} {\em tid})}}
\label{classResourcePool_a687aa4600423bb30ecf3bb1da6cd6000}
Activate Thread in all resources 


\begin{DoxyCode}
342 {
343     bool do_activate = cpu->threadModel != InOrderCPU::SwitchOnCacheMiss ||
344         cpu->numActiveThreads() < 1 ||
345         cpu->activeThreadId() == tid;
346     
347         
348     if (do_activate) {
349         DPRINTF(Resource, "[tid:%i] Broadcasting Thread Activation to all "
350                     "resources.\n", tid);
351  
352         int num_resources = resources.size();
353  
354         for (int idx = 0; idx < num_resources; idx++) {
355             resources[idx]->activateThread(tid);
356         }
357     } else {
358         DPRINTF(Resource, "[tid:%i] Ignoring Thread Activation to all "
359                     "resources.\n", tid);
360      }
361 }
\end{DoxyCode}
\hypertarget{classResourcePool_ad11d9216ad92d9036ebf37844cf6e706}{
\index{ResourcePool@{ResourcePool}!deactivateThread@{deactivateThread}}
\index{deactivateThread@{deactivateThread}!ResourcePool@{ResourcePool}}
\subsubsection[{deactivateThread}]{\setlength{\rightskip}{0pt plus 5cm}void deactivateThread ({\bf ThreadID} {\em tid})}}
\label{classResourcePool_ad11d9216ad92d9036ebf37844cf6e706}
De-\/Activate Thread in all resources 


\begin{DoxyCode}
365 {
366     DPRINTF(Resource, "[tid:%i] Broadcasting Thread Deactivation to all "
367             "resources.\n", tid);
368 
369     int num_resources = resources.size();
370 
371     for (int idx = 0; idx < num_resources; idx++) {
372         resources[idx]->deactivateThread(tid);
373     }
374 }
\end{DoxyCode}
\hypertarget{classResourcePool_ab2c545b49e59a8de568a4f7a6cbd7d32}{
\index{ResourcePool@{ResourcePool}!getDataUnit@{getDataUnit}}
\index{getDataUnit@{getDataUnit}!ResourcePool@{ResourcePool}}
\subsubsection[{getDataUnit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf CacheUnit}$\ast$ getDataUnit () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classResourcePool_ab2c545b49e59a8de568a4f7a6cbd7d32}
Get a pointer to the (always present) data load/store unit.

\begin{DoxyReturn}{戻り値}
the data cache unit 
\end{DoxyReturn}



\begin{DoxyCode}
234 { return dataUnit; }
\end{DoxyCode}
\hypertarget{classResourcePool_a6a12b19003afbeeb3b69b71ced3b2a6e}{
\index{ResourcePool@{ResourcePool}!getInstUnit@{getInstUnit}}
\index{getInstUnit@{getInstUnit}!ResourcePool@{ResourcePool}}
\subsubsection[{getInstUnit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf FetchUnit}$\ast$ getInstUnit () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classResourcePool_a6a12b19003afbeeb3b69b71ced3b2a6e}
Get a pointer to the (always present) instruction fetch unit.

\begin{DoxyReturn}{戻り値}
the instruction unit 
\end{DoxyReturn}



\begin{DoxyCode}
227 { return instUnit; }
\end{DoxyCode}
\hypertarget{classResourcePool_aa590916e201f046ca64fa621f9e3dc0c}{
\index{ResourcePool@{ResourcePool}!getResIdx@{getResIdx}}
\index{getResIdx@{getResIdx}!ResourcePool@{ResourcePool}}
\subsubsection[{getResIdx}]{\setlength{\rightskip}{0pt plus 5cm}unsigned getResIdx (const {\bf ThePipeline::ResourceId} \& {\em res\_\-id})}}
\label{classResourcePool_aa590916e201f046ca64fa621f9e3dc0c}
Returns a specific resource. 


\begin{DoxyCode}
175 {
176     int num_resources = resources.size();
177 
178     for (int idx = 0; idx < num_resources; idx++) {
179         if (resources[idx]->getId() == res_id)
180             return idx;
181     }
182 
183     // todo: change return value to int and return a -1 here
184     //       maybe even have enumerated type
185     //       panic for now...
186     panic("Can't find resource idx for: %i\n", res_id);
187 
188     return 0;
189 }
\end{DoxyCode}
\hypertarget{classResourcePool_a70b29b3de5f1fcf1d1a666dd5303250a}{
\index{ResourcePool@{ResourcePool}!getResource@{getResource}}
\index{getResource@{getResource}!ResourcePool@{ResourcePool}}
\subsubsection[{getResource}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Resource}$\ast$ getResource (int {\em res\_\-idx})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classResourcePool_a70b29b3de5f1fcf1d1a666dd5303250a}
Returns a pointer to a resource 


\begin{DoxyCode}
159 { return resources[res_idx]; }
\end{DoxyCode}
\hypertarget{classResourcePool_a02fd73d861ef2e4aabb38c0c9ff82947}{
\index{ResourcePool@{ResourcePool}!init@{init}}
\index{init@{init}!ResourcePool@{ResourcePool}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}void init ()}}
\label{classResourcePool_a02fd73d861ef2e4aabb38c0c9ff82947}



\begin{DoxyCode}
116 {
117     for (int i=0; i < resources.size(); i++) {
118         resources[i]->init();
119     }
120 }
\end{DoxyCode}
\hypertarget{classResourcePool_a3f5f4da90448a4c3a3c0533881fb3129}{
\index{ResourcePool@{ResourcePool}!instGraduated@{instGraduated}}
\index{instGraduated@{instGraduated}!ResourcePool@{ResourcePool}}
\subsubsection[{instGraduated}]{\setlength{\rightskip}{0pt plus 5cm}void instGraduated ({\bf InstSeqNum} {\em seq\_\-num}, \/  {\bf ThreadID} {\em tid})}}
\label{classResourcePool_a3f5f4da90448a4c3a3c0533881fb3129}
Broadcast graduation to all resources 


\begin{DoxyCode}
293 {
294     DPRINTF(Resource, "[tid:%i] Broadcasting [sn:%i] graduation to all resources.
      \n",
295             tid, seq_num);
296 
297     int num_resources = resources.size();
298 
299     for (int idx = 0; idx < num_resources; idx++) {
300         resources[idx]->instGraduated(seq_num, tid);
301     }
302 }
\end{DoxyCode}
\hypertarget{classResourcePool_ac28b6ddca5d1abd76095cffee93aa164}{
\index{ResourcePool@{ResourcePool}!name@{name}}
\index{name@{name}!ResourcePool@{ResourcePool}}
\subsubsection[{name}]{\setlength{\rightskip}{0pt plus 5cm}std::string name (int {\em res\_\-idx})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classResourcePool_ac28b6ddca5d1abd76095cffee93aa164}



\begin{DoxyCode}
146 { return resources[res_idx]->name(); }
\end{DoxyCode}
\hypertarget{classResourcePool_aa62b508d2c0e7d9cec12924965276eb5}{
\index{ResourcePool@{ResourcePool}!name@{name}}
\index{name@{name}!ResourcePool@{ResourcePool}}
\subsubsection[{name}]{\setlength{\rightskip}{0pt plus 5cm}string name ()}}
\label{classResourcePool_aa62b508d2c0e7d9cec12924965276eb5}



\begin{DoxyCode}
124 {
125     return cpu->name() + ".ResourcePool";
126 }
\end{DoxyCode}
\hypertarget{classResourcePool_a388f572c62279f839ee138a9afbdeeb5}{
\index{ResourcePool@{ResourcePool}!print@{print}}
\index{print@{print}!ResourcePool@{ResourcePool}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}void print ()}}
\label{classResourcePool_a388f572c62279f839ee138a9afbdeeb5}



\begin{DoxyCode}
152 {
153     for (int i=0; i < resources.size(); i++) {
154         DPRINTF(InOrderDynInst, "Res:%i %s\n",
155                 i, resources[i]->name());
156     }
157 
158 }
\end{DoxyCode}
\hypertarget{classResourcePool_a4dc637449366fcdfc4e764cdf12d9b11}{
\index{ResourcePool@{ResourcePool}!regStats@{regStats}}
\index{regStats@{regStats}!ResourcePool@{ResourcePool}}
\subsubsection[{regStats}]{\setlength{\rightskip}{0pt plus 5cm}void regStats ()}}
\label{classResourcePool_a4dc637449366fcdfc4e764cdf12d9b11}
\hyperlink{classRegister}{Register} Statistics in All Resources 


\begin{DoxyCode}
131 {
132     DPRINTF(Resource, "Registering Stats Throughout Resource Pool.\n");
133 
134     int num_resources = resources.size();
135 
136     for (int idx = 0; idx < num_resources; idx++) {
137         resources[idx]->regStats();
138     }
139 }
\end{DoxyCode}
\hypertarget{classResourcePool_a75ce2cd367c200399a9fd0839d951124}{
\index{ResourcePool@{ResourcePool}!request@{request}}
\index{request@{request}!ResourcePool@{ResourcePool}}
\subsubsection[{request}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ResReqPtr} request (int {\em res\_\-idx}, \/  {\bf DynInstPtr} {\em inst})}}
\label{classResourcePool_a75ce2cd367c200399a9fd0839d951124}
\hyperlink{classRequest}{Request} usage of this resource. Returns -\/1 if not granted and a positive request tag if granted. 


\begin{DoxyCode}
143 {
144     //Make Sure This is a valid resource ID
145     assert(res_idx >= 0 && res_idx < resources.size());
146 
147     return resources[res_idx]->request(inst);
148 }
\end{DoxyCode}
\hypertarget{classResourcePool_a2ab648fcabe96285d025deacd2175cbd}{
\index{ResourcePool@{ResourcePool}!scheduleEvent@{scheduleEvent}}
\index{scheduleEvent@{scheduleEvent}!ResourcePool@{ResourcePool}}
\subsubsection[{scheduleEvent}]{\setlength{\rightskip}{0pt plus 5cm}void scheduleEvent ({\bf InOrderCPU::CPUEventType} {\em e\_\-type}, \/  {\bf DynInstPtr} {\em inst} = {\ttfamily NULL}, \/  {\bf Cycles} {\em delay} = {\ttfamily {\bf Cycles}(0)}, \/  int {\em res\_\-idx} = {\ttfamily 0}, \/  {\bf ThreadID} {\em tid} = {\ttfamily 0})}}
\label{classResourcePool_a2ab648fcabe96285d025deacd2175cbd}
Schedule resource event, regardless of its current state. 


\begin{DoxyCode}
241 {
242     assert(delay >= 0);
243 
244     Tick when = cpu->clockEdge(delay);
245 
246     switch ((int)e_type)
247     {
248       case ResourcePool::InstGraduated:
249         {
250             DPRINTF(Resource, "Scheduling Inst-Graduated Resource Pool "
251                     "Event for tick %i.\n", curTick() + delay);
252             ResPoolEventPri grad_pri = ResGrad_Pri;
253             ResPoolEvent *res_pool_event = 
254                 new ResPoolEvent(this,
255                                  e_type,
256                                  inst,
257                                  inst->squashingStage,
258                                  inst->seqNum,
259                                  inst->readTid(),
260                                  grad_pri);
261             cpu->schedule(res_pool_event, when);
262         }
263         break;
264 
265       case ResourcePool::SquashAll:
266         {
267             DPRINTF(Resource, "Scheduling Squash Resource Pool Event for "
268                     "tick %i.\n", curTick() + delay);
269             ResPoolEventPri squash_pri = ResSquash_Pri;
270             ResPoolEvent *res_pool_event = 
271                 new ResPoolEvent(this,
272                                  e_type,
273                                  inst,
274                                  inst->squashingStage,
275                                  inst->squashSeqNum,
276                                  inst->readTid(),
277                                  squash_pri);
278             cpu->schedule(res_pool_event, when);
279         }
280         break;
281 
282       case ResourcePool::UpdateAfterContextSwitch:
283         {
284             DPRINTF(Resource, "Scheduling UpdatePC Resource Pool Event "
285                     "for tick %i.\n",
286                     curTick() + delay);
287             ResPoolEvent *res_pool_event = new ResPoolEvent(this,
288                                                             e_type,
289                                                             inst,
290                                                             inst->squashingStage,
      
291                                                             inst->seqNum,
292                                                             inst->readTid());
293             cpu->schedule(res_pool_event, when);
294         }
295         break;
296 
297       default:
298         DPRINTF(Resource, "Ignoring Unrecognized CPU Event (%s).\n", 
299                 InOrderCPU::eventNames[e_type]);
300     }
301 }
\end{DoxyCode}
\hypertarget{classResourcePool_acbd2796a939e932960eb09ec21ce3c3b}{
\index{ResourcePool@{ResourcePool}!slotsAvail@{slotsAvail}}
\index{slotsAvail@{slotsAvail}!ResourcePool@{ResourcePool}}
\subsubsection[{slotsAvail}]{\setlength{\rightskip}{0pt plus 5cm}int slotsAvail (int {\em res\_\-idx})}}
\label{classResourcePool_acbd2796a939e932960eb09ec21ce3c3b}
The number of instructions available that a resource can can still process. 


\begin{DoxyCode}
159 {
160     return resources[res_idx]->slotsAvail();
161 }
\end{DoxyCode}
\hypertarget{classResourcePool_ac30878605317c199fc4371360bce7e0c}{
\index{ResourcePool@{ResourcePool}!slotsInUse@{slotsInUse}}
\index{slotsInUse@{slotsInUse}!ResourcePool@{ResourcePool}}
\subsubsection[{slotsInUse}]{\setlength{\rightskip}{0pt plus 5cm}int slotsInUse (int {\em res\_\-idx})}}
\label{classResourcePool_ac30878605317c199fc4371360bce7e0c}
The number of instructions using a resource 


\begin{DoxyCode}
165 {
166     return resources[res_idx]->slotsInUse();
167 }
\end{DoxyCode}
\hypertarget{classResourcePool_a1e6b072b1524df996c37c65f032c0c5e}{
\index{ResourcePool@{ResourcePool}!squash@{squash}}
\index{squash@{squash}!ResourcePool@{ResourcePool}}
\subsubsection[{squash}]{\setlength{\rightskip}{0pt plus 5cm}void squash ({\bf DynInstPtr} {\em inst}, \/  int {\em res\_\-idx}, \/  {\bf InstSeqNum} {\em done\_\-seq\_\-num}, \/  {\bf ThreadID} {\em tid})}}
\label{classResourcePool_a1e6b072b1524df996c37c65f032c0c5e}
Squash The \hyperlink{classResource}{Resource} 


\begin{DoxyCode}
153 {
154     resources[res_idx]->squash(inst, ThePipeline::NumStages-1, done_seq_num, tid)
      ;
155 }
\end{DoxyCode}
\hypertarget{classResourcePool_a58b8c9f76e422935e05267f75493d722}{
\index{ResourcePool@{ResourcePool}!squashAll@{squashAll}}
\index{squashAll@{squashAll}!ResourcePool@{ResourcePool}}
\subsubsection[{squashAll}]{\setlength{\rightskip}{0pt plus 5cm}void squashAll ({\bf DynInstPtr} {\em inst}, \/  int {\em stage\_\-num}, \/  {\bf InstSeqNum} {\em done\_\-seq\_\-num}, \/  {\bf ThreadID} {\em tid})}}
\label{classResourcePool_a58b8c9f76e422935e05267f75493d722}
Squash All Resources in Pool after Done Seq. Num 


\begin{DoxyCode}
254 {
255     DPRINTF(Resource, "[tid:%i] Stage %i squashing all instructions above [sn:%i]
      .\n",
256             stage_num, tid, done_seq_num);
257 
258     int num_resources = resources.size();
259 
260     for (int idx = 0; idx < num_resources; idx++) {
261         resources[idx]->squash(inst, stage_num, done_seq_num, tid);
262     }
263 }
\end{DoxyCode}
\hypertarget{classResourcePool_ae8f7628b42285a715d374b5a04f241e4}{
\index{ResourcePool@{ResourcePool}!squashDueToMemStall@{squashDueToMemStall}}
\index{squashDueToMemStall@{squashDueToMemStall}!ResourcePool@{ResourcePool}}
\subsubsection[{squashDueToMemStall}]{\setlength{\rightskip}{0pt plus 5cm}void squashDueToMemStall ({\bf DynInstPtr} {\em inst}, \/  int {\em stage\_\-num}, \/  {\bf InstSeqNum} {\em done\_\-seq\_\-num}, \/  {\bf ThreadID} {\em tid})}}
\label{classResourcePool_ae8f7628b42285a715d374b5a04f241e4}
Squash Resources in Pool after a memory stall NOTE: Only use during Switch-\/On-\/Miss Thread model 


\begin{DoxyCode}
327 {
328     DPRINTF(Resource, "[tid:%i] Broadcasting SquashDueToMemStall Event"
329             " starting w/stage %i for all instructions above [sn:%i].\n",
330             tid, stage_num, done_seq_num);
331 
332     int num_resources = resources.size();
333 
334     for (int idx = 0; idx < num_resources; idx++) {
335         resources[idx]->squashDueToMemStall(inst, stage_num, done_seq_num, 
336                                             tid);
337     }
338 }
\end{DoxyCode}
\hypertarget{classResourcePool_a86b760932b88a9cebef1df8514818390}{
\index{ResourcePool@{ResourcePool}!startup@{startup}}
\index{startup@{startup}!ResourcePool@{ResourcePool}}
\subsubsection[{startup}]{\setlength{\rightskip}{0pt plus 5cm}virtual void startup ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classResourcePool_a86b760932b88a9cebef1df8514818390}
Tasks to perform when simulation starts 


\begin{DoxyCode}
215 { }
\end{DoxyCode}
\hypertarget{classResourcePool_aee7a498a20266fbfbc6aa3f165577b68}{
\index{ResourcePool@{ResourcePool}!suspendThread@{suspendThread}}
\index{suspendThread@{suspendThread}!ResourcePool@{ResourcePool}}
\subsubsection[{suspendThread}]{\setlength{\rightskip}{0pt plus 5cm}void suspendThread ({\bf ThreadID} {\em tid})}}
\label{classResourcePool_aee7a498a20266fbfbc6aa3f165577b68}
Suspend Thread in all resources 


\begin{DoxyCode}
378 {
379     DPRINTF(Resource, "[tid:%i] Broadcasting Thread Suspension to all "
380             "resources.\n", tid);
381 
382     int num_resources = resources.size();
383 
384     for (int idx = 0; idx < num_resources; idx++) {
385         resources[idx]->suspendThread(tid);
386     }
387 }
\end{DoxyCode}
\hypertarget{classResourcePool_abf76d6d245f7d3b17d26ea8dcc0cf36f}{
\index{ResourcePool@{ResourcePool}!trap@{trap}}
\index{trap@{trap}!ResourcePool@{ResourcePool}}
\subsubsection[{trap}]{\setlength{\rightskip}{0pt plus 5cm}void trap ({\bf Fault} {\em fault}, \/  {\bf ThreadID} {\em tid}, \/  {\bf DynInstPtr} {\em inst})}}
\label{classResourcePool_abf76d6d245f7d3b17d26ea8dcc0cf36f}
Broadcast trap to all resources 


\begin{DoxyCode}
210 {
211     DPRINTF(Resource, "[tid:%i] Broadcasting Trap to all "
212             "resources.\n", tid);
213 
214     int num_resources = resources.size();
215 
216     for (int idx = 0; idx < num_resources; idx++)
217         resources[idx]->trap(fault, tid, inst);
218 }
\end{DoxyCode}
\hypertarget{classResourcePool_a3102e3eb3a1648c4c448c0573142fd0b}{
\index{ResourcePool@{ResourcePool}!unscheduleEvent@{unscheduleEvent}}
\index{unscheduleEvent@{unscheduleEvent}!ResourcePool@{ResourcePool}}
\subsubsection[{unscheduleEvent}]{\setlength{\rightskip}{0pt plus 5cm}void unscheduleEvent (int {\em res\_\-idx}, \/  {\bf DynInstPtr} {\em inst})}}
\label{classResourcePool_a3102e3eb3a1648c4c448c0573142fd0b}
UnSchedule resource event, regardless of its current state. 


\begin{DoxyCode}
247 {
248     resources[res_idx]->unscheduleEvent(inst);
249 }
\end{DoxyCode}
\hypertarget{classResourcePool_a339073618ad3c21c492d64a55ce2e216}{
\index{ResourcePool@{ResourcePool}!updateAfterContextSwitch@{updateAfterContextSwitch}}
\index{updateAfterContextSwitch@{updateAfterContextSwitch}!ResourcePool@{ResourcePool}}
\subsubsection[{updateAfterContextSwitch}]{\setlength{\rightskip}{0pt plus 5cm}void updateAfterContextSwitch ({\bf DynInstPtr} {\em inst}, \/  {\bf ThreadID} {\em tid})}}
\label{classResourcePool_a339073618ad3c21c492d64a55ce2e216}
Broadcast Context \hyperlink{classSwitch}{Switch} Update to all resources 


\begin{DoxyCode}
404 {
405     DPRINTF(Resource, "[tid:%i] Broadcasting Update PC to all resources.\n",
406             tid);
407 
408     int num_resources = resources.size();
409 
410     for (int idx = 0; idx < num_resources; idx++) {
411         resources[idx]->updateAfterContextSwitch(inst, tid);
412     }
413 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classResourcePool_a41d682c28d0f49e04393c52815808782}{
\index{ResourcePool@{ResourcePool}!cpu@{cpu}}
\index{cpu@{cpu}!ResourcePool@{ResourcePool}}
\subsubsection[{cpu}]{\setlength{\rightskip}{0pt plus 5cm}{\bf InOrderCPU}$\ast$ {\bf cpu}}}
\label{classResourcePool_a41d682c28d0f49e04393c52815808782}
The CPU(s) that this resource interacts with \hypertarget{classResourcePool_a35963c6401a395a10f1b0d8eeb84e1ed}{
\index{ResourcePool@{ResourcePool}!dataUnit@{dataUnit}}
\index{dataUnit@{dataUnit}!ResourcePool@{ResourcePool}}
\subsubsection[{dataUnit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf CacheUnit}$\ast$ {\bf dataUnit}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classResourcePool_a35963c6401a395a10f1b0d8eeb84e1ed}
The data load/store unit. \hypertarget{classResourcePool_a8f57f75c5150b34b12a0d461a8941704}{
\index{ResourcePool@{ResourcePool}!dummyInst@{dummyInst}}
\index{dummyInst@{dummyInst}!ResourcePool@{ResourcePool}}
\subsubsection[{dummyInst}]{\setlength{\rightskip}{0pt plus 5cm}{\bf DynInstPtr} {\bf dummyInst}\mbox{[}{\bf ThePipeline::MaxThreads}\mbox{]}}}
\label{classResourcePool_a8f57f75c5150b34b12a0d461a8941704}
\hypertarget{classResourcePool_a62c7474a6f50366616afac7a3af89f08}{
\index{ResourcePool@{ResourcePool}!gradObjects@{gradObjects}}
\index{gradObjects@{gradObjects}!ResourcePool@{ResourcePool}}
\subsubsection[{gradObjects}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std::vector}$<$int$>$ {\bf gradObjects}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classResourcePool_a62c7474a6f50366616afac7a3af89f08}
Resources that need to be updated on an inst. graduation \hypertarget{classResourcePool_a693ed6c316127146b1da381cddea5ef9}{
\index{ResourcePool@{ResourcePool}!instUnit@{instUnit}}
\index{instUnit@{instUnit}!ResourcePool@{ResourcePool}}
\subsubsection[{instUnit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf FetchUnit}$\ast$ {\bf instUnit}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classResourcePool_a693ed6c316127146b1da381cddea5ef9}
The instruction fetch unit. \hypertarget{classResourcePool_a46a3c49c7a2cc60b053ccc0fecdfc334}{
\index{ResourcePool@{ResourcePool}!resources@{resources}}
\index{resources@{resources}!ResourcePool@{ResourcePool}}
\subsubsection[{resources}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std::vector}$<${\bf Resource} $\ast$$>$ {\bf resources}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classResourcePool_a46a3c49c7a2cc60b053ccc0fecdfc334}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
cpu/inorder/\hyperlink{resource__pool_8hh}{resource\_\-pool.hh}\item 
cpu/inorder/\hyperlink{resource__pool_89stage_8cc}{resource\_\-pool.9stage.cc}\item 
cpu/inorder/\hyperlink{resource__pool_8cc}{resource\_\-pool.cc}\end{DoxyCompactItemize}
