<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス LRU</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス LRU</h1><!-- doxytag: class="LRU" --><!-- doxytag: inherits="BaseTags" -->
<p><code>#include &lt;<a class="el" href="lru_8hh_source.html">lru.hh</a>&gt;</code></p>
<div class="dynheader">
LRUに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classLRU.gif" usemap="#LRU_map" alt=""/>
  <map id="LRU_map" name="LRU_map">
<area href="classBaseTags.html" alt="BaseTags" shape="rect" coords="105,168,200,192"/>
<area href="classClockedObject.html" alt="ClockedObject" shape="rect" coords="105,112,200,136"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="105,56,200,80"/>
<area href="classEventManager.html" alt="EventManager" shape="rect" coords="0,0,95,24"/>
<area href="classSerializable.html" alt="Serializable" shape="rect" coords="105,0,200,24"/>
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="210,0,305,24"/>
</map>
 </div>
</div>

<p><a href="classLRU-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classCacheBlk.html">CacheBlk</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="classCacheBlk.html">BlkType</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a10e9d0cbb622eb6efe1dd332af622902">BlkList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classCacheSet.html">CacheSet</a>&lt; <a class="el" href="classCacheBlk.html">CacheBlk</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a3c0e5e439e276493def31913011594ff">SetType</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef LRUParams&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a7817e729934956b9b3573d13924bf1eb">Params</a></td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#ad9acf3c29ee59e97dd4b0b73d560f382">LRU</a> (const <a class="el" href="classLRU.html#a7817e729934956b9b3573d13924bf1eb">Params</a> *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a611da3810a76e96c8b574845d82b6b8c">~LRU</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a38301abe4b3689f8ac7de5c13a046234">getBlockSize</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#aca3769c95ef908ce22475a69f8929a32">getSubBlockSize</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a11ea27715371eaeb125996e0a9ce14ab">invalidate</a> (<a class="el" href="classCacheBlk.html">BlkType</a> *blk)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCacheBlk.html">BlkType</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a969b41d68459011b652da68b4d5683a9">accessBlock</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr, bool is_secure, <a class="el" href="classCycles.html">Cycles</a> &amp;lat, int context_src)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCacheBlk.html">BlkType</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a0db6e9d80746c5480efcbba5d6be30da">findBlock</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr, bool is_secure) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCacheBlk.html">BlkType</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#ac69a78bca11156aff8773ad59125b55b">findVictim</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a79eef32acfa26685ba4a2f8e89f3f949">insertBlock</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="classCacheBlk.html">BlkType</a> *blk)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a3a855eb5b0d8adbf737f25baa15a3d7b">extractTag</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a8fdcc1372cb0a5d8e1933bdb0bf7d680">extractSet</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#aca82d98193a0685a9648acf6127abb1c">extractBlkOffset</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a73119e914b3b83f88be5bde312855cfe">blkAlign</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a33c16949fb3c73efb61bca4c90195b7d">regenerateBlkAddr</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> tag, unsigned set) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a0239f3ef0ba6cf7c0460b12d289e6517">getHitLatency</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a522e7dda9c2f4eba2cc1c103887d9265">clearLocks</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a1acd4c03e94e57919f1254cc4fa0b059">cleanupRefs</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#ae8a5b5e9e0e6be3b115ee77fa7b4d0c8">print</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a7dd045727ced6181c74934442e2ca33d">computeStats</a> ()</td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;typename V &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">void&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classLRU.html#a2f6fd1256bf2c210092c065ea65b83de">forEachBlk</a> (V &amp;visitor)</td></tr>
<tr><td colspan="2"><h2>Protected 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#abcad7d1df4609a3182779b57fc4120ac">sequentialAccess</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCacheSet.html">SetType</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCacheBlk.html">BlkType</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#aec49d2d4de051250b86595f2ac472d42">dataBlks</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a836015c10ab05e1e7c4be79579a50730">setShift</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a782a405572109567b3a79ac934e91632">tagShift</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#aaac2f20338ad5e01ac8e2354606777ea">setMask</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLRU.html#a7dcd7050ee7dfacdc9057287efbe3aa6">blkMask</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p>A <a class="el" href="classLRU.html">LRU</a> cache tag store. </p>
<dl class="see"><dt><b>参照:</b></dt><dd>gem5 Memory System </dd></dl>
<hr/><h2>型定義</h2>
<a class="anchor" id="a10e9d0cbb622eb6efe1dd332af622902"></a><!-- doxytag: member="LRU::BlkList" ref="a10e9d0cbb622eb6efe1dd332af622902" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="classCacheBlk.html">BlkType</a>*&gt; <a class="el" href="classstd_1_1list.html">BlkList</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Typedef for a list of pointers to the local block class. </p>

</div>
</div>
<a class="anchor" id="a005ef3750319995a4a77bcfeee56e222"></a><!-- doxytag: member="LRU::BlkType" ref="a005ef3750319995a4a77bcfeee56e222" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classCacheBlk.html">CacheBlk</a> <a class="el" href="classCacheBlk.html">BlkType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Typedef the block type used in this tag store. </p>

</div>
</div>
<a class="anchor" id="a7817e729934956b9b3573d13924bf1eb"></a><!-- doxytag: member="LRU::Params" ref="a7817e729934956b9b3573d13924bf1eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef LRUParams <a class="el" href="classLRU.html#a7817e729934956b9b3573d13924bf1eb">Params</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convenience typedef. </p>

<p><a class="el" href="classBaseTags.html#aab33a5313a7ca07c69f8a4e6e1490375">BaseTags</a>を再定義しています。</p>

</div>
</div>
<a class="anchor" id="a3c0e5e439e276493def31913011594ff"></a><!-- doxytag: member="LRU::SetType" ref="a3c0e5e439e276493def31913011594ff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classCacheSet.html">CacheSet</a>&lt;<a class="el" href="classCacheBlk.html">CacheBlk</a>&gt; <a class="el" href="classCacheSet.html">SetType</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Typedef the set type used in this tag store. </p>

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="ad9acf3c29ee59e97dd4b0b73d560f382"></a><!-- doxytag: member="LRU::LRU" ref="ad9acf3c29ee59e97dd4b0b73d560f382" args="(const Params *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLRU.html">LRU</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLRU.html#a7817e729934956b9b3573d13924bf1eb">Params</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Construct and initialize this tag store. </p>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000081">TODO:</a></b></dt><dd>Make warmup percentage a parameter. </dd></dl>
</p>

<p><div class="fragment"><pre class="fragment"><a name="l00060"></a>00060     :<a class="code" href="classBaseTags.html#ae200d65039ec8144c2ec926a52f4fe6f">BaseTags</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>), <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;assoc),
<a name="l00061"></a>00061      <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;size / (<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;block_size * <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;assoc)),
<a name="l00062"></a>00062      <a class="code" href="classLRU.html#abcad7d1df4609a3182779b57fc4120ac">sequentialAccess</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;sequential_access)
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064     <span class="comment">// Check parameters</span>
<a name="l00065"></a>00065     <span class="keywordflow">if</span> (<a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a> &lt; 4 || !<a class="code" href="intmath_8hh.html#aa73a8269f3cc1853f96c7a9210f61f0e">isPowerOf2</a>(<a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>)) {
<a name="l00066"></a>00066         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Block size must be at least 4 and a power of 2&quot;</span>);
<a name="l00067"></a>00067     }
<a name="l00068"></a>00068     <span class="keywordflow">if</span> (<a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> &lt;= 0 || !<a class="code" href="intmath_8hh.html#aa73a8269f3cc1853f96c7a9210f61f0e">isPowerOf2</a>(<a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>)) {
<a name="l00069"></a>00069         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;# of sets must be non-zero and a power of 2&quot;</span>);
<a name="l00070"></a>00070     }
<a name="l00071"></a>00071     <span class="keywordflow">if</span> (<a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a> &lt;= 0) {
<a name="l00072"></a>00072         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;associativity must be greater than zero&quot;</span>);
<a name="l00073"></a>00073     }
<a name="l00074"></a>00074     <span class="keywordflow">if</span> (<a class="code" href="classBaseTags.html#a4075fdc5720f8f0f57c379c396e74718">hitLatency</a> &lt;= 0) {
<a name="l00075"></a>00075         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;access latency must be greater than zero&quot;</span>);
<a name="l00076"></a>00076     }
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <a class="code" href="classLRU.html#a7dcd7050ee7dfacdc9057287efbe3aa6">blkMask</a> = <a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a> - 1;
<a name="l00079"></a>00079     <a class="code" href="classLRU.html#a836015c10ab05e1e7c4be79579a50730">setShift</a> = <a class="code" href="intmath_8hh.html#ad61f5307b84292529da332fee695614e">floorLog2</a>(<a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>);
<a name="l00080"></a>00080     <a class="code" href="classLRU.html#aaac2f20338ad5e01ac8e2354606777ea">setMask</a> = <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> - 1;
<a name="l00081"></a>00081     <a class="code" href="classLRU.html#a782a405572109567b3a79ac934e91632">tagShift</a> = <a class="code" href="classLRU.html#a836015c10ab05e1e7c4be79579a50730">setShift</a> + <a class="code" href="intmath_8hh.html#ad61f5307b84292529da332fee695614e">floorLog2</a>(<a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>);
<a name="l00082"></a>00082     <a class="code" href="classBaseTags.html#a63243e2a441445feb3cf7a36fbaf4673">warmedUp</a> = <span class="keyword">false</span>;
<a name="l00084"></a>00084     <a class="code" href="classBaseTags.html#a34cba5da4dbcf8dec784f2ebf3bcb431">warmupBound</a> = <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> * <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>;
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a> = <span class="keyword">new</span> <a class="code" href="classLRU.html#a3c0e5e439e276493def31913011594ff">SetType</a>[<a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>];
<a name="l00087"></a>00087     <a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a> = <span class="keyword">new</span> <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a>[<a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> * assoc];
<a name="l00088"></a>00088     <span class="comment">// allocate data storage in one big chunk</span>
<a name="l00089"></a>00089     <a class="code" href="classBaseTags.html#af2c745d276c1a795177201764016234c">numBlocks</a> = <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> * assoc;
<a name="l00090"></a>00090     <a class="code" href="classLRU.html#aec49d2d4de051250b86595f2ac472d42">dataBlks</a> = <span class="keyword">new</span> uint8_t[<a class="code" href="classBaseTags.html#af2c745d276c1a795177201764016234c">numBlocks</a> * <a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>];
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <span class="keywordtype">unsigned</span> blkIndex = 0;       <span class="comment">// index into blks array</span>
<a name="l00093"></a>00093     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00094"></a>00094         <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheSet.html#a07d90beac0f56f39fbcff30aea1863d7">assoc</a> = assoc;
<a name="l00095"></a>00095 
<a name="l00096"></a>00096         <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheSet.html#a6e04ed065f754b0b10cbd1edfb239c64">blks</a> = <span class="keyword">new</span> <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a>*[assoc];
<a name="l00097"></a>00097 
<a name="l00098"></a>00098         <span class="comment">// link in the data blocks</span>
<a name="l00099"></a>00099         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; assoc; ++<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>) {
<a name="l00100"></a>00100             <span class="comment">// locate next cache block</span>
<a name="l00101"></a>00101             <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a> *blk = &amp;<a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[blkIndex];
<a name="l00102"></a>00102             blk-&gt;<a class="code" href="classCacheBlk.html#abe222f6d3581e7920dcad5306cc906a8">data</a> = &amp;<a class="code" href="classLRU.html#aec49d2d4de051250b86595f2ac472d42">dataBlks</a>[<a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>*blkIndex];
<a name="l00103"></a>00103             ++blkIndex;
<a name="l00104"></a>00104 
<a name="l00105"></a>00105             <span class="comment">// invalidate new cache block</span>
<a name="l00106"></a>00106             blk-&gt;invalidate();
<a name="l00107"></a>00107 
<a name="l00108"></a>00108             <span class="comment">//EGH Fix Me : do we need to initialize blk?</span>
<a name="l00109"></a>00109 
<a name="l00110"></a>00110             <span class="comment">// Setting the tag to j is just to prevent long chains in the hash</span>
<a name="l00111"></a>00111             <span class="comment">// table; won&apos;t matter because the block is invalid</span>
<a name="l00112"></a>00112             blk-&gt;tag = <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>;
<a name="l00113"></a>00113             blk-&gt;whenReady = 0;
<a name="l00114"></a>00114             blk-&gt;isTouched = <span class="keyword">false</span>;
<a name="l00115"></a>00115             blk-&gt;size = <a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>;
<a name="l00116"></a>00116             <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheSet.html#a6e04ed065f754b0b10cbd1edfb239c64">blks</a>[<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>]=blk;
<a name="l00117"></a>00117             blk-&gt;set = <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00118"></a>00118         }
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a611da3810a76e96c8b574845d82b6b8c"></a><!-- doxytag: member="LRU::~LRU" ref="a611da3810a76e96c8b574845d82b6b8c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classLRU.html">LRU</a> </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Destructor </p>

<p><div class="fragment"><pre class="fragment"><a name="l00123"></a>00123 {
<a name="l00124"></a>00124     <span class="keyword">delete</span> [] <a class="code" href="classLRU.html#aec49d2d4de051250b86595f2ac472d42">dataBlks</a>;
<a name="l00125"></a>00125     <span class="keyword">delete</span> [] <a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>;
<a name="l00126"></a>00126     <span class="keyword">delete</span> [] <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>;
<a name="l00127"></a>00127 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a969b41d68459011b652da68b4d5683a9"></a><!-- doxytag: member="LRU::accessBlock" ref="a969b41d68459011b652da68b4d5683a9" args="(Addr addr, bool is_secure, Cycles &amp;lat, int context_src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCacheBlk.html">LRU::BlkType</a> * accessBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>is_secure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCycles.html">Cycles</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>context_src</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Access block and update replacement data. May not succeed, in which case NULL pointer is returned. This has all the implications of a cache access and should only be used as such. Returns the access latency as a side effect. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address to find. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_secure</em>&nbsp;</td><td>True if the target memory space is secure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>asid</em>&nbsp;</td><td>The address space ID. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>lat</em>&nbsp;</td><td>The access latency. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Pointer to the cache block if found. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00131"></a>00131 {
<a name="l00132"></a>00132     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> tag = <a class="code" href="classLRU.html#a3a855eb5b0d8adbf737f25baa15a3d7b">extractTag</a>(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>);
<a name="l00133"></a>00133     <span class="keywordtype">unsigned</span> <span class="keyword">set</span> = <a class="code" href="classLRU.html#a8fdcc1372cb0a5d8e1933bdb0bf7d680">extractSet</a>(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>);
<a name="l00134"></a>00134     <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a> *blk = <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<span class="keyword">set</span>].<a class="code" href="classCacheSet.html#a0536397551c228605cbb683c0d18971a">findBlk</a>(tag, is_secure);
<a name="l00135"></a>00135     lat = <a class="code" href="classBaseTags.html#a4075fdc5720f8f0f57c379c396e74718">hitLatency</a>;
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="comment">// Access all tags in parallel, hence one in each way.  The data side</span>
<a name="l00138"></a>00138     <span class="comment">// either accesses all blocks in parallel, or one block sequentially on</span>
<a name="l00139"></a>00139     <span class="comment">// a hit.  Sequential access with a miss doesn&apos;t access data.</span>
<a name="l00140"></a>00140     <a class="code" href="group__CacheStatistics.html#ga42eda9fe19a58cfd6ed7aaa7427664e4">tagAccesses</a> += <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>;
<a name="l00141"></a>00141     <span class="keywordflow">if</span> (<a class="code" href="classLRU.html#abcad7d1df4609a3182779b57fc4120ac">sequentialAccess</a>) {
<a name="l00142"></a>00142         <span class="keywordflow">if</span> (blk != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00143"></a>00143             <a class="code" href="group__CacheStatistics.html#gad8dad26f755f9db669fc2b8dab657c0a">dataAccesses</a> += 1;
<a name="l00144"></a>00144         }
<a name="l00145"></a>00145     } <span class="keywordflow">else</span> {
<a name="l00146"></a>00146         <a class="code" href="group__CacheStatistics.html#gad8dad26f755f9db669fc2b8dab657c0a">dataAccesses</a> += <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>;
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="keywordflow">if</span> (blk != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00150"></a>00150         <span class="comment">// move this block to head of the MRU list</span>
<a name="l00151"></a>00151         <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<span class="keyword">set</span>].<a class="code" href="classCacheSet.html#a36bd3b7504969f977b5f5a9c2d2d5413">moveToHead</a>(blk);
<a name="l00152"></a>00152         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(CacheRepl, <span class="stringliteral">&quot;set %x: moving blk %x (%s) to MRU\n&quot;</span>,
<a name="l00153"></a>00153                 <span class="keyword">set</span>, <a class="code" href="classLRU.html#a33c16949fb3c73efb61bca4c90195b7d">regenerateBlkAddr</a>(tag, <span class="keyword">set</span>), is_secure ? <span class="stringliteral">&quot;s&quot;</span> : <span class="stringliteral">&quot;ns&quot;</span>);
<a name="l00154"></a>00154         <span class="keywordflow">if</span> (blk-&gt;whenReady &gt; <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>()
<a name="l00155"></a>00155             &amp;&amp; <a class="code" href="classBaseTags.html#a5cc08dee7231c774489c04728dd5f169">cache</a>-&gt;<a class="code" href="classClockedObject.html#a91cfeb85669839d1ecafb7e62cf9d57a">ticksToCycles</a>(blk-&gt;whenReady - <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>()) &gt; <a class="code" href="classBaseTags.html#a4075fdc5720f8f0f57c379c396e74718">hitLatency</a>) {
<a name="l00156"></a>00156             lat = <a class="code" href="classBaseTags.html#a5cc08dee7231c774489c04728dd5f169">cache</a>-&gt;<a class="code" href="classClockedObject.html#a91cfeb85669839d1ecafb7e62cf9d57a">ticksToCycles</a>(blk-&gt;whenReady - <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158         blk-&gt;refCount += 1;
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="keywordflow">return</span> blk;
<a name="l00162"></a>00162 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a73119e914b3b83f88be5bde312855cfe"></a><!-- doxytag: member="LRU::blkAlign" ref="a73119e914b3b83f88be5bde312855cfe" args="(Addr addr) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> blkAlign </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Align an address to the block size. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>the address to align. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The block address. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00220"></a>00220     {
<a name="l00221"></a>00221         <span class="keywordflow">return</span> (<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> &amp; ~(<a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>)<a class="code" href="classLRU.html#a7dcd7050ee7dfacdc9057287efbe3aa6">blkMask</a>);
<a name="l00222"></a>00222     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1acd4c03e94e57919f1254cc4fa0b059"></a><!-- doxytag: member="LRU::cleanupRefs" ref="a1acd4c03e94e57919f1254cc4fa0b059" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanupRefs </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called at end of simulation to complete average block reference stats. </p>

<p><a class="el" href="classBaseTags.html#aab539ffaf653a007b5326b2042dc8e86">BaseTags</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00291"></a>00291 {
<a name="l00292"></a>00292     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>*<a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00293"></a>00293         <span class="keywordflow">if</span> (<a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].isValid()) {
<a name="l00294"></a>00294             <a class="code" href="group__CacheStatistics.html#gaafe04ce7df5e42da3c45e3991561520e">totalRefs</a> += <a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheBlk.html#a43ab0d8eafd71383b2233bdee65911de">refCount</a>;
<a name="l00295"></a>00295             ++<a class="code" href="group__CacheStatistics.html#ga0b8c102a0e9d83ec69d9ac7ee25b378b">sampledRefs</a>;
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a522e7dda9c2f4eba2cc1c103887d9265"></a><!-- doxytag: member="LRU::clearLocks" ref="a522e7dda9c2f4eba2cc1c103887d9265" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearLocks </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>iterated through all blocks and clear all locks Needed to clear all lock tracking at once </p>

<p><a class="el" href="classBaseTags.html#a9f3e3b80f263780be72db8b9dc53680e">BaseTags</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00261"></a>00261 {
<a name="l00262"></a>00262     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classBaseTags.html#af2c745d276c1a795177201764016234c">numBlocks</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++){
<a name="l00263"></a>00263         <a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheBlk.html#a9e0b822a716ddb1833f6be383be068e7">clearLoadLocks</a>();
<a name="l00264"></a>00264     }
<a name="l00265"></a>00265 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7dd045727ced6181c74934442e2ca33d"></a><!-- doxytag: member="LRU::computeStats" ref="a7dd045727ced6181c74934442e2ca33d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void computeStats </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Called prior to dumping stats to compute task occupancy </p>

<p><a class="el" href="classBaseTags.html#a23fd48fae3a5efe5e8ffbefb54e51c1c">BaseTags</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00302"></a>00302 {
<a name="l00303"></a>00303     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="namespaceContextSwitchTaskId.html#aa8dd388981e62e592eb420a58ab290b7aed1b0e3dbb2efd4067685b0be5b03167">ContextSwitchTaskId::NumTaskId</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00304"></a>00304         <a class="code" href="group__CacheStatistics.html#ga6fa3359c33f65a569c3e2adc8d04dc26">occupanciesTaskId</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = 0;
<a name="l00305"></a>00305         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; 5; ++<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>) {
<a name="l00306"></a>00306             <a class="code" href="group__CacheStatistics.html#gac02dc8ce25ce56af2d9038844ba89d99">ageTaskId</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>] = 0;
<a name="l00307"></a>00307         }
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> * <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00311"></a>00311         <span class="keywordflow">if</span> (<a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].isValid()) {
<a name="l00312"></a>00312             assert(<a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].task_id &lt; ContextSwitchTaskId::NumTaskId);
<a name="l00313"></a>00313             <a class="code" href="group__CacheStatistics.html#ga6fa3359c33f65a569c3e2adc8d04dc26">occupanciesTaskId</a>[<a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheBlk.html#a9956f784c0c9fae2e20cbedeff5decfb">task_id</a>]++;
<a name="l00314"></a>00314             <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> age = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() - blks[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].tickInserted;
<a name="l00315"></a>00315             assert(age &gt;= 0);
<a name="l00316"></a>00316 
<a name="l00317"></a>00317             <span class="keywordtype">int</span> age_index;
<a name="l00318"></a>00318             <span class="keywordflow">if</span> (age / <a class="code" href="namespaceSimClock_1_1Int.html#a5d9982f5170bf420523d942720c32d8c" title="microsecond">SimClock::Int::us</a> &lt; 10) { <span class="comment">// &lt;10us</span>
<a name="l00319"></a>00319                 age_index = 0;
<a name="l00320"></a>00320             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (age / <a class="code" href="namespaceSimClock_1_1Int.html#a5d9982f5170bf420523d942720c32d8c" title="microsecond">SimClock::Int::us</a> &lt; 100) { <span class="comment">// &lt;100us</span>
<a name="l00321"></a>00321                 age_index = 1;
<a name="l00322"></a>00322             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (age / <a class="code" href="namespaceSimClock_1_1Int.html#ac4888dd8ac1c3bbc038feb1b22a411bc" title="millisecond">SimClock::Int::ms</a> &lt; 1) { <span class="comment">// &lt;1ms</span>
<a name="l00323"></a>00323                 age_index = 2;
<a name="l00324"></a>00324             } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (age / <a class="code" href="namespaceSimClock_1_1Int.html#ac4888dd8ac1c3bbc038feb1b22a411bc" title="millisecond">SimClock::Int::ms</a> &lt; 10) { <span class="comment">// &lt;10ms</span>
<a name="l00325"></a>00325                 age_index = 3;
<a name="l00326"></a>00326             } <span class="keywordflow">else</span>
<a name="l00327"></a>00327                 age_index = 4; <span class="comment">// &gt;10ms</span>
<a name="l00328"></a>00328 
<a name="l00329"></a>00329             <a class="code" href="group__CacheStatistics.html#gac02dc8ce25ce56af2d9038844ba89d99">ageTaskId</a>[blks[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].task_id][age_index]++;
<a name="l00330"></a>00330         }
<a name="l00331"></a>00331     }
<a name="l00332"></a>00332 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aca82d98193a0685a9648acf6127abb1c"></a><!-- doxytag: member="LRU::extractBlkOffset" ref="aca82d98193a0685a9648acf6127abb1c" args="(Addr addr) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int extractBlkOffset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the block offset from an address. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address to get the offset of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The block offset. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00210"></a>00210     {
<a name="l00211"></a>00211         <span class="keywordflow">return</span> (<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> &amp; <a class="code" href="classLRU.html#a7dcd7050ee7dfacdc9057287efbe3aa6">blkMask</a>);
<a name="l00212"></a>00212     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8fdcc1372cb0a5d8e1933bdb0bf7d680"></a><!-- doxytag: member="LRU::extractSet" ref="a8fdcc1372cb0a5d8e1933bdb0bf7d680" args="(Addr addr) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int extractSet </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculate the set index from the address. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address to get the set from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The set index of the address. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00200"></a>00200     {
<a name="l00201"></a>00201         <span class="keywordflow">return</span> ((<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> &gt;&gt; <a class="code" href="classLRU.html#a836015c10ab05e1e7c4be79579a50730">setShift</a>) &amp; <a class="code" href="classLRU.html#aaac2f20338ad5e01ac8e2354606777ea">setMask</a>);
<a name="l00202"></a>00202     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a855eb5b0d8adbf737f25baa15a3d7b"></a><!-- doxytag: member="LRU::extractTag" ref="a3a855eb5b0d8adbf737f25baa15a3d7b" args="(Addr addr) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> extractTag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generate the tag from the given address. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address to get the tag from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The tag of the address. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00190"></a>00190     {
<a name="l00191"></a>00191         <span class="keywordflow">return</span> (<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> &gt;&gt; <a class="code" href="classLRU.html#a782a405572109567b3a79ac934e91632">tagShift</a>);
<a name="l00192"></a>00192     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0db6e9d80746c5480efcbba5d6be30da"></a><!-- doxytag: member="LRU::findBlock" ref="a0db6e9d80746c5480efcbba5d6be30da" args="(Addr addr, bool is_secure) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCacheBlk.html">LRU::BlkType</a> * findBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>is_secure</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Finds the given address in the cache, do not update replacement data. i.e. This is a no-side-effect find of a block. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The address to find. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_secure</em>&nbsp;</td><td>True if the target memory space is secure. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>asid</em>&nbsp;</td><td>The address space ID. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Pointer to the cache block if found. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00167"></a>00167 {
<a name="l00168"></a>00168     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> tag = <a class="code" href="classLRU.html#a3a855eb5b0d8adbf737f25baa15a3d7b">extractTag</a>(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>);
<a name="l00169"></a>00169     <span class="keywordtype">unsigned</span> <span class="keyword">set</span> = <a class="code" href="classLRU.html#a8fdcc1372cb0a5d8e1933bdb0bf7d680">extractSet</a>(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>);
<a name="l00170"></a>00170     <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a> *blk = <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<span class="keyword">set</span>].<a class="code" href="classCacheSet.html#a0536397551c228605cbb683c0d18971a">findBlk</a>(tag, is_secure);
<a name="l00171"></a>00171     <span class="keywordflow">return</span> blk;
<a name="l00172"></a>00172 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac69a78bca11156aff8773ad59125b55b"></a><!-- doxytag: member="LRU::findVictim" ref="ac69a78bca11156aff8773ad59125b55b" args="(Addr addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCacheBlk.html">LRU::BlkType</a> * findVictim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find a block to evict for the address provided. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>addr</em>&nbsp;</td><td>The addr to a find a replacement candidate for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The candidate block. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00176"></a>00176 {
<a name="l00177"></a>00177     <span class="keywordtype">unsigned</span> <span class="keyword">set</span> = <a class="code" href="classLRU.html#a8fdcc1372cb0a5d8e1933bdb0bf7d680">extractSet</a>(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>);
<a name="l00178"></a>00178     <span class="comment">// grab a replacement candidate</span>
<a name="l00179"></a>00179     <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a> *blk = <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<span class="keyword">set</span>].<a class="code" href="classCacheSet.html#a6e04ed065f754b0b10cbd1edfb239c64">blks</a>[<a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>-1];
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <span class="keywordflow">if</span> (blk-&gt;isValid()) {
<a name="l00182"></a>00182         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(CacheRepl, <span class="stringliteral">&quot;set %x: selecting blk %x for replacement\n&quot;</span>,
<a name="l00183"></a>00183                 <span class="keyword">set</span>, <a class="code" href="classLRU.html#a33c16949fb3c73efb61bca4c90195b7d">regenerateBlkAddr</a>(blk-&gt;tag, <span class="keyword">set</span>));
<a name="l00184"></a>00184     }
<a name="l00185"></a>00185     <span class="keywordflow">return</span> blk;
<a name="l00186"></a>00186 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2f6fd1256bf2c210092c065ea65b83de"></a><!-- doxytag: member="LRU::forEachBlk" ref="a2f6fd1256bf2c210092c065ea65b83de" args="(V &amp;visitor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void forEachBlk </td>
          <td>(</td>
          <td class="paramtype">V &amp;&nbsp;</td>
          <td class="paramname"> <em>visitor</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Visit each block in the tag store and apply a visitor to the block.</p>
<p>The visitor should be a function (or object that behaves like a function) that takes a cache block reference as its parameter and returns a bool. A visitor can request the traversal to be stopped by returning false, returning true causes it to be called for the next block in the tag store.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>visitor</em>&nbsp;</td><td>Visitor to call on each block. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00277"></a>00277                                 {
<a name="l00278"></a>00278         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a> * <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00279"></a>00279             <span class="keywordflow">if</span> (!visitor(<a class="code" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]))
<a name="l00280"></a>00280                 <span class="keywordflow">return</span>;
<a name="l00281"></a>00281         }
<a name="l00282"></a>00282     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a38301abe4b3689f8ac7de5c13a046234"></a><!-- doxytag: member="LRU::getBlockSize" ref="a38301abe4b3689f8ac7de5c13a046234" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned getBlockSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the block size. </p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>the block size. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00125"></a>00125     {
<a name="l00126"></a>00126         <span class="keywordflow">return</span> <a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>;
<a name="l00127"></a>00127     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0239f3ef0ba6cf7c0460b12d289e6517"></a><!-- doxytag: member="LRU::getHitLatency" ref="a0239f3ef0ba6cf7c0460b12d289e6517" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> getHitLatency </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the hit latency. </p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>the hit latency. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00240"></a>00240     {
<a name="l00241"></a>00241         <span class="keywordflow">return</span> <a class="code" href="classBaseTags.html#a4075fdc5720f8f0f57c379c396e74718">hitLatency</a>;
<a name="l00242"></a>00242     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aca3769c95ef908ce22475a69f8929a32"></a><!-- doxytag: member="LRU::getSubBlockSize" ref="aca3769c95ef908ce22475a69f8929a32" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned getSubBlockSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Return the subblock size. In the case of <a class="el" href="classLRU.html">LRU</a> it is always the block size. </p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The block size. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00136"></a>00136     {
<a name="l00137"></a>00137         <span class="keywordflow">return</span> <a class="code" href="classBaseTags.html#a87b03496724866a3daf3e8ebeb831290">blkSize</a>;
<a name="l00138"></a>00138     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a79eef32acfa26685ba4a2f8e89f3f949"></a><!-- doxytag: member="LRU::insertBlock" ref="a79eef32acfa26685ba4a2f8e89f3f949" args="(PacketPtr pkt, BlkType *blk)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insertBlock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCacheBlk.html">BlkType</a> *&nbsp;</td>
          <td class="paramname"> <em>blk</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Insert the new block into the cache. For <a class="el" href="classLRU.html">LRU</a> this means inserting into the MRU position of the set. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td><a class="el" href="classPacket.html">Packet</a> holding the address to update </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>blk</em>&nbsp;</td><td>The block to update. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00190"></a>00190 {
<a name="l00191"></a>00191     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> = pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>();
<a name="l00192"></a>00192     <a class="code" href="request_8hh.html#ac366b729262fd8e7cbd3283da6f775cf">MasterID</a> master_id = pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#a9b7d32db0521388c0953e531c79aab50">masterId</a>();
<a name="l00193"></a>00193     <a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> task_id = pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#a7abf15d67b3fbd53236fde58eecb3f34">taskId</a>();
<a name="l00194"></a>00194     <span class="keywordtype">bool</span> is_secure = pkt-&gt;<a class="code" href="classPacket.html#a3110ebf17828782ae5aeced7396cfff2">isSecure</a>();
<a name="l00195"></a>00195     <span class="keywordflow">if</span> (!blk-&gt;isTouched) {
<a name="l00196"></a>00196         <a class="code" href="group__CacheStatistics.html#gac47f8631e7a5c6ca2d7bdc4a3385ef5c">tagsInUse</a>++;
<a name="l00197"></a>00197         blk-&gt;isTouched = <span class="keyword">true</span>;
<a name="l00198"></a>00198         <span class="keywordflow">if</span> (!<a class="code" href="classBaseTags.html#a63243e2a441445feb3cf7a36fbaf4673">warmedUp</a> &amp;&amp; <a class="code" href="group__CacheStatistics.html#gac47f8631e7a5c6ca2d7bdc4a3385ef5c">tagsInUse</a>.<a class="code" href="classStats_1_1ScalarBase.html#aa9e486cb7eb0ad44f5f89923594b68a4">value</a>() &gt;= <a class="code" href="classBaseTags.html#a34cba5da4dbcf8dec784f2ebf3bcb431">warmupBound</a>) {
<a name="l00199"></a>00199             <a class="code" href="classBaseTags.html#a63243e2a441445feb3cf7a36fbaf4673">warmedUp</a> = <span class="keyword">true</span>;
<a name="l00200"></a>00200             <a class="code" href="group__CacheStatistics.html#ga2607cf0f839148422c1a78a9e21e2c29">warmupCycle</a> = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00201"></a>00201         }
<a name="l00202"></a>00202     }
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     <span class="comment">// If we&apos;re replacing a block that was previously valid update</span>
<a name="l00205"></a>00205     <span class="comment">// stats for it. This can&apos;t be done in findBlock() because a</span>
<a name="l00206"></a>00206     <span class="comment">// found block might not actually be replaced there if the</span>
<a name="l00207"></a>00207     <span class="comment">// coherence protocol says it can&apos;t be.</span>
<a name="l00208"></a>00208     <span class="keywordflow">if</span> (blk-&gt;isValid()) {
<a name="l00209"></a>00209         <a class="code" href="group__CacheStatistics.html#gabe49d967160cb4f2808c2374eada5cbd">replacements</a>[0]++;
<a name="l00210"></a>00210         <a class="code" href="group__CacheStatistics.html#gaafe04ce7df5e42da3c45e3991561520e">totalRefs</a> += blk-&gt;refCount;
<a name="l00211"></a>00211         ++<a class="code" href="group__CacheStatistics.html#ga0b8c102a0e9d83ec69d9ac7ee25b378b">sampledRefs</a>;
<a name="l00212"></a>00212         blk-&gt;refCount = 0;
<a name="l00213"></a>00213 
<a name="l00214"></a>00214         <span class="comment">// deal with evicted block</span>
<a name="l00215"></a>00215         assert(blk-&gt;srcMasterId &lt; <a class="code" href="classBaseTags.html#a5cc08dee7231c774489c04728dd5f169">cache</a>-&gt;<a class="code" href="classBaseCache.html#af27ccd765f13a4b7bd119dc7579e2746">system</a>-&gt;<a class="code" href="classSystem.html#a4cd916c36458ce47e9ba4ccbfc75a095">maxMasters</a>());
<a name="l00216"></a>00216         <a class="code" href="group__CacheStatistics.html#ga5626c7c93bb670e27e205ceba0240361">occupancies</a>[blk-&gt;srcMasterId]--;
<a name="l00217"></a>00217 
<a name="l00218"></a>00218         blk-&gt;invalidate();
<a name="l00219"></a>00219     }
<a name="l00220"></a>00220 
<a name="l00221"></a>00221     blk-&gt;isTouched = <span class="keyword">true</span>;
<a name="l00222"></a>00222     <span class="comment">// Set tag for new block.  Caller is responsible for setting status.</span>
<a name="l00223"></a>00223     blk-&gt;tag = <a class="code" href="classLRU.html#a3a855eb5b0d8adbf737f25baa15a3d7b">extractTag</a>(addr);
<a name="l00224"></a>00224     <span class="keywordflow">if</span> (is_secure)
<a name="l00225"></a>00225         blk-&gt;status |= <a class="code" href="blk_8hh.html#aba0f973471df5d3edb783ecd63fe51f7ae61b87ec40871a2ddb384c14fc1e46e2">BlkSecure</a>;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     <span class="comment">// deal with what we are bringing in</span>
<a name="l00228"></a>00228     assert(master_id &lt; cache-&gt;<a class="code" href="namespaceX86ISA.html#a400778a664a4822401bb6677e1cef9c3">system</a>-&gt;maxMasters());
<a name="l00229"></a>00229     occupancies[master_id]++;
<a name="l00230"></a>00230     blk-&gt;srcMasterId = master_id;
<a name="l00231"></a>00231     blk-&gt;task_id = task_id;
<a name="l00232"></a>00232     blk-&gt;tickInserted = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00233"></a>00233 
<a name="l00234"></a>00234     <span class="keywordtype">unsigned</span> <span class="keyword">set</span> = <a class="code" href="classLRU.html#a8fdcc1372cb0a5d8e1933bdb0bf7d680">extractSet</a>(addr);
<a name="l00235"></a>00235     <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<span class="keyword">set</span>].<a class="code" href="classCacheSet.html#a36bd3b7504969f977b5f5a9c2d2d5413">moveToHead</a>(blk);
<a name="l00236"></a>00236 
<a name="l00237"></a>00237     <span class="comment">// We only need to write into one tag and one data block.</span>
<a name="l00238"></a>00238     <a class="code" href="group__CacheStatistics.html#ga42eda9fe19a58cfd6ed7aaa7427664e4">tagAccesses</a> += 1;
<a name="l00239"></a>00239     <a class="code" href="group__CacheStatistics.html#gad8dad26f755f9db669fc2b8dab657c0a">dataAccesses</a> += 1;
<a name="l00240"></a>00240 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a11ea27715371eaeb125996e0a9ce14ab"></a><!-- doxytag: member="LRU::invalidate" ref="a11ea27715371eaeb125996e0a9ce14ab" args="(BlkType *blk)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void invalidate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCacheBlk.html">BlkType</a> *&nbsp;</td>
          <td class="paramname"> <em>blk</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Invalidate the given block. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>blk</em>&nbsp;</td><td>The block to invalidate. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00244"></a>00244 {
<a name="l00245"></a>00245     assert(blk);
<a name="l00246"></a>00246     assert(blk-&gt;isValid());
<a name="l00247"></a>00247     <a class="code" href="group__CacheStatistics.html#gac47f8631e7a5c6ca2d7bdc4a3385ef5c">tagsInUse</a>--;
<a name="l00248"></a>00248     assert(blk-&gt;srcMasterId &lt; <a class="code" href="classBaseTags.html#a5cc08dee7231c774489c04728dd5f169">cache</a>-&gt;<a class="code" href="classBaseCache.html#af27ccd765f13a4b7bd119dc7579e2746">system</a>-&gt;<a class="code" href="classSystem.html#a4cd916c36458ce47e9ba4ccbfc75a095">maxMasters</a>());
<a name="l00249"></a>00249     <a class="code" href="group__CacheStatistics.html#ga5626c7c93bb670e27e205ceba0240361">occupancies</a>[blk-&gt;srcMasterId]--;
<a name="l00250"></a>00250     blk-&gt;srcMasterId = <a class="code" href="classRequest.html#a1bb5b2ea96370ac4071dbe85cc9883c8">Request::invldMasterId</a>;
<a name="l00251"></a>00251     blk-&gt;task_id = <a class="code" href="namespaceContextSwitchTaskId.html#aa8dd388981e62e592eb420a58ab290b7a4e81c184ac3ad48a389cd4454c4a05bb">ContextSwitchTaskId::Unknown</a>;
<a name="l00252"></a>00252     blk-&gt;tickInserted = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00253"></a>00253 
<a name="l00254"></a>00254     <span class="comment">// should be evicted before valid blocks</span>
<a name="l00255"></a>00255     <span class="keywordtype">unsigned</span> <span class="keyword">set</span> = blk-&gt;set;
<a name="l00256"></a>00256     <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<span class="keyword">set</span>].<a class="code" href="classCacheSet.html#abac25ca30812f3e15af829d389845946">moveToTail</a>(blk);
<a name="l00257"></a>00257 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae8a5b5e9e0e6be3b115ee77fa7b4d0c8"></a><!-- doxytag: member="LRU::print" ref="ae8a5b5e9e0e6be3b115ee77fa7b4d0c8" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string print </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Print all tags used </p>

<p><a class="el" href="classBaseTags.html#a56a7c10391fb704ea26efc16f4f4f87b">BaseTags</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00273"></a>00273                  {
<a name="l00274"></a>00274     std::string cache_state;
<a name="l00275"></a>00275     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00276"></a>00276         <span class="comment">// link in the data blocks</span>
<a name="l00277"></a>00277         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; <a class="code" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a>; ++<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>) {
<a name="l00278"></a>00278             <a class="code" href="classLRU.html#a005ef3750319995a4a77bcfeee56e222">BlkType</a> *blk = <a class="code" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].<a class="code" href="classCacheSet.html#a6e04ed065f754b0b10cbd1edfb239c64">blks</a>[<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>];
<a name="l00279"></a>00279             <span class="keywordflow">if</span> (blk-&gt;isValid())
<a name="l00280"></a>00280                 cache_state += <a class="code" href="cprintf_8hh.html#ace22d1c39f2df58e593bc49d1613eca2">csprintf</a>(<span class="stringliteral">&quot;\tset: %d block: %d %s\n&quot;</span>, <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>, <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>,
<a name="l00281"></a>00281                         blk-&gt;print());
<a name="l00282"></a>00282         }
<a name="l00283"></a>00283     }
<a name="l00284"></a>00284     <span class="keywordflow">if</span> (cache_state.empty())
<a name="l00285"></a>00285         cache_state = <span class="stringliteral">&quot;no valid tags\n&quot;</span>;
<a name="l00286"></a>00286     <span class="keywordflow">return</span> cache_state;
<a name="l00287"></a>00287 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a33c16949fb3c73efb61bca4c90195b7d"></a><!-- doxytag: member="LRU::regenerateBlkAddr" ref="a33c16949fb3c73efb61bca4c90195b7d" args="(Addr tag, unsigned set) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> regenerateBlkAddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>tag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>set</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Regenerate the block address from the tag. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>tag</em>&nbsp;</td><td>The tag of the block. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>set</em>&nbsp;</td><td>The set of the block. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The block address. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00231"></a>00231     {
<a name="l00232"></a>00232         <span class="keywordflow">return</span> ((tag &lt;&lt; <a class="code" href="classLRU.html#a782a405572109567b3a79ac934e91632">tagShift</a>) | ((<a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>)<span class="keyword">set</span> &lt;&lt; <a class="code" href="classLRU.html#a836015c10ab05e1e7c4be79579a50730">setShift</a>));
<a name="l00233"></a>00233     }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="accc9cc9a48a59881735c6aab4afc3ceb"></a><!-- doxytag: member="LRU::assoc" ref="accc9cc9a48a59881735c6aab4afc3ceb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned <a class="el" href="classLRU.html#accc9cc9a48a59881735c6aab4afc3ceb">assoc</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The associativity of the cache. </p>

</div>
</div>
<a class="anchor" id="a7dcd7050ee7dfacdc9057287efbe3aa6"></a><!-- doxytag: member="LRU::blkMask" ref="a7dcd7050ee7dfacdc9057287efbe3aa6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLRU.html#a7dcd7050ee7dfacdc9057287efbe3aa6">blkMask</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mask out all bits that aren't part of the block offset. </p>

</div>
</div>
<a class="anchor" id="adf78a0a96f176dd1b76d59906eda0c7d"></a><!-- doxytag: member="LRU::blks" ref="adf78a0a96f176dd1b76d59906eda0c7d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCacheBlk.html">BlkType</a>* <a class="el" href="classLRU.html#adf78a0a96f176dd1b76d59906eda0c7d">blks</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The cache blocks. </p>

</div>
</div>
<a class="anchor" id="aec49d2d4de051250b86595f2ac472d42"></a><!-- doxytag: member="LRU::dataBlks" ref="aec49d2d4de051250b86595f2ac472d42" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t* <a class="el" href="classLRU.html#aec49d2d4de051250b86595f2ac472d42">dataBlks</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The data blocks, 1 per cache block. </p>

</div>
</div>
<a class="anchor" id="a5fd82580355559fd0c858de6292f3bb7"></a><!-- doxytag: member="LRU::numSets" ref="a5fd82580355559fd0c858de6292f3bb7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned <a class="el" href="classLRU.html#a5fd82580355559fd0c858de6292f3bb7">numSets</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The number of sets in the cache. </p>

</div>
</div>
<a class="anchor" id="abcad7d1df4609a3182779b57fc4120ac"></a><!-- doxytag: member="LRU::sequentialAccess" ref="abcad7d1df4609a3182779b57fc4120ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const bool <a class="el" href="classLRU.html#abcad7d1df4609a3182779b57fc4120ac">sequentialAccess</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Whether tags and data are accessed sequentially. </p>

</div>
</div>
<a class="anchor" id="aaac2f20338ad5e01ac8e2354606777ea"></a><!-- doxytag: member="LRU::setMask" ref="aaac2f20338ad5e01ac8e2354606777ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLRU.html#aaac2f20338ad5e01ac8e2354606777ea">setMask</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mask out all bits that aren't part of the set index. </p>

</div>
</div>
<a class="anchor" id="af644b16f4706597c8192621b8c58e2ed"></a><!-- doxytag: member="LRU::sets" ref="af644b16f4706597c8192621b8c58e2ed" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCacheSet.html">SetType</a>* <a class="el" href="classLRU.html#af644b16f4706597c8192621b8c58e2ed">sets</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The cache sets. </p>

</div>
</div>
<a class="anchor" id="a836015c10ab05e1e7c4be79579a50730"></a><!-- doxytag: member="LRU::setShift" ref="a836015c10ab05e1e7c4be79579a50730" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classLRU.html#a836015c10ab05e1e7c4be79579a50730">setShift</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The amount to shift the address to get the set. </p>

</div>
</div>
<a class="anchor" id="a782a405572109567b3a79ac934e91632"></a><!-- doxytag: member="LRU::tagShift" ref="a782a405572109567b3a79ac934e91632" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classLRU.html#a782a405572109567b3a79ac934e91632">tagShift</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The amount to shift the address to get the tag. </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>mem/cache/tags/<a class="el" href="lru_8hh_source.html">lru.hh</a></li>
<li>mem/cache/tags/<a class="el" href="lru_8cc.html">lru.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
