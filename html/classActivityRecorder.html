<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス ActivityRecorder</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス ActivityRecorder</h1><!-- doxytag: class="ActivityRecorder" -->
<p><code>#include &lt;<a class="el" href="activity_8hh_source.html">activity.hh</a>&gt;</code></p>

<p><a href="classActivityRecorder-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#aee994d49a31bd533aa152dfeb18c7b2d">ActivityRecorder</a> (const std::string &amp;name, int num_stages, int longest_latency, int count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a72527148fb233d9e5a0d887becb03458">~ActivityRecorder</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a0ea760b87a5516ee794818d5eb8c243d">activity</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a8903a4e9f3d5fb42d0faa9d53e21d85c">advance</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a9039dad8d295c41b50eba0342e6c11c0">activateStage</a> (const int idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a4d73bea02eaf6f93e267391592556fe7">deactivateStage</a> (const int idx)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a918c8f58bd15e33d7d44a37109a868e4">getStageActive</a> (const int idx) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#aabc85525e8d2526f4a909313fcb9bfa2">getNumStages</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a24e9ead78b85428639a9e76329ecd0b7">getActivityCount</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a562d654f23b8a293deda98e8d585973f">setActivityCount</a> (int count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a0cb3050c8a4f6bdb2c1f727eec8d9701">active</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#ad20897c5c8bd47f5d4005989bead0e55">reset</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#accd2600060dbaee3a3b41aed4034c63c">dump</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a41d45236c37b75848f4b1667a11fb50e">validate</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::string &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a324e8c54c4c5161913681a1a52fef959">name</a> () const </td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#aaf2ed934b37cbbd236fdd1b01a5f5005">_name</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; bool &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#a20bd7fb0de8433f0f95dc50ed74bf620">longestLatency</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#aaf4f71ec3fd6f4e154d09cd71c2c331b">numStages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p><a class="el" href="classActivityRecorder.html">ActivityRecorder</a> helper class that informs the CPU if it can switch over to being idle or not. It works by having a time buffer as long as any time buffer in the CPU, and the CPU and all of its stages inform the <a class="el" href="classActivityRecorder.html">ActivityRecorder</a> when they write to any time buffer. The <a class="el" href="classActivityRecorder.html">ActivityRecorder</a> marks a 1 in the "0" slot of the time buffer any time a stage writes to a time buffer, and it advances its time buffer at the same time as all other stages. The <a class="el" href="classActivityRecorder.html">ActivityRecorder</a> also records if a stage has activity to do next cycle. The recorder keeps a count of these two. Thus any time the count is non-zero, there is either communication still in flight, or activity that still must be done, meaning that the CPU can not idle. If count is zero, then the CPU can safely idle as it has no more outstanding work to do. </p>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="aee994d49a31bd533aa152dfeb18c7b2d"></a><!-- doxytag: member="ActivityRecorder::ActivityRecorder" ref="aee994d49a31bd533aa152dfeb18c7b2d" args="(const std::string &amp;name, int num_stages, int longest_latency, int count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classActivityRecorder.html">ActivityRecorder</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>num_stages</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>longest_latency</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a72527148fb233d9e5a0d887becb03458"></a><!-- doxytag: member="ActivityRecorder::~ActivityRecorder" ref="a72527148fb233d9e5a0d887becb03458" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classActivityRecorder.html">ActivityRecorder</a> </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00050"></a>00050 {
<a name="l00051"></a>00051     <span class="keyword">delete</span>[] <a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>;
<a name="l00052"></a>00052 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a9039dad8d295c41b50eba0342e6c11c0"></a><!-- doxytag: member="ActivityRecorder::activateStage" ref="a9039dad8d295c41b50eba0342e6c11c0" args="(const int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void activateStage </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Marks a stage as active. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00092"></a>00092 {
<a name="l00093"></a>00093     <span class="comment">// Increment the activity count if this stage wasn&apos;t already active.</span>
<a name="l00094"></a>00094     <span class="keywordflow">if</span> (!<a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[idx]) {
<a name="l00095"></a>00095         ++<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>;
<a name="l00096"></a>00096 
<a name="l00097"></a>00097         <a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[idx] = <span class="keyword">true</span>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity: %i\n&quot;</span>, <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>);
<a name="l00100"></a>00100     } <span class="keywordflow">else</span> {
<a name="l00101"></a>00101         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Stage %i already active.\n&quot;</span>, idx);
<a name="l00102"></a>00102     }
<a name="l00103"></a>00103 
<a name="l00104"></a>00104 <span class="comment">//    assert(activityCount &lt; longestLatency + numStages + 1);</span>
<a name="l00105"></a>00105 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0cb3050c8a4f6bdb2c1f727eec8d9701"></a><!-- doxytag: member="ActivityRecorder::active" ref="a0cb3050c8a4f6bdb2c1f727eec8d9701" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool active </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns if the CPU should be active. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00090"></a>00090 { <span class="keywordflow">return</span> <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0ea760b87a5516ee794818d5eb8c243d"></a><!-- doxytag: member="ActivityRecorder::activity" ref="a0ea760b87a5516ee794818d5eb8c243d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void activity </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Records that there is activity this cycle. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00056"></a>00056 {
<a name="l00057"></a>00057     <span class="comment">// If we&apos;ve already recorded activity for this cycle, we don&apos;t</span>
<a name="l00058"></a>00058     <span class="comment">// want to increment the count any more.</span>
<a name="l00059"></a>00059     <span class="keywordflow">if</span> (<a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>[0]) {
<a name="l00060"></a>00060         <span class="keywordflow">return</span>;
<a name="l00061"></a>00061     }
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>[0] = <span class="keyword">true</span>;
<a name="l00064"></a>00064 
<a name="l00065"></a>00065     ++<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>;
<a name="l00066"></a>00066 
<a name="l00067"></a>00067     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity: %i\n&quot;</span>, <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>);
<a name="l00068"></a>00068 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8903a4e9f3d5fb42d0faa9d53e21d85c"></a><!-- doxytag: member="ActivityRecorder::advance" ref="a8903a4e9f3d5fb42d0faa9d53e21d85c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void advance </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Advances the activity buffer, decrementing the activityCount if active communication just left the time buffer, and determining if there is no activity. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00072"></a>00072 {
<a name="l00073"></a>00073     <span class="comment">// If there&apos;s a 1 in the slot that is about to be erased once the</span>
<a name="l00074"></a>00074     <span class="comment">// time buffer advances, then decrement the activityCount.</span>
<a name="l00075"></a>00075     <span class="keywordflow">if</span> (<a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>[-<a class="code" href="classActivityRecorder.html#a20bd7fb0de8433f0f95dc50ed74bf620">longestLatency</a>]) {
<a name="l00076"></a>00076         --<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078         assert(<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a> &gt;= 0);
<a name="l00079"></a>00079 
<a name="l00080"></a>00080         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity: %i\n&quot;</span>, <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082         <span class="keywordflow">if</span> (<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a> == 0) {
<a name="l00083"></a>00083             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;No activity left!\n&quot;</span>);
<a name="l00084"></a>00084         }
<a name="l00085"></a>00085     }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     <a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>.<a class="code" href="classTimeBuffer.html#a8903a4e9f3d5fb42d0faa9d53e21d85c">advance</a>();
<a name="l00088"></a>00088 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4d73bea02eaf6f93e267391592556fe7"></a><!-- doxytag: member="ActivityRecorder::deactivateStage" ref="a4d73bea02eaf6f93e267391592556fe7" args="(const int idx)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void deactivateStage </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Deactivates a stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00109"></a>00109 {
<a name="l00110"></a>00110     <span class="comment">// Decrement the activity count if this stage was active.</span>
<a name="l00111"></a>00111     <span class="keywordflow">if</span> (<a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[idx]) {
<a name="l00112"></a>00112         --<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[idx] = <span class="keyword">false</span>;
<a name="l00115"></a>00115 
<a name="l00116"></a>00116         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity: %i\n&quot;</span>, <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>);
<a name="l00117"></a>00117     } <span class="keywordflow">else</span> {
<a name="l00118"></a>00118         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Stage %i already inactive.\n&quot;</span>, idx);
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120 
<a name="l00121"></a>00121     assert(<a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a> &gt;= 0);
<a name="l00122"></a>00122 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="accd2600060dbaee3a3b41aed4034c63c"></a><!-- doxytag: member="ActivityRecorder::dump" ref="accd2600060dbaee3a3b41aed4034c63c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dump </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="namespaceDebug.html">Debug</a> function to dump the contents of the time buffer. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00135"></a>00135 {
<a name="l00136"></a>00136     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt;= <a class="code" href="classActivityRecorder.html#a20bd7fb0de8433f0f95dc50ed74bf620">longestLatency</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00137"></a>00137         <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;[Idx:%i %i] &quot;</span>, <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>, <a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>[-<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]);
<a name="l00138"></a>00138     }
<a name="l00139"></a>00139 
<a name="l00140"></a>00140     <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classActivityRecorder.html#aaf4f71ec3fd6f4e154d09cd71c2c331b">numStages</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00143"></a>00143         <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;[Stage:%i %i]\n&quot;</span>, <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>, <a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]);
<a name="l00144"></a>00144     }
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;\n&quot;</span>);
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;Activity count: %i\n&quot;</span>, <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>);
<a name="l00149"></a>00149 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a24e9ead78b85428639a9e76329ecd0b7"></a><!-- doxytag: member="ActivityRecorder::getActivityCount" ref="a24e9ead78b85428639a9e76329ecd0b7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getActivityCount </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns how many things are active within the recorder. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081 { <span class="keywordflow">return</span> <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aabc85525e8d2526f4a909313fcb9bfa2"></a><!-- doxytag: member="ActivityRecorder::getNumStages" ref="aabc85525e8d2526f4a909313fcb9bfa2" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getNumStages </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the number of stages. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00078"></a>00078 { <span class="keywordflow">return</span> <a class="code" href="classActivityRecorder.html#aaf4f71ec3fd6f4e154d09cd71c2c331b">numStages</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a918c8f58bd15e33d7d44a37109a868e4"></a><!-- doxytag: member="ActivityRecorder::getStageActive" ref="a918c8f58bd15e33d7d44a37109a868e4" args="(const int idx) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool getStageActive </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>idx</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the activity status of a stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00075"></a>00075 { <span class="keywordflow">return</span> <a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[idx]; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a324e8c54c4c5161913681a1a52fef959"></a><!-- doxytag: member="ActivityRecorder::name" ref="a324e8c54c4c5161913681a1a52fef959" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string&amp; name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00103"></a>00103 { <span class="keywordflow">return</span> <a class="code" href="classActivityRecorder.html#aaf2ed934b37cbbd236fdd1b01a5f5005">_name</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad20897c5c8bd47f5d4005989bead0e55"></a><!-- doxytag: member="ActivityRecorder::reset" ref="ad20897c5c8bd47f5d4005989bead0e55" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clears the time buffer and the activity count. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00126"></a>00126 {
<a name="l00127"></a>00127     <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a> = 0;
<a name="l00128"></a>00128     std::memset(<a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>, 0, <a class="code" href="classActivityRecorder.html#aaf4f71ec3fd6f4e154d09cd71c2c331b">numStages</a>);
<a name="l00129"></a>00129     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classActivityRecorder.html#a20bd7fb0de8433f0f95dc50ed74bf620">longestLatency</a> + 1; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>)
<a name="l00130"></a>00130         <a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>.<a class="code" href="classTimeBuffer.html#a8903a4e9f3d5fb42d0faa9d53e21d85c">advance</a>();
<a name="l00131"></a>00131 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a562d654f23b8a293deda98e8d585973f"></a><!-- doxytag: member="ActivityRecorder::setActivityCount" ref="a562d654f23b8a293deda98e8d585973f" args="(int count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setActivityCount </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>count</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the count to a starting value. Can be used to disable the idling option. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00087"></a>00087     { <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a> = <a class="code" href="namespaceX86ISA.html#a668f84c330035fdb72824eb18e09cd09">count</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a41d45236c37b75848f4b1667a11fb50e"></a><!-- doxytag: member="ActivityRecorder::validate" ref="a41d45236c37b75848f4b1667a11fb50e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void validate </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="namespaceDebug.html">Debug</a> function to ensure that the activity count matches the contents of the time buffer. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00153"></a>00153 {
<a name="l00154"></a>00154     <span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#a668f84c330035fdb72824eb18e09cd09">count</a> = 0;
<a name="l00155"></a>00155     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt;= <a class="code" href="classActivityRecorder.html#a20bd7fb0de8433f0f95dc50ed74bf620">longestLatency</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00156"></a>00156         <span class="keywordflow">if</span> (<a class="code" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a>[-<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]) {
<a name="l00157"></a>00157             count++;
<a name="l00158"></a>00158         }
<a name="l00159"></a>00159     }
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classActivityRecorder.html#aaf4f71ec3fd6f4e154d09cd71c2c331b">numStages</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00162"></a>00162         <span class="keywordflow">if</span> (<a class="code" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]) {
<a name="l00163"></a>00163             count++;
<a name="l00164"></a>00164         }
<a name="l00165"></a>00165     }
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     assert(count == <a class="code" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a>);
<a name="l00168"></a>00168 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="aaf2ed934b37cbbd236fdd1b01a5f5005"></a><!-- doxytag: member="ActivityRecorder::_name" ref="aaf2ed934b37cbbd236fdd1b01a5f5005" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classActivityRecorder.html#aaf2ed934b37cbbd236fdd1b01a5f5005">_name</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6c508a89a541285053c7b900bd730cc2"></a><!-- doxytag: member="ActivityRecorder::activityBuffer" ref="a6c508a89a541285053c7b900bd730cc2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;bool&gt; <a class="el" href="classActivityRecorder.html#a6c508a89a541285053c7b900bd730cc2">activityBuffer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classTime.html">Time</a> buffer that tracks if any cycles has active communication in them. It should be as long as the longest communication latency in the system. Each time any time buffer is written, the activity buffer should also be written to. The activityBuffer is advanced along with all the other time buffers, so it should have a 1 somewhere in it only if there is active communication in a time buffer. </p>

</div>
</div>
<a class="anchor" id="adf01a2f1e7e8ad0795ef04b3a4e6dfb6"></a><!-- doxytag: member="ActivityRecorder::activityCount" ref="adf01a2f1e7e8ad0795ef04b3a4e6dfb6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classActivityRecorder.html#adf01a2f1e7e8ad0795ef04b3a4e6dfb6">activityCount</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tracks how many stages and cycles of time buffer have activity. Stages increment this count when they switch to active, and decrement it when they switch to inactive. Whenever a cycle that previously had no information is written in the time buffer, this is incremented. When a cycle that had information exits the time buffer due to age, this count is decremented. When the count is 0, there is no activity in the CPU, and it can be descheduled. </p>

</div>
</div>
<a class="anchor" id="a20bd7fb0de8433f0f95dc50ed74bf620"></a><!-- doxytag: member="ActivityRecorder::longestLatency" ref="a20bd7fb0de8433f0f95dc50ed74bf620" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classActivityRecorder.html#a20bd7fb0de8433f0f95dc50ed74bf620">longestLatency</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Longest latency time buffer in the CPU. </p>

</div>
</div>
<a class="anchor" id="aaf4f71ec3fd6f4e154d09cd71c2c331b"></a><!-- doxytag: member="ActivityRecorder::numStages" ref="aaf4f71ec3fd6f4e154d09cd71c2c331b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classActivityRecorder.html#aaf4f71ec3fd6f4e154d09cd71c2c331b">numStages</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of stages that can be marked as active or inactive. </p>

</div>
</div>
<a class="anchor" id="aebf0081a358874c1eedf8728e4a478a4"></a><!-- doxytag: member="ActivityRecorder::stageActive" ref="aebf0081a358874c1eedf8728e4a478a4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool* <a class="el" href="classActivityRecorder.html#aebf0081a358874c1eedf8728e4a478a4">stageActive</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Records which stages are active/inactive. </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>cpu/<a class="el" href="activity_8hh_source.html">activity.hh</a></li>
<li>cpu/<a class="el" href="activity_8cc.html">activity.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
