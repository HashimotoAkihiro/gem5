\hypertarget{classExecutionUnit}{
\section{クラス ExecutionUnit}
\label{classExecutionUnit}\index{ExecutionUnit@{ExecutionUnit}}
}


{\ttfamily \#include $<$execution\_\-unit.hh$>$}ExecutionUnitに対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classExecutionUnit}
\end{center}
\end{figure}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classExecutionUnit_a2afce0a47a93eee73a314d53e4890153}{Command} \{ \hyperlink{classExecutionUnit_a2afce0a47a93eee73a314d53e4890153a50945a7008a230660c285c62a9708066}{ExecuteInst}
 \}
\item 
typedef \hyperlink{classRefCountingPtr}{ThePipeline::DynInstPtr} \hyperlink{classExecutionUnit_af9d0c8a46736ba6aa2d8bb94da1a5e73}{DynInstPtr}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classExecutionUnit_a05c170b2ead38efc8ad22aaa5a5d53b0}{ExecutionUnit} (std::string res\_\-name, int res\_\-id, int res\_\-width, \hyperlink{classCycles}{Cycles} res\_\-latency, \hyperlink{classInOrderCPU}{InOrderCPU} $\ast$\_\-cpu, \hyperlink{namespaceThePipeline_ab62ca16eeca26566ad2422b5df4943ce}{ThePipeline::Params} $\ast$params)
\item 
void \hyperlink{classExecutionUnit_a4dc637449366fcdfc4e764cdf12d9b11}{regStats} ()
\item 
void \hyperlink{classExecutionUnit_a7b7fff82f8c9cbdb02add1346f60bb9e}{execute} (int slot\_\-num)
\end{DoxyCompactItemize}
\subsection*{Protected 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classStats_1_1Scalar}{Stats::Scalar} \hyperlink{classExecutionUnit_aa848feac8bfb4947ca3acb410bfe75c6}{predictedTakenIncorrect}
\item 
\hyperlink{classStats_1_1Scalar}{Stats::Scalar} \hyperlink{classExecutionUnit_ae1cc96638781ca35cb92a5606bd508b7}{predictedNotTakenIncorrect}
\item 
\hyperlink{classStats_1_1Scalar}{Stats::Scalar} \hyperlink{classExecutionUnit_ad540db2d08293b78c8609804d83f97e9}{predictedIncorrect}
\item 
\hyperlink{classStats_1_1Scalar}{Stats::Scalar} \hyperlink{classExecutionUnit_a1cb1bf4a746a7dd06086a839e83d1ef1}{predictedCorrect}
\item 
\hyperlink{classStats_1_1Formula}{Stats::Formula} \hyperlink{classExecutionUnit_a5155e8fb3a34aa84bd812d5ff99d0153}{mispredictPct}
\item 
\hyperlink{classStats_1_1Scalar}{Stats::Scalar} \hyperlink{classExecutionUnit_a9ca9a8e3f9eb86debde9df26107d828d}{executions}
\item 
\hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classExecutionUnit_a9a1ba2f52fb666bf08047e454e19e05d}{lastExecuteTick}
\item 
\hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classExecutionUnit_a754fd76d0796936423f7aae0158822f5}{lastControlTick}
\end{DoxyCompactItemize}


\subsection{型定義}
\hypertarget{classExecutionUnit_af9d0c8a46736ba6aa2d8bb94da1a5e73}{
\index{ExecutionUnit@{ExecutionUnit}!DynInstPtr@{DynInstPtr}}
\index{DynInstPtr@{DynInstPtr}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{DynInstPtr}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf ThePipeline::DynInstPtr} {\bf DynInstPtr}}}
\label{classExecutionUnit_af9d0c8a46736ba6aa2d8bb94da1a5e73}


\hyperlink{classResource_af9d0c8a46736ba6aa2d8bb94da1a5e73}{Resource}を再定義しています。

\subsection{列挙型}
\hypertarget{classExecutionUnit_a2afce0a47a93eee73a314d53e4890153}{
\index{ExecutionUnit@{ExecutionUnit}!Command@{Command}}
\index{Command@{Command}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{Command}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Command}}}
\label{classExecutionUnit_a2afce0a47a93eee73a314d53e4890153}
\begin{Desc}
\item[列挙型の値: ]\par
\begin{description}
\index{ExecuteInst@{ExecuteInst}!ExecutionUnit@{ExecutionUnit}}\index{ExecutionUnit@{ExecutionUnit}!ExecuteInst@{ExecuteInst}}\item[{\em 
\hypertarget{classExecutionUnit_a2afce0a47a93eee73a314d53e4890153a50945a7008a230660c285c62a9708066}{
ExecuteInst}
\label{classExecutionUnit_a2afce0a47a93eee73a314d53e4890153a50945a7008a230660c285c62a9708066}
}]\end{description}
\end{Desc}




\begin{DoxyCode}
48                  {
49         ExecuteInst
50     };
\end{DoxyCode}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classExecutionUnit_a05c170b2ead38efc8ad22aaa5a5d53b0}{
\index{ExecutionUnit@{ExecutionUnit}!ExecutionUnit@{ExecutionUnit}}
\index{ExecutionUnit@{ExecutionUnit}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{ExecutionUnit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ExecutionUnit} (std::string {\em res\_\-name}, \/  int {\em res\_\-id}, \/  int {\em res\_\-width}, \/  {\bf Cycles} {\em res\_\-latency}, \/  {\bf InOrderCPU} $\ast$ {\em \_\-cpu}, \/  {\bf ThePipeline::Params} $\ast$ {\em params})}}
\label{classExecutionUnit_a05c170b2ead38efc8ad22aaa5a5d53b0}


\subsection{関数}
\hypertarget{classExecutionUnit_a7b7fff82f8c9cbdb02add1346f60bb9e}{
\index{ExecutionUnit@{ExecutionUnit}!execute@{execute}}
\index{execute@{execute}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{execute}]{\setlength{\rightskip}{0pt plus 5cm}void execute (int {\em slot\_\-num})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classExecutionUnit_a7b7fff82f8c9cbdb02add1346f60bb9e}
Execute the function of this resource. The Default is action is to do nothing. More specific models will derive from this class and define their own execute function. 

\hyperlink{classResource_a39af49c5568d1db3f53c12d7d6914c32}{Resource}を再定義しています。


\begin{DoxyCode}
89 {
90     ResourceRequest* exec_req = reqs[slot_num];
91     DynInstPtr inst = reqs[slot_num]->inst;
92     if (inst->fault != NoFault) {
93         DPRINTF(InOrderExecute,
94                 "[tid:%i]: [sn:%i]: Detected %s fault @ %x. Forwarding to "
95                 "next stage.\n", inst->readTid(), inst->seqNum, inst->fault->name
      (),
96                 inst->pcState());
97         exec_req->done();
98         return;
99     }
100 
101     Fault fault = NoFault;
102     Tick cur_tick = curTick();
103     unsigned stage_num = exec_req->getStageNum();
104     ThreadID tid = inst->readTid();
105 #if TRACING_ON
106     InstSeqNum seq_num = inst->seqNum;
107 #endif
108 
109     switch (exec_req->cmd)
110     {
111       case ExecuteInst:
112         {
113             if (inst->isNop()) {
114                 DPRINTF(InOrderExecute, "[tid:%i] [sn:%i] [PC:%s] Ignoring execut
      ion"
115                         "of %s.\n", inst->readTid(), seq_num, inst->pcState(),
116                         inst->instName());
117                 inst->setExecuted();
118                 exec_req->done();
119                 return;
120             } else {
121                 DPRINTF(InOrderExecute, "[tid:%i] Executing [sn:%i] [PC:%s] %s.\n
      ",
122                         inst->readTid(), seq_num, inst->pcState(), inst->instName
      ());
123             }
124 
125             if (cur_tick != lastExecuteTick) {
126                 lastExecuteTick = cur_tick;
127             }
128 
129             //@todo: handle address generation here
130             assert(!inst->isMemRef());
131 
132             if (inst->isControl()) {
133                 if (lastControlTick == cur_tick) {
134                     DPRINTF(InOrderExecute, "Can not Execute More than One Contro
      l "
135                             "Inst Per Cycle. Blocking Request.\n");
136                     exec_req->done(false);
137                     return;
138                 }
139                 lastControlTick = curTick();
140 
141                 // Evaluate Branch
142                 fault = inst->execute();
143 
144                 // Should unconditional control , pc relative count as an
145                 // execution??? Probably not.
146                 executions++;
147 
148                 if (fault == NoFault) {
149                     inst->setExecuted();
150 
151                     if (inst->mispredicted()) {
152                         assert(inst->isControl());
153 
154                         // Set up Squash Generated By this Misprediction
155                         TheISA::PCState pc = inst->pcState();
156                         TheISA::advancePC(pc, inst->staticInst);
157                         inst->setPredTarg(pc);
158                         inst->setSquashInfo(stage_num);
159                         setupSquash(inst, stage_num, tid);
160 
161                         DPRINTF(InOrderExecute, "[tid:%i]: [sn:%i] Squashing from
       "
162                                 "stage %i. Redirecting  fetch to %s.\n", tid,
163                                 inst->seqNum, stage_num, pc);
164                         DPRINTF(InOrderStall, "STALL: [tid:%i]: Branch"
165                                 " misprediction at %s\n", tid, inst->pcState());
166 
167                         if (inst->predTaken()) {
168                             predictedTakenIncorrect++;
169                             DPRINTF(InOrderExecute, "[tid:%i] [sn:%i] %s ..."
170                                     "PC %s ... Mispredicts! "
171                                     "(Prediction: Taken)\n",
172                                     tid, inst->seqNum,
173                                     inst->staticInst->disassemble(
174                                         inst->instAddr()),
175                                     inst->pcState());
176                         } else {
177                             predictedNotTakenIncorrect++;
178                             DPRINTF(InOrderExecute, "[tid:%i] [sn:%i] %s ..."
179                                     "PC %s ... Mispredicts! "
180                                     "(Prediction: Not Taken)\n",
181                                     tid, inst->seqNum,
182                                     inst->staticInst->disassemble(
183                                         inst->instAddr()),
184                                     inst->pcState());
185                         }
186                         predictedIncorrect++;
187                     } else {
188                         DPRINTF(InOrderExecute, "[tid:%i]: [sn:%i]: Prediction"
189                                 "Correct.\n", inst->readTid(), seq_num);
190                         predictedCorrect++;
191                     }
192 
193                     exec_req->done();
194                 } else {
195                     DPRINTF(Fault, "[tid:%i]:[sn:%i]: Fault %s found\n",
196                             inst->readTid(), inst->seqNum, fault->name());
197                     inst->fault = fault;
198                     exec_req->done();
199                 }
200             } else {
201                 // Regular ALU instruction
202                 fault = inst->execute();
203                 executions++;
204 
205                 if (fault == NoFault) {
206                     inst->setExecuted();
207 
208 #if TRACING_ON
209                     for (int didx = 0; didx < inst->numDestRegs(); didx++)
210                         if (inst->resultType(didx) == InOrderDynInst::Float ||
211                             inst->resultType(didx) == InOrderDynInst::FloatBits |
      |
212                             inst->resultType(didx) == InOrderDynInst::Double)
213                             DPRINTF(InOrderExecute, "[tid:%i]: [sn:%i]: Dest resu
      lt %i "
214                                     "of FP execution is %08f (%x).\n", inst->read
      Tid(),
215                                     seq_num, didx, inst->readFloatResult(didx),
216                                     inst->readFloatBitsResult(didx));
217                         else
218                             DPRINTF(InOrderExecute, "[tid:%i]: [sn:%i]: Dest resu
      lt %i "
219                                     "of Int execution is 0x%x.\n", inst->readTid(
      ),
220                                     seq_num, didx, inst->readIntResult(didx));
221 #endif
222 
223                     if (!FullSystem) {
224                         // The Syscall might change the PC, so conservatively
225                         // squash everything behing it
226                         if (inst->isSyscall()) {
227                             inst->setSquashInfo(stage_num);
228                             setupSquash(inst, stage_num, tid);
229                         }
230                     }
231                 } else {
232                     DPRINTF(InOrderExecute, "[tid:%i]: [sn:%i]: had a %s "
233                             "fault.\n", inst->readTid(), seq_num, fault->name());
      
234                     DPRINTF(Fault, "[tid:%i]:[sn:%i]: Fault %s found\n",
235                             inst->readTid(), inst->seqNum, fault->name());
236                     inst->fault = fault;
237                 }
238 
239                 exec_req->done();
240             }
241         }
242         break;
243 
244       default:
245         fatal("Unrecognized command to %s", resName);
246     }
247 }
\end{DoxyCode}
\hypertarget{classExecutionUnit_a4dc637449366fcdfc4e764cdf12d9b11}{
\index{ExecutionUnit@{ExecutionUnit}!regStats@{regStats}}
\index{regStats@{regStats}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{regStats}]{\setlength{\rightskip}{0pt plus 5cm}void regStats ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classExecutionUnit_a4dc637449366fcdfc4e764cdf12d9b11}
\hyperlink{classRegister}{Register} \hyperlink{namespaceStats}{Stats} for this resource 

\hyperlink{classResource_ac1739a9be0fbd5d96cf441cd3b2c1c78}{Resource}を再定義しています。


\begin{DoxyCode}
55 {
56     predictedTakenIncorrect
57         .name(name() + ".predictedTakenIncorrect")
58         .desc("Number of Branches Incorrectly Predicted As Taken.");
59 
60     predictedNotTakenIncorrect
61         .name(name() + ".predictedNotTakenIncorrect")
62         .desc("Number of Branches Incorrectly Predicted As Not Taken).");
63 
64     executions
65         .name(name() + ".executions")
66         .desc("Number of Instructions Executed.");
67 
68  
69     predictedIncorrect
70         .name(name() + ".mispredicted")
71         .desc("Number of Branches Incorrectly Predicted");
72 
73     predictedCorrect
74         .name(name() + ".predicted")
75         .desc("Number of Branches Incorrectly Predicted");
76 
77     mispredictPct
78         .name(name() + ".mispredictPct")
79         .desc("Percentage of Incorrect Branches Predicts")
80         .precision(6);
81     mispredictPct = (predictedIncorrect / 
82                      (predictedCorrect + predictedIncorrect)) * 100;
83 
84     Resource::regStats();
85 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classExecutionUnit_a9ca9a8e3f9eb86debde9df26107d828d}{
\index{ExecutionUnit@{ExecutionUnit}!executions@{executions}}
\index{executions@{executions}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{executions}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Stats::Scalar} {\bf executions}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_a9ca9a8e3f9eb86debde9df26107d828d}
\hypertarget{classExecutionUnit_a754fd76d0796936423f7aae0158822f5}{
\index{ExecutionUnit@{ExecutionUnit}!lastControlTick@{lastControlTick}}
\index{lastControlTick@{lastControlTick}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{lastControlTick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} {\bf lastControlTick}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_a754fd76d0796936423f7aae0158822f5}
\hypertarget{classExecutionUnit_a9a1ba2f52fb666bf08047e454e19e05d}{
\index{ExecutionUnit@{ExecutionUnit}!lastExecuteTick@{lastExecuteTick}}
\index{lastExecuteTick@{lastExecuteTick}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{lastExecuteTick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} {\bf lastExecuteTick}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_a9a1ba2f52fb666bf08047e454e19e05d}
\hypertarget{classExecutionUnit_a5155e8fb3a34aa84bd812d5ff99d0153}{
\index{ExecutionUnit@{ExecutionUnit}!mispredictPct@{mispredictPct}}
\index{mispredictPct@{mispredictPct}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{mispredictPct}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Stats::Formula} {\bf mispredictPct}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_a5155e8fb3a34aa84bd812d5ff99d0153}
\hypertarget{classExecutionUnit_a1cb1bf4a746a7dd06086a839e83d1ef1}{
\index{ExecutionUnit@{ExecutionUnit}!predictedCorrect@{predictedCorrect}}
\index{predictedCorrect@{predictedCorrect}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{predictedCorrect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Stats::Scalar} {\bf predictedCorrect}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_a1cb1bf4a746a7dd06086a839e83d1ef1}
\hypertarget{classExecutionUnit_ad540db2d08293b78c8609804d83f97e9}{
\index{ExecutionUnit@{ExecutionUnit}!predictedIncorrect@{predictedIncorrect}}
\index{predictedIncorrect@{predictedIncorrect}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{predictedIncorrect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Stats::Scalar} {\bf predictedIncorrect}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_ad540db2d08293b78c8609804d83f97e9}
\hypertarget{classExecutionUnit_ae1cc96638781ca35cb92a5606bd508b7}{
\index{ExecutionUnit@{ExecutionUnit}!predictedNotTakenIncorrect@{predictedNotTakenIncorrect}}
\index{predictedNotTakenIncorrect@{predictedNotTakenIncorrect}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{predictedNotTakenIncorrect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Stats::Scalar} {\bf predictedNotTakenIncorrect}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_ae1cc96638781ca35cb92a5606bd508b7}
\hypertarget{classExecutionUnit_aa848feac8bfb4947ca3acb410bfe75c6}{
\index{ExecutionUnit@{ExecutionUnit}!predictedTakenIncorrect@{predictedTakenIncorrect}}
\index{predictedTakenIncorrect@{predictedTakenIncorrect}!ExecutionUnit@{ExecutionUnit}}
\subsubsection[{predictedTakenIncorrect}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Stats::Scalar} {\bf predictedTakenIncorrect}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classExecutionUnit_aa848feac8bfb4947ca3acb410bfe75c6}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
cpu/inorder/resources/\hyperlink{execution__unit_8hh}{execution\_\-unit.hh}\item 
cpu/inorder/resources/\hyperlink{execution__unit_8cc}{execution\_\-unit.cc}\end{DoxyCompactItemize}
