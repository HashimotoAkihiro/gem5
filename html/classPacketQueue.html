<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス PacketQueue</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス PacketQueue</h1><!-- doxytag: class="PacketQueue" --><!-- doxytag: inherits="Drainable" -->
<p><code>#include &lt;<a class="el" href="packet__queue_8hh_source.html">packet_queue.hh</a>&gt;</code></p>
<div class="dynheader">
PacketQueueに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classPacketQueue.gif" usemap="#PacketQueue_map" alt=""/>
  <map id="PacketQueue_map" name="PacketQueue_map">
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="112,0,327,24"/>
<area href="classMasterPacketQueue.html" alt="MasterPacketQueue" shape="rect" coords="0,112,215,136"/>
<area href="classSlavePacketQueue.html" alt="SlavePacketQueue" shape="rect" coords="225,112,440,136"/>
<area href="classCache_1_1MemSidePacketQueue.html" alt="MemSidePacketQueue&lt; TagStore &gt;" shape="rect" coords="0,168,215,192"/>
</map>
 </div>
</div>

<p><a href="classPacketQueue-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>構成</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue_1_1DeferredPacket.html">DeferredPacket</a></td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a2d319721a65496069642871a52e47056">name</a> () const =0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a8eb60d4744b6212ad749f3a586759266">checkFunctional</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#af99adfc2df426c1ebd4e1fcb804c7e4d">schedSendEvent</a> (<a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> when)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a9b0fd72bebb706403e57dd17daff1f40">schedSendTiming</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> when, bool send_as_snoop=false)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a549fc33ae3e5c345795b8384a91fb544">retry</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#aa8a18d230dba7a674ac8a0b4f35bc36a">drain</a> (<a class="el" href="classDrainManager.html">DrainManager</a> *dm)</td></tr>
<tr><td colspan="2"><h2>Protected メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a052ea90ae061f6d3b53d6dee3b3076f3">deferredPacketReady</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a9a43740cba452beb76e08a890f59c70d">deferredPacketReadyTime</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a3ce3f4b79c2caf000124b3de8ba9157c">sendDeferredPacket</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a391c414b53eb45782e37bc539608e477">trySendTiming</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a3111a75f1ac04df57de8a34ded64a82d">sendTiming</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, bool send_as_snoop)=0</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a34d5599fd6c275e889527628932a224e">scheduleSend</a> (<a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> time=<a class="el" href="base_2types_8hh.html#abe940b1b328825e234da719447e15ca5">MaxTick</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#af60d9c2c17fb4c9ebc5384a7e0c9f289">recvRangeChange</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#aa30b1ba397193e7094a87b2a945f7237">PacketQueue</a> (<a class="el" href="classEventManager.html">EventManager</a> &amp;_em, const std::string &amp;_label)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a3efbe442356f38106e0b67f41070245a">~PacketQueue</a> ()</td></tr>
<tr><td colspan="2"><h2>Protected 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#ae471a4c4073716b769170188214fe93d">label</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a></td></tr>
<tr><td colspan="2"><h2>Private 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="classPacketQueue_1_1DeferredPacket.html">DeferredPacket</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#ae5fc25ae70b3044ebae593494f7f58c8">DeferredPacketList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classstd_1_1list.html">std::list</a><br class="typebreak"/>
&lt; <a class="el" href="classPacketQueue_1_1DeferredPacket.html">DeferredPacket</a> &gt;::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#ad01f0c4d4677a8aeea2433ba7ef9f6fd">DeferredPacketIterator</a></td></tr>
<tr><td colspan="2"><h2>Private メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a09299dd6109496c23923f9e4f45b6f89">processSendEvent</a> ()</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1list.html">DeferredPacketList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventManager.html">EventManager</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a52e0dd5074be0e61097a0dadf9cda146">em</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classPacketQueue.html">PacketQueue</a>,&amp;PacketQueue::processSendEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPacketQueue.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p>A packet queue is a class that holds deferred packets and later sends them using the associated slave port or master port. </p>
<hr/><h2>型定義</h2>
<a class="anchor" id="ad01f0c4d4677a8aeea2433ba7ef9f6fd"></a><!-- doxytag: member="PacketQueue::DeferredPacketIterator" ref="ad01f0c4d4677a8aeea2433ba7ef9f6fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="classPacketQueue_1_1DeferredPacket.html">DeferredPacket</a>&gt;::iterator <a class="el" href="classPacketQueue.html#ad01f0c4d4677a8aeea2433ba7ef9f6fd">DeferredPacketIterator</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae5fc25ae70b3044ebae593494f7f58c8"></a><!-- doxytag: member="PacketQueue::DeferredPacketList" ref="ae5fc25ae70b3044ebae593494f7f58c8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="classPacketQueue_1_1DeferredPacket.html">DeferredPacket</a>&gt; <a class="el" href="classstd_1_1list.html">DeferredPacketList</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="aa30b1ba397193e7094a87b2a945f7237"></a><!-- doxytag: member="PacketQueue::PacketQueue" ref="aa30b1ba397193e7094a87b2a945f7237" args="(EventManager &amp;_em, const std::string &amp;_label)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPacketQueue.html">PacketQueue</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classEventManager.html">EventManager</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>_em</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>_label</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a packet queue, linked to an event manager, and a label that will be used for functional print request packets.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_em</em>&nbsp;</td><td><a class="el" href="classEvent.html">Event</a> manager used for scheduling this queue </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_label</em>&nbsp;</td><td>Label to push on the label stack for print request packets </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00052"></a>00052     : <a class="code" href="classPacketQueue.html#a52e0dd5074be0e61097a0dadf9cda146">em</a>(_em), <a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>(<span class="keyword">this</span>), <a class="code" href="classPacketQueue.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>(<a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>), <a class="code" href="classPacketQueue.html#ae471a4c4073716b769170188214fe93d">label</a>(_label),
<a name="l00053"></a>00053       <a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a>(<span class="keyword">false</span>)
<a name="l00054"></a>00054 {
<a name="l00055"></a>00055 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3efbe442356f38106e0b67f41070245a"></a><!-- doxytag: member="PacketQueue::~PacketQueue" ref="a3efbe442356f38106e0b67f41070245a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classPacketQueue.html">PacketQueue</a> </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Virtual desctructor since the class may be used as a base class. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00058"></a>00058 {
<a name="l00059"></a>00059 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a8eb60d4744b6212ad749f3a586759266"></a><!-- doxytag: member="PacketQueue::checkFunctional" ref="a8eb60d4744b6212ad749f3a586759266" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkFunctional </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classCheck.html">Check</a> the list of buffered packets against the supplied functional request. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00071"></a>00071 {
<a name="l00072"></a>00072     pkt-&gt;<a class="code" href="classPacket.html#ad2656c333949d4b445823d47398829f2">pushLabel</a>(<a class="code" href="classPacketQueue.html#ae471a4c4073716b769170188214fe93d">label</a>);
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <a class="code" href="classPacketQueue.html#ad01f0c4d4677a8aeea2433ba7ef9f6fd">DeferredPacketIterator</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.begin();
<a name="l00075"></a>00075     <a class="code" href="classPacketQueue.html#ad01f0c4d4677a8aeea2433ba7ef9f6fd">DeferredPacketIterator</a> end = <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.end();
<a name="l00076"></a>00076     <span class="keywordtype">bool</span> found = <span class="keyword">false</span>;
<a name="l00077"></a>00077 
<a name="l00078"></a>00078     <span class="keywordflow">while</span> (!found &amp;&amp; i != end) {
<a name="l00079"></a>00079         <span class="comment">// If the buffered packet contains data, and it overlaps the</span>
<a name="l00080"></a>00080         <span class="comment">// current packet, then update data</span>
<a name="l00081"></a>00081         found = pkt-&gt;<a class="code" href="classPacket.html#a77410f93ce8057ce67882c121ac2e667">checkFunctional</a>(i-&gt;pkt);
<a name="l00082"></a>00082         ++i;
<a name="l00083"></a>00083     }
<a name="l00084"></a>00084 
<a name="l00085"></a>00085     pkt-&gt;<a class="code" href="classPacket.html#a3ab6da7065be0d85f45a8dd050515f16">popLabel</a>();
<a name="l00086"></a>00086 
<a name="l00087"></a>00087     <span class="keywordflow">return</span> found;
<a name="l00088"></a>00088 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a052ea90ae061f6d3b53d6dee3b3076f3"></a><!-- doxytag: member="PacketQueue::deferredPacketReady" ref="a052ea90ae061f6d3b53d6dee3b3076f3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool deferredPacketReady </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classCheck.html">Check</a> whether we have a packet ready to go on the transmit list. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00113"></a>00113     { <span class="keywordflow">return</span> !<a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.empty() &amp;&amp; <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.front().tick &lt;= <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>(); }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9a43740cba452beb76e08a890f59c70d"></a><!-- doxytag: member="PacketQueue::deferredPacketReadyTime" ref="a9a43740cba452beb76e08a890f59c70d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> deferredPacketReadyTime </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00116"></a>00116     { <span class="keywordflow">return</span> <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.empty() ? <a class="code" href="base_2types_8hh.html#abe940b1b328825e234da719447e15ca5">MaxTick</a> : <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.front().tick; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa8a18d230dba7a674ac8a0b4f35bc36a"></a><!-- doxytag: member="PacketQueue::drain" ref="aa8a18d230dba7a674ac8a0b4f35bc36a" args="(DrainManager *dm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int drain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td>
          <td class="paramname"> <em>drainManager</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Determine if an object needs draining and register a <a class="el" href="classDrainManager.html">DrainManager</a>.</p>
<p>When draining the state of an object, the simulator calls drain with a pointer to a drain manager. If the object does not need further simulation to drain internal buffers, it switched to the Drained state and returns 0, otherwise it switches to the Draining state and returns the number of times that it will call <a class="el" href="classEvent.html#a142b75b68a6291400e20fb0dd905b1c8">Event::process()</a> on the drain event. Most objects are expected to return either 0 or 1.</p>
<dl class="note"><dt><b>覚え書き:</b></dt><dd>An object that has entered the Drained state can be disturbed by other objects in the system and consequently be forced to enter the Draining state again. The simulator therefore repeats the draining process until all objects return 0 on the first call to <a class="el" href="classPacketQueue.html#aa8a18d230dba7a674ac8a0b4f35bc36a">drain()</a>.</dd></dl>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>drainManager</em>&nbsp;</td><td><a class="el" href="classDrainManager.html">DrainManager</a> to use to inform the simulator when draining has completed.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>0 if the object is ready for serialization now, &gt;0 if it needs further simulation. </dd></dl>

<p><a class="el" href="classDrainable.html#a1ed42c14f2f622ea6b0df3865e89c8b4">Drainable</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00218"></a>00218 {
<a name="l00219"></a>00219     <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.empty() &amp;&amp; !<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>())
<a name="l00220"></a>00220         <span class="keywordflow">return</span> 0;
<a name="l00221"></a>00221     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Drain, <span class="stringliteral">&quot;PacketQueue not drained\n&quot;</span>);
<a name="l00222"></a>00222     drainManager = <a class="code" href="namespaceMipsISA.html#a2575c29e7f4617b6076486f340b6fe19">dm</a>;
<a name="l00223"></a>00223     <span class="keywordflow">return</span> 1;
<a name="l00224"></a>00224 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2d319721a65496069642871a52e47056"></a><!-- doxytag: member="PacketQueue::name" ref="a2d319721a65496069642871a52e47056" args="() const =0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const std::string name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Provide a name to simplify debugging.</p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>A complete name, appended to module and port </dd></dl>

<p><a class="el" href="classMasterPacketQueue.html#a6490f765a824ced1cc94979609fe7e07">MasterPacketQueue</a>, と <a class="el" href="classSlavePacketQueue.html#a6490f765a824ced1cc94979609fe7e07">SlavePacketQueue</a>で実装されています。</p>

</div>
</div>
<a class="anchor" id="a09299dd6109496c23923f9e4f45b6f89"></a><!-- doxytag: member="PacketQueue::processSendEvent" ref="a09299dd6109496c23923f9e4f45b6f89" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processSendEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>This function attempts to send deferred packets. Scheduled to be called in the future via SendEvent. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00211"></a>00211 {
<a name="l00212"></a>00212     assert(!<a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a>);
<a name="l00213"></a>00213     <a class="code" href="classPacketQueue.html#a3ce3f4b79c2caf000124b3de8ba9157c">sendDeferredPacket</a>();
<a name="l00214"></a>00214 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af60d9c2c17fb4c9ebc5384a7e0c9f289"></a><!-- doxytag: member="PacketQueue::recvRangeChange" ref="af60d9c2c17fb4c9ebc5384a7e0c9f289" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void recvRangeChange </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Simple ports are generally used as slave ports (i.e. the respond to requests) and thus do not expect to receive any range changes (as the neighbouring port has a master role and do not have any address ranges. A subclass can override the default behaviuor if needed. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00156"></a>00156 { }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a549fc33ae3e5c345795b8384a91fb544"></a><!-- doxytag: member="PacketQueue::retry" ref="a549fc33ae3e5c345795b8384a91fb544" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void retry </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used by a port to notify the queue that a retry was received and that the queue can proceed and retry sending the packet that caused the wait. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00063"></a>00063 {
<a name="l00064"></a>00064     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classPacketQueue.html">PacketQueue</a>, <span class="stringliteral">&quot;Queue %s received retry\n&quot;</span>, <a class="code" href="classPacketQueue.html#a2d319721a65496069642871a52e47056">name</a>());
<a name="l00065"></a>00065     assert(<a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a>);
<a name="l00066"></a>00066     <a class="code" href="classPacketQueue.html#a3ce3f4b79c2caf000124b3de8ba9157c">sendDeferredPacket</a>();
<a name="l00067"></a>00067 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af99adfc2df426c1ebd4e1fcb804c7e4d"></a><!-- doxytag: member="PacketQueue::schedSendEvent" ref="af99adfc2df426c1ebd4e1fcb804c7e4d" args="(Tick when)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void schedSendEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>when</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Schedule a send even if not already waiting for a retry. If the requested time is before an already scheduled send event it will be rescheduled.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>when</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00092"></a>00092 {
<a name="l00093"></a>00093     <span class="comment">// if we are waiting on a retry, do not schedule a send event, and</span>
<a name="l00094"></a>00094     <span class="comment">// instead rely on retry being called</span>
<a name="l00095"></a>00095     <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a>) {
<a name="l00096"></a>00096         assert(!<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l00097"></a>00097         <span class="keywordflow">return</span>;
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099 
<a name="l00100"></a>00100     <span class="keywordflow">if</span> (!<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l00101"></a>00101         <a class="code" href="classPacketQueue.html#a52e0dd5074be0e61097a0dadf9cda146">em</a>.<a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(&amp;<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>, when);
<a name="l00102"></a>00102     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>() &gt; when) {
<a name="l00103"></a>00103         <a class="code" href="classPacketQueue.html#a52e0dd5074be0e61097a0dadf9cda146">em</a>.<a class="code" href="classEventManager.html#a83fe8e2d06cd7c6e36743e5beb07298f">reschedule</a>(&amp;<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>, when);
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9b0fd72bebb706403e57dd17daff1f40"></a><!-- doxytag: member="PacketQueue::schedSendTiming" ref="a9b0fd72bebb706403e57dd17daff1f40" args="(PacketPtr pkt, Tick when, bool send_as_snoop=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void schedSendTiming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>when</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>send_as_snoop</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Add a packet to the transmit list, and ensure that a processSendEvent is called in the future.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td><a class="el" href="classPacket.html">Packet</a> to send </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>when</em>&nbsp;</td><td>Absolute time (in ticks) to send packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>send_as_snoop</em>&nbsp;</td><td>Send the packet as a snoop or not </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00109"></a>00109 {
<a name="l00110"></a>00110     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classPacketQueue.html">PacketQueue</a>, <span class="stringliteral">&quot;%s for %s address %x size %d\n&quot;</span>, __func__,
<a name="l00111"></a>00111             pkt-&gt;<a class="code" href="classPacket.html#a863af57e28a01258236ea303155fc7ff">cmdString</a>(), pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>(), pkt-&gt;<a class="code" href="classPacket.html#a1d18ba49c7be427da1f4a42d53e35f48">getSize</a>());
<a name="l00112"></a>00112     <span class="comment">// we can still send a packet before the end of this tick</span>
<a name="l00113"></a>00113     assert(when &gt;= <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="comment">// express snoops should never be queued</span>
<a name="l00116"></a>00116     assert(!pkt-&gt;<a class="code" href="classPacket.html#aa20026c596161a1efabde68c4a34e00b">isExpressSnoop</a>());
<a name="l00117"></a>00117 
<a name="l00118"></a>00118     <span class="comment">// add a very basic sanity check on the port to ensure the</span>
<a name="l00119"></a>00119     <span class="comment">// invisible buffer is not growing beyond reasonable limits</span>
<a name="l00120"></a>00120     <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.size() &gt; 100) {
<a name="l00121"></a>00121         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Packet queue %s has grown beyond 100 packets\n&quot;</span>,
<a name="l00122"></a>00122               <a class="code" href="classPacketQueue.html#a2d319721a65496069642871a52e47056">name</a>());
<a name="l00123"></a>00123     }
<a name="l00124"></a>00124 
<a name="l00125"></a>00125     <span class="comment">// nothing on the list, or earlier than current front element,</span>
<a name="l00126"></a>00126     <span class="comment">// schedule an event</span>
<a name="l00127"></a>00127     <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.empty() || when &lt; <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.front().tick) {
<a name="l00128"></a>00128         <span class="comment">// note that currently we ignore a potentially outstanding retry</span>
<a name="l00129"></a>00129         <span class="comment">// and could in theory put a new packet at the head of the</span>
<a name="l00130"></a>00130         <span class="comment">// transmit list before retrying the existing packet</span>
<a name="l00131"></a>00131         <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.push_front(DeferredPacket(when, pkt, send_as_snoop));
<a name="l00132"></a>00132         <a class="code" href="classPacketQueue.html#af99adfc2df426c1ebd4e1fcb804c7e4d">schedSendEvent</a>(when);
<a name="l00133"></a>00133         <span class="keywordflow">return</span>;
<a name="l00134"></a>00134     }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="comment">// list is non-empty and this belongs at the end</span>
<a name="l00137"></a>00137     <span class="keywordflow">if</span> (when &gt;= <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.back().tick) {
<a name="l00138"></a>00138         <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.push_back(DeferredPacket(when, pkt, send_as_snoop));
<a name="l00139"></a>00139         <span class="keywordflow">return</span>;
<a name="l00140"></a>00140     }
<a name="l00141"></a>00141 
<a name="l00142"></a>00142     <span class="comment">// this belongs in the middle somewhere, insertion sort</span>
<a name="l00143"></a>00143     <a class="code" href="classPacketQueue.html#ad01f0c4d4677a8aeea2433ba7ef9f6fd">DeferredPacketIterator</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.begin();
<a name="l00144"></a>00144     ++i; <span class="comment">// already checked for insertion at front</span>
<a name="l00145"></a>00145     <span class="keywordflow">while</span> (i != <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.end() &amp;&amp; when &gt;= i-&gt;tick)
<a name="l00146"></a>00146         ++i;
<a name="l00147"></a>00147     <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.insert(i, DeferredPacket(when, pkt, send_as_snoop));
<a name="l00148"></a>00148 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a34d5599fd6c275e889527628932a224e"></a><!-- doxytag: member="PacketQueue::scheduleSend" ref="a34d5599fd6c275e889527628932a224e" args="(Tick time=MaxTick)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void scheduleSend </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>time</em> = <code><a class="el" href="base_2types_8hh.html#abe940b1b328825e234da719447e15ca5">MaxTick</a></code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Based on the transmit list, or the provided time, schedule a send event if there are packets to send. If we are idle and asked to drain then do so.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>time</em>&nbsp;</td><td>an alternative time for the next send event </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00174"></a>00174 {
<a name="l00175"></a>00175     <span class="comment">// the next ready time is either determined by the next deferred packet,</span>
<a name="l00176"></a>00176     <span class="comment">// or in the cache through the MSHR ready time</span>
<a name="l00177"></a>00177     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> nextReady = std::min(<a class="code" href="classPacketQueue.html#a9a43740cba452beb76e08a890f59c70d">deferredPacketReadyTime</a>(), time);
<a name="l00178"></a>00178 
<a name="l00179"></a>00179     <span class="keywordflow">if</span> (nextReady != <a class="code" href="base_2types_8hh.html#abe940b1b328825e234da719447e15ca5">MaxTick</a>) {
<a name="l00180"></a>00180         <span class="comment">// if the sendTiming caused someone else to call our</span>
<a name="l00181"></a>00181         <span class="comment">// recvTiming we could already have an event scheduled, check</span>
<a name="l00182"></a>00182         <span class="keywordflow">if</span> (!<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>())
<a name="l00183"></a>00183             <a class="code" href="classPacketQueue.html#a52e0dd5074be0e61097a0dadf9cda146">em</a>.<a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(&amp;<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>, std::max(nextReady, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + 1));
<a name="l00184"></a>00184     } <span class="keywordflow">else</span> {
<a name="l00185"></a>00185         <span class="comment">// no more to send, so if we&apos;re draining, we may be done</span>
<a name="l00186"></a>00186         <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a> &amp;&amp; <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.empty() &amp;&amp; !<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l00187"></a>00187             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Drain, <span class="stringliteral">&quot;PacketQueue done draining,&quot;</span>
<a name="l00188"></a>00188                     <span class="stringliteral">&quot;processing drain event\n&quot;</span>);
<a name="l00189"></a>00189             <a class="code" href="classPacketQueue.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>-&gt;<a class="code" href="classDrainManager.html#ab89d10e368d2e82061eddb9e40022382">signalDrainDone</a>();
<a name="l00190"></a>00190             <a class="code" href="classPacketQueue.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a> = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00191"></a>00191         }
<a name="l00192"></a>00192     }
<a name="l00193"></a>00193 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3ce3f4b79c2caf000124b3de8ba9157c"></a><!-- doxytag: member="PacketQueue::sendDeferredPacket" ref="a3ce3f4b79c2caf000124b3de8ba9157c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sendDeferredPacket </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Attempt to send the packet at the head of the transmit list. Caller must guarantee that the list is non-empty and that the head packet is scheduled for <a class="el" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick()</a> (or earlier). Note that a subclass of the <a class="el" href="classPacketQueue.html">PacketQueue</a> can override this method and thus change the behaviour (as done by the cache). </p>

<p><a class="el" href="classCache_1_1MemSidePacketQueue.html#a3ce3f4b79c2caf000124b3de8ba9157c">MemSidePacketQueue&lt; TagStore &gt;</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00197"></a>00197 {
<a name="l00198"></a>00198     <span class="comment">// try to send what is on the list, this will set waitingOnRetry</span>
<a name="l00199"></a>00199     <span class="comment">// accordingly</span>
<a name="l00200"></a>00200     <a class="code" href="classPacketQueue.html#a391c414b53eb45782e37bc539608e477">trySendTiming</a>();
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <span class="comment">// if we succeeded and are not waiting for a retry, schedule the</span>
<a name="l00203"></a>00203     <span class="comment">// next send</span>
<a name="l00204"></a>00204     <span class="keywordflow">if</span> (!<a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a>) {
<a name="l00205"></a>00205         <a class="code" href="classPacketQueue.html#a34d5599fd6c275e889527628932a224e">scheduleSend</a>();
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3111a75f1ac04df57de8a34ded64a82d"></a><!-- doxytag: member="PacketQueue::sendTiming" ref="a3111a75f1ac04df57de8a34ded64a82d" args="(PacketPtr pkt, bool send_as_snoop)=0" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool sendTiming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>send_as_snoop</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected, pure virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classMasterPacketQueue.html#a49e787c20f2f8d3e4fc0b8213bebcfc4">MasterPacketQueue</a>, と <a class="el" href="classSlavePacketQueue.html#a49e787c20f2f8d3e4fc0b8213bebcfc4">SlavePacketQueue</a>で実装されています。</p>

</div>
</div>
<a class="anchor" id="a391c414b53eb45782e37bc539608e477"></a><!-- doxytag: member="PacketQueue::trySendTiming" ref="a391c414b53eb45782e37bc539608e477" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void trySendTiming </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Attempt to send the packet at the front of the transmit list, and set waitingOnRetry accordingly. The packet is temporarily taken off the list, but put back at the front if not successfully sent. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00151"></a>00151 {
<a name="l00152"></a>00152     assert(<a class="code" href="classPacketQueue.html#a052ea90ae061f6d3b53d6dee3b3076f3">deferredPacketReady</a>());
<a name="l00153"></a>00153 
<a name="l00154"></a>00154     <span class="comment">// take the next packet off the list here, as we might return to</span>
<a name="l00155"></a>00155     <span class="comment">// ourselves through the sendTiming call below</span>
<a name="l00156"></a>00156     DeferredPacket dp = <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.front();
<a name="l00157"></a>00157     <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.pop_front();
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <span class="comment">// use the appropriate implementation of sendTiming based on the</span>
<a name="l00160"></a>00160     <span class="comment">// type of port associated with the queue, and whether the packet</span>
<a name="l00161"></a>00161     <span class="comment">// is to be sent as a snoop or not</span>
<a name="l00162"></a>00162     <a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a> = !<a class="code" href="classPacketQueue.html#a3111a75f1ac04df57de8a34ded64a82d">sendTiming</a>(dp.pkt, dp.sendAsSnoop);
<a name="l00163"></a>00163 
<a name="l00164"></a>00164     <span class="keywordflow">if</span> (<a class="code" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a>) {
<a name="l00165"></a>00165         <span class="comment">// put the packet back at the front of the list (packet should</span>
<a name="l00166"></a>00166         <span class="comment">// not have changed since it wasn&apos;t accepted)</span>
<a name="l00167"></a>00167         assert(!<a class="code" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l00168"></a>00168         <a class="code" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a>.push_front(dp);
<a name="l00169"></a>00169     }
<a name="l00170"></a>00170 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a329b71fb934a93312ca0aacbf5a3f982"></a><!-- doxytag: member="PacketQueue::drainManager" ref="a329b71fb934a93312ca0aacbf5a3f982" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDrainManager.html">DrainManager</a>* <a class="el" href="classPacketQueue.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If we need to drain, keep the drain manager around until we're done here. </p>

</div>
</div>
<a class="anchor" id="a52e0dd5074be0e61097a0dadf9cda146"></a><!-- doxytag: member="PacketQueue::em" ref="a52e0dd5074be0e61097a0dadf9cda146" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventManager.html">EventManager</a>&amp; <a class="el" href="classPacketQueue.html#a52e0dd5074be0e61097a0dadf9cda146">em</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The manager which is used for the event queue </p>

</div>
</div>
<a class="anchor" id="ae471a4c4073716b769170188214fe93d"></a><!-- doxytag: member="PacketQueue::label" ref="ae471a4c4073716b769170188214fe93d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::string <a class="el" href="classPacketQueue.html#ae471a4c4073716b769170188214fe93d">label</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Label to use for print request packets label stack. </p>

</div>
</div>
<a class="anchor" id="a2fc6007386af1667bd97ee56a71079fb"></a><!-- doxytag: member="PacketQueue::sendEvent" ref="a2fc6007386af1667bd97ee56a71079fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classPacketQueue.html">PacketQueue</a>, &amp;PacketQueue::processSendEvent&gt; <a class="el" href="classPacketQueue.html#a2fc6007386af1667bd97ee56a71079fb">sendEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classEvent.html">Event</a> used to call processSendEvent. </p>

</div>
</div>
<a class="anchor" id="a32a79d68b8d8f4f33bc27f59809eeae7"></a><!-- doxytag: member="PacketQueue::transmitList" ref="a32a79d68b8d8f4f33bc27f59809eeae7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1list.html">DeferredPacketList</a> <a class="el" href="classPacketQueue.html#a32a79d68b8d8f4f33bc27f59809eeae7">transmitList</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>A list of outgoing timing response packets that haven't been serviced yet. </p>

</div>
</div>
<a class="anchor" id="ad4363dd8230c71676c4cad8dd5a0b8a7"></a><!-- doxytag: member="PacketQueue::waitingOnRetry" ref="ad4363dd8230c71676c4cad8dd5a0b8a7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPacketQueue.html#ad4363dd8230c71676c4cad8dd5a0b8a7">waitingOnRetry</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remember whether we're awaiting a retry from the bus. </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>mem/<a class="el" href="packet__queue_8hh_source.html">packet_queue.hh</a></li>
<li>mem/<a class="el" href="packet__queue_8cc.html">packet_queue.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
