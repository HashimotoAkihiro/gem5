<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス PipelineStage</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス PipelineStage</h1><!-- doxytag: class="PipelineStage" -->
<p><code>#include &lt;<a class="el" href="pipeline__stage_8hh_source.html">pipeline_stage.hh</a>&gt;</code></p>
<div class="dynheader">
PipelineStageに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classPipelineStage.gif" usemap="#PipelineStage_map" alt=""/>
  <map id="PipelineStage_map" name="PipelineStage_map">
<area href="classFirstStage.html" alt="FirstStage" shape="rect" coords="0,56,89,80"/>
</map>
 </div>
</div>

<p><a href="classPipelineStage-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>構成</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structPipelineStage_1_1Stalls.html">Stalls</a></td></tr>
<tr><td colspan="2"><h2>Public 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018">StageStatus</a> { <a class="el" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a26bd8444261cc58df7a86753c79d2520">Active</a>, 
<a class="el" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6">Inactive</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a> { <br/>
&nbsp;&nbsp;<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>, 
<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>, 
<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca19a48e232b72697e4bb7ea1b6075ed49">StartSquash</a>, 
<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>, 
<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>, 
<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca84d11a0919e33ccd274f5f0f82006fa6">MemWaitResponse</a>, 
<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf98795b778c51c0111a0d4982b178200">MemWaitRetry</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca1883fc473d33feb95a8ea53164e91d0e">MemAccessComplete</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a30721921ff32a2c7bc0e01c472c8c935">PipelineStage</a> (<a class="el" href="classPipelineStage.html#aa14874985381292db0aea05d1c8a122c">Params</a> *params, unsigned stage_num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a5045b86dad0c4a626861dc2aa1c59180">~PipelineStage</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a66db401ca5ea7de9fe7ca057d5eeb53c">init</a> (<a class="el" href="classPipelineStage.html#aa14874985381292db0aea05d1c8a122c">Params</a> *params)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4dc637449366fcdfc4e764cdf12d9b11">regStats</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a6fd0f914e19bcfb6d9f28e537ad956d5">setCPU</a> (<a class="el" href="classInOrderCPU.html">InOrderCPU</a> *cpu_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a2b521ea5f191fff72265f60d4ed5187b">setTimeBuffer</a> (<a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt; *tb_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aff9a9995beb69e92bbcf40c780c17b93">setPrevStageQueue</a> (<a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt; *prev_stage_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ace33f1daf903e9438330807405092e20">setNextStageQueue</a> (<a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt; *next_stage_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aab96bdacf8bd420402cbb543f994e054">setActiveThreads</a> (<a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt; *at_ptr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ab6e550d3e889847f642fa2205c6e12fd">nextStageQueueValid</a> (int stage_num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ab8e0f4a73d5a3ab9fe269f3c36d97e4f">isBlocked</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a05f299b443f8cc73a93d61572edc0218">switchOut</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a8674059ce345e23aac5086b2c3e24a43">takeOverFrom</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a873dd91783f9efb4a590aded1f70d6b0">tick</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af11246f186567b60383a2ff1d4bcf27c">setResStall</a> (<a class="el" href="classResourceRequest.html">ResReqPtr</a> res_req, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a71090c4bc5fc055eb0ea621cb65fddc8">unsetResStall</a> (<a class="el" href="classResourceRequest.html">ResReqPtr</a> res_req, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af5bd22ce78c3a8bafb5b91b7b70e8a41">removeStalls</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4623e7080104807616729bb5504b76ce">stageBufferAvail</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a687aa4600423bb30ecf3bb1da6cd6000">activateThread</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a9c19142b0bc2ce7b7a6593a5190cebc7">setupSquash</a> (<a class="el" href="classRefCountingPtr.html">DynInstPtr</a> inst, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a960b60a46045a5363df0c263f0f43902">squashDueToMemStall</a> (<a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> seq_num, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aee9dc23de90acd20200641407a3bd1da">squash</a> (<a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> squash_num, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#adbce9d3c16239dca0ffd19bc176ea258">squashPrevStageInsts</a> (<a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> squash_seq_num, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a80587b4fe043bbe1995536cb3b361588">dumpInsts</a> ()</td></tr>
<tr><td colspan="2"><h2>Public 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt;::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af54931163e4bdb38a1295065af735582">prevStageQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt;<br class="typebreak"/>
::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aa6321826776981dc0e21fbdeefe52016">nextStageQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt;<br class="typebreak"/>
::wire&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a97808a9870039f4168da10ecfb5dc472">idle</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structPipelineStage_1_1Stalls.html">Stalls</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a42e0f4c18fdb8ef7504f5c45d697fb14">idleCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af9addd340a133c2f4add363a3055b019">runCycles</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a04353589e0e920909d3ceb8e73abb7ac">utilization</a></td></tr>
<tr><td colspan="2"><h2>Protected 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="namespaceThePipeline.html#ab62ca16eeca26566ad2422b5df4943ce">ThePipeline::Params</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aa14874985381292db0aea05d1c8a122c">Params</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classRefCountingPtr.html">ThePipeline::DynInstPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af9d0c8a46736ba6aa2d8bb94da1a5e73">DynInstPtr</a></td></tr>
<tr><td colspan="2"><h2>Protected メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a0782fca2c80ef367ee914d464584ab20">processStage</a> (bool &amp;status_change)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a3e391d45d3f6411be62510f3b23105c9">processThread</a> (bool &amp;status_change, <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4120d7c6b83eb82877f4d21109c105ba">processInsts</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ac8bd857e45d0b201ea328b6ea8bcb890">processInstSchedule</a> (<a class="el" href="classRefCountingPtr.html">DynInstPtr</a> inst, int &amp;reqs_processed)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4666632f247a5d92380cb32d6e286c75">canSendInstToStage</a> (unsigned stage_num)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a3a5710b990e95498611464d54c90dcf1">sendInstToNextStage</a> (<a class="el" href="classRefCountingPtr.html">DynInstPtr</a> inst)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a112431820c072831aa16794d42dc25e4">skidSize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#afe3e2673d17dd5c568862ef5ae68b4d8">skidsEmpty</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4bb9486757ce225941aaaf759b357a57">updateStatus</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a9ff2aa32ab0f40674cb3518108d62f8e">sortInsts</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ad65c9f053a6038ac8c34c34bfe9a88c3">readStallSignals</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af77f2bf38a75182c65e633b9fdf295d2">checkSignalsAndUpdate</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a6ba4f2f95d991f5be818dabf7500feed">checkStall</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ab03996f3423928a0e84dc3df7fd493f2">prevStageInstsValid</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ad1993925abd15d3fb59fde2ccfa3d678">block</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#aee83987cebca092f91d7328291e7d40f">blockDueToBuffer</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a9cc3b95f6969935f78c0158aa5145021">unblock</a> (<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid)</td></tr>
<tr><td colspan="2"><h2>Protected 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a51d98139f56a84585e4cb68e3cd67a1c">stageWidth</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018">StageStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classInOrderCPU.html">InOrderCPU</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTrace_1_1InOrderTrace.html">Trace::InOrderTrace</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af3ad9be2b464186b902b5ca568b6d439">tracer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classRefCountingPtr.html">DynInstPtr</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a693e4a546dfc51b4e402fe75e73e812e">switchedOutBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; bool &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a09a91d6926260c8037374f0b646a62ee">switchedOutValid</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="classRefCountingPtr.html">DynInstPtr</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a09dc4a08ace7d6e74531ffff1ba5d905">dummyBufferInst</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ab949b1ea7ed96a92d473eeaa17348bed">bdelayDoneSeqNum</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ac364a786221f4a1741023dc82bc834f9">squashAfterDelaySlot</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a2313a835690e0d98e53b1aa69754bb1f">squashInst</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a8b3bf50b9e561c023857979eaf326bee">stageBufferMax</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ab6a826f43ca871b277e724aa148d1816">toNextStageIndex</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#ac171ebbc339fe3c1b91878034586b7a5">lastStallingStage</a> [<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt; *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classPipelineStage.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a></td></tr>
</table>
<hr/><h2>型定義</h2>
<a class="anchor" id="af9d0c8a46736ba6aa2d8bb94da1a5e73"></a><!-- doxytag: member="PipelineStage::DynInstPtr" ref="af9d0c8a46736ba6aa2d8bb94da1a5e73" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classRefCountingPtr.html">ThePipeline::DynInstPtr</a> <a class="el" href="classRefCountingPtr.html">DynInstPtr</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa14874985381292db0aea05d1c8a122c"></a><!-- doxytag: member="PipelineStage::Params" ref="aa14874985381292db0aea05d1c8a122c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="namespaceThePipeline.html#ab62ca16eeca26566ad2422b5df4943ce">ThePipeline::Params</a> <a class="el" href="classPipelineStage.html#aa14874985381292db0aea05d1c8a122c">Params</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>列挙型</h2>
<a class="anchor" id="add44b42ba3608b213fc0986c4aee6018"></a><!-- doxytag: member="PipelineStage::StageStatus" ref="add44b42ba3608b213fc0986c4aee6018" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018">StageStatus</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Overall stage status. Used to determine if the CPU can deschedule itself due to a lack of activity. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="add44b42ba3608b213fc0986c4aee6018a26bd8444261cc58df7a86753c79d2520"></a><!-- doxytag: member="Active" ref="add44b42ba3608b213fc0986c4aee6018a26bd8444261cc58df7a86753c79d2520" args="" -->Active</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6"></a><!-- doxytag: member="Inactive" ref="add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6" args="" -->Inactive</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00057"></a>00057                      {
<a name="l00058"></a>00058         <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a26bd8444261cc58df7a86753c79d2520">Active</a>,
<a name="l00059"></a>00059         <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6">Inactive</a>
<a name="l00060"></a>00060     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2739961013a00cede621d4d72f2173c"></a><!-- doxytag: member="PipelineStage::ThreadStatus" ref="ae2739961013a00cede621d4d72f2173c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Individual thread status. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb"></a><!-- doxytag: member="Running" ref="ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb" args="" -->Running</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19"></a><!-- doxytag: member="Idle" ref="ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19" args="" -->Idle</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca19a48e232b72697e4bb7ea1b6075ed49"></a><!-- doxytag: member="StartSquash" ref="ae2739961013a00cede621d4d72f2173ca19a48e232b72697e4bb7ea1b6075ed49" args="" -->StartSquash</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7"></a><!-- doxytag: member="Squashing" ref="ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7" args="" -->Squashing</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30"></a><!-- doxytag: member="Blocked" ref="ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30" args="" -->Blocked</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0"></a><!-- doxytag: member="Unblocking" ref="ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0" args="" -->Unblocking</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca84d11a0919e33ccd274f5f0f82006fa6"></a><!-- doxytag: member="MemWaitResponse" ref="ae2739961013a00cede621d4d72f2173ca84d11a0919e33ccd274f5f0f82006fa6" args="" -->MemWaitResponse</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173caf98795b778c51c0111a0d4982b178200"></a><!-- doxytag: member="MemWaitRetry" ref="ae2739961013a00cede621d4d72f2173caf98795b778c51c0111a0d4982b178200" args="" -->MemWaitRetry</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="ae2739961013a00cede621d4d72f2173ca1883fc473d33feb95a8ea53164e91d0e"></a><!-- doxytag: member="MemAccessComplete" ref="ae2739961013a00cede621d4d72f2173ca1883fc473d33feb95a8ea53164e91d0e" args="" -->MemAccessComplete</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00063"></a>00063                       {
<a name="l00064"></a>00064         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>,
<a name="l00065"></a>00065         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>,
<a name="l00066"></a>00066         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca19a48e232b72697e4bb7ea1b6075ed49">StartSquash</a>,
<a name="l00067"></a>00067         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>,
<a name="l00068"></a>00068         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>,
<a name="l00069"></a>00069         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>,
<a name="l00070"></a>00070         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca84d11a0919e33ccd274f5f0f82006fa6">MemWaitResponse</a>,
<a name="l00071"></a>00071         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf98795b778c51c0111a0d4982b178200">MemWaitRetry</a>,
<a name="l00072"></a>00072         <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca1883fc473d33feb95a8ea53164e91d0e">MemAccessComplete</a>
<a name="l00073"></a>00073     };
</pre></div></p>

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="a30721921ff32a2c7bc0e01c472c8c935"></a><!-- doxytag: member="PipelineStage::PipelineStage" ref="a30721921ff32a2c7bc0e01c472c8c935" args="(Params *params, unsigned stage_num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPipelineStage.html">PipelineStage</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPipelineStage.html#aa14874985381292db0aea05d1c8a122c">Params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>stage_num</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00047"></a>00047     : <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>(stage_num), <a class="code" href="classPipelineStage.html#a51d98139f56a84585e4cb68e3cd67a1c">stageWidth</a>(params-&gt;stageWidth),
<a name="l00048"></a>00048       <a class="code" href="classPipelineStage.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>(<a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>), <a class="code" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a>(<a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6">Inactive</a>),
<a name="l00049"></a>00049       <a class="code" href="classPipelineStage.html#a8b3bf50b9e561c023857979eaf326bee">stageBufferMax</a>(params-&gt;stageWidth),
<a name="l00050"></a>00050       <a class="code" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a>(<span class="keyword">false</span>), <a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a>(<span class="keyword">false</span>), <a class="code" href="classPipelineStage.html#a97808a9870039f4168da10ecfb5dc472">idle</a>(<span class="keyword">false</span>)
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052     <a class="code" href="classPipelineStage.html#a66db401ca5ea7de9fe7ca057d5eeb53c">init</a>(params);
<a name="l00053"></a>00053 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5045b86dad0c4a626861dc2aa1c59180"></a><!-- doxytag: member="PipelineStage::~PipelineStage" ref="a5045b86dad0c4a626861dc2aa1c59180" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">~<a class="el" href="classPipelineStage.html">PipelineStage</a> </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00056"></a>00056 {
<a name="l00057"></a>00057    <span class="keywordflow">for</span>(<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = 0; tid &lt; <a class="code" href="classPipelineStage.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; tid++) {
<a name="l00058"></a>00058        <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].clear();
<a name="l00059"></a>00059        <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.clear();
<a name="l00060"></a>00060    }
<a name="l00061"></a>00061 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a687aa4600423bb30ecf3bb1da6cd6000"></a><!-- doxytag: member="PipelineStage::activateThread" ref="a687aa4600423bb30ecf3bb1da6cd6000" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void activateThread </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00540"></a>00540 {    
<a name="l00541"></a>00541     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#af190f1a05b1875acfda59f02e59e2fe0">threadModel</a> == <a class="code" href="classInOrderCPU.html#a27fc31cad7f14b3f31546056efddeaf1af15b471f97b68795dc1ed6ca9cac5ebc">InOrderCPU::SwitchOnCacheMiss</a>) {
<a name="l00542"></a>00542         <span class="keywordflow">if</span> (!<a class="code" href="classPipelineStage.html#a09a91d6926260c8037374f0b646a62ee">switchedOutValid</a>[tid]) {
<a name="l00543"></a>00543             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i] No instruction available in &quot;</span>
<a name="l00544"></a>00544                     <span class="stringliteral">&quot;switch out buffer.\n&quot;</span>, tid);        
<a name="l00545"></a>00545         } <span class="keywordflow">else</span> {
<a name="l00546"></a>00546             <a class="code" href="classRefCountingPtr.html">DynInstPtr</a> inst = <a class="code" href="classPipelineStage.html#a693e4a546dfc51b4e402fe75e73e812e">switchedOutBuffer</a>[tid];
<a name="l00547"></a>00547 
<a name="l00548"></a>00548             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage,<span class="stringliteral">&quot;[tid:%i]: Re-Inserting [sn:%lli] PC:%s into&quot;</span>
<a name="l00549"></a>00549                     <span class="stringliteral">&quot; stage skidBuffer %i\n&quot;</span>, tid, inst-&gt;seqNum,
<a name="l00550"></a>00550                     inst-&gt;pcState(), inst-&gt;threadNumber);
<a name="l00551"></a>00551 
<a name="l00552"></a>00552             <span class="comment">// Make instruction available for pipeline processing</span>
<a name="l00553"></a>00553             <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].push_back(inst);
<a name="l00554"></a>00554 
<a name="l00555"></a>00555             <span class="comment">// Update PC so that we start fetching after this instruction to</span>
<a name="l00556"></a>00556             <span class="comment">// prevent &quot;double&quot;-execution of instructions</span>
<a name="l00557"></a>00557             <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a2979f0f9689d1d8615cacdc85c65e11f">resPool</a>-&gt;<a class="code" href="classResourcePool.html#a2ab648fcabe96285d025deacd2175cbd">scheduleEvent</a>((<a class="code" href="classInOrderCPU.html#aedc081b7a3ef1b1568e62dec4a64c1ca">InOrderCPU::CPUEventType</a>)
<a name="l00558"></a>00558                                         <a class="code" href="classResourcePool.html#a35de859343d36cfc41403577ea3c7de5a86a572ebd39e3afa528248332156c260">ResourcePool::UpdateAfterContextSwitch</a>, 
<a name="l00559"></a>00559                                         inst, <a class="code" href="classCycles.html">Cycles</a>(0), 0, tid);
<a name="l00560"></a>00560 
<a name="l00561"></a>00561             <span class="comment">// Clear switchout buffer</span>
<a name="l00562"></a>00562             <a class="code" href="classPipelineStage.html#a693e4a546dfc51b4e402fe75e73e812e">switchedOutBuffer</a>[tid] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00563"></a>00563             <a class="code" href="classPipelineStage.html#a09a91d6926260c8037374f0b646a62ee">switchedOutValid</a>[tid] = <span class="keyword">false</span>;            
<a name="l00564"></a>00564 
<a name="l00565"></a>00565             <span class="comment">// Update any CPU stats based off context switches</span>
<a name="l00566"></a>00566             <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a18e33751f284bf73d45d25224e93e6a0">updateContextSwitchStats</a>();            
<a name="l00567"></a>00567         }        
<a name="l00568"></a>00568     }
<a name="l00569"></a>00569     
<a name="l00570"></a>00570 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad1993925abd15d3fb59fde2ccfa3d678"></a><!-- doxytag: member="PipelineStage::block" ref="ad1993925abd15d3fb59fde2ccfa3d678" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool block </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Switches stage to blocking, and signals back that stage has become blocked. </p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Returns true if there is a status change. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00286"></a>00286 {
<a name="l00287"></a>00287     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%d]: Blocking, sending block signal back to &quot;</span>
<a name="l00288"></a>00288             <span class="stringliteral">&quot;previous stages.\n&quot;</span>, tid);
<a name="l00289"></a>00289 
<a name="l00290"></a>00290     <span class="comment">// If the stage status is blocked or unblocking then stage has not yet</span>
<a name="l00291"></a>00291     <span class="comment">// signalled fetch to unblock. In that case, there is no need to tell</span>
<a name="l00292"></a>00292     <span class="comment">// fetch to block.</span>
<a name="l00293"></a>00293     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] != <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>) {
<a name="l00294"></a>00294         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] != <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>) {
<a name="l00295"></a>00295             <a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">true</span>;
<a name="l00296"></a>00296         }
<a name="l00297"></a>00297 
<a name="l00298"></a>00298         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>;
<a name="l00299"></a>00299 
<a name="l00300"></a>00300         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a>) {
<a name="l00301"></a>00301             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%d]: Stage %i setting block signal.\n&quot;</span>,
<a name="l00302"></a>00302                     tid, <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l00303"></a>00303             <a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a>-&gt;stageBlock[<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>][tid] = <span class="keyword">true</span>;
<a name="l00304"></a>00304         }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00307"></a>00307     }
<a name="l00308"></a>00308 
<a name="l00309"></a>00309 
<a name="l00310"></a>00310     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00311"></a>00311 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aee83987cebca092f91d7328291e7d40f"></a><!-- doxytag: member="PipelineStage::blockDueToBuffer" ref="aee83987cebca092f91d7328291e7d40f" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void blockDueToBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00315"></a>00315 {
<a name="l00316"></a>00316     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%d]: Blocking instructions from passing to &quot;</span>
<a name="l00317"></a>00317             <span class="stringliteral">&quot;next stage.\n&quot;</span>, tid);
<a name="l00318"></a>00318 
<a name="l00319"></a>00319     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] != <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>) {
<a name="l00320"></a>00320         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] != <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>) {
<a name="l00321"></a>00321             <a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">true</span>;
<a name="l00322"></a>00322         }
<a name="l00323"></a>00323 
<a name="l00324"></a>00324         <span class="comment">// Set the status to Blocked.</span>
<a name="l00325"></a>00325         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>;
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4666632f247a5d92380cb32d6e286c75"></a><!-- doxytag: member="PipelineStage::canSendInstToStage" ref="a4666632f247a5d92380cb32d6e286c75" args="(unsigned stage_num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool canSendInstToStage </td>
          <td>(</td>
          <td class="paramtype">unsigned&nbsp;</td>
          <td class="paramname"> <em>stage_num</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Is there room in the next stage buffer for this instruction? </p>

<p><div class="fragment"><pre class="fragment"><a name="l00458"></a>00458 {
<a name="l00459"></a>00459     <span class="keywordtype">bool</span> buffer_avail = <span class="keyword">false</span>;
<a name="l00460"></a>00460 
<a name="l00461"></a>00461     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[stage_num]-&gt;<a class="code" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a>) {
<a name="l00462"></a>00462         buffer_avail = <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[stage_num]-&gt;<a class="code" href="classPipelineStage.html#a4623e7080104807616729bb5504b76ce">stageBufferAvail</a>() -
<a name="l00463"></a>00463             <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[stage_num-1]-&gt;<a class="code" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>() &gt;= 1;
<a name="l00464"></a>00464     }
<a name="l00465"></a>00465 
<a name="l00466"></a>00466     <span class="keywordflow">if</span> (!buffer_avail &amp;&amp; <a class="code" href="classPipelineStage.html#ab6e550d3e889847f642fa2205c6e12fd">nextStageQueueValid</a>(stage_num)) {
<a name="l00467"></a>00467         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStall, <span class="stringliteral">&quot;STALL: No room in stage %i buffer.\n&quot;</span>, 
<a name="l00468"></a>00468                 <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> + 1);
<a name="l00469"></a>00469     }
<a name="l00470"></a>00470 
<a name="l00471"></a>00471     <span class="keywordflow">return</span> buffer_avail;
<a name="l00472"></a>00472 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af77f2bf38a75182c65e633b9fdf295d2"></a><!-- doxytag: member="PipelineStage::checkSignalsAndUpdate" ref="af77f2bf38a75182c65e633b9fdf295d2" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkSignalsAndUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks all input signals and updates stage's status appropriately. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00661"></a>00661 {
<a name="l00662"></a>00662     <span class="comment">// Check if there&apos;s a squash signal, squash if there is.</span>
<a name="l00663"></a>00663     <span class="comment">// Check stall signals, block if necessary.</span>
<a name="l00664"></a>00664     <span class="comment">// If status was blocked</span>
<a name="l00665"></a>00665     <span class="comment">//     Check if stall conditions have passed</span>
<a name="l00666"></a>00666     <span class="comment">//         if so then go to unblocking</span>
<a name="l00667"></a>00667     <span class="comment">// If status was Squashing</span>
<a name="l00668"></a>00668     <span class="comment">//     check if squashing is not high.  Switch to running this cycle.</span>
<a name="l00669"></a>00669 
<a name="l00670"></a>00670     <span class="comment">// Update the per thread stall statuses.</span>
<a name="l00671"></a>00671     <a class="code" href="classPipelineStage.html#ad65c9f053a6038ac8c34c34bfe9a88c3">readStallSignals</a>(tid);
<a name="l00672"></a>00672 
<a name="l00673"></a>00673     <span class="comment">// Check for squash from later pipeline stages</span>
<a name="l00674"></a>00674     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stage_idx=<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>; stage_idx &lt; <a class="code" href="namespaceThePipeline.html#a6918d1731267e5f56969bfb5c240be85">NumStages</a>; stage_idx++) {
<a name="l00675"></a>00675         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageInfo[stage_idx][tid].squash) {
<a name="l00676"></a>00676             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Squashing instructions due to &quot;</span>
<a name="l00677"></a>00677                     <span class="stringliteral">&quot;squash from stage %u.\n&quot;</span>, tid, stage_idx);
<a name="l00678"></a>00678             <a class="code" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> squash_seq_num = <a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;
<a name="l00679"></a>00679                 stageInfo[stage_idx][tid].doneSeqNum;
<a name="l00680"></a>00680             <a class="code" href="classPipelineStage.html#aee9dc23de90acd20200641407a3bd1da">squash</a>(squash_seq_num, tid);
<a name="l00681"></a>00681             <span class="keywordflow">break</span>; <span class="comment">//return true;</span>
<a name="l00682"></a>00682         }
<a name="l00683"></a>00683     }
<a name="l00684"></a>00684 
<a name="l00685"></a>00685     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a6ba4f2f95d991f5be818dabf7500feed">checkStall</a>(tid)) {
<a name="l00686"></a>00686         <span class="keywordflow">return</span> <a class="code" href="classPipelineStage.html#ad1993925abd15d3fb59fde2ccfa3d678">block</a>(tid);
<a name="l00687"></a>00687     }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>) {
<a name="l00690"></a>00690         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Done blocking, switching to &quot;</span>
<a name="l00691"></a>00691                 <span class="stringliteral">&quot;unblocking.\n&quot;</span>, tid);
<a name="l00692"></a>00692 
<a name="l00693"></a>00693         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>;
<a name="l00694"></a>00694 
<a name="l00695"></a>00695         <a class="code" href="classPipelineStage.html#a9cc3b95f6969935f78c0158aa5145021">unblock</a>(tid);
<a name="l00696"></a>00696 
<a name="l00697"></a>00697         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00698"></a>00698     }
<a name="l00699"></a>00699 
<a name="l00700"></a>00700     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>) {
<a name="l00701"></a>00701         <span class="keywordflow">if</span> (!<a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].empty()) {
<a name="l00702"></a>00702             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Done squashing, switching to &quot;</span>
<a name="l00703"></a>00703                     <span class="stringliteral">&quot;unblocking.\n&quot;</span>, tid);
<a name="l00704"></a>00704 
<a name="l00705"></a>00705             <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>;
<a name="l00706"></a>00706         } <span class="keywordflow">else</span> {
<a name="l00707"></a>00707             <span class="comment">// Switch status to running if stage isn&apos;t being told to block or</span>
<a name="l00708"></a>00708             <span class="comment">// squash this cycle.</span>
<a name="l00709"></a>00709             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Done squashing, switching to &quot;</span>
<a name="l00710"></a>00710                     <span class="stringliteral">&quot;running.\n&quot;</span>, tid);
<a name="l00711"></a>00711 
<a name="l00712"></a>00712             <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>;
<a name="l00713"></a>00713         }
<a name="l00714"></a>00714 
<a name="l00715"></a>00715         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00716"></a>00716     }
<a name="l00717"></a>00717 
<a name="l00718"></a>00718     <span class="comment">// If we&apos;ve reached this point, we have not gotten any signals that</span>
<a name="l00719"></a>00719     <span class="comment">// cause stage to change its status.  Stage remains the same as before.*/</span>
<a name="l00720"></a>00720     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00721"></a>00721 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6ba4f2f95d991f5be818dabf7500feed"></a><!-- doxytag: member="PipelineStage::checkStall" ref="a6ba4f2f95d991f5be818dabf7500feed" args="(ThreadID tid) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool checkStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks all stall signals, and returns if any are true. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00219"></a>00219 {
<a name="l00220"></a>00220     <span class="keywordtype">bool</span> ret_val = <span class="keyword">false</span>;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222     <span class="comment">// Only check pipeline stall from stage directly following this stage</span>
<a name="l00223"></a>00223     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a> &amp;&amp; <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].stage[<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> + 1]) {
<a name="l00224"></a>00224         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage,<span class="stringliteral">&quot;[tid:%i]: Stall fom Stage %i detected.\n&quot;</span>,
<a name="l00225"></a>00225                 tid, <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> + 1);
<a name="l00226"></a>00226         ret_val = <span class="keyword">true</span>;
<a name="l00227"></a>00227     }
<a name="l00228"></a>00228 
<a name="l00229"></a>00229     <span class="keywordflow">if</span> (!<a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].resources.empty()) {
<a name="l00230"></a>00230 <span class="preprocessor">#if TRACING_ON</span>
<a name="l00231"></a>00231 <span class="preprocessor"></span>        <span class="keywordtype">string</span> stall_src;
<a name="l00232"></a>00232 
<a name="l00233"></a>00233         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>=0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.size(); <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00234"></a>00234             stall_src += <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;res-&gt;name() + <span class="stringliteral">&quot;:&quot;</span>;
<a name="l00235"></a>00235         }
<a name="l00236"></a>00236 
<a name="l00237"></a>00237         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage,<span class="stringliteral">&quot;[tid:%i]: Stall fom resources (%s) detected.\n&quot;</span>,
<a name="l00238"></a>00238                 tid, stall_src);
<a name="l00239"></a>00239 <span class="preprocessor">#endif</span>
<a name="l00240"></a>00240 <span class="preprocessor"></span>        ret_val = <span class="keyword">true</span>;
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     <span class="keywordflow">return</span> ret_val;
<a name="l00244"></a>00244 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a80587b4fe043bbe1995536cb3b361588"></a><!-- doxytag: member="PipelineStage::dumpInsts" ref="a80587b4fe043bbe1995536cb3b361588" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dumpInsts </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01108"></a>01108 {
<a name="l01109"></a>01109     <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;Insts in Stage %i skidbuffers\n&quot;</span>,<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l01110"></a>01110 
<a name="l01111"></a>01111     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = 0; tid &lt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>; tid++) {
<a name="l01112"></a>01112         <a class="code" href="classstd_1_1list.html">std::list&lt;DynInstPtr&gt;::iterator</a> cur_it =  <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].begin();
<a name="l01113"></a>01113         <a class="code" href="classstd_1_1list.html">std::list&lt;DynInstPtr&gt;::iterator</a> end_it =  <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].end();
<a name="l01114"></a>01114 
<a name="l01115"></a>01115         <span class="keywordflow">while</span> (cur_it != end_it) {
<a name="l01116"></a>01116             <a class="code" href="classRefCountingPtr.html">DynInstPtr</a> inst = (*cur_it);
<a name="l01117"></a>01117 
<a name="l01118"></a>01118             <a class="code" href="cprintf_8hh.html#a46231f0e413d30a2560384d0ae05536b">cprintf</a>(<span class="stringliteral">&quot;Inst. PC:%s\n[tid:%i]\n[sn:%i]\n\n&quot;</span>,
<a name="l01119"></a>01119                     inst-&gt;pcState(), inst-&gt;threadNumber, inst-&gt;seqNum);
<a name="l01120"></a>01120 
<a name="l01121"></a>01121             cur_it++;
<a name="l01122"></a>01122         }
<a name="l01123"></a>01123     }
<a name="l01124"></a>01124 
<a name="l01125"></a>01125 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a66db401ca5ea7de9fe7ca057d5eeb53c"></a><!-- doxytag: member="PipelineStage::init" ref="a66db401ca5ea7de9fe7ca057d5eeb53c" args="(Params *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPipelineStage.html#aa14874985381292db0aea05d1c8a122c">Params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classPipelineStage.html">PipelineStage</a> initialization. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00065"></a>00065 {
<a name="l00066"></a>00066     <span class="keywordflow">for</span>(<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = 0; tid &lt; <a class="code" href="classPipelineStage.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; tid++) {
<a name="l00067"></a>00067         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>;
<a name="l00068"></a>00068 
<a name="l00069"></a>00069         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stNum = 0; stNum &lt; <a class="code" href="namespaceThePipeline.html#a6918d1731267e5f56969bfb5c240be85">NumStages</a>; stNum++) {
<a name="l00070"></a>00070             <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#a7f7ee2cedce805d9faf18a261242fac3">stage</a>[stNum] = <span class="keyword">false</span>;
<a name="l00071"></a>00071         }
<a name="l00072"></a>00072         <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.clear();
<a name="l00073"></a>00073 
<a name="l00074"></a>00074         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> &lt; <a class="code" href="namespaceThePipeline.html#a1508fbbf00b857ada3c63696ded87cf6">BackEndStartStage</a>)
<a name="l00075"></a>00075             <a class="code" href="classPipelineStage.html#ac171ebbc339fe3c1b91878034586b7a5">lastStallingStage</a>[tid] = <a class="code" href="namespaceThePipeline.html#a1508fbbf00b857ada3c63696ded87cf6">BackEndStartStage</a> - 1;
<a name="l00076"></a>00076         <span class="keywordflow">else</span>
<a name="l00077"></a>00077             <a class="code" href="classPipelineStage.html#ac171ebbc339fe3c1b91878034586b7a5">lastStallingStage</a>[tid] = NumStages - 1;
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="keywordflow">if</span> ((<a class="code" href="classInOrderCPU_1_1ThreadModel.html">InOrderCPU::ThreadModel</a>) params-&gt;threadModel ==
<a name="l00081"></a>00081         <a class="code" href="classInOrderCPU.html#a27fc31cad7f14b3f31546056efddeaf1af15b471f97b68795dc1ed6ca9cac5ebc">InOrderCPU::SwitchOnCacheMiss</a>) {
<a name="l00082"></a>00082         <a class="code" href="classPipelineStage.html#a693e4a546dfc51b4e402fe75e73e812e">switchedOutBuffer</a>.resize(<a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>);
<a name="l00083"></a>00083         <a class="code" href="classPipelineStage.html#a09a91d6926260c8037374f0b646a62ee">switchedOutValid</a>.resize(<a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>);
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab8e0f4a73d5a3ab9fe269f3c36d97e4f"></a><!-- doxytag: member="PipelineStage::isBlocked" ref="ab8e0f4a73d5a3ab9fe269f3c36d97e4f" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isBlocked </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00280"></a>00280 {
<a name="l00281"></a>00281     <span class="keywordflow">return</span> <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca9463ee9b8700258a1019b4b9d2d77a30">Blocked</a>;
<a name="l00282"></a>00282 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37627d5d5bba7f4a8690c71c2ab3cb07"></a><!-- doxytag: member="PipelineStage::name" ref="a37627d5d5bba7f4a8690c71c2ab3cb07" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the name of stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00090"></a>00090 {
<a name="l00091"></a>00091      <span class="keywordflow">return</span> <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;name() + <span class="stringliteral">&quot;.stage&quot;</span> + <a class="code" href="str_8hh.html#a61cce639667f3e4f1d8790c4fec5c439">to_string</a>(<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l00092"></a>00092 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab6e550d3e889847f642fa2205c6e12fd"></a><!-- doxytag: member="PipelineStage::nextStageQueueValid" ref="ab6e550d3e889847f642fa2205c6e12fd" args="(int stage_num)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool nextStageQueueValid </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage_num</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01037"></a>01037 {
<a name="l01038"></a>01038     <span class="keywordflow">return</span> <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[stage_num]-&gt;<a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a>;
<a name="l01039"></a>01039 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab03996f3423928a0e84dc3df7fd493f2"></a><!-- doxytag: member="PipelineStage::prevStageInstsValid" ref="ab03996f3423928a0e84dc3df7fd493f2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool prevStageInstsValid </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns if there any instructions from the previous stage on this cycle. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00274"></a>00274 {
<a name="l00275"></a>00275     <span class="keywordflow">return</span> <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>() &gt; 0;
<a name="l00276"></a>00276 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4120d7c6b83eb82877f4d21109c105ba"></a><!-- doxytag: member="PipelineStage::processInsts" ref="a4120d7c6b83eb82877f4d21109c105ba" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processInsts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Processes instructions from fetch and passes them on to rename. Decoding of instructions actually happens when they are created in fetch, so this function mostly checks if PC-relative branches are correct. </p>

<p><a class="el" href="classFirstStage.html#a4120d7c6b83eb82877f4d21109c105ba">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00860"></a>00860 {
<a name="l00861"></a>00861     <span class="comment">// Instructions can come either from the skid buffer or the list of</span>
<a name="l00862"></a>00862     <span class="comment">// instructions coming from fetch, depending on stage&apos;s status.</span>
<a name="l00863"></a>00863     <span class="keywordtype">int</span> insts_available = <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].size();
<a name="l00864"></a>00864 
<a name="l00865"></a>00865     <a class="code" href="classstd_1_1list.html">std::list&lt;DynInstPtr&gt;</a> &amp;insts_to_stage = <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid];
<a name="l00866"></a>00866 
<a name="l00867"></a>00867     <span class="keywordflow">if</span> (insts_available == 0) {
<a name="l00868"></a>00868         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Nothing to do, breaking out&quot;</span>
<a name="l00869"></a>00869                 <span class="stringliteral">&quot; early.\n&quot;</span>,tid);
<a name="l00870"></a>00870         <span class="keywordflow">return</span>;
<a name="l00871"></a>00871     }
<a name="l00872"></a>00872 
<a name="l00873"></a>00873     <a class="code" href="classRefCountingPtr.html">DynInstPtr</a> inst;
<a name="l00874"></a>00874     <span class="keywordtype">bool</span> last_req_completed = <span class="keyword">true</span>;
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     <span class="keywordflow">while</span> (insts_available &gt; 0 &amp;&amp;
<a name="l00877"></a>00877            <a class="code" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a> &lt; <a class="code" href="classPipelineStage.html#a51d98139f56a84585e4cb68e3cd67a1c">stageWidth</a> &amp;&amp;
<a name="l00878"></a>00878            last_req_completed) {
<a name="l00879"></a>00879         assert(!insts_to_stage.empty());
<a name="l00880"></a>00880 
<a name="l00881"></a>00881         inst = insts_to_stage.front();
<a name="l00882"></a>00882 
<a name="l00883"></a>00883         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Processing instruction [sn:%lli] &quot;</span>
<a name="l00884"></a>00884                 <span class="stringliteral">&quot;%s with PC %s\n&quot;</span>, tid, inst-&gt;seqNum,
<a name="l00885"></a>00885                 inst-&gt;instName(),
<a name="l00886"></a>00886                 inst-&gt;pcState());
<a name="l00887"></a>00887 
<a name="l00888"></a>00888         <span class="keywordflow">if</span> (inst-&gt;isSquashed()) {
<a name="l00889"></a>00889             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Instruction %i with PC %s is &quot;</span>
<a name="l00890"></a>00890                     <span class="stringliteral">&quot;squashed, skipping.\n&quot;</span>,
<a name="l00891"></a>00891                     tid, inst-&gt;seqNum, inst-&gt;pcState());
<a name="l00892"></a>00892 
<a name="l00893"></a>00893             insts_to_stage.pop_front();
<a name="l00894"></a>00894 
<a name="l00895"></a>00895             --insts_available;
<a name="l00896"></a>00896 
<a name="l00897"></a>00897             <span class="keywordflow">continue</span>;
<a name="l00898"></a>00898         }
<a name="l00899"></a>00899 
<a name="l00900"></a>00900         <span class="keywordtype">int</span> reqs_processed = 0;        
<a name="l00901"></a>00901         last_req_completed = <a class="code" href="classPipelineStage.html#ac8bd857e45d0b201ea328b6ea8bcb890">processInstSchedule</a>(inst, reqs_processed);
<a name="l00902"></a>00902 
<a name="l00903"></a>00903         <span class="comment">// If the instruction isnt squashed &amp; we&apos;ve completed one request</span>
<a name="l00904"></a>00904         <span class="comment">// Then we can officially count this instruction toward the stage&apos;s </span>
<a name="l00905"></a>00905         <span class="comment">// bandwidth count</span>
<a name="l00906"></a>00906         <span class="keywordflow">if</span> (reqs_processed &gt; 0)
<a name="l00907"></a>00907             <a class="code" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a>++;
<a name="l00908"></a>00908 
<a name="l00909"></a>00909         <span class="comment">// Don&apos;t let instruction pass to next stage if it hasnt completed</span>
<a name="l00910"></a>00910         <span class="comment">// all of it&apos;s requests for this stage.</span>
<a name="l00911"></a>00911         <span class="keywordflow">if</span> (!last_req_completed)
<a name="l00912"></a>00912             <span class="keywordflow">continue</span>;
<a name="l00913"></a>00913 
<a name="l00914"></a>00914         <span class="comment">// Send to Next Stage or Break Loop</span>
<a name="l00915"></a>00915         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a> &amp;&amp; !<a class="code" href="classPipelineStage.html#a3a5710b990e95498611464d54c90dcf1">sendInstToNextStage</a>(inst)) {
<a name="l00916"></a>00916             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i] [sn:%i] unable to proceed to stage&quot;</span>
<a name="l00917"></a>00917                     <span class="stringliteral">&quot; %i.\n&quot;</span>, tid, inst-&gt;seqNum,inst-&gt;nextStage);
<a name="l00918"></a>00918             <span class="keywordflow">break</span>;
<a name="l00919"></a>00919         }
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         insts_to_stage.pop_front();
<a name="l00922"></a>00922 
<a name="l00923"></a>00923         --insts_available;
<a name="l00924"></a>00924     }
<a name="l00925"></a>00925 
<a name="l00926"></a>00926     <span class="comment">// If we didn&apos;t process all instructions, then we will need to block</span>
<a name="l00927"></a>00927     <span class="comment">// and put all those instructions into the skid buffer.</span>
<a name="l00928"></a>00928     <span class="keywordflow">if</span> (!insts_to_stage.empty()) {
<a name="l00929"></a>00929         <a class="code" href="classPipelineStage.html#aee83987cebca092f91d7328291e7d40f">blockDueToBuffer</a>(tid);
<a name="l00930"></a>00930     }
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     <span class="comment">// Record that stage has written to the time buffer for activity</span>
<a name="l00933"></a>00933     <span class="comment">// tracking.</span>
<a name="l00934"></a>00934     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a>) {
<a name="l00935"></a>00935         <a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">true</span>;
<a name="l00936"></a>00936     }
<a name="l00937"></a>00937 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac8bd857e45d0b201ea328b6ea8bcb890"></a><!-- doxytag: member="PipelineStage::processInstSchedule" ref="ac8bd857e45d0b201ea328b6ea8bcb890" args="(DynInstPtr inst, int &amp;reqs_processed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool processInstSchedule </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>inst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&nbsp;</td>
          <td class="paramname"> <em>reqs_processed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classProcess.html">Process</a> all resources on an instruction's resource schedule </p>

<p><div class="fragment"><pre class="fragment"><a name="l00941"></a>00941 {
<a name="l00942"></a>00942     <span class="keywordtype">bool</span> last_req_completed = <span class="keyword">true</span>;
<a name="l00943"></a>00943     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = inst-&gt;readTid();
<a name="l00944"></a>00944 
<a name="l00945"></a>00945     <span class="keywordflow">if</span> (inst-&gt;nextResStage() == <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>) {
<a name="l00946"></a>00946         <span class="keywordtype">int</span> res_stage_num = inst-&gt;nextResStage();
<a name="l00947"></a>00947 
<a name="l00948"></a>00948         <span class="keywordflow">while</span> (res_stage_num == <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>) {
<a name="l00949"></a>00949             <span class="keywordtype">int</span> res_num = inst-&gt;nextResource();
<a name="l00950"></a>00950 
<a name="l00951"></a>00951 
<a name="l00952"></a>00952             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: [sn:%i]: sending request to %s.&quot;</span>
<a name="l00953"></a>00953                     <span class="stringliteral">&quot;\n&quot;</span>, tid, inst-&gt;seqNum, <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a2979f0f9689d1d8615cacdc85c65e11f">resPool</a>-&gt;<a class="code" href="classResourcePool.html#aa62b508d2c0e7d9cec12924965276eb5">name</a>(res_num));
<a name="l00954"></a>00954 
<a name="l00955"></a>00955             <a class="code" href="classResourceRequest.html">ResReqPtr</a> req = <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a2979f0f9689d1d8615cacdc85c65e11f">resPool</a>-&gt;<a class="code" href="classResourcePool.html#a75ce2cd367c200399a9fd0839d951124">request</a>(res_num, inst);
<a name="l00956"></a>00956             assert(req-&gt;valid);
<a name="l00957"></a>00957 
<a name="l00958"></a>00958             <span class="keywordtype">bool</span> req_completed = req-&gt;isCompleted();
<a name="l00959"></a>00959             <span class="keywordtype">bool</span> done_in_pipeline = <span class="keyword">false</span>;
<a name="l00960"></a>00960             <span class="keywordflow">if</span> (req_completed) {
<a name="l00961"></a>00961                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: [sn:%i] request to %s &quot;</span>
<a name="l00962"></a>00962                         <span class="stringliteral">&quot;completed.\n&quot;</span>, tid, inst-&gt;seqNum, 
<a name="l00963"></a>00963                         <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a2979f0f9689d1d8615cacdc85c65e11f">resPool</a>-&gt;<a class="code" href="classResourcePool.html#aa62b508d2c0e7d9cec12924965276eb5">name</a>(res_num));
<a name="l00964"></a>00964 
<a name="l00965"></a>00965                 reqs_processed++;                
<a name="l00966"></a>00966 
<a name="l00967"></a>00967                 req-&gt;stagePasses++;                
<a name="l00968"></a>00968 
<a name="l00969"></a>00969                 done_in_pipeline = inst-&gt;finishSkedEntry();
<a name="l00970"></a>00970                 <span class="keywordflow">if</span> (done_in_pipeline) {
<a name="l00971"></a>00971                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classInOrderDynInst.html">InOrderDynInst</a>, <span class="stringliteral">&quot;[tid:%i]: [sn:%i] finished &quot;</span>
<a name="l00972"></a>00972                             <span class="stringliteral">&quot;in pipeline.\n&quot;</span>, tid, inst-&gt;seqNum);
<a name="l00973"></a>00973                 }
<a name="l00974"></a>00974             } <span class="keywordflow">else</span> {
<a name="l00975"></a>00975                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: [sn:%i] request to %s failed.&quot;</span>
<a name="l00976"></a>00976                         <span class="stringliteral">&quot;\n&quot;</span>, tid, inst-&gt;seqNum, <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a2979f0f9689d1d8615cacdc85c65e11f">resPool</a>-&gt;<a class="code" href="classResourcePool.html#aa62b508d2c0e7d9cec12924965276eb5">name</a>(res_num));
<a name="l00977"></a>00977 
<a name="l00978"></a>00978                 last_req_completed = <span class="keyword">false</span>;
<a name="l00979"></a>00979 
<a name="l00980"></a>00980                 <span class="keywordflow">if</span> (req-&gt;isMemStall() &amp;&amp; 
<a name="l00981"></a>00981                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#af190f1a05b1875acfda59f02e59e2fe0">threadModel</a> == <a class="code" href="classInOrderCPU.html#a27fc31cad7f14b3f31546056efddeaf1af15b471f97b68795dc1ed6ca9cac5ebc">InOrderCPU::SwitchOnCacheMiss</a>) {
<a name="l00982"></a>00982                     <span class="comment">// Save Stalling Instruction</span>
<a name="l00983"></a>00983                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(ThreadModel, <span class="stringliteral">&quot;[tid:%i] [sn:%i] Detected cache &quot;</span>
<a name="l00984"></a>00984                             <span class="stringliteral">&quot;miss.\n&quot;</span>, tid, inst-&gt;seqNum);
<a name="l00985"></a>00985 
<a name="l00986"></a>00986                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Inserting [tid:%i][sn:%i] into &quot;</span>
<a name="l00987"></a>00987                             <span class="stringliteral">&quot;switch out buffer.\n&quot;</span>, tid, inst-&gt;seqNum);
<a name="l00988"></a>00988 
<a name="l00989"></a>00989                     <a class="code" href="classPipelineStage.html#a693e4a546dfc51b4e402fe75e73e812e">switchedOutBuffer</a>[tid] = inst;
<a name="l00990"></a>00990                     <a class="code" href="classPipelineStage.html#a09a91d6926260c8037374f0b646a62ee">switchedOutValid</a>[tid] = <span class="keyword">true</span>;
<a name="l00991"></a>00991                     
<a name="l00992"></a>00992                     <span class="comment">// Remove Thread From Pipeline &amp; Resource Pool</span>
<a name="l00993"></a>00993                     inst-&gt;squashingStage = <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>;
<a name="l00994"></a>00994                     inst-&gt;squashSeqNum = inst-&gt;seqNum;
<a name="l00995"></a>00995                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a3b9652a69ff2d5c02c1b696c1007ac9d">squashFromMemStall</a>(inst, tid);  
<a name="l00996"></a>00996 
<a name="l00997"></a>00997                     <span class="comment">// Switch On Cache Miss</span>
<a name="l00998"></a>00998                     <span class="comment">//=====================</span>
<a name="l00999"></a>00999                     <span class="comment">// Suspend Thread at end of cycle</span>
<a name="l01000"></a>01000                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(ThreadModel, <span class="stringliteral">&quot;Suspending [tid:%i] due to cache &quot;</span>
<a name="l01001"></a>01001                             <span class="stringliteral">&quot;miss.\n&quot;</span>, tid);
<a name="l01002"></a>01002                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aed2e2b9af515a66bdde61b85f150856a">suspendContext</a>(tid);                    
<a name="l01003"></a>01003 
<a name="l01004"></a>01004                     <span class="comment">// Activate Next Ready Thread at end of cycle</span>
<a name="l01005"></a>01005                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(ThreadModel, <span class="stringliteral">&quot;Attempting to activate next ready &quot;</span>
<a name="l01006"></a>01006                             <span class="stringliteral">&quot;thread due to cache miss.\n&quot;</span>);
<a name="l01007"></a>01007                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a067a25ab186d028e9c581a68903f5e32">activateNextReadyContext</a>();
<a name="l01008"></a>01008                 }
<a name="l01009"></a>01009             }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011             <span class="comment">// If this request is no longer needs to take up bandwidth in the</span>
<a name="l01012"></a>01012             <span class="comment">// resource, go ahead and free that bandwidth up</span>
<a name="l01013"></a>01013             <span class="keywordflow">if</span> (req-&gt;doneInResource) {
<a name="l01014"></a>01014                 req-&gt;freeSlot();
<a name="l01015"></a>01015             }
<a name="l01016"></a>01016 
<a name="l01017"></a>01017             <span class="comment">// No longer need to process this instruction if the last</span>
<a name="l01018"></a>01018             <span class="comment">// request it had wasn&apos;t completed or if there is nothing</span>
<a name="l01019"></a>01019             <span class="comment">// else for it to do in the pipeline</span>
<a name="l01020"></a>01020             <span class="keywordflow">if</span> (done_in_pipeline || !req_completed) {
<a name="l01021"></a>01021                 <span class="keywordflow">break</span>;
<a name="l01022"></a>01022             }
<a name="l01023"></a>01023 
<a name="l01024"></a>01024             res_stage_num = inst-&gt;nextResStage();
<a name="l01025"></a>01025         }
<a name="l01026"></a>01026     } <span class="keywordflow">else</span> {
<a name="l01027"></a>01027         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Instruction [sn:%i] with PC %s &quot;</span>
<a name="l01028"></a>01028                 <span class="stringliteral">&quot; needed no resources in stage %i.\n&quot;</span>,
<a name="l01029"></a>01029                 tid, inst-&gt;seqNum, inst-&gt;pcState(), <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l01030"></a>01030     }
<a name="l01031"></a>01031 
<a name="l01032"></a>01032     <span class="keywordflow">return</span> last_req_completed;
<a name="l01033"></a>01033 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0782fca2c80ef367ee914d464584ab20"></a><!-- doxytag: member="PipelineStage::processStage" ref="a0782fca2c80ef367ee914d464584ab20" args="(bool &amp;status_change)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processStage </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>status_change</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Evaluate Stage Conditions and then process stage </p>

<p><a class="el" href="classFirstStage.html#a0782fca2c80ef367ee914d464584ab20">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00792"></a>00792 {
<a name="l00793"></a>00793     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l00794"></a>00794 
<a name="l00795"></a>00795     <span class="comment">//Check stall and squash signals.</span>
<a name="l00796"></a>00796     <span class="keywordflow">while</span> (threads != <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end()) {
<a name="l00797"></a>00797         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *threads++;
<a name="l00798"></a>00798 
<a name="l00799"></a>00799         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage,<span class="stringliteral">&quot;Processing [tid:%i]\n&quot;</span>,tid);
<a name="l00800"></a>00800         status_change =  <a class="code" href="classPipelineStage.html#af77f2bf38a75182c65e633b9fdf295d2">checkSignalsAndUpdate</a>(tid) || status_change;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802         <a class="code" href="classPipelineStage.html#a3e391d45d3f6411be62510f3b23105c9">processThread</a>(status_change, tid);
<a name="l00803"></a>00803     }
<a name="l00804"></a>00804 
<a name="l00805"></a>00805     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a>) {
<a name="l00806"></a>00806         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;%i insts now available for stage %i.\n&quot;</span>,
<a name="l00807"></a>00807                 <a class="code" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>(), <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> + 1);
<a name="l00808"></a>00808     }
<a name="l00809"></a>00809 
<a name="l00810"></a>00810     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a> &gt; 0) {
<a name="l00811"></a>00811         ++<a class="code" href="classPipelineStage.html#af9addd340a133c2f4add363a3055b019">runCycles</a>;
<a name="l00812"></a>00812         <a class="code" href="classPipelineStage.html#a97808a9870039f4168da10ecfb5dc472">idle</a> = <span class="keyword">false</span>;        
<a name="l00813"></a>00813     } <span class="keywordflow">else</span> {
<a name="l00814"></a>00814         ++<a class="code" href="classPipelineStage.html#a42e0f4c18fdb8ef7504f5c45d697fb14">idleCycles</a>;        
<a name="l00815"></a>00815         <a class="code" href="classPipelineStage.html#a97808a9870039f4168da10ecfb5dc472">idle</a> = <span class="keyword">true</span>;        
<a name="l00816"></a>00816     }
<a name="l00817"></a>00817     
<a name="l00818"></a>00818     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;%i left in stage %i incoming buffer.\n&quot;</span>, <a class="code" href="classPipelineStage.html#a112431820c072831aa16794d42dc25e4">skidSize</a>(),
<a name="l00819"></a>00819             <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l00820"></a>00820 
<a name="l00821"></a>00821     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;%i available in stage %i incoming buffer.\n&quot;</span>, 
<a name="l00822"></a>00822             <a class="code" href="classPipelineStage.html#a4623e7080104807616729bb5504b76ce">stageBufferAvail</a>(), <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l00823"></a>00823 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3e391d45d3f6411be62510f3b23105c9"></a><!-- doxytag: member="PipelineStage::processThread" ref="a3e391d45d3f6411be62510f3b23105c9" args="(bool &amp;status_change, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processThread </td>
          <td>(</td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>status_change</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Determines what to do based on stage's current status. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>status_change</em>&nbsp;</td><td>stage() sets this variable if there was a status change (ie switching from from blocking to unblocking). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tid</em>&nbsp;</td><td>Thread id to stage instructions from. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00827"></a>00827 {
<a name="l00828"></a>00828     <span class="comment">// If status is Running or idle,</span>
<a name="l00829"></a>00829     <span class="comment">//     call processInsts()</span>
<a name="l00830"></a>00830     <span class="comment">// If status is Unblocking,</span>
<a name="l00831"></a>00831     <span class="comment">//     buffer any instructions coming from fetch</span>
<a name="l00832"></a>00832    <span class="comment">//     continue trying to empty skid buffer</span>
<a name="l00833"></a>00833     <span class="comment">//     check if stall conditions have passed</span>
<a name="l00834"></a>00834 
<a name="l00835"></a>00835     <span class="comment">// Stage should try to process as many instructions as its bandwidth</span>
<a name="l00836"></a>00836     <span class="comment">// will allow, as long as it is not currently blocked.</span>
<a name="l00837"></a>00837     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l00838"></a>00838         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>) {
<a name="l00839"></a>00839         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Not blocked, so attempting to run &quot;</span>
<a name="l00840"></a>00840                 <span class="stringliteral">&quot;stage.\n&quot;</span>,tid);
<a name="l00841"></a>00841 
<a name="l00842"></a>00842         <a class="code" href="classPipelineStage.html#a4120d7c6b83eb82877f4d21109c105ba">processInsts</a>(tid);
<a name="l00843"></a>00843     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>) {
<a name="l00844"></a>00844         <span class="comment">// Make sure that the skid buffer has something in it if the</span>
<a name="l00845"></a>00845         <span class="comment">// status is unblocking.</span>
<a name="l00846"></a>00846         assert(!<a class="code" href="classPipelineStage.html#afe3e2673d17dd5c568862ef5ae68b4d8">skidsEmpty</a>());
<a name="l00847"></a>00847 
<a name="l00848"></a>00848         <span class="comment">// If the status was unblocking, then instructions from the skid</span>
<a name="l00849"></a>00849         <span class="comment">// buffer were used.  Remove those instructions and handle</span>
<a name="l00850"></a>00850         <span class="comment">// the rest of unblocking.</span>
<a name="l00851"></a>00851         <a class="code" href="classPipelineStage.html#a4120d7c6b83eb82877f4d21109c105ba">processInsts</a>(tid);
<a name="l00852"></a>00852 
<a name="l00853"></a>00853         status_change = <a class="code" href="classPipelineStage.html#a9cc3b95f6969935f78c0158aa5145021">unblock</a>(tid) || status_change;
<a name="l00854"></a>00854     }
<a name="l00855"></a>00855 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad65c9f053a6038ac8c34c34bfe9a88c3"></a><!-- doxytag: member="PipelineStage::readStallSignals" ref="ad65c9f053a6038ac8c34c34bfe9a88c3" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void readStallSignals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reads all stall signals from the backwards communication timebuffer. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00630"></a>00630 {
<a name="l00631"></a>00631     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stage_idx = <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>+1; stage_idx &lt;= <a class="code" href="classPipelineStage.html#ac171ebbc339fe3c1b91878034586b7a5">lastStallingStage</a>[tid];
<a name="l00632"></a>00632          stage_idx++) {
<a name="l00633"></a>00633 
<a name="l00634"></a>00634         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i] Reading stall signals from Stage &quot;</span>
<a name="l00635"></a>00635                 <span class="stringliteral">&quot;%i. Block:%i Unblock:%i.\n&quot;</span>,
<a name="l00636"></a>00636                 tid,
<a name="l00637"></a>00637                 stage_idx,
<a name="l00638"></a>00638                 <a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageBlock[stage_idx][tid],
<a name="l00639"></a>00639                 <a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageUnblock[stage_idx][tid]);
<a name="l00640"></a>00640 
<a name="l00641"></a>00641         <span class="comment">// Check for Stage Blocking Signal</span>
<a name="l00642"></a>00642         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageBlock[stage_idx][tid]) {
<a name="l00643"></a>00643             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i] Stall from stage %i set.\n&quot;</span>, tid,
<a name="l00644"></a>00644                     stage_idx);
<a name="l00645"></a>00645             <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#a7f7ee2cedce805d9faf18a261242fac3">stage</a>[stage_idx] = <span class="keyword">true</span>;
<a name="l00646"></a>00646         }
<a name="l00647"></a>00647 
<a name="l00648"></a>00648         <span class="comment">// Check for Stage Unblocking Signal</span>
<a name="l00649"></a>00649         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageUnblock[stage_idx][tid]) {
<a name="l00650"></a>00650             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i] Stall from stage %i unset.\n&quot;</span>, tid,
<a name="l00651"></a>00651                     stage_idx);
<a name="l00652"></a>00652             <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#a7f7ee2cedce805d9faf18a261242fac3">stage</a>[stage_idx] = <span class="keyword">false</span>;
<a name="l00653"></a>00653         }
<a name="l00654"></a>00654     }
<a name="l00655"></a>00655 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4dc637449366fcdfc4e764cdf12d9b11"></a><!-- doxytag: member="PipelineStage::regStats" ref="a4dc637449366fcdfc4e764cdf12d9b11" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regStats </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Registers statistics. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00097"></a>00097 {
<a name="l00098"></a>00098    <a class="code" href="classPipelineStage.html#a42e0f4c18fdb8ef7504f5c45d697fb14">idleCycles</a>
<a name="l00099"></a>00099         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classPipelineStage.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.idleCycles&quot;</span>)
<a name="l00100"></a>00100        .desc(<span class="stringliteral">&quot;Number of cycles 0 instructions are processed.&quot;</span>);
<a name="l00101"></a>00101    
<a name="l00102"></a>00102     <a class="code" href="classPipelineStage.html#af9addd340a133c2f4add363a3055b019">runCycles</a>
<a name="l00103"></a>00103         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classPipelineStage.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.runCycles&quot;</span>)
<a name="l00104"></a>00104         .desc(<span class="stringliteral">&quot;Number of cycles 1+ instructions are processed.&quot;</span>);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <a class="code" href="classPipelineStage.html#a04353589e0e920909d3ceb8e73abb7ac">utilization</a>
<a name="l00107"></a>00107         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classPipelineStage.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>() + <span class="stringliteral">&quot;.utilization&quot;</span>)
<a name="l00108"></a>00108         .desc(<span class="stringliteral">&quot;Percentage of cycles stage was utilized (processing insts).&quot;</span>)
<a name="l00109"></a>00109         .precision(6);
<a name="l00110"></a>00110     <a class="code" href="classPipelineStage.html#a04353589e0e920909d3ceb8e73abb7ac">utilization</a> = (<a class="code" href="classPipelineStage.html#af9addd340a133c2f4add363a3055b019">runCycles</a> / <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;numCycles) * 100;
<a name="l00111"></a>00111     
<a name="l00112"></a>00112 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af5bd22ce78c3a8bafb5b91b7b70e8a41"></a><!-- doxytag: member="PipelineStage::removeStalls" ref="af5bd22ce78c3a8bafb5b91b7b70e8a41" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void removeStalls </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remove all stall signals for a particular thread; </p>

<p><div class="fragment"><pre class="fragment"><a name="l00249"></a>00249 {
<a name="l00250"></a>00250     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> st_num = 0; st_num &lt; <a class="code" href="namespaceThePipeline.html#a6918d1731267e5f56969bfb5c240be85">NumStages</a>; st_num++) {
<a name="l00251"></a>00251         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].stage[st_num]) {
<a name="l00252"></a>00252             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Removing stall from stage %i.\n&quot;</span>,
<a name="l00253"></a>00253                     st_num);
<a name="l00254"></a>00254             <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#a7f7ee2cedce805d9faf18a261242fac3">stage</a>[st_num] = <span class="keyword">false</span>;
<a name="l00255"></a>00255         }
<a name="l00256"></a>00256 
<a name="l00257"></a>00257         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a>-&gt;stageBlock[st_num][tid]) {
<a name="l00258"></a>00258             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Removing pending block from stage %i.\n&quot;</span>,
<a name="l00259"></a>00259                     st_num);
<a name="l00260"></a>00260             <a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a>-&gt;stageBlock[st_num][tid] = <span class="keyword">false</span>;
<a name="l00261"></a>00261         }
<a name="l00262"></a>00262 
<a name="l00263"></a>00263         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageBlock[st_num][tid]) {
<a name="l00264"></a>00264             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Removing pending block from stage %i.\n&quot;</span>,
<a name="l00265"></a>00265                     st_num);
<a name="l00266"></a>00266             <a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a>-&gt;stageBlock[st_num][tid] = <span class="keyword">false</span>;
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268     }
<a name="l00269"></a>00269     <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.clear();
<a name="l00270"></a>00270 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3a5710b990e95498611464d54c90dcf1"></a><!-- doxytag: member="PipelineStage::sendInstToNextStage" ref="a3a5710b990e95498611464d54c90dcf1" args="(DynInstPtr inst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool sendInstToNextStage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>inst</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Send an instruction to the next stage buffer </p>

<p><div class="fragment"><pre class="fragment"><a name="l01044"></a>01044 {
<a name="l01045"></a>01045     <span class="comment">// Update Next Stage Variable in Instruction</span>
<a name="l01046"></a>01046     <span class="comment">// NOTE: Some Resources will update this nextStage var. to</span>
<a name="l01047"></a>01047     <span class="comment">// for bypassing, so can&apos;t always assume nextStage=stageNum+1</span>
<a name="l01048"></a>01048     <span class="keywordflow">if</span> (inst-&gt;nextStage == <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>)
<a name="l01049"></a>01049         inst-&gt;nextStage++;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051     <span class="keywordtype">bool</span> success = <span class="keyword">false</span>;
<a name="l01052"></a>01052     <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = inst-&gt;readTid();
<a name="l01053"></a>01053     <span class="keywordtype">int</span> next_stage = inst-&gt;nextStage;
<a name="l01054"></a>01054     <span class="keywordtype">int</span> prev_stage = next_stage - 1;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056     assert(next_stage &gt;= 1);
<a name="l01057"></a>01057     assert(prev_stage &gt;= 0);
<a name="l01058"></a>01058 
<a name="l01059"></a>01059     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Attempting to send instructions to &quot;</span>
<a name="l01060"></a>01060             <span class="stringliteral">&quot;stage %u.\n&quot;</span>, tid, <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>+1);
<a name="l01061"></a>01061 
<a name="l01062"></a>01062     <span class="keywordflow">if</span> (!<a class="code" href="classPipelineStage.html#a4666632f247a5d92380cb32d6e286c75">canSendInstToStage</a>(inst-&gt;nextStage)) {
<a name="l01063"></a>01063         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Could not send instruction to &quot;</span>
<a name="l01064"></a>01064                 <span class="stringliteral">&quot;stage %u.\n&quot;</span>, tid, <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>+1);
<a name="l01065"></a>01065         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l01066"></a>01066     }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068 
<a name="l01069"></a>01069     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#ab6e550d3e889847f642fa2205c6e12fd">nextStageQueueValid</a>(inst-&gt;nextStage - 1)) {
<a name="l01070"></a>01070         <span class="keywordflow">if</span> (inst-&gt;seqNum &gt; <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a8c48389ee147811c1be413cdd4be4b68">squashSeqNum</a>[tid] &amp;&amp;
<a name="l01071"></a>01071             <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() == <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a07ac7fa00a59be2904eaa76d4735681e">lastSquashCycle</a>[tid]) {
<a name="l01072"></a>01072             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: [sn:%i]: squashed, skipping &quot;</span>
<a name="l01073"></a>01073                     <span class="stringliteral">&quot;insertion into stage %i queue.\n&quot;</span>, tid, inst-&gt;seqNum, 
<a name="l01074"></a>01074                     inst-&gt;nextStage);
<a name="l01075"></a>01075         } <span class="keywordflow">else</span> {
<a name="l01076"></a>01076             <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a>) {
<a name="l01077"></a>01077                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u] %i slots available in next &quot;</span>
<a name="l01078"></a>01078                         <span class="stringliteral">&quot;stage buffer.\n&quot;</span>, tid, 
<a name="l01079"></a>01079                         <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[next_stage]-&gt;<a class="code" href="classPipelineStage.html#a4623e7080104807616729bb5504b76ce">stageBufferAvail</a>());
<a name="l01080"></a>01080             }
<a name="l01081"></a>01081 
<a name="l01082"></a>01082             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: [sn:%i]: being placed into  &quot;</span>
<a name="l01083"></a>01083                     <span class="stringliteral">&quot;index %i of stage buffer %i queue.\n&quot;</span>,
<a name="l01084"></a>01084                     tid, inst-&gt;seqNum,
<a name="l01085"></a>01085                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[prev_stage]-&gt;<a class="code" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>(),
<a name="l01086"></a>01086                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[prev_stage]-&gt;<a class="code" href="classPipelineStage.html#aa6321826776981dc0e21fbdeefe52016">nextStageQueue</a>-&gt;<a class="code" href="classTimeBuffer.html#a7f3a9af2f60b21012f5dab71251b5b8f">id</a>());
<a name="l01087"></a>01087 
<a name="l01088"></a>01088             <span class="comment">// Place instructions in inter-stage communication struct for next</span>
<a name="l01089"></a>01089             <span class="comment">// pipeline stage to read next cycle</span>
<a name="l01090"></a>01090             <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[prev_stage]-&gt;<a class="code" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a>-&gt;insts.push_back(inst);
<a name="l01091"></a>01091 
<a name="l01092"></a>01092             success = <span class="keyword">true</span>;
<a name="l01093"></a>01093 
<a name="l01094"></a>01094             <span class="comment">// Take note of trace data for this inst &amp; stage</span>
<a name="l01095"></a>01095             <span class="keywordflow">if</span> (inst-&gt;traceData) {
<a name="l01096"></a>01096                 <span class="comment">//@todo: exec traces are broke. fix them</span>
<a name="l01097"></a>01097                 inst-&gt;traceData-&gt;setStageCycle(<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01098"></a>01098             }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100         }
<a name="l01101"></a>01101     }
<a name="l01102"></a>01102 
<a name="l01103"></a>01103     <span class="keywordflow">return</span> success;
<a name="l01104"></a>01104 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aab96bdacf8bd420402cbb543f994e054"></a><!-- doxytag: member="PipelineStage::setActiveThreads" ref="aab96bdacf8bd420402cbb543f994e054" args="(std::list&lt; ThreadID &gt; *at_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setActiveThreads </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>at_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets pointer to list of active threads. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00170"></a>00170 {
<a name="l00171"></a>00171     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Setting active threads list pointer.\n&quot;</span>);
<a name="l00172"></a>00172     <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a> = at_ptr;
<a name="l00173"></a>00173 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6fd0f914e19bcfb6d9f28e537ad956d5"></a><!-- doxytag: member="PipelineStage::setCPU" ref="a6fd0f914e19bcfb6d9f28e537ad956d5" args="(InOrderCPU *cpu_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setCPU </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classInOrderCPU.html">InOrderCPU</a> *&nbsp;</td>
          <td class="paramname"> <em>cpu_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets CPU pointer. </p>

<p><a class="el" href="classFirstStage.html#a6fd0f914e19bcfb6d9f28e537ad956d5">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00117"></a>00117 {
<a name="l00118"></a>00118     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a> = cpu_ptr;
<a name="l00119"></a>00119 
<a name="l00120"></a>00120     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Set CPU pointer.\n&quot;</span>);
<a name="l00121"></a>00121 
<a name="l00122"></a>00122     <a class="code" href="classPipelineStage.html#af3ad9be2b464186b902b5ca568b6d439">tracer</a> = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classTrace_1_1InOrderTrace.html">Trace::InOrderTrace</a> *<span class="keyword">&gt;</span>(<a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;getTracer());
<a name="l00123"></a>00123 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ace33f1daf903e9438330807405092e20"></a><!-- doxytag: member="PipelineStage::setNextStageQueue" ref="ace33f1daf903e9438330807405092e20" args="(TimeBuffer&lt; InterStageStruct &gt; *next_stage_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setNextStageQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>next_stage_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets pointer to time buffer used to communicate to the next stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00157"></a>00157 {
<a name="l00158"></a>00158     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Setting next stage pointer.\n&quot;</span>);
<a name="l00159"></a>00159     <a class="code" href="classPipelineStage.html#aa6321826776981dc0e21fbdeefe52016">nextStageQueue</a> = next_stage_ptr;
<a name="l00160"></a>00160 
<a name="l00161"></a>00161     <span class="comment">// Setup wire to write information to proper place in stage queue.</span>
<a name="l00162"></a>00162     <a class="code" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a> = <a class="code" href="classPipelineStage.html#aa6321826776981dc0e21fbdeefe52016">nextStageQueue</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(0);
<a name="l00163"></a>00163     <a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a> = <span class="keyword">true</span>;
<a name="l00164"></a>00164 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aff9a9995beb69e92bbcf40c780c17b93"></a><!-- doxytag: member="PipelineStage::setPrevStageQueue" ref="aff9a9995beb69e92bbcf40c780c17b93" args="(TimeBuffer&lt; InterStageStruct &gt; *prev_stage_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setPrevStageQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structInterStageStruct.html">InterStageStruct</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>prev_stage_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets pointer to time buffer coming from fetch. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00143"></a>00143 {
<a name="l00144"></a>00144     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Setting previous stage queue pointer.\n&quot;</span>);
<a name="l00145"></a>00145     <a class="code" href="classPipelineStage.html#af54931163e4bdb38a1295065af735582">prevStageQueue</a> = prev_stage_ptr;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147     <span class="comment">// Setup wire to read information from fetch queue.</span>
<a name="l00148"></a>00148     <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a> = <a class="code" href="classPipelineStage.html#af54931163e4bdb38a1295065af735582">prevStageQueue</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(-1);
<a name="l00149"></a>00149 
<a name="l00150"></a>00150     <a class="code" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a> = <span class="keyword">true</span>;
<a name="l00151"></a>00151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af11246f186567b60383a2ff1d4bcf27c"></a><!-- doxytag: member="PipelineStage::setResStall" ref="af11246f186567b60383a2ff1d4bcf27c" args="(ResReqPtr res_req, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setResStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classResourceRequest.html">ResReqPtr</a>&nbsp;</td>
          <td class="paramname"> <em>res_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classSet.html">Set</a> a resource stall in the pipeline-stage </p>

<p><div class="fragment"><pre class="fragment"><a name="l00754"></a>00754 {
<a name="l00755"></a>00755     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Inserting stall from %s.\n&quot;</span>, res_req-&gt;<a class="code" href="classResourceRequest.html#ae6cb01f81685fa77e8716cdef5924b8a">res</a>-&gt;<a class="code" href="classResource.html#af1801e31af6399bccce114ab12575168">name</a>());
<a name="l00756"></a>00756     <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.push_back(res_req);
<a name="l00757"></a>00757 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2b521ea5f191fff72265f60d4ed5187b"></a><!-- doxytag: member="PipelineStage::setTimeBuffer" ref="a2b521ea5f191fff72265f60d4ed5187b" args="(TimeBuffer&lt; TimeStruct &gt; *tb_ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setTimeBuffer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt; <a class="el" href="structTimeStruct.html">TimeStruct</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>tb_ptr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets the main backwards communication time buffer pointer. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00128"></a>00128 {
<a name="l00129"></a>00129     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Setting time buffer pointer.\n&quot;</span>);
<a name="l00130"></a>00130     <a class="code" href="classPipelineStage.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a> = tb_ptr;
<a name="l00131"></a>00131 
<a name="l00132"></a>00132     <span class="comment">// Setup wire to write information back to fetch.</span>
<a name="l00133"></a>00133     <span class="comment">// @todo: should this be writing to the next stage =&gt; -1 and reading from is (0)???</span>
<a name="l00134"></a>00134     <a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a> = <a class="code" href="classPipelineStage.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(0);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136     <span class="comment">// Create wires to get information from proper places in time buffer.</span>
<a name="l00137"></a>00137     <a class="code" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a> = <a class="code" href="classPipelineStage.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a>-&gt;<a class="code" href="classTimeBuffer.html#ab1c801fd9d022ce4339cc62f4a0625dd">getWire</a>(-1);
<a name="l00138"></a>00138 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c19142b0bc2ce7b7a6593a5190cebc7"></a><!-- doxytag: member="PipelineStage::setupSquash" ref="a9c19142b0bc2ce7b7a6593a5190cebc7" args="(DynInstPtr inst, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setupSquash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&nbsp;</td>
          <td class="paramname"> <em>inst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Setup Squashing Information to be passed back thru the pipeline </p>

<p><div class="fragment"><pre class="fragment"><a name="l00353"></a>00353 {
<a name="l00354"></a>00354     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a07ac7fa00a59be2904eaa76d4735681e">lastSquashCycle</a>[tid] == <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() &amp;&amp;
<a name="l00355"></a>00355         <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a8c48389ee147811c1be413cdd4be4b68">squashSeqNum</a>[tid] &lt; inst-&gt;seqNum){
<a name="l00356"></a>00356         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classResource.html">Resource</a>, <span class="stringliteral">&quot;Ignoring [sn:%i] branch squash signal due to &quot;</span>
<a name="l00357"></a>00357                 <span class="stringliteral">&quot;another stage&apos;s squash signal for after [sn:%i].\n&quot;</span>, 
<a name="l00358"></a>00358                 inst-&gt;seqNum, <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a8c48389ee147811c1be413cdd4be4b68">squashSeqNum</a>[tid]);
<a name="l00359"></a>00359     } <span class="keywordflow">else</span> {
<a name="l00360"></a>00360         <a class="code" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a> squash_seq_num = inst-&gt;squashSeqNum;
<a name="l00361"></a>00361         <span class="keywordtype">unsigned</span> squash_stage = (<a class="code" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a>) ? <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> + 1
<a name="l00362"></a>00362             : <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>;
<a name="l00363"></a>00363 
<a name="l00364"></a>00364         <a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a>-&gt;stageInfo[squash_stage][tid].squash = <span class="keyword">true</span>;
<a name="l00365"></a>00365         <a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a>-&gt;stageInfo[squash_stage][tid].doneSeqNum =
<a name="l00366"></a>00366             squash_seq_num;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Setting up squashing after &quot;</span>
<a name="l00369"></a>00369                 <span class="stringliteral">&quot;[sn:%i], due to [sn:%i] %s. Squash-Start-Stage:%i\n&quot;</span>,
<a name="l00370"></a>00370                 tid, squash_seq_num, inst-&gt;seqNum, inst-&gt;instName(),
<a name="l00371"></a>00371                 squash_stage);
<a name="l00372"></a>00372 
<a name="l00373"></a>00373         <span class="comment">// Save squash num for later stage use</span>
<a name="l00374"></a>00374         <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a07ac7fa00a59be2904eaa76d4735681e">lastSquashCycle</a>[tid] = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00375"></a>00375         <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a8c48389ee147811c1be413cdd4be4b68">squashSeqNum</a>[tid] = squash_seq_num;
<a name="l00376"></a>00376     }
<a name="l00377"></a>00377 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afe3e2673d17dd5c568862ef5ae68b4d8"></a><!-- doxytag: member="PipelineStage::skidsEmpty" ref="afe3e2673d17dd5c568862ef5ae68b4d8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool skidsEmpty </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns if all of the skid buffers are empty. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00488"></a>00488 {
<a name="l00489"></a>00489     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="keywordflow">while</span> (threads != <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end()) {
<a name="l00492"></a>00492         <span class="keywordflow">if</span> (!<a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[*threads++].empty())
<a name="l00493"></a>00493             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00494"></a>00494     }
<a name="l00495"></a>00495 
<a name="l00496"></a>00496     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00497"></a>00497 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a112431820c072831aa16794d42dc25e4"></a><!-- doxytag: member="PipelineStage::skidSize" ref="a112431820c072831aa16794d42dc25e4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int skidSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Total size of all skid buffers </p>

<p><div class="fragment"><pre class="fragment"><a name="l00476"></a>00476 {
<a name="l00477"></a>00477     <span class="keywordtype">int</span> <a class="code" href="namespaceStats.html#a4031dfee086a6a4cf1deea1fff2e0d5c">total</a> = 0;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>=0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00480"></a>00480         total += <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].size();
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="keywordflow">return</span> total;
<a name="l00484"></a>00484 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9ff2aa32ab0f40674cb3518108d62f8e"></a><!-- doxytag: member="PipelineStage::sortInsts" ref="a9ff2aa32ab0f40674cb3518108d62f8e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sortInsts </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Separates instructions from fetch into individual lists of instructions sorted by thread. </p>

<p><a class="el" href="classFirstStage.html#a9ff2aa32ab0f40674cb3518108d62f8e">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00575"></a>00575 {
<a name="l00576"></a>00576     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a>) {
<a name="l00577"></a>00577         assert(<a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>() &lt;= <a class="code" href="classPipelineStage.html#a51d98139f56a84585e4cb68e3cd67a1c">stageWidth</a>);
<a name="l00578"></a>00578 
<a name="l00579"></a>00579         <span class="keywordtype">int</span> insts_from_prev_stage = <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>();
<a name="l00580"></a>00580         <span class="keywordtype">int</span> insts_from_cur_stage = <a class="code" href="classPipelineStage.html#a112431820c072831aa16794d42dc25e4">skidSize</a>();
<a name="l00581"></a>00581         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;%i insts available from stage buffer %i. Stage &quot;</span>
<a name="l00582"></a>00582                 <span class="stringliteral">&quot;currently has %i insts from last cycle.\n&quot;</span>,
<a name="l00583"></a>00583                 insts_from_prev_stage, <a class="code" href="classPipelineStage.html#af54931163e4bdb38a1295065af735582">prevStageQueue</a>-&gt;<a class="code" href="classTimeBuffer.html#a7f3a9af2f60b21012f5dab71251b5b8f">id</a>(),
<a name="l00584"></a>00584                 insts_from_cur_stage);
<a name="l00585"></a>00585 
<a name="l00586"></a>00586         <span class="keywordtype">int</span> inserted_insts = 0;
<a name="l00587"></a>00587 
<a name="l00588"></a>00588         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; insts_from_prev_stage; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00589"></a>00589             <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;isSquashed()) {
<a name="l00590"></a>00590                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Ignoring squashed [sn:%i], &quot;</span>
<a name="l00591"></a>00591                         <span class="stringliteral">&quot;not inserting into stage buffer.\n&quot;</span>,
<a name="l00592"></a>00592                     <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;readTid(),
<a name="l00593"></a>00593                     <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;seqNum);
<a name="l00594"></a>00594                 <span class="keywordflow">continue</span>;
<a name="l00595"></a>00595             }
<a name="l00596"></a>00596 
<a name="l00597"></a>00597             <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;threadNumber;
<a name="l00598"></a>00598 
<a name="l00599"></a>00599             <span class="keywordflow">if</span> (inserted_insts + insts_from_cur_stage == <a class="code" href="classPipelineStage.html#a51d98139f56a84585e4cb68e3cd67a1c">stageWidth</a>) {
<a name="l00600"></a>00600                <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;Stage %i has accepted all insts &quot;</span>
<a name="l00601"></a>00601                        <span class="stringliteral">&quot;possible for this tick. Placing [sn:%i] in stage %i skidBuffer\n&quot;</span>,
<a name="l00602"></a>00602                        <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>, <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;seqNum, <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> - 1);
<a name="l00603"></a>00603                 <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> - 1]-&gt;
<a name="l00604"></a>00604                     <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].push_front(<a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]);
<a name="l00605"></a>00605 
<a name="l00606"></a>00606                 <span class="keywordtype">int</span> prev_stage = <a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a> - 1;
<a name="l00607"></a>00607                 <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[prev_stage]-&gt;<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a> ||
<a name="l00608"></a>00608                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[prev_stage]-&gt;<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>) {
<a name="l00609"></a>00609                     <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#aae220dcd072e514a6cf72df0abf36d42">pipelineStage</a>[prev_stage]-&gt;<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>;
<a name="l00610"></a>00610                 }
<a name="l00611"></a>00611             } <span class="keywordflow">else</span> {
<a name="l00612"></a>00612                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Inserting [sn:%i] into stage &quot;</span>
<a name="l00613"></a>00613                         <span class="stringliteral">&quot;buffer.\n&quot;</span>, <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;readTid(),
<a name="l00614"></a>00614                         <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;seqNum);
<a name="l00615"></a>00615 
<a name="l00616"></a>00616                 <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].push_back(<a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]);
<a name="l00617"></a>00617             }
<a name="l00618"></a>00618 
<a name="l00619"></a>00619             <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a09dc4a08ace7d6e74531ffff1ba5d905">dummyBufferInst</a>;
<a name="l00620"></a>00620 
<a name="l00621"></a>00621             inserted_insts++;
<a name="l00622"></a>00622         }
<a name="l00623"></a>00623     }
<a name="l00624"></a>00624 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aee9dc23de90acd20200641407a3bd1da"></a><!-- doxytag: member="PipelineStage::squash" ref="aee9dc23de90acd20200641407a3bd1da" args="(InstSeqNum squash_num, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void squash </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a>&nbsp;</td>
          <td class="paramname"> <em>squash_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Perform squash of instructions above seq_num </p>

<p><a class="el" href="classFirstStage.html#ad9e3c0e17499440cfafb6145d7be97a1">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00409"></a>00409 {
<a name="l00410"></a>00410     <span class="comment">// Set status to squashing.</span>
<a name="l00411"></a>00411     <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca22a648855197e326dc88f548634c0ec7">Squashing</a>;
<a name="l00412"></a>00412 
<a name="l00413"></a>00413     <a class="code" href="classPipelineStage.html#adbce9d3c16239dca0ffd19bc176ea258">squashPrevStageInsts</a>(squash_seq_num, tid);
<a name="l00414"></a>00414 
<a name="l00415"></a>00415     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Removing instructions from incoming stage&quot;</span>
<a name="l00416"></a>00416             <span class="stringliteral">&quot; skidbuffer.\n&quot;</span>, tid);
<a name="l00417"></a>00417     <span class="comment">//@TODO: Walk Through List Using iterator and remove</span>
<a name="l00418"></a>00418     <span class="comment">//       all instructions over the value</span>
<a name="l00419"></a>00419     <a class="code" href="classstd_1_1list.html">std::list&lt;DynInstPtr&gt;::iterator</a> cur_it = <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].begin();
<a name="l00420"></a>00420     <a class="code" href="classstd_1_1list.html">std::list&lt;DynInstPtr&gt;::iterator</a> end_it = <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].end();
<a name="l00421"></a>00421 
<a name="l00422"></a>00422     <span class="keywordflow">while</span> (cur_it != end_it) {
<a name="l00423"></a>00423         <span class="keywordflow">if</span> ((*cur_it)-&gt;seqNum &lt;= squash_seq_num) {
<a name="l00424"></a>00424             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Cannot remove skidBuffer &quot;</span>
<a name="l00425"></a>00425                     <span class="stringliteral">&quot;instructions (starting w/[sn:%i]) before &quot;</span>
<a name="l00426"></a>00426                     <span class="stringliteral">&quot;[sn:%i]. %i insts left.\n&quot;</span>, tid, 
<a name="l00427"></a>00427                     (*cur_it)-&gt;seqNum, squash_seq_num,
<a name="l00428"></a>00428                     <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].size());
<a name="l00429"></a>00429             cur_it++;
<a name="l00430"></a>00430         } <span class="keywordflow">else</span> {
<a name="l00431"></a>00431             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Removing instruction, [sn:%i] &quot;</span>
<a name="l00432"></a>00432                     <span class="stringliteral">&quot; PC %s.\n&quot;</span>, tid, (*cur_it)-&gt;seqNum, (*cur_it)-&gt;pc);
<a name="l00433"></a>00433             (*cur_it)-&gt;setSquashed();
<a name="l00434"></a>00434             cur_it = <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].erase(cur_it);
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436 
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a960b60a46045a5363df0c263f0f43902"></a><!-- doxytag: member="PipelineStage::squashDueToMemStall" ref="a960b60a46045a5363df0c263f0f43902" args="(InstSeqNum seq_num, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void squashDueToMemStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a>&nbsp;</td>
          <td class="paramname"> <em>seq_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classFirstStage.html#a960b60a46045a5363df0c263f0f43902">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00381"></a>00381 {
<a name="l00382"></a>00382     <a class="code" href="classPipelineStage.html#aee9dc23de90acd20200641407a3bd1da">squash</a>(seq_num, tid);    
<a name="l00383"></a>00383 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="adbce9d3c16239dca0ffd19bc176ea258"></a><!-- doxytag: member="PipelineStage::squashPrevStageInsts" ref="adbce9d3c16239dca0ffd19bc176ea258" args="(InstSeqNum squash_seq_num, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void squashPrevStageInsts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="inst__seq_8hh.html#a258d93d98edaedee089435c19ea2ea2e">InstSeqNum</a>&nbsp;</td>
          <td class="paramname"> <em>squash_seq_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Squash instructions from stage buffer </p>

<p><div class="fragment"><pre class="fragment"><a name="l00387"></a>00387 {
<a name="l00388"></a>00388     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Removing instructions from &quot;</span>
<a name="l00389"></a>00389             <span class="stringliteral">&quot;incoming stage queue.\n&quot;</span>, tid);
<a name="l00390"></a>00390 
<a name="l00391"></a>00391     <span class="keywordtype">int</span> insts_from_prev_stage = <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts.<a class="code" href="classTimeBuffer.html#a245260f6f74972558f61b85227df5aae">size</a>();
<a name="l00392"></a>00392     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>=0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; insts_from_prev_stage; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00393"></a>00393         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;threadNumber == tid &amp;&amp;
<a name="l00394"></a>00394             <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;seqNum &gt; squash_seq_num) {
<a name="l00395"></a>00395             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%i]: Squashing instruction, &quot;</span>
<a name="l00396"></a>00396                     <span class="stringliteral">&quot;[sn:%i] PC %s.\n&quot;</span>,
<a name="l00397"></a>00397                     tid,
<a name="l00398"></a>00398                     <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;seqNum,
<a name="l00399"></a>00399                     <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;pcState());
<a name="l00400"></a>00400             <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]-&gt;setSquashed();
<a name="l00401"></a>00401 
<a name="l00402"></a>00402             <a class="code" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a>-&gt;insts[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>] = <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a09dc4a08ace7d6e74531ffff1ba5d905">dummyBufferInst</a>;
<a name="l00403"></a>00403         }
<a name="l00404"></a>00404     }
<a name="l00405"></a>00405 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4623e7080104807616729bb5504b76ce"></a><!-- doxytag: member="PipelineStage::stageBufferAvail" ref="a4623e7080104807616729bb5504b76ce" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stageBufferAvail </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Is there room in the stage buffer? </p>

<p><div class="fragment"><pre class="fragment"><a name="l00443"></a>00443 {
<a name="l00444"></a>00444     <span class="keywordtype">unsigned</span> <a class="code" href="namespaceStats.html#a4031dfee086a6a4cf1deea1fff2e0d5c">total</a> = 0;
<a name="l00445"></a>00445 
<a name="l00446"></a>00446     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>=0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00447"></a>00447         total += <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].size();
<a name="l00448"></a>00448     }
<a name="l00449"></a>00449 
<a name="l00450"></a>00450     <span class="keywordtype">int</span> avail = <a class="code" href="classPipelineStage.html#a8b3bf50b9e561c023857979eaf326bee">stageBufferMax</a> - total;
<a name="l00451"></a>00451     assert(avail &gt;= 0);
<a name="l00452"></a>00452 
<a name="l00453"></a>00453     <span class="keywordflow">return</span> avail;
<a name="l00454"></a>00454 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a05f299b443f8cc73a93d61572edc0218"></a><!-- doxytag: member="PipelineStage::switchOut" ref="a05f299b443f8cc73a93d61572edc0218" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void switchOut </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Changes the status of this stage to active, and indicates this to the CPU. Changes the status of this stage to inactive, and indicates this to the CPU. Switches out the stage stage. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00189"></a>00189 {
<a name="l00190"></a>00190     <span class="comment">// Stage can immediately switch out.</span>
<a name="l00191"></a>00191     <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Switching Out of Stages Unimplemented&quot;</span>);
<a name="l00192"></a>00192 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8674059ce345e23aac5086b2c3e24a43"></a><!-- doxytag: member="PipelineStage::takeOverFrom" ref="a8674059ce345e23aac5086b2c3e24a43" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void takeOverFrom </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Takes over from another CPU's thread. </p>

<p><a class="el" href="classFirstStage.html#a8674059ce345e23aac5086b2c3e24a43">FirstStage</a>で再定義されています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00197"></a>00197 {
<a name="l00198"></a>00198     <a class="code" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a> = <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6">Inactive</a>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <span class="comment">// Be sure to reset state and clear out any old instructions.</span>
<a name="l00201"></a>00201     <span class="keywordflow">for</span> (<a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = 0; tid &lt; <a class="code" href="classPipelineStage.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a>; ++tid) {
<a name="l00202"></a>00202         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173cad3fa9ae9431d6cb1772f9d9df48cab19">Idle</a>;
<a name="l00203"></a>00203 
<a name="l00204"></a>00204         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> stNum = 0; stNum &lt; <a class="code" href="namespaceThePipeline.html#a6918d1731267e5f56969bfb5c240be85">NumStages</a>; stNum++) {
<a name="l00205"></a>00205             <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#a7f7ee2cedce805d9faf18a261242fac3">stage</a>[stNum] = <span class="keyword">false</span>;
<a name="l00206"></a>00206         }
<a name="l00207"></a>00207 
<a name="l00208"></a>00208         <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.clear();
<a name="l00209"></a>00209 
<a name="l00210"></a>00210         <a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].clear();
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212     <a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">false</span>;
<a name="l00213"></a>00213 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a873dd91783f9efb4a590aded1f70d6b0"></a><!-- doxytag: member="PipelineStage::tick" ref="a873dd91783f9efb4a590aded1f70d6b0" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void tick </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Ticks stage, processing all input signals and executing as many instructions as possible. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00727"></a>00727 {
<a name="l00728"></a>00728     <a class="code" href="classPipelineStage.html#a97808a9870039f4168da10ecfb5dc472">idle</a> = <span class="keyword">false</span>;
<a name="l00729"></a>00729     
<a name="l00730"></a>00730     <a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">false</span>;
<a name="l00731"></a>00731 
<a name="l00732"></a>00732     <span class="keywordtype">bool</span> status_change = <span class="keyword">false</span>;
<a name="l00733"></a>00733     
<a name="l00734"></a>00734     <a class="code" href="classPipelineStage.html#a9ff2aa32ab0f40674cb3518108d62f8e">sortInsts</a>();
<a name="l00735"></a>00735 
<a name="l00736"></a>00736     <a class="code" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a> = 0;
<a name="l00737"></a>00737 
<a name="l00738"></a>00738     <a class="code" href="classPipelineStage.html#a0782fca2c80ef367ee914d464584ab20">processStage</a>(status_change);
<a name="l00739"></a>00739 
<a name="l00740"></a>00740     <span class="keywordflow">if</span> (status_change) {
<a name="l00741"></a>00741         <a class="code" href="classPipelineStage.html#a4bb9486757ce225941aaaf759b357a57">updateStatus</a>();
<a name="l00742"></a>00742     }
<a name="l00743"></a>00743 
<a name="l00744"></a>00744     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a>) {
<a name="l00745"></a>00745         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activity this cycle.\n&quot;</span>);
<a name="l00746"></a>00746         <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#ad7e5c2506873e8dc8c71740ac6dabb23">activityThisCycle</a>();
<a name="l00747"></a>00747     }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;\n\n&quot;</span>);
<a name="l00750"></a>00750 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cc3b95f6969935f78c0158aa5145021"></a><!-- doxytag: member="PipelineStage::unblock" ref="a9cc3b95f6969935f78c0158aa5145021" args="(ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool unblock </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Switches stage to unblocking if the skid buffer is empty, and signals back that stage has unblocked. </p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Returns true if there is a status change. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00331"></a>00331 {
<a name="l00332"></a>00332     <span class="comment">// @todo: Shouldnt this be if any available slots are open???</span>
<a name="l00333"></a>00333     <span class="comment">// Stage is done unblocking only if the skid buffer is empty.</span>
<a name="l00334"></a>00334     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[tid].empty()) {
<a name="l00335"></a>00335         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Done unblocking.\n&quot;</span>, tid);
<a name="l00336"></a>00336 
<a name="l00337"></a>00337         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a>)
<a name="l00338"></a>00338             <a class="code" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a>-&gt;stageUnblock[<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>][tid] = <span class="keyword">true</span>;
<a name="l00339"></a>00339 
<a name="l00340"></a>00340         <a class="code" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a> = <span class="keyword">true</span>;
<a name="l00341"></a>00341 
<a name="l00342"></a>00342         <a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] = <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173ca2f5f2c4a8c4f4f0519d503dcdfbf55cb">Running</a>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00345"></a>00345     }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Currently unblocking.\n&quot;</span>, tid);
<a name="l00348"></a>00348     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00349"></a>00349 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a71090c4bc5fc055eb0ea621cb65fddc8"></a><!-- doxytag: member="PipelineStage::unsetResStall" ref="a71090c4bc5fc055eb0ea621cb65fddc8" args="(ResReqPtr res_req, ThreadID tid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unsetResStall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classResourceRequest.html">ResReqPtr</a>&nbsp;</td>
          <td class="paramname"> <em>res_req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&nbsp;</td>
          <td class="paramname"> <em>tid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Unset a resource stall in the pipeline-stage </p>

<p><div class="fragment"><pre class="fragment"><a name="l00761"></a>00761 {
<a name="l00762"></a>00762     <span class="comment">// Search through stalls to find stalling request and then</span>
<a name="l00763"></a>00763     <span class="comment">// remove it</span>
<a name="l00764"></a>00764     <a class="code" href="classstd_1_1vector.html">vector&lt;ResReqPtr&gt;::iterator</a> req_it = <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.begin();
<a name="l00765"></a>00765     <a class="code" href="classstd_1_1vector.html">vector&lt;ResReqPtr&gt;::iterator</a> req_end = <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.end();
<a name="l00766"></a>00766 
<a name="l00767"></a>00767     <span class="keywordflow">while</span> (req_it != req_end) {
<a name="l00768"></a>00768         <span class="keywordflow">if</span>( (*req_it)-&gt;res ==  res_req-&gt;<a class="code" href="classResourceRequest.html#ae6cb01f81685fa77e8716cdef5924b8a">res</a> &amp;&amp; <span class="comment">// Same Resource</span>
<a name="l00769"></a>00769             (*req_it)-&gt;inst ==  res_req-&gt;<a class="code" href="classResourceRequest.html#af5d4fb974eeb4507d4c837d365d0cefc">inst</a> &amp;&amp; <span class="comment">// Same Instruction</span>
<a name="l00770"></a>00770             (*req_it)-&gt;getSlot() ==  res_req-&gt;<a class="code" href="classResourceRequest.html#aa3dcf920f4d17ee3b6baf56b80de49b8">getSlot</a>()) {
<a name="l00771"></a>00771             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: Clearing stall by %s.\n&quot;</span>,
<a name="l00772"></a>00772                     tid, res_req-&gt;<a class="code" href="classResourceRequest.html#ae6cb01f81685fa77e8716cdef5924b8a">res</a>-&gt;<a class="code" href="classResource.html#af1801e31af6399bccce114ab12575168">name</a>());
<a name="l00773"></a>00773             <a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].<a class="code" href="structPipelineStage_1_1Stalls.html#af9fda64ae38e61e396127c777a08e977">resources</a>.erase(req_it);
<a name="l00774"></a>00774             <span class="keywordflow">break</span>;
<a name="l00775"></a>00775         }
<a name="l00776"></a>00776 
<a name="l00777"></a>00777         req_it++;
<a name="l00778"></a>00778     }
<a name="l00779"></a>00779 
<a name="l00780"></a>00780     <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[tid].resources.size() == 0) {
<a name="l00781"></a>00781         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(InOrderStage, <span class="stringliteral">&quot;[tid:%u]: There are no remaining resource&quot;</span>
<a name="l00782"></a>00782                 <span class="stringliteral">&quot;stalls.\n&quot;</span>, tid);
<a name="l00783"></a>00783     }
<a name="l00784"></a>00784 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4bb9486757ce225941aaaf759b357a57"></a><!-- doxytag: member="PipelineStage::updateStatus" ref="a4bb9486757ce225941aaaf759b357a57" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateStatus </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Updates overall stage status based on all of the threads' statuses. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00503"></a>00503 {
<a name="l00504"></a>00504     <span class="keywordtype">bool</span> any_unblocking = <span class="keyword">false</span>;
<a name="l00505"></a>00505 
<a name="l00506"></a>00506     <a class="code" href="classstd_1_1list.html">list&lt;ThreadID&gt;::iterator</a> threads = <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;begin();
<a name="l00507"></a>00507 
<a name="l00508"></a>00508     <span class="keywordflow">while</span> (threads != <a class="code" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a>-&gt;end()) {
<a name="l00509"></a>00509         <a class="code" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> tid = *threads++;
<a name="l00510"></a>00510 
<a name="l00511"></a>00511         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[tid] == <a class="code" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173caf2a3acf850890cb1651bc41dcbacb7e0">Unblocking</a>) {
<a name="l00512"></a>00512             any_unblocking = <span class="keyword">true</span>;
<a name="l00513"></a>00513             <span class="keywordflow">break</span>;
<a name="l00514"></a>00514         }
<a name="l00515"></a>00515     }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517     <span class="comment">// Stage will have activity if it&apos;s unblocking.</span>
<a name="l00518"></a>00518     <span class="keywordflow">if</span> (any_unblocking) {
<a name="l00519"></a>00519         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a> == <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6">Inactive</a>) {
<a name="l00520"></a>00520             <a class="code" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a> = <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a26bd8444261cc58df7a86753c79d2520">Active</a>;
<a name="l00521"></a>00521 
<a name="l00522"></a>00522             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Activating stage.\n&quot;</span>);
<a name="l00523"></a>00523 
<a name="l00524"></a>00524             <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a9039dad8d295c41b50eba0342e6c11c0">activateStage</a>(<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l00525"></a>00525         }
<a name="l00526"></a>00526     } <span class="keywordflow">else</span> {
<a name="l00527"></a>00527         <span class="comment">// If it&apos;s not unblocking, then stage will not have any internal</span>
<a name="l00528"></a>00528         <span class="comment">// activity.  Switch it to inactive.</span>
<a name="l00529"></a>00529         <span class="keywordflow">if</span> (<a class="code" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a> == <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a26bd8444261cc58df7a86753c79d2520">Active</a>) {
<a name="l00530"></a>00530             <a class="code" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a> = <a class="code" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018a969c924a722daf6334fca64346092ae6">Inactive</a>;
<a name="l00531"></a>00531             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Activity, <span class="stringliteral">&quot;Deactivating stage.\n&quot;</span>);
<a name="l00532"></a>00532 
<a name="l00533"></a>00533             <a class="code" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a>-&gt;<a class="code" href="classInOrderCPU.html#a4d73bea02eaf6f93e267391592556fe7">deactivateStage</a>(<a class="code" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a>);
<a name="l00534"></a>00534         }
<a name="l00535"></a>00535     }
<a name="l00536"></a>00536 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a4530a0391410036c939865008a53f356"></a><!-- doxytag: member="PipelineStage::_status" ref="a4530a0391410036c939865008a53f356" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPipelineStage.html#add44b42ba3608b213fc0986c4aee6018">StageStatus</a> <a class="el" href="classPipelineStage.html#a4530a0391410036c939865008a53f356">_status</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stage status. </p>

</div>
</div>
<a class="anchor" id="af6eaea53db532812052f71bf0380dab5"></a><!-- doxytag: member="PipelineStage::activeThreads" ref="af6eaea53db532812052f71bf0380dab5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a>&gt;* <a class="el" href="classPipelineStage.html#af6eaea53db532812052f71bf0380dab5">activeThreads</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List of active thread ids </p>

</div>
</div>
<a class="anchor" id="ab949b1ea7ed96a92d473eeaa17348bed"></a><!-- doxytag: member="PipelineStage::bdelayDoneSeqNum" ref="ab949b1ea7ed96a92d473eeaa17348bed" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classPipelineStage.html#ab949b1ea7ed96a92d473eeaa17348bed">bdelayDoneSeqNum</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>SeqNum of Squashing Branch Delay Instruction (used for MIPS) </p>

</div>
</div>
<a class="anchor" id="a41d682c28d0f49e04393c52815808782"></a><!-- doxytag: member="PipelineStage::cpu" ref="a41d682c28d0f49e04393c52815808782" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classInOrderCPU.html">InOrderCPU</a>* <a class="el" href="classPipelineStage.html#a41d682c28d0f49e04393c52815808782">cpu</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>CPU interface. </p>

</div>
</div>
<a class="anchor" id="a09dc4a08ace7d6e74531ffff1ba5d905"></a><!-- doxytag: member="PipelineStage::dummyBufferInst" ref="a09dc4a08ace7d6e74531ffff1ba5d905" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a> <a class="el" href="classPipelineStage.html#a09dc4a08ace7d6e74531ffff1ba5d905">dummyBufferInst</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Instruction used to signify that there is no *real* instruction in buffer slot </p>

</div>
</div>
<a class="anchor" id="a728ac6e701ecba86ee9e8d15ae07d53f"></a><!-- doxytag: member="PipelineStage::fromNextStages" ref="a728ac6e701ecba86ee9e8d15ae07d53f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;::wire <a class="el" href="classPipelineStage.html#a728ac6e701ecba86ee9e8d15ae07d53f">fromNextStages</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get rename's output from backwards time buffer. </p>

</div>
</div>
<a class="anchor" id="a97808a9870039f4168da10ecfb5dc472"></a><!-- doxytag: member="PipelineStage::idle" ref="a97808a9870039f4168da10ecfb5dc472" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPipelineStage.html#a97808a9870039f4168da10ecfb5dc472">idle</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a42e0f4c18fdb8ef7504f5c45d697fb14"></a><!-- doxytag: member="PipelineStage::idleCycles" ref="a42e0f4c18fdb8ef7504f5c45d697fb14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classPipelineStage.html#a42e0f4c18fdb8ef7504f5c45d697fb14">idleCycles</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of cycles 0 instruction(s) are processed. </p>

</div>
</div>
<a class="anchor" id="a4ac908fc89a76ee30c0af235353b6c2f"></a><!-- doxytag: member="PipelineStage::instsProcessed" ref="a4ac908fc89a76ee30c0af235353b6c2f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classPipelineStage.html#a4ac908fc89a76ee30c0af235353b6c2f">instsProcessed</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Instructions that we've processed this tick NOTE: "Processed" means completed at least 1 instruction request </p>

</div>
</div>
<a class="anchor" id="ac171ebbc339fe3c1b91878034586b7a5"></a><!-- doxytag: member="PipelineStage::lastStallingStage" ref="ac171ebbc339fe3c1b91878034586b7a5" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classPipelineStage.html#ac171ebbc339fe3c1b91878034586b7a5">lastStallingStage</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The last stage that this particular stage should look for stalls </p>

</div>
</div>
<a class="anchor" id="a7a06bbc61668c11d11fde945df559f55"></a><!-- doxytag: member="PipelineStage::nextStage" ref="a7a06bbc61668c11d11fde945df559f55" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structInterStageStruct.html">InterStageStruct</a>&gt;::wire <a class="el" href="classPipelineStage.html#a7a06bbc61668c11d11fde945df559f55">nextStage</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to write to the next stage </p>

</div>
</div>
<a class="anchor" id="aa6321826776981dc0e21fbdeefe52016"></a><!-- doxytag: member="PipelineStage::nextStageQueue" ref="aa6321826776981dc0e21fbdeefe52016" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structInterStageStruct.html">InterStageStruct</a>&gt;* <a class="el" href="classPipelineStage.html#aa6321826776981dc0e21fbdeefe52016">nextStageQueue</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Instruction queue linking next stage </p>

</div>
</div>
<a class="anchor" id="a74cfb32df253cbcbf5d70e6523492d2d"></a><!-- doxytag: member="PipelineStage::nextStageValid" ref="a74cfb32df253cbcbf5d70e6523492d2d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPipelineStage.html#a74cfb32df253cbcbf5d70e6523492d2d">nextStageValid</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Is Next Stage Valid? </p>

</div>
</div>
<a class="anchor" id="a88377f855dbf5adeeecb06b5bb821d35"></a><!-- doxytag: member="PipelineStage::numThreads" ref="a88377f855dbf5adeeecb06b5bb821d35" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#ab39b1a4f9dad884694c7a74ed69e6a6b">ThreadID</a> <a class="el" href="classPipelineStage.html#a88377f855dbf5adeeecb06b5bb821d35">numThreads</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of Threads </p>

</div>
</div>
<a class="anchor" id="a560e9ae4ad5991a1789e95d33f59503b"></a><!-- doxytag: member="PipelineStage::prevStage" ref="a560e9ae4ad5991a1789e95d33f59503b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structInterStageStruct.html">InterStageStruct</a>&gt;::wire <a class="el" href="classPipelineStage.html#a560e9ae4ad5991a1789e95d33f59503b">prevStage</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get the previous stage's. </p>

</div>
</div>
<a class="anchor" id="af54931163e4bdb38a1295065af735582"></a><!-- doxytag: member="PipelineStage::prevStageQueue" ref="af54931163e4bdb38a1295065af735582" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structInterStageStruct.html">InterStageStruct</a>&gt;* <a class="el" href="classPipelineStage.html#af54931163e4bdb38a1295065af735582">prevStageQueue</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Instruction queue linking previous stage </p>

</div>
</div>
<a class="anchor" id="abb343738ea92390af4fbc30bc718d1bc"></a><!-- doxytag: member="PipelineStage::prevStageValid" ref="abb343738ea92390af4fbc30bc718d1bc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPipelineStage.html#abb343738ea92390af4fbc30bc718d1bc">prevStageValid</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Is Previous Stage Valid? </p>

</div>
</div>
<a class="anchor" id="af9addd340a133c2f4add363a3055b019"></a><!-- doxytag: member="PipelineStage::runCycles" ref="af9addd340a133c2f4add363a3055b019" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classPipelineStage.html#af9addd340a133c2f4add363a3055b019">runCycles</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of cycles 1+ instructions are processed. </p>

</div>
</div>
<a class="anchor" id="ad02ffed1611064a60befad18c5d428ef"></a><!-- doxytag: member="PipelineStage::skidBuffer" ref="ad02ffed1611064a60befad18c5d428ef" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&gt; <a class="el" href="classPipelineStage.html#ad02ffed1611064a60befad18c5d428ef">skidBuffer</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Skid buffer between previous stage and this one. </p>

</div>
</div>
<a class="anchor" id="ac364a786221f4a1741023dc82bc834f9"></a><!-- doxytag: member="PipelineStage::squashAfterDelaySlot" ref="ac364a786221f4a1741023dc82bc834f9" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPipelineStage.html#ac364a786221f4a1741023dc82bc834f9">squashAfterDelaySlot</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tells when their is a pending delay slot inst. to send to rename. If there is, then wait squash after the next instruction (used for MIPS). </p>

</div>
</div>
<a class="anchor" id="a2313a835690e0d98e53b1aa69754bb1f"></a><!-- doxytag: member="PipelineStage::squashInst" ref="a2313a835690e0d98e53b1aa69754bb1f" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">DynInstPtr</a> <a class="el" href="classPipelineStage.html#a2313a835690e0d98e53b1aa69754bb1f">squashInst</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Instruction used for squashing branch (used for MIPS) </p>

</div>
</div>
<a class="anchor" id="a8b3bf50b9e561c023857979eaf326bee"></a><!-- doxytag: member="PipelineStage::stageBufferMax" ref="a8b3bf50b9e561c023857979eaf326bee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classPipelineStage.html#a8b3bf50b9e561c023857979eaf326bee">stageBufferMax</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Maximum size of the inter-stage buffer connecting the previous stage to this stage (which we call a skid buffer) </p>

</div>
</div>
<a class="anchor" id="afc0a9a26d747553fd1fd8e698a8e7029"></a><!-- doxytag: member="PipelineStage::stageNum" ref="afc0a9a26d747553fd1fd8e698a8e7029" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classPipelineStage.html#afc0a9a26d747553fd1fd8e698a8e7029">stageNum</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The Number of This Pipeline Stage </p>

</div>
</div>
<a class="anchor" id="af95a0e3fe4e1c0a168cc3c74869a4816"></a><!-- doxytag: member="PipelineStage::stageStatus" ref="af95a0e3fe4e1c0a168cc3c74869a4816" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPipelineStage.html#ae2739961013a00cede621d4d72f2173c">ThreadStatus</a> <a class="el" href="classPipelineStage.html#af95a0e3fe4e1c0a168cc3c74869a4816">stageStatus</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Per-thread status. </p>

</div>
</div>
<a class="anchor" id="a51d98139f56a84585e4cb68e3cd67a1c"></a><!-- doxytag: member="PipelineStage::stageWidth" ref="a51d98139f56a84585e4cb68e3cd67a1c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classPipelineStage.html#a51d98139f56a84585e4cb68e3cd67a1c">stageWidth</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The width of stage, in instructions. </p>

</div>
</div>
<a class="anchor" id="aa7522ea079359a7730812c7091dbb4a5"></a><!-- doxytag: member="PipelineStage::stalls" ref="aa7522ea079359a7730812c7091dbb4a5" args="[ThePipeline::MaxThreads]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structPipelineStage_1_1Stalls.html">Stalls</a> <a class="el" href="classPipelineStage.html#aa7522ea079359a7730812c7091dbb4a5">stalls</a>[<a class="el" href="namespaceThePipeline.html#ac9c0bbe9cf27d93e08ea8ccc4096e633">ThePipeline::MaxThreads</a>]</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Tracks stage/resource stalls </p>

</div>
</div>
<a class="anchor" id="a693e4a546dfc51b4e402fe75e73e812e"></a><!-- doxytag: member="PipelineStage::switchedOutBuffer" ref="a693e4a546dfc51b4e402fe75e73e812e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classRefCountingPtr.html">DynInstPtr</a>&gt; <a class="el" href="classPipelineStage.html#a693e4a546dfc51b4e402fe75e73e812e">switchedOutBuffer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classBuffer.html">Buffer</a> of instructions switched out to mem-stall. Only used when using SwitchOnCacheMiss threading model Used as 1-to-1 mapping between ThreadID and Entry. </p>

</div>
</div>
<a class="anchor" id="a09a91d6926260c8037374f0b646a62ee"></a><!-- doxytag: member="PipelineStage::switchedOutValid" ref="a09a91d6926260c8037374f0b646a62ee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;bool&gt; <a class="el" href="classPipelineStage.html#a09a91d6926260c8037374f0b646a62ee">switchedOutValid</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a83f9ee976e732665aeb08dbc19acfd45"></a><!-- doxytag: member="PipelineStage::timeBuffer" ref="a83f9ee976e732665aeb08dbc19acfd45" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;* <a class="el" href="classPipelineStage.html#a83f9ee976e732665aeb08dbc19acfd45">timeBuffer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classTime.html">Time</a> buffer interface. </p>

</div>
</div>
<a class="anchor" id="ab6a826f43ca871b277e724aa148d1816"></a><!-- doxytag: member="PipelineStage::toNextStageIndex" ref="ab6a826f43ca871b277e724aa148d1816" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classPipelineStage.html#ab6a826f43ca871b277e724aa148d1816">toNextStageIndex</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Index of instructions being sent to the next stage. </p>

</div>
</div>
<a class="anchor" id="ad270a1de154f2e748a16880469c9baea"></a><!-- doxytag: member="PipelineStage::toPrevStages" ref="ad270a1de154f2e748a16880469c9baea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTimeBuffer.html">TimeBuffer</a>&lt;<a class="el" href="structTimeStruct.html">TimeStruct</a>&gt;::wire <a class="el" href="classPipelineStage.html#ad270a1de154f2e748a16880469c9baea">toPrevStages</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classWire.html">Wire</a> to get iew's information from backwards time buffer. </p>

</div>
</div>
<a class="anchor" id="af3ad9be2b464186b902b5ca568b6d439"></a><!-- doxytag: member="PipelineStage::tracer" ref="af3ad9be2b464186b902b5ca568b6d439" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classTrace_1_1InOrderTrace.html">Trace::InOrderTrace</a>* <a class="el" href="classPipelineStage.html#af3ad9be2b464186b902b5ca568b6d439">tracer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a04353589e0e920909d3ceb8e73abb7ac"></a><!-- doxytag: member="PipelineStage::utilization" ref="a04353589e0e920909d3ceb8e73abb7ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classPipelineStage.html#a04353589e0e920909d3ceb8e73abb7ac">utilization</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Percentage of cycles 1+ instructions are processed. </p>

</div>
</div>
<a class="anchor" id="a2c7e870d4babdac0dc91fc7ffabd0f3d"></a><!-- doxytag: member="PipelineStage::wroteToTimeBuffer" ref="a2c7e870d4babdac0dc91fc7ffabd0f3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classPipelineStage.html#a2c7e870d4babdac0dc91fc7ffabd0f3d">wroteToTimeBuffer</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Variable that tracks if stage has written to the time buffer this cycle. Used to tell CPU if there is activity this cycle. </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>cpu/inorder/<a class="el" href="pipeline__stage_8hh_source.html">pipeline_stage.hh</a></li>
<li>cpu/inorder/<a class="el" href="pipeline__stage_8cc.html">pipeline_stage.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
