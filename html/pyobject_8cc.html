<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: python/swig/pyobject.cc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li><a href="annotated.html"><span>クラス</span></a></li>
      <li class="current"><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>ファイル一覧</span></a></li>
      <li><a href="globals.html"><span>ファイルメンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>python/swig/pyobject.cc</h1><code>#include &lt;Python.h&gt;</code><br/>
<code>#include &lt;string&gt;</code><br/>
<code>#include &quot;<a class="el" href="inifile_8hh_source.html">base/inifile.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="output_8hh_source.html">base/output.hh</a>&quot;</code><br/>
<code>#include &quot;config/the_isa.hh&quot;</code><br/>
<code>#include &quot;<a class="el" href="mem__object_8hh_source.html">mem/mem_object.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="pyobject_8hh_source.html">python/swig/pyobject.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="full__system_8hh_source.html">sim/full_system.hh</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sim__object_8hh_source.html">sim/sim_object.hh</a>&quot;</code><br/>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>マクロ定義</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pyobject_8cc.html#a7f39c59205bc447b57403e3b2c78e50a">PCC</a>(s)&nbsp;&nbsp;&nbsp;const_cast&lt;char *&gt;(s)</td></tr>
<tr><td colspan="2"><h2>関数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pyobject_8cc.html#a07ed93a9ca4128b7d2b30ee7a82bb77e">connectPorts</a> (<a class="el" href="classSimObject.html">SimObject</a> *o1, const std::string &amp;name1, int i1, <a class="el" href="classSimObject.html">SimObject</a> *o2, const std::string &amp;name2, int i2)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classIniFile.html">IniFile</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pyobject_8cc.html#ac390ef5a36b7dee6bd6913a9f7734b4f">inifile</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSimObject.html">SimObject</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pyobject_8cc.html#a35bd8f1c38b15825afd59cae5bb0169e">convertSwigSimObjectPtr</a> (<a class="el" href="init_8hh.html#ae19630c1f4ca6d5236b30719d9140013">PyObject</a> *)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSimObject.html">SimObject</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pyobject_8cc.html#a768f957834fc9bdd7b98a109dd58adab">resolveSimObject</a> (const string &amp;name)</td></tr>
</table>
<hr/><h2>マクロ定義</h2>
<a class="anchor" id="a7f39c59205bc447b57403e3b2c78e50a"></a><!-- doxytag: member="pyobject.cc::PCC" ref="a7f39c59205bc447b57403e3b2c78e50a" args="(s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PCC</td>
          <td>(</td>
          <td class="paramtype">s&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td>&nbsp;&nbsp;&nbsp;const_cast&lt;char *&gt;(s)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a07ed93a9ca4128b7d2b30ee7a82bb77e"></a><!-- doxytag: member="pyobject.cc::connectPorts" ref="a07ed93a9ca4128b7d2b30ee7a82bb77e" args="(SimObject *o1, const std::string &amp;name1, int i1, SimObject *o2, const std::string &amp;name2, int i2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int connectPorts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSimObject.html">SimObject</a> *&nbsp;</td>
          <td class="paramname"> <em>o1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSimObject.html">SimObject</a> *&nbsp;</td>
          <td class="paramname"> <em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Connect the described <a class="el" href="classMemObject.html">MemObject</a> ports. Called from Python via SWIG. The indices i1 &amp; i2 will be -1 for regular ports, &gt;= 0 for vector ports. SimObject1 is the master, and SimObject2 is the slave </p>

<p><div class="fragment"><pre class="fragment"><a name="l00077"></a>00077 {
<a name="l00078"></a>00078 <span class="preprocessor">#if THE_ISA != NULL_ISA</span>
<a name="l00079"></a>00079 <span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370">FullSystem</a>) {
<a name="l00080"></a>00080         <a class="code" href="classEtherObject.html">EtherObject</a> *eo1, *eo2;
<a name="l00081"></a>00081         <a class="code" href="classEtherDevice.html">EtherDevice</a> *ed1, *ed2;
<a name="l00082"></a>00082         eo1 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classEtherObject.html">EtherObject</a>*<span class="keyword">&gt;</span>(o1);
<a name="l00083"></a>00083         ed1 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classEtherDevice.html">EtherDevice</a>*<span class="keyword">&gt;</span>(o1);
<a name="l00084"></a>00084         eo2 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classEtherObject.html">EtherObject</a>*<span class="keyword">&gt;</span>(o2);
<a name="l00085"></a>00085         ed2 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classEtherDevice.html">EtherDevice</a>*<span class="keyword">&gt;</span>(o2);
<a name="l00086"></a>00086 
<a name="l00087"></a>00087         <span class="keywordflow">if</span> ((eo1 || ed1) &amp;&amp; (eo2 || ed2)) {
<a name="l00088"></a>00088             <a class="code" href="classEtherInt.html">EtherInt</a> *p1 = <a class="code" href="pyobject_8hh.html#a7140d9d13a7d38ed7ac6fe75319f64ca">lookupEthPort</a>(o1, name1, i1);
<a name="l00089"></a>00089             <a class="code" href="classEtherInt.html">EtherInt</a> *p2 = <a class="code" href="pyobject_8hh.html#a7140d9d13a7d38ed7ac6fe75319f64ca">lookupEthPort</a>(o2, name2, i2);
<a name="l00090"></a>00090 
<a name="l00091"></a>00091             <span class="keywordflow">if</span> (p1 != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a> &amp;&amp;  p2 != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00092"></a>00092 
<a name="l00093"></a>00093                 p1-&gt;<a class="code" href="classEtherInt.html#a12ec40007e0f314c816d25e64fb6daa3">setPeer</a>(p2);
<a name="l00094"></a>00094                 p2-&gt;<a class="code" href="classEtherInt.html#a12ec40007e0f314c816d25e64fb6daa3">setPeer</a>(p1);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096                 <span class="keywordflow">return</span> 1;
<a name="l00097"></a>00097             }
<a name="l00098"></a>00098         }
<a name="l00099"></a>00099     }
<a name="l00100"></a>00100 <span class="preprocessor">#endif</span>
<a name="l00101"></a>00101 <span class="preprocessor"></span>    <a class="code" href="classMemObject.html">MemObject</a> *mo1, *mo2;
<a name="l00102"></a>00102     mo1 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classMemObject.html">MemObject</a>*<span class="keyword">&gt;</span>(o1);
<a name="l00103"></a>00103     mo2 = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classMemObject.html">MemObject</a>*<span class="keyword">&gt;</span>(o2);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <span class="keywordflow">if</span>(mo1 == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a> || mo2 == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00106"></a>00106         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a> (<span class="stringliteral">&quot;Error casting SimObjects %s and %s to MemObject&quot;</span>, o1-&gt;<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>(),
<a name="l00107"></a>00107                o2-&gt;<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>());
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109 
<a name="l00110"></a>00110     <span class="comment">// generic master/slave port connection</span>
<a name="l00111"></a>00111     <a class="code" href="classBaseMasterPort.html">BaseMasterPort</a>&amp; masterPort = mo1-&gt;<a class="code" href="classMemObject.html#adc4e675e51defbdd1e354dac729d0703">getMasterPort</a>(name1, i1);
<a name="l00112"></a>00112     <a class="code" href="classBaseSlavePort.html">BaseSlavePort</a>&amp; slavePort   = mo2-&gt;<a class="code" href="classMemObject.html#ac918a145092d7514ebc6dbd952dceafb">getSlavePort</a>(name2, i2);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     masterPort.<a class="code" href="classBaseMasterPort.html#a55647ab861a1f8cf8d26df2f402188d7">bind</a>(slavePort);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="keywordflow">return</span> 1;
<a name="l00117"></a>00117 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a35bd8f1c38b15825afd59cae5bb0169e"></a><!-- doxytag: member="pyobject.cc::convertSwigSimObjectPtr" ref="a35bd8f1c38b15825afd59cae5bb0169e" args="(PyObject *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSimObject.html">SimObject</a>* convertSwigSimObjectPtr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="init_8hh.html#ae19630c1f4ca6d5236b30719d9140013">PyObject</a> *&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Convert a pointer to the Python object that SWIG wraps around a C++ <a class="el" href="classSimObject.html">SimObject</a> pointer back to the actual C++ pointer. See main.i. </p>

</div>
</div>
<a class="anchor" id="ac390ef5a36b7dee6bd6913a9f7734b4f"></a><!-- doxytag: member="pyobject.cc::inifile" ref="ac390ef5a36b7dee6bd6913a9f7734b4f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIniFile.html">IniFile</a>&amp; inifile </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00121"></a>00121 {
<a name="l00122"></a>00122     <span class="keyword">static</span> <a class="code" href="classIniFile.html">IniFile</a> <a class="code" href="pyobject_8cc.html#ac390ef5a36b7dee6bd6913a9f7734b4f">inifile</a>;
<a name="l00123"></a>00123     <span class="keywordflow">return</span> inifile;
<a name="l00124"></a>00124 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a768f957834fc9bdd7b98a109dd58adab"></a><!-- doxytag: member="pyobject.cc::resolveSimObject" ref="a768f957834fc9bdd7b98a109dd58adab" args="(const string &amp;name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSimObject.html">SimObject</a>* resolveSimObject </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00141"></a>00141 {
<a name="l00142"></a>00142     <a class="code" href="init_8hh.html#ae19630c1f4ca6d5236b30719d9140013">PyObject</a> *module = PyImport_ImportModule(<a class="code" href="pyobject_8cc.html#a7f39c59205bc447b57403e3b2c78e50a">PCC</a>(<span class="stringliteral">&quot;m5.SimObject&quot;</span>));
<a name="l00143"></a>00143     <span class="keywordflow">if</span> (module == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>)
<a name="l00144"></a>00144         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Could not import m5.SimObject&quot;</span>);
<a name="l00145"></a>00145 
<a name="l00146"></a>00146     <a class="code" href="init_8hh.html#ae19630c1f4ca6d5236b30719d9140013">PyObject</a> *resolver =
<a name="l00147"></a>00147         PyObject_GetAttrString(module, <a class="code" href="pyobject_8cc.html#a7f39c59205bc447b57403e3b2c78e50a">PCC</a>(<span class="stringliteral">&quot;resolveSimObject&quot;</span>));
<a name="l00148"></a>00148     <span class="keywordflow">if</span> (resolver == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00149"></a>00149         PyErr_Print();
<a name="l00150"></a>00150         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;resolveSimObject: failed to find resolveSimObject&quot;</span>);
<a name="l00151"></a>00151     }
<a name="l00152"></a>00152 
<a name="l00153"></a>00153     <a class="code" href="init_8hh.html#ae19630c1f4ca6d5236b30719d9140013">PyObject</a> *ptr = PyObject_CallFunction(resolver, <a class="code" href="pyobject_8cc.html#a7f39c59205bc447b57403e3b2c78e50a">PCC</a>(<span class="stringliteral">&quot;(s)&quot;</span>), <a class="code" href="trace_8hh.html#a166fa10b86d8faa127fb7c78191e3e60">name</a>.c_str());
<a name="l00154"></a>00154     <span class="keywordflow">if</span> (ptr == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00155"></a>00155         PyErr_Print();
<a name="l00156"></a>00156         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;resolveSimObject: failure on call to Python for %s&quot;</span>, <a class="code" href="trace_8hh.html#a166fa10b86d8faa127fb7c78191e3e60">name</a>);
<a name="l00157"></a>00157     }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159     <a class="code" href="classSimObject.html">SimObject</a> *obj = <a class="code" href="pyobject_8cc.html#a35bd8f1c38b15825afd59cae5bb0169e">convertSwigSimObjectPtr</a>(ptr);
<a name="l00160"></a>00160     <span class="keywordflow">if</span> (obj == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>)
<a name="l00161"></a>00161         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;resolveSimObject: failure on pointer conversion for %s&quot;</span>, <a class="code" href="trace_8hh.html#a166fa10b86d8faa127fb7c78191e3e60">name</a>);
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     Py_DECREF(module);
<a name="l00164"></a>00164     Py_DECREF(resolver);
<a name="l00165"></a>00165     Py_DECREF(ptr);
<a name="l00166"></a>00166 
<a name="l00167"></a>00167     <span class="keywordflow">return</span> obj;
<a name="l00168"></a>00168 }
</pre></div></p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
