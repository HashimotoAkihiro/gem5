<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス DRAMCtrl</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス DRAMCtrl</h1><!-- doxytag: class="DRAMCtrl" --><!-- doxytag: inherits="AbstractMemory" -->
<p><code>#include &lt;<a class="el" href="dram__ctrl_8hh_source.html">dram_ctrl.hh</a>&gt;</code></p>
<div class="dynheader">
DRAMCtrlに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classDRAMCtrl.gif" usemap="#DRAMCtrl_map" alt=""/>
  <map id="DRAMCtrl_map" name="DRAMCtrl_map">
<area href="classAbstractMemory.html" alt="AbstractMemory" shape="rect" coords="115,224,220,248"/>
<area href="classMemObject.html" alt="MemObject" shape="rect" coords="115,168,220,192"/>
<area href="classClockedObject.html" alt="ClockedObject" shape="rect" coords="115,112,220,136"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="115,56,220,80"/>
<area href="classEventManager.html" alt="EventManager" shape="rect" coords="0,0,105,24"/>
<area href="classSerializable.html" alt="Serializable" shape="rect" coords="115,0,220,24"/>
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="230,0,335,24"/>
</map>
 </div>
</div>

<p><a href="classDRAMCtrl-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>構成</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1AddrMap.html">AddrMap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1BurstHelper.html">BurstHelper</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1DDR3__1333__x64__DRAMSim2.html">DDR3_1333_x64_DRAMSim2</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1DDR3__1600__x64.html">DDR3_1600_x64</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1DDR3__2133__x64.html">DDR3_2133_x64</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1DDR4__2400__x64.html">DDR4_2400_x64</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1LPDDR2__S4__1066__x32.html">LPDDR2_S4_1066_x32</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1LPDDR3__1600__x32.html">LPDDR3_1600_x32</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1MemoryPort.html">MemoryPort</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1MemSched.html">MemSched</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1PageManage.html">PageManage</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl_1_1WideIO__200__x128.html">WideIO_200_x128</a></td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a4dc637449366fcdfc4e764cdf12d9b11">regStats</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#af86a9f0ba5b3737e1a7ba1f97dbf0e91">DRAMCtrl</a> (const DRAMCtrlParams *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aa8a18d230dba7a674ac8a0b4f35bc36a">drain</a> (<a class="el" href="classDrainManager.html">DrainManager</a> *dm)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="classBaseSlavePort.html">BaseSlavePort</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a4edba7d5e567b66fcd93297802a97077">getSlavePort</a> (const std::string &amp;if_name, <a class="el" href="base_2types_8hh.html#acef4d7d41cb21fdc252e20c04cd7bb8e">PortID</a> idx=<a class="el" href="base_2types_8hh.html#a65bf40f138cf863f0c5e2d8ca1144126">InvalidPortID</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a02fd73d861ef2e4aabb38c0c9ff82947">init</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aecc7d8debf54990ffeaaed5bac7d7d81">startup</a> ()</td></tr>
<tr><td colspan="2"><h2>Protected メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a5f0b4c4a94f6b0053f9d7a4eb9c2518a">recvAtomic</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aeefa907fb6d6a787e6dab90e8138ea90">recvFunctional</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a3344d9dd0f83257feab5424e761f31c6">recvTimingReq</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt)</td></tr>
<tr><td colspan="2"><h2>Private 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11">BusState</a> { <a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6">READ</a> =  0, 
<a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a12f0259011cf4a6cf10274abcf71daaa">READ_TO_WRITE</a>, 
<a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>, 
<a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11ad12c9fdf4a8009963c2eb263513e4aab">WRITE_TO_READ</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5">RefreshState</a> { <a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6">REF_IDLE</a> =  0, 
<a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77">REF_DRAIN</a>, 
<a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592">REF_PRE</a>, 
<a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5">REF_RUN</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a> { <br/>
&nbsp;&nbsp;<a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a> =  0, 
<a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>, 
<a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ad70441288ec3dbe4fb80e814a1342f18">PWR_PRE_PDN</a>, 
<a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870">PWR_ACT</a>, 
<br/>
&nbsp;&nbsp;<a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80acb35a2366cd70ef3f0d263d22a3f3200">PWR_ACT_PDN</a>
<br/>
 }</td></tr>
<tr><td colspan="2"><h2>Private メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a0798c7e6d736756005d72ec03a38badd">processNextReqEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ab4cdaf6d543d6785652264ff7ebbecac">processRespondEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ac54213c91d7d83dfe481534b1f165391">processActivateEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aac7163c120622a5f0bcc2291bc3054cd">processPrechargeEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a56cadd2563b7704b3af145a6a9f5e6ea">processRefreshEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a969289183ebadcc99a8dd9f63120b4eb">processPowerEvent</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a865d7144c26ea7f206d937e12935f840">readQueueFull</a> (unsigned int pktCount) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a34f56ea41ba7accf7b75a46aa79b560c">writeQueueFull</a> (unsigned int pktCount) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ac224a72395d7f9bea08435f4aee435df">addToReadQueue</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, unsigned int pktCount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a9538c5891b7139a62cffe6cbd7853b9a">addToWriteQueue</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, unsigned int pktCount)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a981a4462a622304ff598af5a232d7dd5">doDRAMAccess</a> (<a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> *dram_pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aa10846589da1206d0047f6b82c2814e4">accessAndRespond</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> static_latency)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a6d379162bc91622a9b1f1bdf82e062cc">decodeAddr</a> (<a class="el" href="classPacket.html">PacketPtr</a> pkt, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> dramPktAddr, unsigned int size, bool isRead)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a45c15f5a90be2e23d6bde9f706db7f24">chooseNext</a> (<a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt; &amp;queue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aabfe6aa48e67d5b5c21e77dfa8a7e965">reorderQueue</a> (<a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt; &amp;queue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a29301d0e29279a6e233f15c13959b0de">minBankActAt</a> (const <a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt; &amp;queue) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a98181e99df633f767f5116fe80e92042">activateBank</a> (<a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> act_tick, uint8_t rank, uint8_t bank, uint16_t row, <a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a> &amp;bank_ref)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ae75715461eec20eff07a532c11c3d54c">prechargeBank</a> (<a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a> &amp;bank, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> pre_at)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a3c5f01de2fe3a6826581f3641cac2ba7">printQs</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a233880f1f4b8f6455a2ff083dda871d3">schedulePowerEvent</a> (<a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a> pwr_state, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classClockedObject.html#a4daae57fbf09ee5423d123f5ce330e92">tick</a>)</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDRAMCtrl_1_1MemoryPort.html">MemoryPort</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aa4e05579e39e0e1ae7859ddba8538932">retryRdReq</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#acf0d3616b5317008b8248aa2245df220">retryWrReq</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11">BusState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processNextReqEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processRespondEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processActivateEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processPrechargeEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processRefreshEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a0bc8ce4f4a849871eb32bd983b5d2843">refreshEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processPowerEvent &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a> &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a9b8ba3e3a3cc11b904cd1b70e7a40ea5">deviceBusWidth</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a7ac4e4b031082616f09700ea29168920">burstLength</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#afdaeeb74e1622ca1cc0f00dcf937a3b0">deviceRowBufferSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a962c654402093dcbdd4b40fd32c0de69">devicesPerRank</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a1f84aad3340018bfb3c46ace200df8cb">columnsPerRowBuffer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a2fa7bea53e9bf8fb52623b494d814d30">channels</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad878fffffe428b1673a17f489f5a4e94">rowsPerBank</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a61f48157d680c1ddf7dd818c9008dd53">writeHighThreshold</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a803b97da34c3b40357123d5713e6ab4a">writeLowThreshold</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a2753a60747e9836fe5f5fec7b613385c">minWritesPerSwitch</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a9cd12bc6d433964d98ff2386c03e5246">tCK</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a33aeea1fd32ea7035fc8ca3a32f75473">tWTR</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a578e383b38a4b65988799b3c16c4c17d">tRTW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a15520c5298cfcc33032b7f0e363f7a3d">tBURST</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a91e2a0dae0024646d5cf40c844996bcc">tRAS</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a3c3ee9ca057928cc876fc54a20356535">tWR</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a850e39d6fd527d4992315e86a8978292">tRTP</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ada7c680f071957137175c60c125b929a">tRFC</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ac09c7763d97a33e93c89f266ed29df29">tRRD</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Enums::MemSched&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a77153a963ea47f1f424595cbc94461e7">memSchedPolicy</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Enums::AddrMap&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a39c22fc32946a97479fd50b6d4db1ed0">addrMapping</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">Enums::PageManage&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ab0ff1e80c0fcb937ef53eee0175cbd13">maxAccessesPerRow</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#af7b0d4000762b26f57e6bdbbdf45cf6d">backendLatency</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5">RefreshState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ab31f48c472ee16c28fc62b8be41b740e">pwrStateTrans</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ae3e56b38f5969512cd915824ec1d5740">prevArrival</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a8baa6fa0f23d432bebbbf1f3845c9cd5">readReqs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#afb65580143c89e0011c2878c20e8ed0a">writeReqs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a14baa61a63ebc1c4ce4aa1930aa9ba50">writeBursts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a4409b60f101f8ea21148966043864074">bytesReadDRAM</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ae2ea884ed0a7e793cabc56748b833ed2">bytesReadWrQ</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a98c4533d0a7053d00f6882f984ebdaef">bytesWritten</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#afd688f67c6a876a7b272e2ec9221fc8f">bytesReadSys</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#acaf3b49004885b5bc8d40fef342c14c1">bytesWrittenSys</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#accaed2ab83bb63d6ddff7bfa861ea537">mergedWrBursts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a10a3647b9ff175594214578eece1e1f7">neitherReadNorWrite</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a1a6c6b88a19805ae5453e5811633f884">perBankRdBursts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ae757d149b2ff05a908b6ceb28f53decc">perBankWrBursts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#acc056895269ee73447f6e9d814a22319">numRdRetry</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a961b9dc82d0ef2814dbdbc498a20e9b3">numWrRetry</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad5c827068947b103cac8503aa45cf6e5">totGap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aee4577f07fe67bcc60ba3c504b35c9f3">readPktSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aecc027383223e3500a37a9646607df81">writePktSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a34cdc0482a9faf13f94abb3a37fa90b8">rdQLenPdf</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ace3009d78850dc82f90724de8df96227">wrQLenPdf</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Histogram.html">Stats::Histogram</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a097e6ef9437eaed0d05c3d0881455b1a">bytesPerActivate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Histogram.html">Stats::Histogram</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#aff56c8c0df213e51ad714cb2b0df2de3">rdPerTurnAround</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Histogram.html">Stats::Histogram</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a6f8f6528076f5f3f9d56b7658368a781">wrPerTurnAround</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a3eea84ec922ff55ae38676da7222cd01">totQLat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a9aa73ba3e536064d1686b6489e57a4bf">totMemAccLat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#abbb23dd61d5f4a897a59ea51328ad3fd">totBusLat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad594e3077a6ad256f07ab26b96b34c5f">avgQLat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad2f8163270cbb3392f2e10fb6c4f78c4">avgBusLat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ac7abb815f3daf254a44904528d4e816b">avgMemAccLat</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a28dfaaa96a94257709a4f53f65ff6de8">avgRdBW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a286267c923c741d2fb82bdf8e76ed309">avgWrBW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a22abe27ebad6f2dff8823abcbfd821b8">avgRdBWSys</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ab3ccc99d9b3a33a2783095e6299af1d8">avgWrBWSys</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a32757323249e0ec2fd96e77d543fc60d">busUtil</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a578cf14141a41ca0c302331cf1641d4a">busUtilRead</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a414d3be953606d246b346cc75032e7d5">busUtilWrite</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Average.html">Stats::Average</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ab0f0022a38b8ccefd6d4d17ed434fcea">avgRdQLen</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Average.html">Stats::Average</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a4cdec63bcb455cfe5f1d8e6db40b66f5">avgWrQLen</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a7f3862d0c1944536c2ec30b0d012e288">readRowHits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a5b75e7220ef0da8a50fe5777a9a1ae52">writeRowHits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a085bc7747d9a41218a9de406bf814c64">readRowHitRate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ae193ec834aceec0ed536dc53ec409f22">writeRowHitRate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ab29b83e3d43dd519d59172a842b673a3">avgGap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a8ec7f3dd4d238e4283760a15dc16c965">pageHitRate</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a06e80ba25d388ee981f9c88e27e189df">pwrStateTick</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classPacket.html">PacketPtr</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p>The DRAM controller is a basic single-channel memory controller aiming to mimic a high-level DRAM controller and the most important timing constraints associated with the DRAM. The focus is really on modelling the impact on the system rather than the DRAM itself, hence the focus is on the controller model and not on the memory. By adhering to the correct timing constraints, ultimately there is no need for a memory model in addition to the controller model.</p>
<p>As a basic design principle, this controller is not cycle callable, but instead uses events to decide when new decisions can be made, when resources become available, when things are to be considered done, and when to send things back. Through these simple principles, we achieve a performant model that is not cycle-accurate, but enables us to evaluate the system impact of a wide range of memory technologies, and also collect statistics about the use of the memory. </p>
<hr/><h2>列挙型</h2>
<a class="anchor" id="a167375ed712267f43fee8fa5d1aa4f11"></a><!-- doxytag: member="DRAMCtrl::BusState" ref="a167375ed712267f43fee8fa5d1aa4f11" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11">BusState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="namespaceBus.html">Bus</a> state used to control the read/write switching and drive the scheduling of the next request. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6"></a><!-- doxytag: member="READ" ref="a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6" args="" -->READ</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a167375ed712267f43fee8fa5d1aa4f11a12f0259011cf4a6cf10274abcf71daaa"></a><!-- doxytag: member="READ_TO_WRITE" ref="a167375ed712267f43fee8fa5d1aa4f11a12f0259011cf4a6cf10274abcf71daaa" args="" -->READ_TO_WRITE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a167375ed712267f43fee8fa5d1aa4f11a61aa7ff70b76bff0fda378cf61d6afbc"></a><!-- doxytag: member="WRITE" ref="a167375ed712267f43fee8fa5d1aa4f11a61aa7ff70b76bff0fda378cf61d6afbc" args="" -->WRITE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a167375ed712267f43fee8fa5d1aa4f11ad12c9fdf4a8009963c2eb263513e4aab"></a><!-- doxytag: member="WRITE_TO_READ" ref="a167375ed712267f43fee8fa5d1aa4f11ad12c9fdf4a8009963c2eb263513e4aab" args="" -->WRITE_TO_READ</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00128"></a>00128                   {
<a name="l00129"></a>00129         <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6">READ</a> = 0,
<a name="l00130"></a>00130         <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a12f0259011cf4a6cf10274abcf71daaa">READ_TO_WRITE</a>,
<a name="l00131"></a>00131         <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>,
<a name="l00132"></a>00132         <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11ad12c9fdf4a8009963c2eb263513e4aab">WRITE_TO_READ</a>
<a name="l00133"></a>00133     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa59b8ef6374ae587f3c228eba57bdf80"></a><!-- doxytag: member="DRAMCtrl::PowerState" ref="aa59b8ef6374ae587f3c228eba57bdf80" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The power state captures the different operational states of the DRAM and interacts with the bus read/write state machine, and the refresh state machine. In the idle state all banks are precharged. From there we either go to an auto refresh (as determined by the refresh state machine), or to a precharge power down mode. From idle the memory can also go to the active state (with one or more banks active), and in turn from there to active power down. At the moment we do not capture the deep power down and self-refresh state. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2"></a><!-- doxytag: member="PWR_IDLE" ref="aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2" args="" -->PWR_IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984"></a><!-- doxytag: member="PWR_REF" ref="aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984" args="" -->PWR_REF</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa59b8ef6374ae587f3c228eba57bdf80ad70441288ec3dbe4fb80e814a1342f18"></a><!-- doxytag: member="PWR_PRE_PDN" ref="aa59b8ef6374ae587f3c228eba57bdf80ad70441288ec3dbe4fb80e814a1342f18" args="" -->PWR_PRE_PDN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870"></a><!-- doxytag: member="PWR_ACT" ref="aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870" args="" -->PWR_ACT</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="aa59b8ef6374ae587f3c228eba57bdf80acb35a2366cd70ef3f0d263d22a3f3200"></a><!-- doxytag: member="PWR_ACT_PDN" ref="aa59b8ef6374ae587f3c228eba57bdf80acb35a2366cd70ef3f0d263d22a3f3200" args="" -->PWR_ACT_PDN</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00554"></a>00554                     {
<a name="l00555"></a>00555         <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a> = 0,
<a name="l00556"></a>00556         <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>,
<a name="l00557"></a>00557         <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ad70441288ec3dbe4fb80e814a1342f18">PWR_PRE_PDN</a>,
<a name="l00558"></a>00558         <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870">PWR_ACT</a>,
<a name="l00559"></a>00559         <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80acb35a2366cd70ef3f0d263d22a3f3200">PWR_ACT_PDN</a>
<a name="l00560"></a>00560     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5f4b1f67c62d22fa4cb3ec1f98b8edf5"></a><!-- doxytag: member="DRAMCtrl::RefreshState" ref="a5f4b1f67c62d22fa4cb3ec1f98b8edf5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5">RefreshState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The refresh state is used to control the progress of the refresh scheduling. When normal operation is in progress the refresh state is idle. From there, it progresses to the refresh drain state once tREFI has passed. The refresh drain state captures the DRAM row active state, as it will stay there until all ongoing accesses complete. Thereafter all banks are precharged, and lastly, the DRAM is refreshed. </p>
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6"></a><!-- doxytag: member="REF_IDLE" ref="a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6" args="" -->REF_IDLE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77"></a><!-- doxytag: member="REF_DRAIN" ref="a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77" args="" -->REF_DRAIN</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592"></a><!-- doxytag: member="REF_PRE" ref="a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592" args="" -->REF_PRE</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5"></a><!-- doxytag: member="REF_RUN" ref="a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5" args="" -->REF_RUN</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00534"></a>00534                       {
<a name="l00535"></a>00535         <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6">REF_IDLE</a> = 0,
<a name="l00536"></a>00536         <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77">REF_DRAIN</a>,
<a name="l00537"></a>00537         <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592">REF_PRE</a>,
<a name="l00538"></a>00538         <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5">REF_RUN</a>
<a name="l00539"></a>00539     };
</pre></div></p>

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="af86a9f0ba5b3737e1a7ba1f97dbf0e91"></a><!-- doxytag: member="DRAMCtrl::DRAMCtrl" ref="af86a9f0ba5b3737e1a7ba1f97dbf0e91" args="(const DRAMCtrlParams *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a> </td>
          <td>(</td>
          <td class="paramtype">const DRAMCtrlParams *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00055"></a>00055                                           :
<a name="l00056"></a>00056     <a class="code" href="classAbstractMemory.html#abe7c4ad03729f9b3dd25d3dc43361103">AbstractMemory</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>),
<a name="l00057"></a>00057     <a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.port&quot;</span>, *<span class="keyword">this</span>),
<a name="l00058"></a>00058     <a class="code" href="classDRAMCtrl.html#aa4e05579e39e0e1ae7859ddba8538932">retryRdReq</a>(<span class="keyword">false</span>), <a class="code" href="classDRAMCtrl.html#acf0d3616b5317008b8248aa2245df220">retryWrReq</a>(<span class="keyword">false</span>),
<a name="l00059"></a>00059     <a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a>(<a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6">READ</a>),
<a name="l00060"></a>00060     <a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>(<span class="keyword">this</span>), <a class="code" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a>(<span class="keyword">this</span>), <a class="code" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a>(<span class="keyword">this</span>),
<a name="l00061"></a>00061     <a class="code" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a>(<span class="keyword">this</span>), <a class="code" href="classDRAMCtrl.html#a0bc8ce4f4a849871eb32bd983b5d2843">refreshEvent</a>(<span class="keyword">this</span>), <a class="code" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a>(<span class="keyword">this</span>),
<a name="l00062"></a>00062     <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>(<a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>),
<a name="l00063"></a>00063     <a class="code" href="classDRAMCtrl.html#a9b8ba3e3a3cc11b904cd1b70e7a40ea5">deviceBusWidth</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;device_bus_width), <a class="code" href="classDRAMCtrl.html#a7ac4e4b031082616f09700ea29168920">burstLength</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;burst_length),
<a name="l00064"></a>00064     <a class="code" href="classDRAMCtrl.html#afdaeeb74e1622ca1cc0f00dcf937a3b0">deviceRowBufferSize</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;device_rowbuffer_size),
<a name="l00065"></a>00065     <a class="code" href="classDRAMCtrl.html#a962c654402093dcbdd4b40fd32c0de69">devicesPerRank</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;devices_per_rank),
<a name="l00066"></a>00066     <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>((<a class="code" href="classDRAMCtrl.html#a962c654402093dcbdd4b40fd32c0de69">devicesPerRank</a> * <a class="code" href="classDRAMCtrl.html#a7ac4e4b031082616f09700ea29168920">burstLength</a> * <a class="code" href="classDRAMCtrl.html#a9b8ba3e3a3cc11b904cd1b70e7a40ea5">deviceBusWidth</a>) / 8),
<a name="l00067"></a>00067     <a class="code" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a>(<a class="code" href="classDRAMCtrl.html#a962c654402093dcbdd4b40fd32c0de69">devicesPerRank</a> * <a class="code" href="classDRAMCtrl.html#afdaeeb74e1622ca1cc0f00dcf937a3b0">deviceRowBufferSize</a>),
<a name="l00068"></a>00068     <a class="code" href="classDRAMCtrl.html#a1f84aad3340018bfb3c46ace200df8cb">columnsPerRowBuffer</a>(<a class="code" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a> / <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>),
<a name="l00069"></a>00069     <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;ranks_per_channel),
<a name="l00070"></a>00070     <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;banks_per_rank), <a class="code" href="classDRAMCtrl.html#a2fa7bea53e9bf8fb52623b494d814d30">channels</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;channels), <a class="code" href="classDRAMCtrl.html#ad878fffffe428b1673a17f489f5a4e94">rowsPerBank</a>(0),
<a name="l00071"></a>00071     <a class="code" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;read_buffer_size),
<a name="l00072"></a>00072     <a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_buffer_size),
<a name="l00073"></a>00073     <a class="code" href="classDRAMCtrl.html#a61f48157d680c1ddf7dd818c9008dd53">writeHighThreshold</a>(<a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a> * <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_high_thresh_perc / 100.0),
<a name="l00074"></a>00074     <a class="code" href="classDRAMCtrl.html#a803b97da34c3b40357123d5713e6ab4a">writeLowThreshold</a>(<a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a> * <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_low_thresh_perc / 100.0),
<a name="l00075"></a>00075     <a class="code" href="classDRAMCtrl.html#a2753a60747e9836fe5f5fec7b613385c">minWritesPerSwitch</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;min_writes_per_switch),
<a name="l00076"></a>00076     <a class="code" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a>(0), <a class="code" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a>(0),
<a name="l00077"></a>00077     <a class="code" href="classDRAMCtrl.html#a9cd12bc6d433964d98ff2386c03e5246">tCK</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tCK), <a class="code" href="classDRAMCtrl.html#a33aeea1fd32ea7035fc8ca3a32f75473">tWTR</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tWTR), <a class="code" href="classDRAMCtrl.html#a578e383b38a4b65988799b3c16c4c17d">tRTW</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRTW), <a class="code" href="classDRAMCtrl.html#a15520c5298cfcc33032b7f0e363f7a3d">tBURST</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tBURST),
<a name="l00078"></a>00078     <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRCD), <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tCL), <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRP), <a class="code" href="classDRAMCtrl.html#a91e2a0dae0024646d5cf40c844996bcc">tRAS</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRAS), <a class="code" href="classDRAMCtrl.html#a3c3ee9ca057928cc876fc54a20356535">tWR</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tWR),
<a name="l00079"></a>00079     <a class="code" href="classDRAMCtrl.html#a850e39d6fd527d4992315e86a8978292">tRTP</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRTP), <a class="code" href="classDRAMCtrl.html#ada7c680f071957137175c60c125b929a">tRFC</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRFC), <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tREFI), <a class="code" href="classDRAMCtrl.html#ac09c7763d97a33e93c89f266ed29df29">tRRD</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tRRD),
<a name="l00080"></a>00080     <a class="code" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;tXAW), <a class="code" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;activation_limit),
<a name="l00081"></a>00081     <a class="code" href="classDRAMCtrl.html#a77153a963ea47f1f424595cbc94461e7">memSchedPolicy</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;mem_sched_policy), <a class="code" href="classDRAMCtrl.html#a39c22fc32946a97479fd50b6d4db1ed0">addrMapping</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;addr_mapping),
<a name="l00082"></a>00082     <a class="code" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;page_policy),
<a name="l00083"></a>00083     <a class="code" href="classDRAMCtrl.html#ab0ff1e80c0fcb937ef53eee0175cbd13">maxAccessesPerRow</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;max_accesses_per_row),
<a name="l00084"></a>00084     <a class="code" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;static_frontend_latency),
<a name="l00085"></a>00085     <a class="code" href="classDRAMCtrl.html#af7b0d4000762b26f57e6bdbbdf45cf6d">backendLatency</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;static_backend_latency),
<a name="l00086"></a>00086     <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a>(0), <a class="code" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a>(0), <a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a>(<a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6">REF_IDLE</a>),
<a name="l00087"></a>00087     <a class="code" href="classDRAMCtrl.html#ab31f48c472ee16c28fc62b8be41b740e">pwrStateTrans</a>(<a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>), <a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a>(<a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>), <a class="code" href="classDRAMCtrl.html#ae3e56b38f5969512cd915824ec1d5740">prevArrival</a>(0),
<a name="l00088"></a>00088     <a class="code" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a>(0), <a class="code" href="classDRAMCtrl.html#a06e80ba25d388ee981f9c88e27e189df">pwrStateTick</a>(0), <a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a>(0)
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090     <span class="comment">// create the bank states based on the dimensions of the ranks and</span>
<a name="l00091"></a>00091     <span class="comment">// banks</span>
<a name="l00092"></a>00092     <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>.resize(<a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>);
<a name="l00093"></a>00093     <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>.resize(<a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>);
<a name="l00094"></a>00094     <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="namespaceArmISA.html#a29b9f05234a93d5391014a3cfc5658b1">c</a> = 0; <a class="code" href="namespaceArmISA.html#a29b9f05234a93d5391014a3cfc5658b1">c</a> &lt; <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>; ++<a class="code" href="namespaceArmISA.html#a29b9f05234a93d5391014a3cfc5658b1">c</a>) {
<a name="l00095"></a>00095         <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#a29b9f05234a93d5391014a3cfc5658b1">c</a>].resize(<a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>);
<a name="l00096"></a>00096         <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[<a class="code" href="namespaceArmISA.html#a29b9f05234a93d5391014a3cfc5658b1">c</a>].resize(<a class="code" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a>, 0);
<a name="l00097"></a>00097     }
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="comment">// perform a basic check of the write thresholds</span>
<a name="l00100"></a>00100     <span class="keywordflow">if</span> (<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_low_thresh_perc &gt;= <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_high_thresh_perc)
<a name="l00101"></a>00101         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Write buffer low threshold %d must be smaller than the &quot;</span>
<a name="l00102"></a>00102               <span class="stringliteral">&quot;high threshold %d\n&quot;</span>, <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_low_thresh_perc,
<a name="l00103"></a>00103               <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;write_high_thresh_perc);
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <span class="comment">// determine the rows per bank by looking at the total capacity</span>
<a name="l00106"></a>00106     uint64_t capacity = <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(1) &lt;&lt; <a class="code" href="intmath_8hh.html#a0ec4eaea50888f737b803dc9427614bf">ceilLog2</a>(<a class="code" href="classAbstractMemory.html#a0b6868dbef44fc07f11d050eb59e5f7e">AbstractMemory::size</a>());
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Memory capacity %lld (%lld) bytes\n&quot;</span>, capacity,
<a name="l00109"></a>00109             <a class="code" href="classAbstractMemory.html#a0b6868dbef44fc07f11d050eb59e5f7e">AbstractMemory::size</a>());
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Row buffer size %d bytes with %d columns per row buffer\n&quot;</span>,
<a name="l00112"></a>00112             <a class="code" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a>, <a class="code" href="classDRAMCtrl.html#a1f84aad3340018bfb3c46ace200df8cb">columnsPerRowBuffer</a>);
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <a class="code" href="classDRAMCtrl.html#ad878fffffe428b1673a17f489f5a4e94">rowsPerBank</a> = capacity / (<a class="code" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a> * <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a> * ranksPerChannel);
<a name="l00115"></a>00115 
<a name="l00116"></a>00116     <span class="keywordflow">if</span> (<a class="code" href="classAbstractMemory.html#a194876a072a83a9fd59dde82e5213f0d">range</a>.<a class="code" href="classAddrRange.html#a5d52a3406dc6afea475c78ce06508afa">interleaved</a>()) {
<a name="l00117"></a>00117         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a2fa7bea53e9bf8fb52623b494d814d30">channels</a> != <a class="code" href="classAbstractMemory.html#a194876a072a83a9fd59dde82e5213f0d">range</a>.<a class="code" href="classAddrRange.html#a922914e9ba305472e1643f0be3b6ab01">stripes</a>())
<a name="l00118"></a>00118             <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;%s has %d interleaved address stripes but %d channel(s)\n&quot;</span>,
<a name="l00119"></a>00119                   <a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>(), <a class="code" href="classAbstractMemory.html#a194876a072a83a9fd59dde82e5213f0d">range</a>.<a class="code" href="classAddrRange.html#a922914e9ba305472e1643f0be3b6ab01">stripes</a>(), <a class="code" href="classDRAMCtrl.html#a2fa7bea53e9bf8fb52623b494d814d30">channels</a>);
<a name="l00120"></a>00120 
<a name="l00121"></a>00121         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a39c22fc32946a97479fd50b6d4db1ed0">addrMapping</a> == Enums::RoRaBaChCo) {
<a name="l00122"></a>00122             <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a> != <a class="code" href="classAbstractMemory.html#a194876a072a83a9fd59dde82e5213f0d">range</a>.<a class="code" href="classAddrRange.html#a2eca79b1c6faa6be9254f65e6e886355">granularity</a>()) {
<a name="l00123"></a>00123                 <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Interleaving of %s doesn&apos;t match RoRaBaChCo &quot;</span>
<a name="l00124"></a>00124                       <span class="stringliteral">&quot;address map\n&quot;</span>, <a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>());
<a name="l00125"></a>00125             }
<a name="l00126"></a>00126         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a39c22fc32946a97479fd50b6d4db1ed0">addrMapping</a> == Enums::RoRaBaCoCh) {
<a name="l00127"></a>00127             <span class="keywordflow">if</span> (<a class="code" href="classAbstractMemory.html#a83984c42bc765168929779ed9a37ebe8">system</a>()-&gt;cacheLineSize() != <a class="code" href="classAbstractMemory.html#a194876a072a83a9fd59dde82e5213f0d">range</a>.<a class="code" href="classAddrRange.html#a2eca79b1c6faa6be9254f65e6e886355">granularity</a>()) {
<a name="l00128"></a>00128                 <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Interleaving of %s doesn&apos;t match RoRaBaCoCh &quot;</span>
<a name="l00129"></a>00129                       <span class="stringliteral">&quot;address map\n&quot;</span>, <a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>());
<a name="l00130"></a>00130             }
<a name="l00131"></a>00131         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a39c22fc32946a97479fd50b6d4db1ed0">addrMapping</a> == Enums::RoCoRaBaCh) {
<a name="l00132"></a>00132             <span class="keywordflow">if</span> (<a class="code" href="classAbstractMemory.html#a83984c42bc765168929779ed9a37ebe8">system</a>()-&gt;cacheLineSize() != <a class="code" href="classAbstractMemory.html#a194876a072a83a9fd59dde82e5213f0d">range</a>.<a class="code" href="classAddrRange.html#a2eca79b1c6faa6be9254f65e6e886355">granularity</a>())
<a name="l00133"></a>00133                 <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Interleaving of %s doesn&apos;t match RoCoRaBaCh &quot;</span>
<a name="l00134"></a>00134                       <span class="stringliteral">&quot;address map\n&quot;</span>, <a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>());
<a name="l00135"></a>00135         }
<a name="l00136"></a>00136     }
<a name="l00137"></a>00137 
<a name="l00138"></a>00138     <span class="comment">// some basic sanity checks</span>
<a name="l00139"></a>00139     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a> &lt;= <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a> || <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a> &lt;= <a class="code" href="classDRAMCtrl.html#ada7c680f071957137175c60c125b929a">tRFC</a>) {
<a name="l00140"></a>00140         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;tREFI (%d) must be larger than tRP (%d) and tRFC (%d)\n&quot;</span>,
<a name="l00141"></a>00141               <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a>, <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>, <a class="code" href="classDRAMCtrl.html#ada7c680f071957137175c60c125b929a">tRFC</a>);
<a name="l00142"></a>00142     }
<a name="l00143"></a>00143 }

</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="aa10846589da1206d0047f6b82c2814e4"></a><!-- doxytag: member="DRAMCtrl::accessAndRespond" ref="aa10846589da1206d0047f6b82c2814e4" args="(PacketPtr pkt, Tick static_latency)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void accessAndRespond </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>static_latency</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>When a packet reaches its "readyTime" in the response Q, use the "access()" method in <a class="el" href="classAbstractMemory.html">AbstractMemory</a> to actually create the response packet, and send it back to the outside world requestor.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>The packet from the outside world </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>static_latency</em>&nbsp;</td><td>Static latency to add before sending the packet </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00721"></a>00721 {
<a name="l00722"></a>00722     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Responding to Address %lld.. &quot;</span>,pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>());
<a name="l00723"></a>00723 
<a name="l00724"></a>00724     <span class="keywordtype">bool</span> needsResponse = pkt-&gt;<a class="code" href="classPacket.html#a390c6cced05593f0a2c75a38a7a24fa9">needsResponse</a>();
<a name="l00725"></a>00725     <span class="comment">// do the actual memory access which also turns the packet into a</span>
<a name="l00726"></a>00726     <span class="comment">// response</span>
<a name="l00727"></a>00727     <a class="code" href="classAbstractMemory.html#aac5d96736802cb79fb2287135bcc1dff">access</a>(pkt);
<a name="l00728"></a>00728 
<a name="l00729"></a>00729     <span class="comment">// turn packet around to go back to requester if response expected</span>
<a name="l00730"></a>00730     <span class="keywordflow">if</span> (needsResponse) {
<a name="l00731"></a>00731         <span class="comment">// access already turned the packet into a response</span>
<a name="l00732"></a>00732         assert(pkt-&gt;<a class="code" href="classPacket.html#a5f89a108755a6cb3e8185d85c850a816">isResponse</a>());
<a name="l00733"></a>00733 
<a name="l00734"></a>00734         <span class="comment">// @todo someone should pay for this</span>
<a name="l00735"></a>00735         pkt-&gt;<a class="code" href="classPacket.html#af8986a05caa6c5b96b0b01bb6cf47772">busFirstWordDelay</a> = pkt-&gt;<a class="code" href="classPacket.html#a7bf8ae0a056329f751eda8b39ca4c268">busLastWordDelay</a> = 0;
<a name="l00736"></a>00736 
<a name="l00737"></a>00737         <span class="comment">// queue the packet in the response queue to be sent out after</span>
<a name="l00738"></a>00738         <span class="comment">// the static latency has passed</span>
<a name="l00739"></a>00739         <a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>.<a class="code" href="classQueuedSlavePort.html#a31c2fe79e7cbd7319eb327074e412675">schedTimingResp</a>(pkt, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + static_latency);
<a name="l00740"></a>00740     } <span class="keywordflow">else</span> {
<a name="l00741"></a>00741         <span class="comment">// @todo the packet is going to be deleted, and the DRAMPacket</span>
<a name="l00742"></a>00742         <span class="comment">// is still having a pointer to it</span>
<a name="l00743"></a>00743         <a class="code" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a>.push_back(pkt);
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745 
<a name="l00746"></a>00746     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Done\n&quot;</span>);
<a name="l00747"></a>00747 
<a name="l00748"></a>00748     <span class="keywordflow">return</span>;
<a name="l00749"></a>00749 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a98181e99df633f767f5116fe80e92042"></a><!-- doxytag: member="DRAMCtrl::activateBank" ref="a98181e99df633f767f5116fe80e92042" args="(Tick act_tick, uint8_t rank, uint8_t bank, uint16_t row, Bank &amp;bank_ref)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void activateBank </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>act_tick</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>rank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>bank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>row</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>bank_ref</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Keep track of when row activations happen, in order to enforce the maximum number of activations in the activation window. The method updates the time that the banks become available based on the current limits.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>act_tick</em>&nbsp;</td><td><a class="el" href="classTime.html">Time</a> when the activation takes place </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>rank</em>&nbsp;</td><td>Index of the rank </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bank</em>&nbsp;</td><td>Index of the bank </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>row</em>&nbsp;</td><td>Index of the row </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bank_ref</em>&nbsp;</td><td>Reference to the bank </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00754"></a>00754 {
<a name="l00755"></a>00755     assert(0 &lt;= rank &amp;&amp; rank &lt; <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>);
<a name="l00756"></a>00756     assert(<a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].<a class="code" href="classAbstractMemory.html#a0b6868dbef44fc07f11d050eb59e5f7e">size</a>() == <a class="code" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a>);
<a name="l00757"></a>00757 
<a name="l00758"></a>00758     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Activate at tick %d\n&quot;</span>, act_tick);
<a name="l00759"></a>00759 
<a name="l00760"></a>00760     <span class="comment">// update the open row</span>
<a name="l00761"></a>00761     assert(bank_ref.openRow == <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a>);
<a name="l00762"></a>00762     bank_ref.openRow = row;
<a name="l00763"></a>00763 
<a name="l00764"></a>00764     <span class="comment">// start counting anew, this covers both the case when we</span>
<a name="l00765"></a>00765     <span class="comment">// auto-precharged, and when this access is forced to</span>
<a name="l00766"></a>00766     <span class="comment">// precharge</span>
<a name="l00767"></a>00767     bank_ref.bytesAccessed = 0;
<a name="l00768"></a>00768     bank_ref.rowAccesses = 0;
<a name="l00769"></a>00769 
<a name="l00770"></a>00770     ++<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a>;
<a name="l00771"></a>00771     assert(<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a> &lt;= <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a> * <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>);
<a name="l00772"></a>00772 
<a name="l00773"></a>00773     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Activate bank at tick %lld, now got %d active\n&quot;</span>,
<a name="l00774"></a>00774             act_tick, <a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a>);
<a name="l00775"></a>00775 
<a name="l00776"></a>00776     <span class="comment">// The next access has to respect tRAS for this bank</span>
<a name="l00777"></a>00777     bank_ref.preAllowedAt = act_tick + <a class="code" href="classDRAMCtrl.html#a91e2a0dae0024646d5cf40c844996bcc">tRAS</a>;
<a name="l00778"></a>00778 
<a name="l00779"></a>00779     <span class="comment">// Respect the row-to-column command delay</span>
<a name="l00780"></a>00780     bank_ref.colAllowedAt = act_tick + <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a>;
<a name="l00781"></a>00781 
<a name="l00782"></a>00782     <span class="comment">// start by enforcing tRRD</span>
<a name="l00783"></a>00783     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00784"></a>00784         <span class="comment">// next activate to any bank in this rank must not happen</span>
<a name="l00785"></a>00785         <span class="comment">// before tRRD</span>
<a name="l00786"></a>00786         <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[rank][<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].actAllowedAt = std::max(act_tick + <a class="code" href="classDRAMCtrl.html#ac09c7763d97a33e93c89f266ed29df29">tRRD</a>,
<a name="l00787"></a>00787                                                <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[rank][<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].actAllowedAt);
<a name="l00788"></a>00788     }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790     <span class="comment">// next, we deal with tXAW, if the activation limit is disabled</span>
<a name="l00791"></a>00791     <span class="comment">// then we are done</span>
<a name="l00792"></a>00792     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].empty())
<a name="l00793"></a>00793         <span class="keywordflow">return</span>;
<a name="l00794"></a>00794 
<a name="l00795"></a>00795     <span class="comment">// sanity check</span>
<a name="l00796"></a>00796     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back() &amp;&amp; (act_tick - <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back()) &lt; <a class="code" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a>) {
<a name="l00797"></a>00797         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Got %d activates in window %d (%llu - %llu) which is smaller &quot;</span>
<a name="l00798"></a>00798               <span class="stringliteral">&quot;than %llu\n&quot;</span>, <a class="code" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a>, act_tick - <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back(),
<a name="l00799"></a>00799               act_tick, <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back(), <a class="code" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a>);
<a name="l00800"></a>00800     }
<a name="l00801"></a>00801 
<a name="l00802"></a>00802     <span class="comment">// shift the times used for the book keeping, the last element</span>
<a name="l00803"></a>00803     <span class="comment">// (highest index) is the oldest one and hence the lowest value</span>
<a name="l00804"></a>00804     <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].pop_back();
<a name="l00805"></a>00805 
<a name="l00806"></a>00806     <span class="comment">// record an new activation (in the future)</span>
<a name="l00807"></a>00807     <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].push_front(act_tick);
<a name="l00808"></a>00808 
<a name="l00809"></a>00809     <span class="comment">// cannot activate more than X times in time window tXAW, push the</span>
<a name="l00810"></a>00810     <span class="comment">// next one (the X + 1&apos;st activate) to be tXAW away from the</span>
<a name="l00811"></a>00811     <span class="comment">// oldest in our window of X</span>
<a name="l00812"></a>00812     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back() &amp;&amp; (act_tick - <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back()) &lt; <a class="code" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a>) {
<a name="l00813"></a>00813         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Enforcing tXAW with X = %d, next activate no earlier &quot;</span>
<a name="l00814"></a>00814                 <span class="stringliteral">&quot;than %llu\n&quot;</span>, <a class="code" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a>, <a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back() + <a class="code" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a>);
<a name="l00815"></a>00815             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; banksPerRank; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>++)
<a name="l00816"></a>00816                 <span class="comment">// next activate must not happen before end of window</span>
<a name="l00817"></a>00817                 <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[rank][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].actAllowedAt =
<a name="l00818"></a>00818                     std::max(<a class="code" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a>[rank].back() + <a class="code" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a>,
<a name="l00819"></a>00819                              <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[rank][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].actAllowedAt);
<a name="l00820"></a>00820     }
<a name="l00821"></a>00821 
<a name="l00822"></a>00822     <span class="comment">// at the point when this activate takes place, make sure we</span>
<a name="l00823"></a>00823     <span class="comment">// transition to the active power state</span>
<a name="l00824"></a>00824     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>())
<a name="l00825"></a>00825         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a>, act_tick);
<a name="l00826"></a>00826     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>() &gt; act_tick)
<a name="l00827"></a>00827         <span class="comment">// move it sooner in time</span>
<a name="l00828"></a>00828         <a class="code" href="classEventManager.html#a83fe8e2d06cd7c6e36743e5beb07298f">reschedule</a>(<a class="code" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a>, act_tick);
<a name="l00829"></a>00829 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac224a72395d7f9bea08435f4aee435df"></a><!-- doxytag: member="DRAMCtrl::addToReadQueue" ref="ac224a72395d7f9bea08435f4aee435df" args="(PacketPtr pkt, unsigned int pktCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addToReadQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pktCount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>When a new read comes in, first check if the write q has a pending request to the same address. If not, decode the address to populate rank/bank/row, create one or mutliple "dram_pkt", and push them to the back of the read queue.\ If this is the only read request in the system, schedule an event to start servicing it.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>The request packet from the outside world </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pktCount</em>&nbsp;</td><td>The number of DRAM bursts the pkt translate to. If pkt size is larger then one full burst, then pktCount is greater than one. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00311"></a>00311 {
<a name="l00312"></a>00312     <span class="comment">// only add to the read queue here. whenever the request is</span>
<a name="l00313"></a>00313     <span class="comment">// eventually done, set the readyTime, and call schedule()</span>
<a name="l00314"></a>00314     assert(!pkt-&gt;<a class="code" href="classPacket.html#ab699d2f0d186312531fd1c279fd27b73">isWrite</a>());
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     assert(pktCount != 0);
<a name="l00317"></a>00317 
<a name="l00318"></a>00318     <span class="comment">// if the request size is larger than burst size, the pkt is split into</span>
<a name="l00319"></a>00319     <span class="comment">// multiple DRAM packets</span>
<a name="l00320"></a>00320     <span class="comment">// Note if the pkt starting address is not aligened to burst size, the</span>
<a name="l00321"></a>00321     <span class="comment">// address of first DRAM packet is kept unaliged. Subsequent DRAM packets</span>
<a name="l00322"></a>00322     <span class="comment">// are aligned to burst size boundaries. This is to ensure we accurately</span>
<a name="l00323"></a>00323     <span class="comment">// check read packets against packets in write queue.</span>
<a name="l00324"></a>00324     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> = pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>();
<a name="l00325"></a>00325     <span class="keywordtype">unsigned</span> pktsServicedByWrQ = 0;
<a name="l00326"></a>00326     BurstHelper* burst_helper = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00327"></a>00327     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cnt = 0; cnt &lt; pktCount; ++cnt) {
<a name="l00328"></a>00328         <span class="keywordtype">unsigned</span> <a class="code" href="classAbstractMemory.html#a0b6868dbef44fc07f11d050eb59e5f7e">size</a> = std::min((addr | (<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a> - 1)) + 1,
<a name="l00329"></a>00329                         pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>() + pkt-&gt;<a class="code" href="classPacket.html#a1d18ba49c7be427da1f4a42d53e35f48">getSize</a>()) - addr;
<a name="l00330"></a>00330         <a class="code" href="classDRAMCtrl.html#aee4577f07fe67bcc60ba3c504b35c9f3">readPktSize</a>[<a class="code" href="intmath_8hh.html#a0ec4eaea50888f737b803dc9427614bf">ceilLog2</a>(size)]++;
<a name="l00331"></a>00331         <a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a>++;
<a name="l00332"></a>00332 
<a name="l00333"></a>00333         <span class="comment">// First check write buffer to see if the data is already at</span>
<a name="l00334"></a>00334         <span class="comment">// the controller</span>
<a name="l00335"></a>00335         <span class="keywordtype">bool</span> foundInWrQ = <span class="keyword">false</span>;
<a name="l00336"></a>00336         <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.begin(); <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> != <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.end(); ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00337"></a>00337             <span class="comment">// check if the read is subsumed in the write entry we are</span>
<a name="l00338"></a>00338             <span class="comment">// looking at</span>
<a name="l00339"></a>00339             <span class="keywordflow">if</span> ((*i)-&gt;addr &lt;= addr &amp;&amp;
<a name="l00340"></a>00340                 (addr + size) &lt;= ((*i)-&gt;addr + (*i)-&gt;size)) {
<a name="l00341"></a>00341                 foundInWrQ = <span class="keyword">true</span>;
<a name="l00342"></a>00342                 <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>++;
<a name="l00343"></a>00343                 pktsServicedByWrQ++;
<a name="l00344"></a>00344                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Read to addr %lld with size %d serviced by &quot;</span>
<a name="l00345"></a>00345                         <span class="stringliteral">&quot;write queue\n&quot;</span>, addr, size);
<a name="l00346"></a>00346                 <a class="code" href="classDRAMCtrl.html#ae2ea884ed0a7e793cabc56748b833ed2">bytesReadWrQ</a> += <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>;
<a name="l00347"></a>00347                 <span class="keywordflow">break</span>;
<a name="l00348"></a>00348             }
<a name="l00349"></a>00349         }
<a name="l00350"></a>00350 
<a name="l00351"></a>00351         <span class="comment">// If not found in the write q, make a DRAM packet and</span>
<a name="l00352"></a>00352         <span class="comment">// push it onto the read queue</span>
<a name="l00353"></a>00353         <span class="keywordflow">if</span> (!foundInWrQ) {
<a name="l00354"></a>00354 
<a name="l00355"></a>00355             <span class="comment">// Make the burst helper for split packets</span>
<a name="l00356"></a>00356             <span class="keywordflow">if</span> (pktCount &gt; 1 &amp;&amp; burst_helper == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00357"></a>00357                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Read to addr %lld translates to %d &quot;</span>
<a name="l00358"></a>00358                         <span class="stringliteral">&quot;dram requests\n&quot;</span>, pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>(), pktCount);
<a name="l00359"></a>00359                 burst_helper = <span class="keyword">new</span> BurstHelper(pktCount);
<a name="l00360"></a>00360             }
<a name="l00361"></a>00361 
<a name="l00362"></a>00362             DRAMPacket* dram_pkt = <a class="code" href="classDRAMCtrl.html#a6d379162bc91622a9b1f1bdf82e062cc">decodeAddr</a>(pkt, addr, size, <span class="keyword">true</span>);
<a name="l00363"></a>00363             dram_pkt-&gt;burstHelper = burst_helper;
<a name="l00364"></a>00364 
<a name="l00365"></a>00365             assert(!<a class="code" href="classDRAMCtrl.html#a865d7144c26ea7f206d937e12935f840">readQueueFull</a>(1));
<a name="l00366"></a>00366             <a class="code" href="classDRAMCtrl.html#a34cdc0482a9faf13f94abb3a37fa90b8">rdQLenPdf</a>[<a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.size() + <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.size()]++;
<a name="l00367"></a>00367 
<a name="l00368"></a>00368             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Adding to read queue\n&quot;</span>);
<a name="l00369"></a>00369 
<a name="l00370"></a>00370             <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.push_back(dram_pkt);
<a name="l00371"></a>00371 
<a name="l00372"></a>00372             <span class="comment">// Update stats</span>
<a name="l00373"></a>00373             <a class="code" href="classDRAMCtrl.html#ab0f0022a38b8ccefd6d4d17ed434fcea">avgRdQLen</a> = <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.size() + <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.size();
<a name="l00374"></a>00374         }
<a name="l00375"></a>00375 
<a name="l00376"></a>00376         <span class="comment">// Starting address of next dram pkt (aligend to burstSize boundary)</span>
<a name="l00377"></a>00377         addr = (addr | (<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a> - 1)) + 1;
<a name="l00378"></a>00378     }
<a name="l00379"></a>00379 
<a name="l00380"></a>00380     <span class="comment">// If all packets are serviced by write queue, we send the repsonse back</span>
<a name="l00381"></a>00381     <span class="keywordflow">if</span> (pktsServicedByWrQ == pktCount) {
<a name="l00382"></a>00382         <a class="code" href="classDRAMCtrl.html#aa10846589da1206d0047f6b82c2814e4">accessAndRespond</a>(pkt, <a class="code" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a>);
<a name="l00383"></a>00383         <span class="keywordflow">return</span>;
<a name="l00384"></a>00384     }
<a name="l00385"></a>00385 
<a name="l00386"></a>00386     <span class="comment">// Update how many split packets are serviced by write queue</span>
<a name="l00387"></a>00387     <span class="keywordflow">if</span> (burst_helper != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>)
<a name="l00388"></a>00388         burst_helper-&gt;burstsServiced = pktsServicedByWrQ;
<a name="l00389"></a>00389 
<a name="l00390"></a>00390     <span class="comment">// If we are not already scheduled to get a request out of the</span>
<a name="l00391"></a>00391     <span class="comment">// queue, do so now</span>
<a name="l00392"></a>00392     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l00393"></a>00393         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Request scheduled immediately\n&quot;</span>);
<a name="l00394"></a>00394         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00395"></a>00395     }
<a name="l00396"></a>00396 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9538c5891b7139a62cffe6cbd7853b9a"></a><!-- doxytag: member="DRAMCtrl::addToWriteQueue" ref="a9538c5891b7139a62cffe6cbd7853b9a" args="(PacketPtr pkt, unsigned int pktCount)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addToWriteQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pktCount</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Decode the incoming pkt, create a dram_pkt and push to the back of the write queue.  the write q length is more than the threshold specified by the user, ie the queue is beginning to get full, stop reads, and start draining writes.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>The request packet from the outside world </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pktCount</em>&nbsp;</td><td>The number of DRAM bursts the pkt translate to. If pkt size is larger then one full burst, then pktCount is greater than one. </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00400"></a>00400 {
<a name="l00401"></a>00401     <span class="comment">// only add to the write queue here. whenever the request is</span>
<a name="l00402"></a>00402     <span class="comment">// eventually done, set the readyTime, and call schedule()</span>
<a name="l00403"></a>00403     assert(pkt-&gt;<a class="code" href="classPacket.html#ab699d2f0d186312531fd1c279fd27b73">isWrite</a>());
<a name="l00404"></a>00404 
<a name="l00405"></a>00405     <span class="comment">// if the request size is larger than burst size, the pkt is split into</span>
<a name="l00406"></a>00406     <span class="comment">// multiple DRAM packets</span>
<a name="l00407"></a>00407     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a> = pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>();
<a name="l00408"></a>00408     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cnt = 0; cnt &lt; pktCount; ++cnt) {
<a name="l00409"></a>00409         <span class="keywordtype">unsigned</span> <a class="code" href="classAbstractMemory.html#a0b6868dbef44fc07f11d050eb59e5f7e">size</a> = std::min((addr | (<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a> - 1)) + 1,
<a name="l00410"></a>00410                         pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>() + pkt-&gt;<a class="code" href="classPacket.html#a1d18ba49c7be427da1f4a42d53e35f48">getSize</a>()) - addr;
<a name="l00411"></a>00411         <a class="code" href="classDRAMCtrl.html#aecc027383223e3500a37a9646607df81">writePktSize</a>[<a class="code" href="intmath_8hh.html#a0ec4eaea50888f737b803dc9427614bf">ceilLog2</a>(size)]++;
<a name="l00412"></a>00412         <a class="code" href="classDRAMCtrl.html#a14baa61a63ebc1c4ce4aa1930aa9ba50">writeBursts</a>++;
<a name="l00413"></a>00413 
<a name="l00414"></a>00414         <span class="comment">// see if we can merge with an existing item in the write</span>
<a name="l00415"></a>00415         <span class="comment">// queue and keep track of whether we have merged or not so we</span>
<a name="l00416"></a>00416         <span class="comment">// can stop at that point and also avoid enqueueing a new</span>
<a name="l00417"></a>00417         <span class="comment">// request</span>
<a name="l00418"></a>00418         <span class="keywordtype">bool</span> merged = <span class="keyword">false</span>;
<a name="l00419"></a>00419         <span class="keyword">auto</span> <a class="code" href="namespaceMipsISA.html#a3c9d192cc8aebe4b3d22912a4604e08d">w</a> = <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.begin();
<a name="l00420"></a>00420 
<a name="l00421"></a>00421         <span class="keywordflow">while</span>(!merged &amp;&amp; <a class="code" href="namespaceMipsISA.html#a3c9d192cc8aebe4b3d22912a4604e08d">w</a> != <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.end()) {
<a name="l00422"></a>00422             <span class="comment">// either of the two could be first, if they are the same</span>
<a name="l00423"></a>00423             <span class="comment">// it does not matter which way we go</span>
<a name="l00424"></a>00424             <span class="keywordflow">if</span> ((*w)-&gt;addr &gt;= addr) {
<a name="l00425"></a>00425                 <span class="comment">// the existing one starts after the new one, figure</span>
<a name="l00426"></a>00426                 <span class="comment">// out where the new one ends with respect to the</span>
<a name="l00427"></a>00427                 <span class="comment">// existing one</span>
<a name="l00428"></a>00428                 <span class="keywordflow">if</span> ((addr + size) &gt;= ((*w)-&gt;addr + (*w)-&gt;size)) {
<a name="l00429"></a>00429                     <span class="comment">// check if the existing one is completely</span>
<a name="l00430"></a>00430                     <span class="comment">// subsumed in the new one</span>
<a name="l00431"></a>00431                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Merging write covering existing burst\n&quot;</span>);
<a name="l00432"></a>00432                     merged = <span class="keyword">true</span>;
<a name="l00433"></a>00433                     <span class="comment">// update both the address and the size</span>
<a name="l00434"></a>00434                     (*w)-&gt;addr = addr;
<a name="l00435"></a>00435                     (*w)-&gt;size = size;
<a name="l00436"></a>00436                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((addr + size) &gt;= (*w)-&gt;addr &amp;&amp;
<a name="l00437"></a>00437                            ((*w)-&gt;addr + (*w)-&gt;size - addr) &lt;= <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>) {
<a name="l00438"></a>00438                     <span class="comment">// the new one is just before or partially</span>
<a name="l00439"></a>00439                     <span class="comment">// overlapping with the existing one, and together</span>
<a name="l00440"></a>00440                     <span class="comment">// they fit within a burst</span>
<a name="l00441"></a>00441                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Merging write before existing burst\n&quot;</span>);
<a name="l00442"></a>00442                     merged = <span class="keyword">true</span>;
<a name="l00443"></a>00443                     <span class="comment">// the existing queue item needs to be adjusted with</span>
<a name="l00444"></a>00444                     <span class="comment">// respect to both address and size</span>
<a name="l00445"></a>00445                     (*w)-&gt;size = (*w)-&gt;addr + (*w)-&gt;size - addr;
<a name="l00446"></a>00446                     (*w)-&gt;addr = addr;
<a name="l00447"></a>00447                 }
<a name="l00448"></a>00448             } <span class="keywordflow">else</span> {
<a name="l00449"></a>00449                 <span class="comment">// the new one starts after the current one, figure</span>
<a name="l00450"></a>00450                 <span class="comment">// out where the existing one ends with respect to the</span>
<a name="l00451"></a>00451                 <span class="comment">// new one</span>
<a name="l00452"></a>00452                 <span class="keywordflow">if</span> (((*w)-&gt;addr + (*w)-&gt;size) &gt;= (addr + size)) {
<a name="l00453"></a>00453                     <span class="comment">// check if the new one is completely subsumed in the</span>
<a name="l00454"></a>00454                     <span class="comment">// existing one</span>
<a name="l00455"></a>00455                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Merging write into existing burst\n&quot;</span>);
<a name="l00456"></a>00456                     merged = <span class="keyword">true</span>;
<a name="l00457"></a>00457                     <span class="comment">// no adjustments necessary</span>
<a name="l00458"></a>00458                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (((*w)-&gt;addr + (*w)-&gt;size) &gt;= addr &amp;&amp;
<a name="l00459"></a>00459                            (addr + size - (*w)-&gt;addr) &lt;= <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>) {
<a name="l00460"></a>00460                     <span class="comment">// the existing one is just before or partially</span>
<a name="l00461"></a>00461                     <span class="comment">// overlapping with the new one, and together</span>
<a name="l00462"></a>00462                     <span class="comment">// they fit within a burst</span>
<a name="l00463"></a>00463                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Merging write after existing burst\n&quot;</span>);
<a name="l00464"></a>00464                     merged = <span class="keyword">true</span>;
<a name="l00465"></a>00465                     <span class="comment">// the address is right, and only the size has</span>
<a name="l00466"></a>00466                     <span class="comment">// to be adjusted</span>
<a name="l00467"></a>00467                     (*w)-&gt;size = addr + size - (*w)-&gt;addr;
<a name="l00468"></a>00468                 }
<a name="l00469"></a>00469             }
<a name="l00470"></a>00470             ++<a class="code" href="namespaceMipsISA.html#a3c9d192cc8aebe4b3d22912a4604e08d">w</a>;
<a name="l00471"></a>00471         }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473         <span class="comment">// if the item was not merged we need to create a new write</span>
<a name="l00474"></a>00474         <span class="comment">// and enqueue it</span>
<a name="l00475"></a>00475         <span class="keywordflow">if</span> (!merged) {
<a name="l00476"></a>00476             DRAMPacket* dram_pkt = <a class="code" href="classDRAMCtrl.html#a6d379162bc91622a9b1f1bdf82e062cc">decodeAddr</a>(pkt, addr, size, <span class="keyword">false</span>);
<a name="l00477"></a>00477 
<a name="l00478"></a>00478             assert(<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size() &lt; <a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>);
<a name="l00479"></a>00479             <a class="code" href="classDRAMCtrl.html#ace3009d78850dc82f90724de8df96227">wrQLenPdf</a>[<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size()]++;
<a name="l00480"></a>00480 
<a name="l00481"></a>00481             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Adding to write queue\n&quot;</span>);
<a name="l00482"></a>00482 
<a name="l00483"></a>00483             <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.push_back(dram_pkt);
<a name="l00484"></a>00484 
<a name="l00485"></a>00485             <span class="comment">// Update stats</span>
<a name="l00486"></a>00486             <a class="code" href="classDRAMCtrl.html#a4cdec63bcb455cfe5f1d8e6db40b66f5">avgWrQLen</a> = <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size();
<a name="l00487"></a>00487         } <span class="keywordflow">else</span> {
<a name="l00488"></a>00488             <span class="comment">// keep track of the fact that this burst effectively</span>
<a name="l00489"></a>00489             <span class="comment">// disappeared as it was merged with an existing one</span>
<a name="l00490"></a>00490             <a class="code" href="classDRAMCtrl.html#accaed2ab83bb63d6ddff7bfa861ea537">mergedWrBursts</a>++;
<a name="l00491"></a>00491         }
<a name="l00492"></a>00492 
<a name="l00493"></a>00493         <span class="comment">// Starting address of next dram pkt (aligend to burstSize boundary)</span>
<a name="l00494"></a>00494         addr = (addr | (<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a> - 1)) + 1;
<a name="l00495"></a>00495     }
<a name="l00496"></a>00496 
<a name="l00497"></a>00497     <span class="comment">// we do not wait for the writes to be send to the actual memory,</span>
<a name="l00498"></a>00498     <span class="comment">// but instead take responsibility for the consistency here and</span>
<a name="l00499"></a>00499     <span class="comment">// snoop the write queue for any upcoming reads</span>
<a name="l00500"></a>00500     <span class="comment">// @todo, if a pkt size is larger than burst size, we might need a</span>
<a name="l00501"></a>00501     <span class="comment">// different front end latency</span>
<a name="l00502"></a>00502     <a class="code" href="classDRAMCtrl.html#aa10846589da1206d0047f6b82c2814e4">accessAndRespond</a>(pkt, <a class="code" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a>);
<a name="l00503"></a>00503 
<a name="l00504"></a>00504     <span class="comment">// If we are not already scheduled to get a request out of the</span>
<a name="l00505"></a>00505     <span class="comment">// queue, do so now</span>
<a name="l00506"></a>00506     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l00507"></a>00507         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Request scheduled immediately\n&quot;</span>);
<a name="l00508"></a>00508         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a45c15f5a90be2e23d6bde9f706db7f24"></a><!-- doxytag: member="DRAMCtrl::chooseNext" ref="a45c15f5a90be2e23d6bde9f706db7f24" args="(std::deque&lt; DRAMPacket * &gt; &amp;queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void chooseNext </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>queue</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The memory schduler/arbiter - picks which request needs to go next, based on the specified policy such as FCFS or FR-FCFS and moves it to the head of the queue. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00651"></a>00651 {
<a name="l00652"></a>00652     <span class="comment">// This method does the arbitration between requests. The chosen</span>
<a name="l00653"></a>00653     <span class="comment">// packet is simply moved to the head of the queue. The other</span>
<a name="l00654"></a>00654     <span class="comment">// methods know that this is the place to look. For example, with</span>
<a name="l00655"></a>00655     <span class="comment">// FCFS, this method does nothing</span>
<a name="l00656"></a>00656     assert(!queue.empty());
<a name="l00657"></a>00657 
<a name="l00658"></a>00658     <span class="keywordflow">if</span> (queue.size() == 1) {
<a name="l00659"></a>00659         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Single request, nothing to do\n&quot;</span>);
<a name="l00660"></a>00660         <span class="keywordflow">return</span>;
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662 
<a name="l00663"></a>00663     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a77153a963ea47f1f424595cbc94461e7">memSchedPolicy</a> == Enums::fcfs) {
<a name="l00664"></a>00664         <span class="comment">// Do nothing, since the correct request is already head</span>
<a name="l00665"></a>00665     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a77153a963ea47f1f424595cbc94461e7">memSchedPolicy</a> == Enums::frfcfs) {
<a name="l00666"></a>00666         <a class="code" href="classDRAMCtrl.html#aabfe6aa48e67d5b5c21e77dfa8a7e965">reorderQueue</a>(queue);
<a name="l00667"></a>00667     } <span class="keywordflow">else</span>
<a name="l00668"></a>00668         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;No scheduling policy chosen\n&quot;</span>);
<a name="l00669"></a>00669 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6d379162bc91622a9b1f1bdf82e062cc"></a><!-- doxytag: member="DRAMCtrl::decodeAddr" ref="a6d379162bc91622a9b1f1bdf82e062cc" args="(PacketPtr pkt, Addr dramPktAddr, unsigned int size, bool isRead)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a>* decodeAddr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>dramPktAddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>isRead</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classAddress.html">Address</a> decoder to figure out physical mapping onto ranks, banks, and rows. This function is called multiple times on the same system packet if the pakcet is larger than burst of the memory. The dramPktAddr is used for the offset within the packet.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>The packet from the outside world </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>dramPktAddr</em>&nbsp;</td><td>The starting address of the DRAM packet </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>size</em>&nbsp;</td><td>The size of the DRAM packet in bytes </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>isRead</em>&nbsp;</td><td>Is the request for a read or a write to DRAM </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>A <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> pointer with the decoded information </dd></dl>

</div>
</div>
<a class="anchor" id="a981a4462a622304ff598af5a232d7dd5"></a><!-- doxytag: member="DRAMCtrl::doDRAMAccess" ref="a981a4462a622304ff598af5a232d7dd5" args="(DRAMPacket *dram_pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void doDRAMAccess </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> *&nbsp;</td>
          <td class="paramname"> <em>dram_pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Actually do the DRAM access - figure out the latency it will take to service the req based on bank state, channel state etc and then update those states to account for this request. Based on this, update the packet's "readyTime" and move it to the response q from where it will eventually go back to the outside world.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pkt</em>&nbsp;</td><td>The DRAM packet created from the outside world pkt </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00892"></a>00892 {
<a name="l00893"></a>00893     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Timing access to addr %lld, rank/bank/row %d %d %d\n&quot;</span>,
<a name="l00894"></a>00894             dram_pkt-&gt;addr, dram_pkt-&gt;rank, dram_pkt-&gt;bank, dram_pkt-&gt;row);
<a name="l00895"></a>00895 
<a name="l00896"></a>00896     <span class="comment">// get the bank</span>
<a name="l00897"></a>00897     Bank&amp; bank = dram_pkt-&gt;bankRef;
<a name="l00898"></a>00898 
<a name="l00899"></a>00899     <span class="comment">// for the state we need to track if it is a row hit or not</span>
<a name="l00900"></a>00900     <span class="keywordtype">bool</span> row_hit = <span class="keyword">true</span>;
<a name="l00901"></a>00901 
<a name="l00902"></a>00902     <span class="comment">// respect any constraints on the command (e.g. tRCD or tCCD)</span>
<a name="l00903"></a>00903     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> cmd_at = std::max(bank.colAllowedAt, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00904"></a>00904 
<a name="l00905"></a>00905     <span class="comment">// Determine the access latency and update the bank state</span>
<a name="l00906"></a>00906     <span class="keywordflow">if</span> (bank.openRow == dram_pkt-&gt;row) {
<a name="l00907"></a>00907         <span class="comment">// nothing to do</span>
<a name="l00908"></a>00908     } <span class="keywordflow">else</span> {
<a name="l00909"></a>00909         row_hit = <span class="keyword">false</span>;
<a name="l00910"></a>00910 
<a name="l00911"></a>00911         <span class="comment">// If there is a page open, precharge it.</span>
<a name="l00912"></a>00912         <span class="keywordflow">if</span> (bank.openRow != <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a>) {
<a name="l00913"></a>00913             <a class="code" href="classDRAMCtrl.html#ae75715461eec20eff07a532c11c3d54c">prechargeBank</a>(bank, std::max(bank.preAllowedAt, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>()));
<a name="l00914"></a>00914         }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916         <span class="comment">// next we need to account for the delay in activating the</span>
<a name="l00917"></a>00917         <span class="comment">// page</span>
<a name="l00918"></a>00918         <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> act_tick = std::max(bank.actAllowedAt, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00919"></a>00919 
<a name="l00920"></a>00920         <span class="comment">// Record the activation and deal with all the global timing</span>
<a name="l00921"></a>00921         <span class="comment">// constraints caused be a new activation (tRRD and tXAW)</span>
<a name="l00922"></a>00922         <a class="code" href="classDRAMCtrl.html#a98181e99df633f767f5116fe80e92042">activateBank</a>(act_tick, dram_pkt-&gt;rank, dram_pkt-&gt;bank,
<a name="l00923"></a>00923                      dram_pkt-&gt;row, bank);
<a name="l00924"></a>00924 
<a name="l00925"></a>00925         <span class="comment">// issue the command as early as possible</span>
<a name="l00926"></a>00926         cmd_at = bank.colAllowedAt;
<a name="l00927"></a>00927     }
<a name="l00928"></a>00928 
<a name="l00929"></a>00929     <span class="comment">// we need to wait until the bus is available before we can issue</span>
<a name="l00930"></a>00930     <span class="comment">// the command</span>
<a name="l00931"></a>00931     cmd_at = std::max(cmd_at, <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> - <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>);
<a name="l00932"></a>00932 
<a name="l00933"></a>00933     <span class="comment">// update the packet ready time</span>
<a name="l00934"></a>00934     dram_pkt-&gt;readyTime = cmd_at + <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a> + <a class="code" href="classDRAMCtrl.html#a15520c5298cfcc33032b7f0e363f7a3d">tBURST</a>;
<a name="l00935"></a>00935 
<a name="l00936"></a>00936     <span class="comment">// only one burst can use the bus at any one point in time</span>
<a name="l00937"></a>00937     assert(dram_pkt-&gt;readyTime - <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> &gt;= tBURST);
<a name="l00938"></a>00938 
<a name="l00939"></a>00939     <span class="comment">// not strictly necessary, but update the time for the next</span>
<a name="l00940"></a>00940     <span class="comment">// read/write (add a max with tCCD here)</span>
<a name="l00941"></a>00941     bank.colAllowedAt = cmd_at + tBURST;
<a name="l00942"></a>00942 
<a name="l00943"></a>00943     <span class="comment">// If this is a write, we also need to respect the write recovery</span>
<a name="l00944"></a>00944     <span class="comment">// time before a precharge, in the case of a read, respect the</span>
<a name="l00945"></a>00945     <span class="comment">// read to precharge constraint</span>
<a name="l00946"></a>00946     bank.preAllowedAt = std::max(bank.preAllowedAt,
<a name="l00947"></a>00947                                  dram_pkt-&gt;isRead ? cmd_at + <a class="code" href="classDRAMCtrl.html#a850e39d6fd527d4992315e86a8978292">tRTP</a> :
<a name="l00948"></a>00948                                  dram_pkt-&gt;readyTime + <a class="code" href="classDRAMCtrl.html#a3c3ee9ca057928cc876fc54a20356535">tWR</a>);
<a name="l00949"></a>00949 
<a name="l00950"></a>00950     <span class="comment">// increment the bytes accessed and the accesses per row</span>
<a name="l00951"></a>00951     bank.bytesAccessed += <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>;
<a name="l00952"></a>00952     ++bank.rowAccesses;
<a name="l00953"></a>00953 
<a name="l00954"></a>00954     <span class="comment">// if we reached the max, then issue with an auto-precharge</span>
<a name="l00955"></a>00955     <span class="keywordtype">bool</span> auto_precharge = <a class="code" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a> == Enums::close ||
<a name="l00956"></a>00956         bank.rowAccesses == <a class="code" href="classDRAMCtrl.html#ab0ff1e80c0fcb937ef53eee0175cbd13">maxAccessesPerRow</a>;
<a name="l00957"></a>00957 
<a name="l00958"></a>00958     <span class="comment">// if we did not hit the limit, we might still want to</span>
<a name="l00959"></a>00959     <span class="comment">// auto-precharge</span>
<a name="l00960"></a>00960     <span class="keywordflow">if</span> (!auto_precharge &amp;&amp;
<a name="l00961"></a>00961         (<a class="code" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a> == Enums::open_adaptive ||
<a name="l00962"></a>00962          <a class="code" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a> == Enums::close_adaptive)) {
<a name="l00963"></a>00963         <span class="comment">// a twist on the open and close page policies:</span>
<a name="l00964"></a>00964         <span class="comment">// 1) open_adaptive page policy does not blindly keep the</span>
<a name="l00965"></a>00965         <span class="comment">// page open, but close it if there are no row hits, and there</span>
<a name="l00966"></a>00966         <span class="comment">// are bank conflicts in the queue</span>
<a name="l00967"></a>00967         <span class="comment">// 2) close_adaptive page policy does not blindly close the</span>
<a name="l00968"></a>00968         <span class="comment">// page, but closes it only if there are no row hits in the queue.</span>
<a name="l00969"></a>00969         <span class="comment">// In this case, only force an auto precharge when there</span>
<a name="l00970"></a>00970         <span class="comment">// are no same page hits in the queue</span>
<a name="l00971"></a>00971         <span class="keywordtype">bool</span> got_more_hits = <span class="keyword">false</span>;
<a name="l00972"></a>00972         <span class="keywordtype">bool</span> got_bank_conflict = <span class="keyword">false</span>;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974         <span class="comment">// either look at the read queue or write queue</span>
<a name="l00975"></a>00975         <span class="keyword">const</span> <a class="code" href="classstd_1_1deque.html">deque&lt;DRAMPacket*&gt;</a>&amp; queue = dram_pkt-&gt;isRead ? <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a> :
<a name="l00976"></a>00976             <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>;
<a name="l00977"></a>00977         <span class="keyword">auto</span> <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a> = queue.begin();
<a name="l00978"></a>00978         <span class="comment">// make sure we are not considering the packet that we are</span>
<a name="l00979"></a>00979         <span class="comment">// currently dealing with (which is the head of the queue)</span>
<a name="l00980"></a>00980         ++<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>;
<a name="l00981"></a>00981 
<a name="l00982"></a>00982         <span class="comment">// keep on looking until we have found required condition or</span>
<a name="l00983"></a>00983         <span class="comment">// reached the end</span>
<a name="l00984"></a>00984         <span class="keywordflow">while</span> (!(got_more_hits &amp;&amp;
<a name="l00985"></a>00985                  (got_bank_conflict || <a class="code" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a> == Enums::close_adaptive)) &amp;&amp;
<a name="l00986"></a>00986                <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a> != queue.end()) {
<a name="l00987"></a>00987             <span class="keywordtype">bool</span> same_rank_bank = (dram_pkt-&gt;rank == (*p)-&gt;rank) &amp;&amp;
<a name="l00988"></a>00988                 (dram_pkt-&gt;bank == (*p)-&gt;bank);
<a name="l00989"></a>00989             <span class="keywordtype">bool</span> same_row = dram_pkt-&gt;row == (*p)-&gt;row;
<a name="l00990"></a>00990             got_more_hits |= same_rank_bank &amp;&amp; same_row;
<a name="l00991"></a>00991             got_bank_conflict |= same_rank_bank &amp;&amp; !same_row;
<a name="l00992"></a>00992             ++<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>;
<a name="l00993"></a>00993         }
<a name="l00994"></a>00994 
<a name="l00995"></a>00995         <span class="comment">// auto pre-charge when either</span>
<a name="l00996"></a>00996         <span class="comment">// 1) open_adaptive policy, we have not got any more hits, and</span>
<a name="l00997"></a>00997         <span class="comment">//    have a bank conflict</span>
<a name="l00998"></a>00998         <span class="comment">// 2) close_adaptive policy and we have not got any more hits</span>
<a name="l00999"></a>00999         auto_precharge = !got_more_hits &amp;&amp;
<a name="l01000"></a>01000             (got_bank_conflict || <a class="code" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a> == Enums::close_adaptive);
<a name="l01001"></a>01001     }
<a name="l01002"></a>01002 
<a name="l01003"></a>01003     <span class="comment">// if this access should use auto-precharge, then we are</span>
<a name="l01004"></a>01004     <span class="comment">// closing the row</span>
<a name="l01005"></a>01005     <span class="keywordflow">if</span> (auto_precharge) {
<a name="l01006"></a>01006         <a class="code" href="classDRAMCtrl.html#ae75715461eec20eff07a532c11c3d54c">prechargeBank</a>(bank, std::max(<a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>(), bank.preAllowedAt));
<a name="l01007"></a>01007 
<a name="l01008"></a>01008         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Auto-precharged bank: %d\n&quot;</span>, dram_pkt-&gt;bankId);
<a name="l01009"></a>01009     }
<a name="l01010"></a>01010 
<a name="l01011"></a>01011     <span class="comment">// Update bus state</span>
<a name="l01012"></a>01012     <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> = dram_pkt-&gt;readyTime;
<a name="l01013"></a>01013 
<a name="l01014"></a>01014     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Access to %lld, ready at %lld bus busy until %lld.\n&quot;</span>,
<a name="l01015"></a>01015             dram_pkt-&gt;addr, dram_pkt-&gt;readyTime, <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a>);
<a name="l01016"></a>01016 
<a name="l01017"></a>01017     <span class="comment">// Update the minimum timing between the requests, this is a</span>
<a name="l01018"></a>01018     <span class="comment">// conservative estimate of when we have to schedule the next</span>
<a name="l01019"></a>01019     <span class="comment">// request to not introduce any unecessary bubbles. In most cases</span>
<a name="l01020"></a>01020     <span class="comment">// we will wake up sooner than we have to.</span>
<a name="l01021"></a>01021     <a class="code" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a> = <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> - (<a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a> + <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a> + <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>);
<a name="l01022"></a>01022 
<a name="l01023"></a>01023     <span class="comment">// Update the stats and schedule the next request</span>
<a name="l01024"></a>01024     <span class="keywordflow">if</span> (dram_pkt-&gt;isRead) {
<a name="l01025"></a>01025         ++<a class="code" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a>;
<a name="l01026"></a>01026         <span class="keywordflow">if</span> (row_hit)
<a name="l01027"></a>01027             <a class="code" href="classDRAMCtrl.html#a7f3862d0c1944536c2ec30b0d012e288">readRowHits</a>++;
<a name="l01028"></a>01028         <a class="code" href="classDRAMCtrl.html#a4409b60f101f8ea21148966043864074">bytesReadDRAM</a> += <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>;
<a name="l01029"></a>01029         <a class="code" href="classDRAMCtrl.html#a1a6c6b88a19805ae5453e5811633f884">perBankRdBursts</a>[dram_pkt-&gt;bankId]++;
<a name="l01030"></a>01030 
<a name="l01031"></a>01031         <span class="comment">// Update latency stats</span>
<a name="l01032"></a>01032         <a class="code" href="classDRAMCtrl.html#a9aa73ba3e536064d1686b6489e57a4bf">totMemAccLat</a> += dram_pkt-&gt;readyTime - dram_pkt-&gt;entryTime;
<a name="l01033"></a>01033         <a class="code" href="classDRAMCtrl.html#abbb23dd61d5f4a897a59ea51328ad3fd">totBusLat</a> += tBURST;
<a name="l01034"></a>01034         <a class="code" href="classDRAMCtrl.html#a3eea84ec922ff55ae38676da7222cd01">totQLat</a> += cmd_at - dram_pkt-&gt;entryTime;
<a name="l01035"></a>01035     } <span class="keywordflow">else</span> {
<a name="l01036"></a>01036         ++<a class="code" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a>;
<a name="l01037"></a>01037         <span class="keywordflow">if</span> (row_hit)
<a name="l01038"></a>01038             <a class="code" href="classDRAMCtrl.html#a5b75e7220ef0da8a50fe5777a9a1ae52">writeRowHits</a>++;
<a name="l01039"></a>01039         <a class="code" href="classDRAMCtrl.html#a98c4533d0a7053d00f6882f984ebdaef">bytesWritten</a> += <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>;
<a name="l01040"></a>01040         <a class="code" href="classDRAMCtrl.html#ae757d149b2ff05a908b6ceb28f53decc">perBankWrBursts</a>[dram_pkt-&gt;bankId]++;
<a name="l01041"></a>01041     }
<a name="l01042"></a>01042 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa8a18d230dba7a674ac8a0b4f35bc36a"></a><!-- doxytag: member="DRAMCtrl::drain" ref="aa8a18d230dba7a674ac8a0b4f35bc36a" args="(DrainManager *dm)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int drain </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDrainManager.html">DrainManager</a> *&nbsp;</td>
          <td class="paramname"> <em>drainManger</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Provide a default implementation of the drain interface that simply returns 0 (draining completed) and sets the drain state to Drained. </p>

<p><a class="el" href="classSimObject.html#a6bf479c521c7c3eb473822d953275b26">SimObject</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l01730"></a>01730 {
<a name="l01731"></a>01731     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#a668f84c330035fdb72824eb18e09cd09">count</a> = <a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>.<a class="code" href="classQueuedSlavePort.html#aa8a18d230dba7a674ac8a0b4f35bc36a">drain</a>(<a class="code" href="namespaceMipsISA.html#a2575c29e7f4617b6076486f340b6fe19">dm</a>);
<a name="l01732"></a>01732 
<a name="l01733"></a>01733     <span class="comment">// if there is anything in any of our internal queues, keep track</span>
<a name="l01734"></a>01734     <span class="comment">// of that as well</span>
<a name="l01735"></a>01735     <span class="keywordflow">if</span> (!(<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.empty() &amp;&amp; <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.empty() &amp;&amp;
<a name="l01736"></a>01736           <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.empty())) {
<a name="l01737"></a>01737         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Drain, <span class="stringliteral">&quot;DRAM controller not drained, write: %d, read: %d,&quot;</span>
<a name="l01738"></a>01738                 <span class="stringliteral">&quot; resp: %d\n&quot;</span>, <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size(), <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.size(),
<a name="l01739"></a>01739                 <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.size());
<a name="l01740"></a>01740         ++count;
<a name="l01741"></a>01741         <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a> = <a class="code" href="namespaceMipsISA.html#a2575c29e7f4617b6076486f340b6fe19">dm</a>;
<a name="l01742"></a>01742 
<a name="l01743"></a>01743         <span class="comment">// the only part that is not drained automatically over time</span>
<a name="l01744"></a>01744         <span class="comment">// is the write queue, thus kick things into action if needed</span>
<a name="l01745"></a>01745         <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.empty() &amp;&amp; !<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l01746"></a>01746             <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01747"></a>01747         }
<a name="l01748"></a>01748     }
<a name="l01749"></a>01749 
<a name="l01750"></a>01750     <span class="keywordflow">if</span> (count)
<a name="l01751"></a>01751         <a class="code" href="classDrainable.html#ad800905390fe03e850cf996e914038f9">setDrainState</a>(<a class="code" href="classDrainable.html#a5d74787dedbc4e11c1ab15bf487e61f8a929d17847bfad0d4689c9ab8540d5134">Drainable::Draining</a>);
<a name="l01752"></a>01752     <span class="keywordflow">else</span>
<a name="l01753"></a>01753         <a class="code" href="classDrainable.html#ad800905390fe03e850cf996e914038f9">setDrainState</a>(<a class="code" href="classDrainable.html#a5d74787dedbc4e11c1ab15bf487e61f8a5656955cb808502a2ec75b367e2c1e82">Drainable::Drained</a>);
<a name="l01754"></a>01754     <span class="keywordflow">return</span> count;
<a name="l01755"></a>01755 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4edba7d5e567b66fcd93297802a97077"></a><!-- doxytag: member="DRAMCtrl::getSlavePort" ref="a4edba7d5e567b66fcd93297802a97077" args="(const std::string &amp;if_name, PortID idx=InvalidPortID)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="classBaseSlavePort.html">BaseSlavePort</a>&amp; getSlavePort </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>if_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#acef4d7d41cb21fdc252e20c04cd7bb8e">PortID</a>&nbsp;</td>
          <td class="paramname"> <em>idx</em> = <code><a class="el" href="base_2types_8hh.html#a65bf40f138cf863f0c5e2d8ca1144126">InvalidPortID</a></code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get a slave port with a given name and index. This is used at binding time and returns a reference to a protocol-agnostic base master port.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>if_name</em>&nbsp;</td><td><a class="el" href="classPort.html">Port</a> name </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>idx</em>&nbsp;</td><td>Index in the case of a VectorPort</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>A reference to the given port </dd></dl>

<p><a class="el" href="classMemObject.html#ac918a145092d7514ebc6dbd952dceafb">MemObject</a>を再定義しています。</p>

</div>
</div>
<a class="anchor" id="a02fd73d861ef2e4aabb38c0c9ff82947"></a><!-- doxytag: member="DRAMCtrl::init" ref="a02fd73d861ef2e4aabb38c0c9ff82947" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classDRAMCtrl.html#a02fd73d861ef2e4aabb38c0c9ff82947">init()</a> is called after all C++ SimObjects have been created and all ports are connected. Initializations that are independent of unserialization but rely on a fully instantiated and connected <a class="el" href="classSimObject.html">SimObject</a> graph should be done here. </p>

<p><a class="el" href="classSimObject.html#a02fd73d861ef2e4aabb38c0c9ff82947">SimObject</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00147"></a>00147 {
<a name="l00148"></a>00148     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>.<a class="code" href="classBaseSlavePort.html#a180fa55a4bf36580963bed9e3e09c227">isConnected</a>()) {
<a name="l00149"></a>00149         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;DRAMCtrl %s is unconnected!\n&quot;</span>, <a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>());
<a name="l00150"></a>00150     } <span class="keywordflow">else</span> {
<a name="l00151"></a>00151         <a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>.<a class="code" href="classSlavePort.html#afb438cc39c4c679860c791bcef6dc7f3">sendRangeChange</a>();
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a29301d0e29279a6e233f15c13959b0de"></a><!-- doxytag: member="DRAMCtrl::minBankActAt" ref="a29301d0e29279a6e233f15c13959b0de" args="(const std::deque&lt; DRAMPacket * &gt; &amp;queue) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t minBankActAt </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>queue</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Find which are the earliest banks ready to issue an activate for the enqueued requests. Assumes maximum of 64 banks per DIMM</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Queued</em>&nbsp;</td><td>requests to consider </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>One-hot encoded mask of bank indices </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l01212"></a>01212 {
<a name="l01213"></a>01213     uint64_t bank_mask = 0;
<a name="l01214"></a>01214     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> min_act_at = <a class="code" href="base_2types_8hh.html#abe940b1b328825e234da719447e15ca5">MaxTick</a>;
<a name="l01215"></a>01215 
<a name="l01216"></a>01216     <span class="comment">// deterimne if we have queued transactions targetting a</span>
<a name="l01217"></a>01217     <span class="comment">// bank in question</span>
<a name="l01218"></a>01218     <a class="code" href="classstd_1_1vector.html">vector&lt;bool&gt;</a> got_waiting(<a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a> * <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>, <span class="keyword">false</span>);
<a name="l01219"></a>01219     <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a> = queue.begin(); <a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a> != queue.end(); ++<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>) {
<a name="l01220"></a>01220         got_waiting[(*p)-&gt;bankId] = <span class="keyword">true</span>;
<a name="l01221"></a>01221     }
<a name="l01222"></a>01222 
<a name="l01223"></a>01223     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l01224"></a>01224         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>++) {
<a name="l01225"></a>01225             uint8_t bank_id = <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> * banksPerRank + <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>;
<a name="l01226"></a>01226 
<a name="l01227"></a>01227             <span class="comment">// if we have waiting requests for the bank, and it is</span>
<a name="l01228"></a>01228             <span class="comment">// amongst the first available, update the mask</span>
<a name="l01229"></a>01229             <span class="keywordflow">if</span> (got_waiting[bank_id]) {
<a name="l01230"></a>01230                 <span class="comment">// simplistic approximation of when the bank can issue</span>
<a name="l01231"></a>01231                 <span class="comment">// an activate, ignoring any rank-to-rank switching</span>
<a name="l01232"></a>01232                 <span class="comment">// cost</span>
<a name="l01233"></a>01233                 <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> act_at = <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][j].openRow == <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a> ?
<a name="l01234"></a>01234                     <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][j].actAllowedAt :
<a name="l01235"></a>01235                     std::max(<a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][j].preAllowedAt, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>()) + <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>;
<a name="l01236"></a>01236 
<a name="l01237"></a>01237                 <span class="keywordflow">if</span> (act_at &lt;= min_act_at) {
<a name="l01238"></a>01238                     <span class="comment">// reset bank mask if new minimum is found</span>
<a name="l01239"></a>01239                     <span class="keywordflow">if</span> (act_at &lt; min_act_at)
<a name="l01240"></a>01240                         bank_mask = 0;
<a name="l01241"></a>01241                     <span class="comment">// set the bit corresponding to the available bank</span>
<a name="l01242"></a>01242                     <a class="code" href="bitfield_8hh.html#a00870999cf02f3961e51279ceb09d1bc">replaceBits</a>(bank_mask, bank_id, bank_id, 1);
<a name="l01243"></a>01243                     min_act_at = act_at;
<a name="l01244"></a>01244                 }
<a name="l01245"></a>01245             }
<a name="l01246"></a>01246         }
<a name="l01247"></a>01247     }
<a name="l01248"></a>01248 
<a name="l01249"></a>01249     <span class="keywordflow">return</span> bank_mask;
<a name="l01250"></a>01250 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae75715461eec20eff07a532c11c3d54c"></a><!-- doxytag: member="DRAMCtrl::prechargeBank" ref="ae75715461eec20eff07a532c11c3d54c" args="(Bank &amp;bank, Tick pre_at)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void prechargeBank </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>bank</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>pre_at</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Precharge a given bank and also update when the precharge is done. This will also deal with any stats related to the accesses to the open page.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bank</em>&nbsp;</td><td>The bank to precharge </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pre_at</em>&nbsp;</td><td><a class="el" href="classTime.html">Time</a> when the precharge takes place </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00843"></a>00843 {
<a name="l00844"></a>00844     <span class="comment">// make sure the bank has an open row</span>
<a name="l00845"></a>00845     assert(bank.openRow != <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a>);
<a name="l00846"></a>00846 
<a name="l00847"></a>00847     <span class="comment">// sample the bytes per activate here since we are closing</span>
<a name="l00848"></a>00848     <span class="comment">// the page</span>
<a name="l00849"></a>00849     <a class="code" href="classDRAMCtrl.html#a097e6ef9437eaed0d05c3d0881455b1a">bytesPerActivate</a>.<a class="code" href="classStats_1_1DistBase.html#afed4e1e09f566c5aa9e972d8c17b5a27">sample</a>(bank.bytesAccessed);
<a name="l00850"></a>00850 
<a name="l00851"></a>00851     bank.openRow = <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a>;
<a name="l00852"></a>00852 
<a name="l00853"></a>00853     <span class="comment">// no precharge allowed before this one</span>
<a name="l00854"></a>00854     bank.preAllowedAt = pre_at;
<a name="l00855"></a>00855 
<a name="l00856"></a>00856     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> pre_done_at = pre_at + <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>;
<a name="l00857"></a>00857 
<a name="l00858"></a>00858     bank.actAllowedAt = std::max(bank.actAllowedAt, pre_done_at);
<a name="l00859"></a>00859 
<a name="l00860"></a>00860     assert(<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a> != 0);
<a name="l00861"></a>00861     --<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a>;
<a name="l00862"></a>00862 
<a name="l00863"></a>00863     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Precharging bank at tick %lld, now got %d active\n&quot;</span>,
<a name="l00864"></a>00864             pre_at, <a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a>);
<a name="l00865"></a>00865 
<a name="l00866"></a>00866     <span class="comment">// if we look at the current number of active banks we might be</span>
<a name="l00867"></a>00867     <span class="comment">// tempted to think the DRAM is now idle, however this can be</span>
<a name="l00868"></a>00868     <span class="comment">// undone by an activate that is scheduled to happen before we</span>
<a name="l00869"></a>00869     <span class="comment">// would have reached the idle state, so schedule an event and</span>
<a name="l00870"></a>00870     <span class="comment">// rather check once we actually make it to the point in time when</span>
<a name="l00871"></a>00871     <span class="comment">// the (last) precharge takes place</span>
<a name="l00872"></a>00872     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>())
<a name="l00873"></a>00873         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a>, pre_done_at);
<a name="l00874"></a>00874     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>() &lt; pre_done_at)
<a name="l00875"></a>00875         <a class="code" href="classEventManager.html#a83fe8e2d06cd7c6e36743e5beb07298f">reschedule</a>(<a class="code" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a>, pre_done_at);
<a name="l00876"></a>00876 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c5f01de2fe3a6826581f3641cac2ba7"></a><!-- doxytag: member="DRAMCtrl::printQs" ref="a3c5f01de2fe3a6826581f3641cac2ba7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void printQs </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Used for debugging to observe the contents of the queues. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00513"></a>00513                         {
<a name="l00514"></a>00514     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;===READ QUEUE===\n\n&quot;</span>);
<a name="l00515"></a>00515     <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.begin() ;  <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> != <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.end() ; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00516"></a>00516         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Read %lu\n&quot;</span>, (*i)-&gt;addr);
<a name="l00517"></a>00517     }
<a name="l00518"></a>00518     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;\n===RESP QUEUE===\n\n&quot;</span>);
<a name="l00519"></a>00519     <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.begin() ;  <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> != <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.end() ; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00520"></a>00520         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Response %lu\n&quot;</span>, (*i)-&gt;addr);
<a name="l00521"></a>00521     }
<a name="l00522"></a>00522     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;\n===WRITE QUEUE===\n\n&quot;</span>);
<a name="l00523"></a>00523     <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.begin() ;  <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> != <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.end() ; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00524"></a>00524         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Write %lu\n&quot;</span>, (*i)-&gt;addr);
<a name="l00525"></a>00525     }
<a name="l00526"></a>00526 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac54213c91d7d83dfe481534b1f165391"></a><!-- doxytag: member="DRAMCtrl::processActivateEvent" ref="ac54213c91d7d83dfe481534b1f165391" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processActivateEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00833"></a>00833 {
<a name="l00834"></a>00834     <span class="comment">// we should transition to the active state as soon as any bank is active</span>
<a name="l00835"></a>00835     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> != <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870">PWR_ACT</a>)
<a name="l00836"></a>00836         <span class="comment">// note that at this point numBanksActive could be back at</span>
<a name="l00837"></a>00837         <span class="comment">// zero again due to a precharge scheduled in the future</span>
<a name="l00838"></a>00838         <a class="code" href="classDRAMCtrl.html#a233880f1f4b8f6455a2ff083dda871d3">schedulePowerEvent</a>(<a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870">PWR_ACT</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00839"></a>00839 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0798c7e6d736756005d72ec03a38badd"></a><!-- doxytag: member="DRAMCtrl::processNextReqEvent" ref="a0798c7e6d736756005d72ec03a38badd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processNextReqEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Bunch of things requires to setup "events" in gem5 When event "respondEvent" occurs for example, the method processRespondEvent is called; no parameters are allowed in these methods </p>

<p><div class="fragment"><pre class="fragment"><a name="l01046"></a>01046 {
<a name="l01047"></a>01047     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> == <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a12f0259011cf4a6cf10274abcf71daaa">READ_TO_WRITE</a>) {
<a name="l01048"></a>01048         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Switching to writes after %d reads with %d reads &quot;</span>
<a name="l01049"></a>01049                 <span class="stringliteral">&quot;waiting\n&quot;</span>, <a class="code" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a>, <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.size());
<a name="l01050"></a>01050 
<a name="l01051"></a>01051         <span class="comment">// sample and reset the read-related stats as we are now</span>
<a name="l01052"></a>01052         <span class="comment">// transitioning to writes, and all reads are done</span>
<a name="l01053"></a>01053         <a class="code" href="classDRAMCtrl.html#aff56c8c0df213e51ad714cb2b0df2de3">rdPerTurnAround</a>.<a class="code" href="classStats_1_1DistBase.html#afed4e1e09f566c5aa9e972d8c17b5a27">sample</a>(<a class="code" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a>);
<a name="l01054"></a>01054         <a class="code" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a> = 0;
<a name="l01055"></a>01055 
<a name="l01056"></a>01056         <span class="comment">// now proceed to do the actual writes</span>
<a name="l01057"></a>01057         <a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> = <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a61aa7ff70b76bff0fda378cf61d6afbc">WRITE</a>;
<a name="l01058"></a>01058     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> == <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11ad12c9fdf4a8009963c2eb263513e4aab">WRITE_TO_READ</a>) {
<a name="l01059"></a>01059         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Switching to reads after %d writes with %d writes &quot;</span>
<a name="l01060"></a>01060                 <span class="stringliteral">&quot;waiting\n&quot;</span>, <a class="code" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a>, <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size());
<a name="l01061"></a>01061 
<a name="l01062"></a>01062         <a class="code" href="classDRAMCtrl.html#a6f8f6528076f5f3f9d56b7658368a781">wrPerTurnAround</a>.<a class="code" href="classStats_1_1DistBase.html#afed4e1e09f566c5aa9e972d8c17b5a27">sample</a>(<a class="code" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a>);
<a name="l01063"></a>01063         <a class="code" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a> = 0;
<a name="l01064"></a>01064 
<a name="l01065"></a>01065         <a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> = <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6">READ</a>;
<a name="l01066"></a>01066     }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> != <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6">REF_IDLE</a>) {
<a name="l01069"></a>01069         <span class="comment">// if a refresh waiting for this event loop to finish, then hand</span>
<a name="l01070"></a>01070         <span class="comment">// over now, and do not schedule a new nextReqEvent</span>
<a name="l01071"></a>01071         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77">REF_DRAIN</a>) {
<a name="l01072"></a>01072             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Refresh drain done, now precharging\n&quot;</span>);
<a name="l01073"></a>01073 
<a name="l01074"></a>01074             <a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> = <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592">REF_PRE</a>;
<a name="l01075"></a>01075 
<a name="l01076"></a>01076             <span class="comment">// hand control back to the refresh event loop</span>
<a name="l01077"></a>01077             <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a0bc8ce4f4a849871eb32bd983b5d2843">refreshEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01078"></a>01078         }
<a name="l01079"></a>01079 
<a name="l01080"></a>01080         <span class="comment">// let the refresh finish before issuing any further requests</span>
<a name="l01081"></a>01081         <span class="keywordflow">return</span>;
<a name="l01082"></a>01082     }
<a name="l01083"></a>01083 
<a name="l01084"></a>01084     <span class="comment">// when we get here it is either a read or a write</span>
<a name="l01085"></a>01085     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> == <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11acb9be765f361bb7efb9073730aac92c6">READ</a>) {
<a name="l01086"></a>01086 
<a name="l01087"></a>01087         <span class="comment">// track if we should switch or not</span>
<a name="l01088"></a>01088         <span class="keywordtype">bool</span> switch_to_writes = <span class="keyword">false</span>;
<a name="l01089"></a>01089 
<a name="l01090"></a>01090         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.empty()) {
<a name="l01091"></a>01091             <span class="comment">// In the case there is no read request to go next,</span>
<a name="l01092"></a>01092             <span class="comment">// trigger writes if we have passed the low threshold (or</span>
<a name="l01093"></a>01093             <span class="comment">// if we are draining)</span>
<a name="l01094"></a>01094             <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.empty() &amp;&amp;
<a name="l01095"></a>01095                 (<a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a> || <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size() &gt; <a class="code" href="classDRAMCtrl.html#a803b97da34c3b40357123d5713e6ab4a">writeLowThreshold</a>)) {
<a name="l01096"></a>01096 
<a name="l01097"></a>01097                 switch_to_writes = <span class="keyword">true</span>;
<a name="l01098"></a>01098             } <span class="keywordflow">else</span> {
<a name="l01099"></a>01099                 <span class="comment">// check if we are drained</span>
<a name="l01100"></a>01100                 <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.empty () &amp;&amp; <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>) {
<a name="l01101"></a>01101                     <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>-&gt;<a class="code" href="classDrainManager.html#ab89d10e368d2e82061eddb9e40022382">signalDrainDone</a>();
<a name="l01102"></a>01102                     <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a> = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l01103"></a>01103                 }
<a name="l01104"></a>01104 
<a name="l01105"></a>01105                 <span class="comment">// nothing to do, not even any point in scheduling an</span>
<a name="l01106"></a>01106                 <span class="comment">// event for the next request</span>
<a name="l01107"></a>01107                 <span class="keywordflow">return</span>;
<a name="l01108"></a>01108             }
<a name="l01109"></a>01109         } <span class="keywordflow">else</span> {
<a name="l01110"></a>01110             <span class="comment">// Figure out which read request goes next, and move it to the</span>
<a name="l01111"></a>01111             <span class="comment">// front of the read queue</span>
<a name="l01112"></a>01112             <a class="code" href="classDRAMCtrl.html#a45c15f5a90be2e23d6bde9f706db7f24">chooseNext</a>(<a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>);
<a name="l01113"></a>01113 
<a name="l01114"></a>01114             DRAMPacket* dram_pkt = <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.front();
<a name="l01115"></a>01115 
<a name="l01116"></a>01116             <a class="code" href="classDRAMCtrl.html#a981a4462a622304ff598af5a232d7dd5">doDRAMAccess</a>(dram_pkt);
<a name="l01117"></a>01117 
<a name="l01118"></a>01118             <span class="comment">// At this point we&apos;re done dealing with the request</span>
<a name="l01119"></a>01119             <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.pop_front();
<a name="l01120"></a>01120 
<a name="l01121"></a>01121             <span class="comment">// sanity check</span>
<a name="l01122"></a>01122             assert(dram_pkt-&gt;size &lt;= <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>);
<a name="l01123"></a>01123             assert(dram_pkt-&gt;readyTime &gt;= <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01124"></a>01124 
<a name="l01125"></a>01125             <span class="comment">// Insert into response queue. It will be sent back to the</span>
<a name="l01126"></a>01126             <span class="comment">// requestor at its readyTime</span>
<a name="l01127"></a>01127             <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.empty()) {
<a name="l01128"></a>01128                 assert(!<a class="code" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l01129"></a>01129                 <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a>, dram_pkt-&gt;readyTime);
<a name="l01130"></a>01130             } <span class="keywordflow">else</span> {
<a name="l01131"></a>01131                 assert(<a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.back()-&gt;readyTime &lt;= dram_pkt-&gt;readyTime);
<a name="l01132"></a>01132                 assert(<a class="code" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l01133"></a>01133             }
<a name="l01134"></a>01134 
<a name="l01135"></a>01135             <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.push_back(dram_pkt);
<a name="l01136"></a>01136 
<a name="l01137"></a>01137             <span class="comment">// we have so many writes that we have to transition</span>
<a name="l01138"></a>01138             <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size() &gt; <a class="code" href="classDRAMCtrl.html#a61f48157d680c1ddf7dd818c9008dd53">writeHighThreshold</a>) {
<a name="l01139"></a>01139                 switch_to_writes = <span class="keyword">true</span>;
<a name="l01140"></a>01140             }
<a name="l01141"></a>01141         }
<a name="l01142"></a>01142 
<a name="l01143"></a>01143         <span class="comment">// switching to writes, either because the read queue is empty</span>
<a name="l01144"></a>01144         <span class="comment">// and the writes have passed the low threshold (or we are</span>
<a name="l01145"></a>01145         <span class="comment">// draining), or because the writes hit the hight threshold</span>
<a name="l01146"></a>01146         <span class="keywordflow">if</span> (switch_to_writes) {
<a name="l01147"></a>01147             <span class="comment">// transition to writing</span>
<a name="l01148"></a>01148             <a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> = <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11a12f0259011cf4a6cf10274abcf71daaa">READ_TO_WRITE</a>;
<a name="l01149"></a>01149 
<a name="l01150"></a>01150             <span class="comment">// add a bubble to the data bus, as defined by the</span>
<a name="l01151"></a>01151             <span class="comment">// tRTW parameter</span>
<a name="l01152"></a>01152             <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> += <a class="code" href="classDRAMCtrl.html#a578e383b38a4b65988799b3c16c4c17d">tRTW</a>;
<a name="l01153"></a>01153 
<a name="l01154"></a>01154             <span class="comment">// update the minimum timing between the requests,</span>
<a name="l01155"></a>01155             <span class="comment">// this shifts us back in time far enough to do any</span>
<a name="l01156"></a>01156             <span class="comment">// bank preparation</span>
<a name="l01157"></a>01157             <a class="code" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a> = <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> - (<a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a> + <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a> + <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>);
<a name="l01158"></a>01158         }
<a name="l01159"></a>01159     } <span class="keywordflow">else</span> {
<a name="l01160"></a>01160         <a class="code" href="classDRAMCtrl.html#a45c15f5a90be2e23d6bde9f706db7f24">chooseNext</a>(<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>);
<a name="l01161"></a>01161         DRAMPacket* dram_pkt = <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.front();
<a name="l01162"></a>01162         <span class="comment">// sanity check</span>
<a name="l01163"></a>01163         assert(dram_pkt-&gt;size &lt;= <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>);
<a name="l01164"></a>01164         <a class="code" href="classDRAMCtrl.html#a981a4462a622304ff598af5a232d7dd5">doDRAMAccess</a>(dram_pkt);
<a name="l01165"></a>01165 
<a name="l01166"></a>01166         <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.pop_front();
<a name="l01167"></a>01167         <span class="keyword">delete</span> dram_pkt;
<a name="l01168"></a>01168 
<a name="l01169"></a>01169         <span class="comment">// If we emptied the write queue, or got sufficiently below the</span>
<a name="l01170"></a>01170         <span class="comment">// threshold (using the minWritesPerSwitch as the hysteresis) and</span>
<a name="l01171"></a>01171         <span class="comment">// are not draining, or we have reads waiting and have done enough</span>
<a name="l01172"></a>01172         <span class="comment">// writes, then switch to reads.</span>
<a name="l01173"></a>01173         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.empty() ||
<a name="l01174"></a>01174             (<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size() + <a class="code" href="classDRAMCtrl.html#a2753a60747e9836fe5f5fec7b613385c">minWritesPerSwitch</a> &lt; <a class="code" href="classDRAMCtrl.html#a803b97da34c3b40357123d5713e6ab4a">writeLowThreshold</a> &amp;&amp;
<a name="l01175"></a>01175              !<a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>) ||
<a name="l01176"></a>01176             (!<a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.empty() &amp;&amp; <a class="code" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a> &gt;= <a class="code" href="classDRAMCtrl.html#a2753a60747e9836fe5f5fec7b613385c">minWritesPerSwitch</a>)) {
<a name="l01177"></a>01177             <span class="comment">// turn the bus back around for reads again</span>
<a name="l01178"></a>01178             <a class="code" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a> = <a class="code" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11ad12c9fdf4a8009963c2eb263513e4aab">WRITE_TO_READ</a>;
<a name="l01179"></a>01179 
<a name="l01180"></a>01180             <span class="comment">// note that the we switch back to reads also in the idle</span>
<a name="l01181"></a>01181             <span class="comment">// case, which eventually will check for any draining and</span>
<a name="l01182"></a>01182             <span class="comment">// also pause any further scheduling if there is really</span>
<a name="l01183"></a>01183             <span class="comment">// nothing to do</span>
<a name="l01184"></a>01184 
<a name="l01185"></a>01185             <span class="comment">// here we get a bit creative and shift the bus busy time not</span>
<a name="l01186"></a>01186             <span class="comment">// just the tWTR, but also a CAS latency to capture the fact</span>
<a name="l01187"></a>01187             <span class="comment">// that we are allowed to prepare a new bank, but not issue a</span>
<a name="l01188"></a>01188             <span class="comment">// read command until after tWTR, in essence we capture a</span>
<a name="l01189"></a>01189             <span class="comment">// bubble on the data bus that is tWTR + tCL</span>
<a name="l01190"></a>01190             <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> += <a class="code" href="classDRAMCtrl.html#a33aeea1fd32ea7035fc8ca3a32f75473">tWTR</a> + <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>;
<a name="l01191"></a>01191 
<a name="l01192"></a>01192             <span class="comment">// update the minimum timing between the requests, this shifts</span>
<a name="l01193"></a>01193             <span class="comment">// us back in time far enough to do any bank preparation</span>
<a name="l01194"></a>01194             <a class="code" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a> = <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> - (<a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a> + <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a> + tCL);
<a name="l01195"></a>01195         }
<a name="l01196"></a>01196     }
<a name="l01197"></a>01197 
<a name="l01198"></a>01198     <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>, std::max(<a class="code" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>()));
<a name="l01199"></a>01199 
<a name="l01200"></a>01200     <span class="comment">// If there is space available and we have writes waiting then let</span>
<a name="l01201"></a>01201     <span class="comment">// them retry. This is done here to ensure that the retry does not</span>
<a name="l01202"></a>01202     <span class="comment">// cause a nextReqEvent to be scheduled before we do so as part of</span>
<a name="l01203"></a>01203     <span class="comment">// the next request processing</span>
<a name="l01204"></a>01204     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#acf0d3616b5317008b8248aa2245df220">retryWrReq</a> &amp;&amp; <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size() &lt; <a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>) {
<a name="l01205"></a>01205         <a class="code" href="classDRAMCtrl.html#acf0d3616b5317008b8248aa2245df220">retryWrReq</a> = <span class="keyword">false</span>;
<a name="l01206"></a>01206         <a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>.<a class="code" href="classSlavePort.html#a6172657b944e32a722d90a20c5896bb7">sendRetry</a>();
<a name="l01207"></a>01207     }
<a name="l01208"></a>01208 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a969289183ebadcc99a8dd9f63120b4eb"></a><!-- doxytag: member="DRAMCtrl::processPowerEvent" ref="a969289183ebadcc99a8dd9f63120b4eb" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processPowerEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01393"></a>01393 {
<a name="l01394"></a>01394     <span class="comment">// remember where we were, and for how long</span>
<a name="l01395"></a>01395     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> duration = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() - <a class="code" href="classDRAMCtrl.html#a06e80ba25d388ee981f9c88e27e189df">pwrStateTick</a>;
<a name="l01396"></a>01396     <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a> prev_state = <a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a>;
<a name="l01397"></a>01397 
<a name="l01398"></a>01398     <span class="comment">// update the accounting</span>
<a name="l01399"></a>01399     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>[prev_state] += duration;
<a name="l01400"></a>01400 
<a name="l01401"></a>01401     <a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> = <a class="code" href="classDRAMCtrl.html#ab31f48c472ee16c28fc62b8be41b740e">pwrStateTrans</a>;
<a name="l01402"></a>01402     <a class="code" href="classDRAMCtrl.html#a06e80ba25d388ee981f9c88e27e189df">pwrStateTick</a> = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l01403"></a>01403 
<a name="l01404"></a>01404     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> == <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>) {
<a name="l01405"></a>01405         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAMState, <span class="stringliteral">&quot;All banks precharged\n&quot;</span>);
<a name="l01406"></a>01406 
<a name="l01407"></a>01407         <span class="comment">// if we were refreshing, make sure we start scheduling requests again</span>
<a name="l01408"></a>01408         <span class="keywordflow">if</span> (prev_state == <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>) {
<a name="l01409"></a>01409             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAMState, <span class="stringliteral">&quot;Was refreshing for %llu ticks\n&quot;</span>, duration);
<a name="l01410"></a>01410             assert(<a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> == <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>);
<a name="l01411"></a>01411 
<a name="l01412"></a>01412             <span class="comment">// kick things into action again</span>
<a name="l01413"></a>01413             <a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> = <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6">REF_IDLE</a>;
<a name="l01414"></a>01414             assert(!<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l01415"></a>01415             <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01416"></a>01416         } <span class="keywordflow">else</span> {
<a name="l01417"></a>01417             assert(prev_state == <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a7cdf09b08fcb323cdbd78014f98ab870">PWR_ACT</a>);
<a name="l01418"></a>01418 
<a name="l01419"></a>01419             <span class="comment">// if we have a pending refresh, and are now moving to</span>
<a name="l01420"></a>01420             <span class="comment">// the idle state, direclty transition to a refresh</span>
<a name="l01421"></a>01421             <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5">REF_RUN</a>) {
<a name="l01422"></a>01422                 <span class="comment">// there should be nothing waiting at this point</span>
<a name="l01423"></a>01423                 assert(!<a class="code" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l01424"></a>01424 
<a name="l01425"></a>01425                 <span class="comment">// update the state in zero time and proceed below</span>
<a name="l01426"></a>01426                 <a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> = <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>;
<a name="l01427"></a>01427             }
<a name="l01428"></a>01428         }
<a name="l01429"></a>01429     }
<a name="l01430"></a>01430 
<a name="l01431"></a>01431     <span class="comment">// we transition to the refresh state, let the refresh state</span>
<a name="l01432"></a>01432     <span class="comment">// machine know of this state update and let it deal with the</span>
<a name="l01433"></a>01433     <span class="comment">// scheduling of the next power state transition as well as the</span>
<a name="l01434"></a>01434     <span class="comment">// following refresh</span>
<a name="l01435"></a>01435     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> == <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>) {
<a name="l01436"></a>01436         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAMState, <span class="stringliteral">&quot;Refreshing\n&quot;</span>);
<a name="l01437"></a>01437         <span class="comment">// kick the refresh event loop into action again, and that</span>
<a name="l01438"></a>01438         <span class="comment">// in turn will schedule a transition to the idle power</span>
<a name="l01439"></a>01439         <span class="comment">// state once the refresh is done</span>
<a name="l01440"></a>01440         assert(<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5">REF_RUN</a>);
<a name="l01441"></a>01441         <a class="code" href="classDRAMCtrl.html#a56cadd2563b7704b3af145a6a9f5e6ea">processRefreshEvent</a>();
<a name="l01442"></a>01442     }
<a name="l01443"></a>01443 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aac7163c120622a5f0bcc2291bc3054cd"></a><!-- doxytag: member="DRAMCtrl::processPrechargeEvent" ref="aac7163c120622a5f0bcc2291bc3054cd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processPrechargeEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00880"></a>00880 {
<a name="l00881"></a>00881     <span class="comment">// if we reached zero, then special conditions apply as we track</span>
<a name="l00882"></a>00882     <span class="comment">// if all banks are precharged for the power models</span>
<a name="l00883"></a>00883     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a> == 0) {
<a name="l00884"></a>00884         <span class="comment">// we should transition to the idle state when the last bank</span>
<a name="l00885"></a>00885         <span class="comment">// is precharged</span>
<a name="l00886"></a>00886         <a class="code" href="classDRAMCtrl.html#a233880f1f4b8f6455a2ff083dda871d3">schedulePowerEvent</a>(<a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00887"></a>00887     }
<a name="l00888"></a>00888 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56cadd2563b7704b3af145a6a9f5e6ea"></a><!-- doxytag: member="DRAMCtrl::processRefreshEvent" ref="a56cadd2563b7704b3af145a6a9f5e6ea" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processRefreshEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01254"></a>01254 {
<a name="l01255"></a>01255     <span class="comment">// when first preparing the refresh, remember when it was due</span>
<a name="l01256"></a>01256     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a0408d01a98c94c06e9b5f01e52b7e4b6">REF_IDLE</a>) {
<a name="l01257"></a>01257         <span class="comment">// remember when the refresh is due</span>
<a name="l01258"></a>01258         <a class="code" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a> = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l01259"></a>01259 
<a name="l01260"></a>01260         <span class="comment">// proceed to drain</span>
<a name="l01261"></a>01261         <a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> = <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77">REF_DRAIN</a>;
<a name="l01262"></a>01262 
<a name="l01263"></a>01263         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Refresh due\n&quot;</span>);
<a name="l01264"></a>01264     }
<a name="l01265"></a>01265 
<a name="l01266"></a>01266     <span class="comment">// let any scheduled read or write go ahead, after which it will</span>
<a name="l01267"></a>01267     <span class="comment">// hand control back to this event loop</span>
<a name="l01268"></a>01268     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5ad23d9d9efbe62841456648a9292a4e77">REF_DRAIN</a>) {
<a name="l01269"></a>01269         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l01270"></a>01270             <span class="comment">// hand control over to the request loop until it is</span>
<a name="l01271"></a>01271             <span class="comment">// evaluated next</span>
<a name="l01272"></a>01272             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Refresh awaiting draining\n&quot;</span>);
<a name="l01273"></a>01273 
<a name="l01274"></a>01274             <span class="keywordflow">return</span>;
<a name="l01275"></a>01275         } <span class="keywordflow">else</span> {
<a name="l01276"></a>01276             <a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> = <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592">REF_PRE</a>;
<a name="l01277"></a>01277         }
<a name="l01278"></a>01278     }
<a name="l01279"></a>01279 
<a name="l01280"></a>01280     <span class="comment">// at this point, ensure that all banks are precharged</span>
<a name="l01281"></a>01281     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a24272ed749c86212cfa9092585b05592">REF_PRE</a>) {
<a name="l01282"></a>01282         <span class="comment">// precharge any active bank if we are not already in the idle</span>
<a name="l01283"></a>01283         <span class="comment">// state</span>
<a name="l01284"></a>01284         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> != <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>) {
<a name="l01285"></a>01285             <span class="comment">// at the moment, we use a precharge all even if there is</span>
<a name="l01286"></a>01286             <span class="comment">// only a single bank open</span>
<a name="l01287"></a>01287             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Precharging all\n&quot;</span>);
<a name="l01288"></a>01288 
<a name="l01289"></a>01289             <span class="comment">// first determine when we can precharge</span>
<a name="l01290"></a>01290             <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> pre_at = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l01291"></a>01291             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l01292"></a>01292                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>++) {
<a name="l01293"></a>01293                     <span class="comment">// respect both causality and any existing bank</span>
<a name="l01294"></a>01294                     <span class="comment">// constraints, some banks could already have a</span>
<a name="l01295"></a>01295                     <span class="comment">// (auto) precharge scheduled</span>
<a name="l01296"></a>01296                     pre_at = std::max(<a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].preAllowedAt, pre_at);
<a name="l01297"></a>01297                 }
<a name="l01298"></a>01298             }
<a name="l01299"></a>01299 
<a name="l01300"></a>01300             <span class="comment">// make sure all banks are precharged, and for those that</span>
<a name="l01301"></a>01301             <span class="comment">// already are, update their availability</span>
<a name="l01302"></a>01302             <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> act_allowed_at = pre_at + <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>;
<a name="l01303"></a>01303 
<a name="l01304"></a>01304             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; ranksPerChannel; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l01305"></a>01305                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>++) {
<a name="l01306"></a>01306                     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].openRow != <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a>) {
<a name="l01307"></a>01307                         <a class="code" href="classDRAMCtrl.html#ae75715461eec20eff07a532c11c3d54c">prechargeBank</a>(<a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>], pre_at);
<a name="l01308"></a>01308                     } <span class="keywordflow">else</span> {
<a name="l01309"></a>01309                         <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].actAllowedAt =
<a name="l01310"></a>01310                             std::max(<a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].actAllowedAt, act_allowed_at);
<a name="l01311"></a>01311                         <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].preAllowedAt =
<a name="l01312"></a>01312                             std::max(<a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].preAllowedAt, pre_at);
<a name="l01313"></a>01313                     }
<a name="l01314"></a>01314                 }
<a name="l01315"></a>01315             }
<a name="l01316"></a>01316         } <span class="keywordflow">else</span> {
<a name="l01317"></a>01317             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;All banks already precharged, starting refresh\n&quot;</span>);
<a name="l01318"></a>01318 
<a name="l01319"></a>01319             <span class="comment">// go ahead and kick the power state machine into gear if</span>
<a name="l01320"></a>01320             <span class="comment">// we are already idle</span>
<a name="l01321"></a>01321             <a class="code" href="classDRAMCtrl.html#a233880f1f4b8f6455a2ff083dda871d3">schedulePowerEvent</a>(<a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01322"></a>01322         }
<a name="l01323"></a>01323 
<a name="l01324"></a>01324         <a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> = <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5">REF_RUN</a>;
<a name="l01325"></a>01325         assert(<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a> == 0);
<a name="l01326"></a>01326 
<a name="l01327"></a>01327         <span class="comment">// wait for all banks to be precharged, at which point the</span>
<a name="l01328"></a>01328         <span class="comment">// power state machine will transition to the idle state, and</span>
<a name="l01329"></a>01329         <span class="comment">// automatically move to a refresh, at that point it will also</span>
<a name="l01330"></a>01330         <span class="comment">// call this method to get the refresh event loop going again</span>
<a name="l01331"></a>01331         <span class="keywordflow">return</span>;
<a name="l01332"></a>01332     }
<a name="l01333"></a>01333 
<a name="l01334"></a>01334     <span class="comment">// last but not least we perform the actual refresh</span>
<a name="l01335"></a>01335     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a> == <a class="code" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5a590de673c457621a7d12606a2b2360f5">REF_RUN</a>) {
<a name="l01336"></a>01336         <span class="comment">// should never get here with any banks active</span>
<a name="l01337"></a>01337         assert(<a class="code" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a> == 0);
<a name="l01338"></a>01338         assert(<a class="code" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a> == <a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80a96cbccc90bf08cf55fb9ce1fde8fb984">PWR_REF</a>);
<a name="l01339"></a>01339 
<a name="l01340"></a>01340         <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> ref_done_at = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + <a class="code" href="classDRAMCtrl.html#ada7c680f071957137175c60c125b929a">tRFC</a>;
<a name="l01341"></a>01341 
<a name="l01342"></a>01342         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; ranksPerChannel; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l01343"></a>01343             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> = 0; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a> &lt; <a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a>; <a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>++) {
<a name="l01344"></a>01344                 <a class="code" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>][<a class="code" href="namespaceArmISA.html#adda8322536e2853111a71e4e2f911762">j</a>].actAllowedAt = ref_done_at;
<a name="l01345"></a>01345             }
<a name="l01346"></a>01346         }
<a name="l01347"></a>01347 
<a name="l01348"></a>01348         <span class="comment">// make sure we did not wait so long that we cannot make up</span>
<a name="l01349"></a>01349         <span class="comment">// for it</span>
<a name="l01350"></a>01350         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a> + <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a> &lt; ref_done_at) {
<a name="l01351"></a>01351             <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Refresh was delayed so long we cannot catch up\n&quot;</span>);
<a name="l01352"></a>01352         }
<a name="l01353"></a>01353 
<a name="l01354"></a>01354         <span class="comment">// compensate for the delay in actually performing the refresh</span>
<a name="l01355"></a>01355         <span class="comment">// when scheduling the next one</span>
<a name="l01356"></a>01356         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a0bc8ce4f4a849871eb32bd983b5d2843">refreshEvent</a>, <a class="code" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a> + <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a> - tRP);
<a name="l01357"></a>01357 
<a name="l01358"></a>01358         assert(!<a class="code" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l01359"></a>01359 
<a name="l01360"></a>01360         <span class="comment">// move to the idle power state once the refresh is done, this</span>
<a name="l01361"></a>01361         <span class="comment">// will also move the refresh state machine to the refresh</span>
<a name="l01362"></a>01362         <span class="comment">// idle state</span>
<a name="l01363"></a>01363         <a class="code" href="classDRAMCtrl.html#a233880f1f4b8f6455a2ff083dda871d3">schedulePowerEvent</a>(<a class="code" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80ada4f1ff35db67e1783712214c08010f2">PWR_IDLE</a>, ref_done_at);
<a name="l01364"></a>01364 
<a name="l01365"></a>01365         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAMState, <span class="stringliteral">&quot;Refresh done at %llu and next refresh at %llu\n&quot;</span>,
<a name="l01366"></a>01366                 ref_done_at, <a class="code" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a> + <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a>);
<a name="l01367"></a>01367     }
<a name="l01368"></a>01368 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab4cdaf6d543d6785652264ff7ebbecac"></a><!-- doxytag: member="DRAMCtrl::processRespondEvent" ref="ab4cdaf6d543d6785652264ff7ebbecac" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processRespondEvent </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00601"></a>00601 {
<a name="l00602"></a>00602     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM,
<a name="l00603"></a>00603             <span class="stringliteral">&quot;processRespondEvent(): Some req has reached its readyTime\n&quot;</span>);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605     DRAMPacket* dram_pkt = <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.front();
<a name="l00606"></a>00606 
<a name="l00607"></a>00607     <span class="keywordflow">if</span> (dram_pkt-&gt;burstHelper) {
<a name="l00608"></a>00608         <span class="comment">// it is a split packet</span>
<a name="l00609"></a>00609         dram_pkt-&gt;burstHelper-&gt;burstsServiced++;
<a name="l00610"></a>00610         <span class="keywordflow">if</span> (dram_pkt-&gt;burstHelper-&gt;burstsServiced ==
<a name="l00611"></a>00611             dram_pkt-&gt;burstHelper-&gt;burstCount) {
<a name="l00612"></a>00612             <span class="comment">// we have now serviced all children packets of a system packet</span>
<a name="l00613"></a>00613             <span class="comment">// so we can now respond to the requester</span>
<a name="l00614"></a>00614             <span class="comment">// @todo we probably want to have a different front end and back</span>
<a name="l00615"></a>00615             <span class="comment">// end latency for split packets</span>
<a name="l00616"></a>00616             <a class="code" href="classDRAMCtrl.html#aa10846589da1206d0047f6b82c2814e4">accessAndRespond</a>(dram_pkt-&gt;pkt, <a class="code" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a> + <a class="code" href="classDRAMCtrl.html#af7b0d4000762b26f57e6bdbbdf45cf6d">backendLatency</a>);
<a name="l00617"></a>00617             <span class="keyword">delete</span> dram_pkt-&gt;burstHelper;
<a name="l00618"></a>00618             dram_pkt-&gt;burstHelper = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620     } <span class="keywordflow">else</span> {
<a name="l00621"></a>00621         <span class="comment">// it is not a split packet</span>
<a name="l00622"></a>00622         <a class="code" href="classDRAMCtrl.html#aa10846589da1206d0047f6b82c2814e4">accessAndRespond</a>(dram_pkt-&gt;pkt, <a class="code" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a> + <a class="code" href="classDRAMCtrl.html#af7b0d4000762b26f57e6bdbbdf45cf6d">backendLatency</a>);
<a name="l00623"></a>00623     }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625     <span class="keyword">delete</span> <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.front();
<a name="l00626"></a>00626     <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.pop_front();
<a name="l00627"></a>00627 
<a name="l00628"></a>00628     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.empty()) {
<a name="l00629"></a>00629         assert(<a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.front()-&gt;readyTime &gt;= <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l00630"></a>00630         assert(!<a class="code" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>());
<a name="l00631"></a>00631         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a>, <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.front()-&gt;readyTime);
<a name="l00632"></a>00632     } <span class="keywordflow">else</span> {
<a name="l00633"></a>00633         <span class="comment">// if there is nothing left in any queue, signal a drain</span>
<a name="l00634"></a>00634         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.empty() &amp;&amp; <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.empty() &amp;&amp;
<a name="l00635"></a>00635             <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>) {
<a name="l00636"></a>00636             <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a>-&gt;<a class="code" href="classDrainManager.html#ab89d10e368d2e82061eddb9e40022382">signalDrainDone</a>();
<a name="l00637"></a>00637             <a class="code" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a> = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00638"></a>00638         }
<a name="l00639"></a>00639     }
<a name="l00640"></a>00640 
<a name="l00641"></a>00641     <span class="comment">// We have made a location in the queue available at this point,</span>
<a name="l00642"></a>00642     <span class="comment">// so if there is a read that was forced to wait, retry now</span>
<a name="l00643"></a>00643     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#aa4e05579e39e0e1ae7859ddba8538932">retryRdReq</a>) {
<a name="l00644"></a>00644         <a class="code" href="classDRAMCtrl.html#aa4e05579e39e0e1ae7859ddba8538932">retryRdReq</a> = <span class="keyword">false</span>;
<a name="l00645"></a>00645         <a class="code" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a>.<a class="code" href="classSlavePort.html#a6172657b944e32a722d90a20c5896bb7">sendRetry</a>();
<a name="l00646"></a>00646     }
<a name="l00647"></a>00647 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a865d7144c26ea7f206d937e12935f840"></a><!-- doxytag: member="DRAMCtrl::readQueueFull" ref="a865d7144c26ea7f206d937e12935f840" args="(unsigned int pktCount) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool readQueueFull </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pktCount</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classCheck.html">Check</a> if the read queue has room for more entries</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pktCount</em>&nbsp;</td><td>The number of entries needed in the read queue </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>true if read queue is full, false otherwise </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00192"></a>00192 {
<a name="l00193"></a>00193     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Read queue limit %d, current size %d, entries needed %d\n&quot;</span>,
<a name="l00194"></a>00194             <a class="code" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a>, <a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.size() + <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.size(),
<a name="l00195"></a>00195             neededEntries);
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="keywordflow">return</span>
<a name="l00198"></a>00198         (<a class="code" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a>.size() + <a class="code" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a>.size() + neededEntries) &gt; <a class="code" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a>;
<a name="l00199"></a>00199 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5f0b4c4a94f6b0053f9d7a4eb9c2518a"></a><!-- doxytag: member="DRAMCtrl::recvAtomic" ref="a5f0b4c4a94f6b0053f9d7a4eb9c2518a" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> recvAtomic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00175"></a>00175 {
<a name="l00176"></a>00176     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;recvAtomic: %s 0x%x\n&quot;</span>, pkt-&gt;<a class="code" href="classPacket.html#a863af57e28a01258236ea303155fc7ff">cmdString</a>(), pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>());
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     <span class="comment">// do the actual memory access and turn the packet into a response</span>
<a name="l00179"></a>00179     <a class="code" href="classAbstractMemory.html#aac5d96736802cb79fb2287135bcc1dff">access</a>(pkt);
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> latency = 0;
<a name="l00182"></a>00182     <span class="keywordflow">if</span> (!pkt-&gt;<a class="code" href="classPacket.html#a9693a1ffeda326646443ab2a2a92be41">memInhibitAsserted</a>() &amp;&amp; pkt-&gt;<a class="code" href="classPacket.html#a0effbd4cf91891700ac41e86defe4aa6">hasData</a>()) {
<a name="l00183"></a>00183         <span class="comment">// this value is not supposed to be accurate, just enough to</span>
<a name="l00184"></a>00184         <span class="comment">// keep things going, mimic a closed page</span>
<a name="l00185"></a>00185         latency = <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a> + <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a> + <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>;
<a name="l00186"></a>00186     }
<a name="l00187"></a>00187     <span class="keywordflow">return</span> latency;
<a name="l00188"></a>00188 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aeefa907fb6d6a787e6dab90e8138ea90"></a><!-- doxytag: member="DRAMCtrl::recvFunctional" ref="aeefa907fb6d6a787e6dab90e8138ea90" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recvFunctional </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01713"></a>01713 {
<a name="l01714"></a>01714     <span class="comment">// rely on the abstract memory</span>
<a name="l01715"></a>01715     <a class="code" href="classAbstractMemory.html#ace845b5316308e12fd958fa5df09a8e8">functionalAccess</a>(pkt);
<a name="l01716"></a>01716 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3344d9dd0f83257feab5424e761f31c6"></a><!-- doxytag: member="DRAMCtrl::recvTimingReq" ref="a3344d9dd0f83257feab5424e761f31c6" args="(PacketPtr pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool recvTimingReq </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000082">TODO:</a></b></dt><dd>temporary hack to deal with memory corruption issues until 4-phase transactions are complete </dd></dl>
</p>

<p><div class="fragment"><pre class="fragment"><a name="l00530"></a>00530 {
<a name="l00533"></a>00533     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a>.size(); <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++)
<a name="l00534"></a>00534         <span class="keyword">delete</span> <a class="code" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>];
<a name="l00535"></a>00535     <a class="code" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a>.clear();
<a name="l00536"></a>00536 
<a name="l00537"></a>00537     <span class="comment">// This is where we enter from the outside world</span>
<a name="l00538"></a>00538     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;recvTimingReq: request %s addr %lld size %d\n&quot;</span>,
<a name="l00539"></a>00539             pkt-&gt;<a class="code" href="classPacket.html#a863af57e28a01258236ea303155fc7ff">cmdString</a>(), pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>(), pkt-&gt;<a class="code" href="classPacket.html#a1d18ba49c7be427da1f4a42d53e35f48">getSize</a>());
<a name="l00540"></a>00540 
<a name="l00541"></a>00541     <span class="comment">// simply drop inhibited packets for now</span>
<a name="l00542"></a>00542     <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="classPacket.html#a9693a1ffeda326646443ab2a2a92be41">memInhibitAsserted</a>()) {
<a name="l00543"></a>00543         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Inhibited packet -- Dropping it now\n&quot;</span>);
<a name="l00544"></a>00544         <a class="code" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a>.push_back(pkt);
<a name="l00545"></a>00545         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00546"></a>00546     }
<a name="l00547"></a>00547 
<a name="l00548"></a>00548     <span class="comment">// Calc avg gap between requests</span>
<a name="l00549"></a>00549     <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#ae3e56b38f5969512cd915824ec1d5740">prevArrival</a> != 0) {
<a name="l00550"></a>00550         <a class="code" href="classDRAMCtrl.html#ad5c827068947b103cac8503aa45cf6e5">totGap</a> += <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() - <a class="code" href="classDRAMCtrl.html#ae3e56b38f5969512cd915824ec1d5740">prevArrival</a>;
<a name="l00551"></a>00551     }
<a name="l00552"></a>00552     <a class="code" href="classDRAMCtrl.html#ae3e56b38f5969512cd915824ec1d5740">prevArrival</a> = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00553"></a>00553 
<a name="l00554"></a>00554 
<a name="l00555"></a>00555     <span class="comment">// Find out how many dram packets a pkt translates to</span>
<a name="l00556"></a>00556     <span class="comment">// If the burst size is equal or larger than the pkt size, then a pkt</span>
<a name="l00557"></a>00557     <span class="comment">// translates to only one dram packet. Otherwise, a pkt translates to</span>
<a name="l00558"></a>00558     <span class="comment">// multiple dram packets</span>
<a name="l00559"></a>00559     <span class="keywordtype">unsigned</span> <a class="code" href="classAbstractMemory.html#a0b6868dbef44fc07f11d050eb59e5f7e">size</a> = pkt-&gt;<a class="code" href="classPacket.html#a1d18ba49c7be427da1f4a42d53e35f48">getSize</a>();
<a name="l00560"></a>00560     <span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#a87b7a740701cddafb930a9460e9f4eba">offset</a> = pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>() &amp; (<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a> - 1);
<a name="l00561"></a>00561     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dram_pkt_count = <a class="code" href="intmath_8hh.html#ae842b412d3570df97a944085b8f85850">divCeil</a>(offset + size, <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>);
<a name="l00562"></a>00562 
<a name="l00563"></a>00563     <span class="comment">// check local buffers and do not accept if full</span>
<a name="l00564"></a>00564     <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="classPacket.html#adc47901747fc3c447db3abddaf01491a">isRead</a>()) {
<a name="l00565"></a>00565         assert(size != 0);
<a name="l00566"></a>00566         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a865d7144c26ea7f206d937e12935f840">readQueueFull</a>(dram_pkt_count)) {
<a name="l00567"></a>00567             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Read queue full, not accepting\n&quot;</span>);
<a name="l00568"></a>00568             <span class="comment">// remember that we have to retry this port</span>
<a name="l00569"></a>00569             <a class="code" href="classDRAMCtrl.html#aa4e05579e39e0e1ae7859ddba8538932">retryRdReq</a> = <span class="keyword">true</span>;
<a name="l00570"></a>00570             <a class="code" href="classDRAMCtrl.html#acc056895269ee73447f6e9d814a22319">numRdRetry</a>++;
<a name="l00571"></a>00571             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00572"></a>00572         } <span class="keywordflow">else</span> {
<a name="l00573"></a>00573             <a class="code" href="classDRAMCtrl.html#ac224a72395d7f9bea08435f4aee435df">addToReadQueue</a>(pkt, dram_pkt_count);
<a name="l00574"></a>00574             <a class="code" href="classDRAMCtrl.html#a8baa6fa0f23d432bebbbf1f3845c9cd5">readReqs</a>++;
<a name="l00575"></a>00575             <a class="code" href="classDRAMCtrl.html#afd688f67c6a876a7b272e2ec9221fc8f">bytesReadSys</a> += size;
<a name="l00576"></a>00576         }
<a name="l00577"></a>00577     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pkt-&gt;<a class="code" href="classPacket.html#ab699d2f0d186312531fd1c279fd27b73">isWrite</a>()) {
<a name="l00578"></a>00578         assert(size != 0);
<a name="l00579"></a>00579         <span class="keywordflow">if</span> (<a class="code" href="classDRAMCtrl.html#a34f56ea41ba7accf7b75a46aa79b560c">writeQueueFull</a>(dram_pkt_count)) {
<a name="l00580"></a>00580             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Write queue full, not accepting\n&quot;</span>);
<a name="l00581"></a>00581             <span class="comment">// remember that we have to retry this port</span>
<a name="l00582"></a>00582             <a class="code" href="classDRAMCtrl.html#acf0d3616b5317008b8248aa2245df220">retryWrReq</a> = <span class="keyword">true</span>;
<a name="l00583"></a>00583             <a class="code" href="classDRAMCtrl.html#a961b9dc82d0ef2814dbdbc498a20e9b3">numWrRetry</a>++;
<a name="l00584"></a>00584             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00585"></a>00585         } <span class="keywordflow">else</span> {
<a name="l00586"></a>00586             <a class="code" href="classDRAMCtrl.html#a9538c5891b7139a62cffe6cbd7853b9a">addToWriteQueue</a>(pkt, dram_pkt_count);
<a name="l00587"></a>00587             <a class="code" href="classDRAMCtrl.html#afb65580143c89e0011c2878c20e8ed0a">writeReqs</a>++;
<a name="l00588"></a>00588             <a class="code" href="classDRAMCtrl.html#acaf3b49004885b5bc8d40fef342c14c1">bytesWrittenSys</a> += size;
<a name="l00589"></a>00589         }
<a name="l00590"></a>00590     } <span class="keywordflow">else</span> {
<a name="l00591"></a>00591         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM,<span class="stringliteral">&quot;Neither read nor write, ignore timing\n&quot;</span>);
<a name="l00592"></a>00592         <a class="code" href="classDRAMCtrl.html#a10a3647b9ff175594214578eece1e1f7">neitherReadNorWrite</a>++;
<a name="l00593"></a>00593         <a class="code" href="classDRAMCtrl.html#aa10846589da1206d0047f6b82c2814e4">accessAndRespond</a>(pkt, 1);
<a name="l00594"></a>00594     }
<a name="l00595"></a>00595 
<a name="l00596"></a>00596     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00597"></a>00597 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4dc637449366fcdfc4e764cdf12d9b11"></a><!-- doxytag: member="DRAMCtrl::regStats" ref="a4dc637449366fcdfc4e764cdf12d9b11" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void regStats </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classRegister.html">Register</a> Statistics </p>

<p><a class="el" href="classAbstractMemory.html#a4dc637449366fcdfc4e764cdf12d9b11">AbstractMemory</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l01447"></a>01447 {
<a name="l01448"></a>01448     <span class="keyword">using namespace </span>Stats;
<a name="l01449"></a>01449 
<a name="l01450"></a>01450     <a class="code" href="classSimObject.html#a4dc637449366fcdfc4e764cdf12d9b11">AbstractMemory::regStats</a>();
<a name="l01451"></a>01451 
<a name="l01452"></a>01452     <a class="code" href="classDRAMCtrl.html#a8baa6fa0f23d432bebbbf1f3845c9cd5">readReqs</a>
<a name="l01453"></a>01453         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.readReqs&quot;</span>)
<a name="l01454"></a>01454         .desc(<span class="stringliteral">&quot;Number of read requests accepted&quot;</span>);
<a name="l01455"></a>01455 
<a name="l01456"></a>01456     <a class="code" href="classDRAMCtrl.html#afb65580143c89e0011c2878c20e8ed0a">writeReqs</a>
<a name="l01457"></a>01457         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.writeReqs&quot;</span>)
<a name="l01458"></a>01458         .desc(<span class="stringliteral">&quot;Number of write requests accepted&quot;</span>);
<a name="l01459"></a>01459 
<a name="l01460"></a>01460     <a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a>
<a name="l01461"></a>01461         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.readBursts&quot;</span>)
<a name="l01462"></a>01462         .desc(<span class="stringliteral">&quot;Number of DRAM read bursts, &quot;</span>
<a name="l01463"></a>01463               <span class="stringliteral">&quot;including those serviced by the write queue&quot;</span>);
<a name="l01464"></a>01464 
<a name="l01465"></a>01465     <a class="code" href="classDRAMCtrl.html#a14baa61a63ebc1c4ce4aa1930aa9ba50">writeBursts</a>
<a name="l01466"></a>01466         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.writeBursts&quot;</span>)
<a name="l01467"></a>01467         .desc(<span class="stringliteral">&quot;Number of DRAM write bursts, &quot;</span>
<a name="l01468"></a>01468               <span class="stringliteral">&quot;including those merged in the write queue&quot;</span>);
<a name="l01469"></a>01469 
<a name="l01470"></a>01470     <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>
<a name="l01471"></a>01471         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.servicedByWrQ&quot;</span>)
<a name="l01472"></a>01472         .desc(<span class="stringliteral">&quot;Number of DRAM read bursts serviced by the write queue&quot;</span>);
<a name="l01473"></a>01473 
<a name="l01474"></a>01474     <a class="code" href="classDRAMCtrl.html#accaed2ab83bb63d6ddff7bfa861ea537">mergedWrBursts</a>
<a name="l01475"></a>01475         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.mergedWrBursts&quot;</span>)
<a name="l01476"></a>01476         .desc(<span class="stringliteral">&quot;Number of DRAM write bursts merged with an existing one&quot;</span>);
<a name="l01477"></a>01477 
<a name="l01478"></a>01478     <a class="code" href="classDRAMCtrl.html#a10a3647b9ff175594214578eece1e1f7">neitherReadNorWrite</a>
<a name="l01479"></a>01479         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.neitherReadNorWriteReqs&quot;</span>)
<a name="l01480"></a>01480         .desc(<span class="stringliteral">&quot;Number of requests that are neither read nor write&quot;</span>);
<a name="l01481"></a>01481 
<a name="l01482"></a>01482     <a class="code" href="classDRAMCtrl.html#a1a6c6b88a19805ae5453e5811633f884">perBankRdBursts</a>
<a name="l01483"></a>01483         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(<a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a> * <a class="code" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a>)
<a name="l01484"></a>01484         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.perBankRdBursts&quot;</span>)
<a name="l01485"></a>01485         .desc(<span class="stringliteral">&quot;Per bank write bursts&quot;</span>);
<a name="l01486"></a>01486 
<a name="l01487"></a>01487     <a class="code" href="classDRAMCtrl.html#ae757d149b2ff05a908b6ceb28f53decc">perBankWrBursts</a>
<a name="l01488"></a>01488         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(<a class="code" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a> * ranksPerChannel)
<a name="l01489"></a>01489         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.perBankWrBursts&quot;</span>)
<a name="l01490"></a>01490         .desc(<span class="stringliteral">&quot;Per bank write bursts&quot;</span>);
<a name="l01491"></a>01491 
<a name="l01492"></a>01492     <a class="code" href="classDRAMCtrl.html#ab0f0022a38b8ccefd6d4d17ed434fcea">avgRdQLen</a>
<a name="l01493"></a>01493         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgRdQLen&quot;</span>)
<a name="l01494"></a>01494         .desc(<span class="stringliteral">&quot;Average read queue length when enqueuing&quot;</span>)
<a name="l01495"></a>01495         .precision(2);
<a name="l01496"></a>01496 
<a name="l01497"></a>01497     <a class="code" href="classDRAMCtrl.html#a4cdec63bcb455cfe5f1d8e6db40b66f5">avgWrQLen</a>
<a name="l01498"></a>01498         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgWrQLen&quot;</span>)
<a name="l01499"></a>01499         .desc(<span class="stringliteral">&quot;Average write queue length when enqueuing&quot;</span>)
<a name="l01500"></a>01500         .precision(2);
<a name="l01501"></a>01501 
<a name="l01502"></a>01502     <a class="code" href="classDRAMCtrl.html#a3eea84ec922ff55ae38676da7222cd01">totQLat</a>
<a name="l01503"></a>01503         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.totQLat&quot;</span>)
<a name="l01504"></a>01504         .desc(<span class="stringliteral">&quot;Total ticks spent queuing&quot;</span>);
<a name="l01505"></a>01505 
<a name="l01506"></a>01506     <a class="code" href="classDRAMCtrl.html#abbb23dd61d5f4a897a59ea51328ad3fd">totBusLat</a>
<a name="l01507"></a>01507         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.totBusLat&quot;</span>)
<a name="l01508"></a>01508         .desc(<span class="stringliteral">&quot;Total ticks spent in databus transfers&quot;</span>);
<a name="l01509"></a>01509 
<a name="l01510"></a>01510     <a class="code" href="classDRAMCtrl.html#a9aa73ba3e536064d1686b6489e57a4bf">totMemAccLat</a>
<a name="l01511"></a>01511         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.totMemAccLat&quot;</span>)
<a name="l01512"></a>01512         .desc(<span class="stringliteral">&quot;Total ticks spent from burst creation until serviced &quot;</span>
<a name="l01513"></a>01513               <span class="stringliteral">&quot;by the DRAM&quot;</span>);
<a name="l01514"></a>01514 
<a name="l01515"></a>01515     <a class="code" href="classDRAMCtrl.html#ad594e3077a6ad256f07ab26b96b34c5f">avgQLat</a>
<a name="l01516"></a>01516         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgQLat&quot;</span>)
<a name="l01517"></a>01517         .desc(<span class="stringliteral">&quot;Average queueing delay per DRAM burst&quot;</span>)
<a name="l01518"></a>01518         .precision(2);
<a name="l01519"></a>01519 
<a name="l01520"></a>01520     <a class="code" href="classDRAMCtrl.html#ad594e3077a6ad256f07ab26b96b34c5f">avgQLat</a> = <a class="code" href="classDRAMCtrl.html#a3eea84ec922ff55ae38676da7222cd01">totQLat</a> / (<a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a> - <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>);
<a name="l01521"></a>01521 
<a name="l01522"></a>01522     <a class="code" href="classDRAMCtrl.html#ad2f8163270cbb3392f2e10fb6c4f78c4">avgBusLat</a>
<a name="l01523"></a>01523         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgBusLat&quot;</span>)
<a name="l01524"></a>01524         .desc(<span class="stringliteral">&quot;Average bus latency per DRAM burst&quot;</span>)
<a name="l01525"></a>01525         .precision(2);
<a name="l01526"></a>01526 
<a name="l01527"></a>01527     <a class="code" href="classDRAMCtrl.html#ad2f8163270cbb3392f2e10fb6c4f78c4">avgBusLat</a> = <a class="code" href="classDRAMCtrl.html#abbb23dd61d5f4a897a59ea51328ad3fd">totBusLat</a> / (<a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a> - <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>);
<a name="l01528"></a>01528 
<a name="l01529"></a>01529     <a class="code" href="classDRAMCtrl.html#ac7abb815f3daf254a44904528d4e816b">avgMemAccLat</a>
<a name="l01530"></a>01530         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgMemAccLat&quot;</span>)
<a name="l01531"></a>01531         .desc(<span class="stringliteral">&quot;Average memory access latency per DRAM burst&quot;</span>)
<a name="l01532"></a>01532         .precision(2);
<a name="l01533"></a>01533 
<a name="l01534"></a>01534     <a class="code" href="classDRAMCtrl.html#ac7abb815f3daf254a44904528d4e816b">avgMemAccLat</a> = <a class="code" href="classDRAMCtrl.html#a9aa73ba3e536064d1686b6489e57a4bf">totMemAccLat</a> / (<a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a> - <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>);
<a name="l01535"></a>01535 
<a name="l01536"></a>01536     <a class="code" href="classDRAMCtrl.html#acc056895269ee73447f6e9d814a22319">numRdRetry</a>
<a name="l01537"></a>01537         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.numRdRetry&quot;</span>)
<a name="l01538"></a>01538         .desc(<span class="stringliteral">&quot;Number of times read queue was full causing retry&quot;</span>);
<a name="l01539"></a>01539 
<a name="l01540"></a>01540     <a class="code" href="classDRAMCtrl.html#a961b9dc82d0ef2814dbdbc498a20e9b3">numWrRetry</a>
<a name="l01541"></a>01541         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.numWrRetry&quot;</span>)
<a name="l01542"></a>01542         .desc(<span class="stringliteral">&quot;Number of times write queue was full causing retry&quot;</span>);
<a name="l01543"></a>01543 
<a name="l01544"></a>01544     <a class="code" href="classDRAMCtrl.html#a7f3862d0c1944536c2ec30b0d012e288">readRowHits</a>
<a name="l01545"></a>01545         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.readRowHits&quot;</span>)
<a name="l01546"></a>01546         .desc(<span class="stringliteral">&quot;Number of row buffer hits during reads&quot;</span>);
<a name="l01547"></a>01547 
<a name="l01548"></a>01548     <a class="code" href="classDRAMCtrl.html#a5b75e7220ef0da8a50fe5777a9a1ae52">writeRowHits</a>
<a name="l01549"></a>01549         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.writeRowHits&quot;</span>)
<a name="l01550"></a>01550         .desc(<span class="stringliteral">&quot;Number of row buffer hits during writes&quot;</span>);
<a name="l01551"></a>01551 
<a name="l01552"></a>01552     <a class="code" href="classDRAMCtrl.html#a085bc7747d9a41218a9de406bf814c64">readRowHitRate</a>
<a name="l01553"></a>01553         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.readRowHitRate&quot;</span>)
<a name="l01554"></a>01554         .desc(<span class="stringliteral">&quot;Row buffer hit rate for reads&quot;</span>)
<a name="l01555"></a>01555         .precision(2);
<a name="l01556"></a>01556 
<a name="l01557"></a>01557     <a class="code" href="classDRAMCtrl.html#a085bc7747d9a41218a9de406bf814c64">readRowHitRate</a> = (<a class="code" href="classDRAMCtrl.html#a7f3862d0c1944536c2ec30b0d012e288">readRowHits</a> / (<a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a> - <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>)) * 100;
<a name="l01558"></a>01558 
<a name="l01559"></a>01559     <a class="code" href="classDRAMCtrl.html#ae193ec834aceec0ed536dc53ec409f22">writeRowHitRate</a>
<a name="l01560"></a>01560         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.writeRowHitRate&quot;</span>)
<a name="l01561"></a>01561         .desc(<span class="stringliteral">&quot;Row buffer hit rate for writes&quot;</span>)
<a name="l01562"></a>01562         .precision(2);
<a name="l01563"></a>01563 
<a name="l01564"></a>01564     <a class="code" href="classDRAMCtrl.html#ae193ec834aceec0ed536dc53ec409f22">writeRowHitRate</a> = (<a class="code" href="classDRAMCtrl.html#a5b75e7220ef0da8a50fe5777a9a1ae52">writeRowHits</a> / (<a class="code" href="classDRAMCtrl.html#a14baa61a63ebc1c4ce4aa1930aa9ba50">writeBursts</a> - <a class="code" href="classDRAMCtrl.html#accaed2ab83bb63d6ddff7bfa861ea537">mergedWrBursts</a>)) * 100;
<a name="l01565"></a>01565 
<a name="l01566"></a>01566     <a class="code" href="classDRAMCtrl.html#aee4577f07fe67bcc60ba3c504b35c9f3">readPktSize</a>
<a name="l01567"></a>01567         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(<a class="code" href="intmath_8hh.html#a0ec4eaea50888f737b803dc9427614bf">ceilLog2</a>(<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>) + 1)
<a name="l01568"></a>01568         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.readPktSize&quot;</span>)
<a name="l01569"></a>01569         .desc(<span class="stringliteral">&quot;Read request sizes (log2)&quot;</span>);
<a name="l01570"></a>01570 
<a name="l01571"></a>01571      <a class="code" href="classDRAMCtrl.html#aecc027383223e3500a37a9646607df81">writePktSize</a>
<a name="l01572"></a>01572         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(<a class="code" href="intmath_8hh.html#a0ec4eaea50888f737b803dc9427614bf">ceilLog2</a>(<a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a>) + 1)
<a name="l01573"></a>01573         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.writePktSize&quot;</span>)
<a name="l01574"></a>01574         .desc(<span class="stringliteral">&quot;Write request sizes (log2)&quot;</span>);
<a name="l01575"></a>01575 
<a name="l01576"></a>01576      <a class="code" href="classDRAMCtrl.html#a34cdc0482a9faf13f94abb3a37fa90b8">rdQLenPdf</a>
<a name="l01577"></a>01577         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(<a class="code" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a>)
<a name="l01578"></a>01578         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.rdQLenPdf&quot;</span>)
<a name="l01579"></a>01579         .desc(<span class="stringliteral">&quot;What read queue length does an incoming req see&quot;</span>);
<a name="l01580"></a>01580 
<a name="l01581"></a>01581      <a class="code" href="classDRAMCtrl.html#ace3009d78850dc82f90724de8df96227">wrQLenPdf</a>
<a name="l01582"></a>01582         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(<a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>)
<a name="l01583"></a>01583         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.wrQLenPdf&quot;</span>)
<a name="l01584"></a>01584         .desc(<span class="stringliteral">&quot;What write queue length does an incoming req see&quot;</span>);
<a name="l01585"></a>01585 
<a name="l01586"></a>01586      <a class="code" href="classDRAMCtrl.html#a097e6ef9437eaed0d05c3d0881455b1a">bytesPerActivate</a>
<a name="l01587"></a>01587          .<a class="code" href="classStats_1_1Histogram.html#a0478d941e230faacf754710bf188a6c9">init</a>(<a class="code" href="classDRAMCtrl.html#ab0ff1e80c0fcb937ef53eee0175cbd13">maxAccessesPerRow</a>)
<a name="l01588"></a>01588          .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.bytesPerActivate&quot;</span>)
<a name="l01589"></a>01589          .desc(<span class="stringliteral">&quot;Bytes accessed per row activation&quot;</span>)
<a name="l01590"></a>01590          .flags(<a class="code" href="namespaceStats.html#aea66fede55fadabd06c458fb36736378">nozero</a>);
<a name="l01591"></a>01591 
<a name="l01592"></a>01592      <a class="code" href="classDRAMCtrl.html#aff56c8c0df213e51ad714cb2b0df2de3">rdPerTurnAround</a>
<a name="l01593"></a>01593          .<a class="code" href="classStats_1_1Histogram.html#a0478d941e230faacf754710bf188a6c9">init</a>(<a class="code" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a>)
<a name="l01594"></a>01594          .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.rdPerTurnAround&quot;</span>)
<a name="l01595"></a>01595          .desc(<span class="stringliteral">&quot;Reads before turning the bus around for writes&quot;</span>)
<a name="l01596"></a>01596          .flags(<a class="code" href="namespaceStats.html#aea66fede55fadabd06c458fb36736378">nozero</a>);
<a name="l01597"></a>01597 
<a name="l01598"></a>01598      <a class="code" href="classDRAMCtrl.html#a6f8f6528076f5f3f9d56b7658368a781">wrPerTurnAround</a>
<a name="l01599"></a>01599          .<a class="code" href="classStats_1_1Histogram.html#a0478d941e230faacf754710bf188a6c9">init</a>(<a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>)
<a name="l01600"></a>01600          .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.wrPerTurnAround&quot;</span>)
<a name="l01601"></a>01601          .desc(<span class="stringliteral">&quot;Writes before turning the bus around for reads&quot;</span>)
<a name="l01602"></a>01602          .flags(<a class="code" href="namespaceStats.html#aea66fede55fadabd06c458fb36736378">nozero</a>);
<a name="l01603"></a>01603 
<a name="l01604"></a>01604     <a class="code" href="classDRAMCtrl.html#a4409b60f101f8ea21148966043864074">bytesReadDRAM</a>
<a name="l01605"></a>01605         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.bytesReadDRAM&quot;</span>)
<a name="l01606"></a>01606         .desc(<span class="stringliteral">&quot;Total number of bytes read from DRAM&quot;</span>);
<a name="l01607"></a>01607 
<a name="l01608"></a>01608     <a class="code" href="classDRAMCtrl.html#ae2ea884ed0a7e793cabc56748b833ed2">bytesReadWrQ</a>
<a name="l01609"></a>01609         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.bytesReadWrQ&quot;</span>)
<a name="l01610"></a>01610         .desc(<span class="stringliteral">&quot;Total number of bytes read from write queue&quot;</span>);
<a name="l01611"></a>01611 
<a name="l01612"></a>01612     <a class="code" href="classDRAMCtrl.html#a98c4533d0a7053d00f6882f984ebdaef">bytesWritten</a>
<a name="l01613"></a>01613         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.bytesWritten&quot;</span>)
<a name="l01614"></a>01614         .desc(<span class="stringliteral">&quot;Total number of bytes written to DRAM&quot;</span>);
<a name="l01615"></a>01615 
<a name="l01616"></a>01616     <a class="code" href="classDRAMCtrl.html#afd688f67c6a876a7b272e2ec9221fc8f">bytesReadSys</a>
<a name="l01617"></a>01617         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.bytesReadSys&quot;</span>)
<a name="l01618"></a>01618         .desc(<span class="stringliteral">&quot;Total read bytes from the system interface side&quot;</span>);
<a name="l01619"></a>01619 
<a name="l01620"></a>01620     <a class="code" href="classDRAMCtrl.html#acaf3b49004885b5bc8d40fef342c14c1">bytesWrittenSys</a>
<a name="l01621"></a>01621         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.bytesWrittenSys&quot;</span>)
<a name="l01622"></a>01622         .desc(<span class="stringliteral">&quot;Total written bytes from the system interface side&quot;</span>);
<a name="l01623"></a>01623 
<a name="l01624"></a>01624     <a class="code" href="classDRAMCtrl.html#a28dfaaa96a94257709a4f53f65ff6de8">avgRdBW</a>
<a name="l01625"></a>01625         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgRdBW&quot;</span>)
<a name="l01626"></a>01626         .desc(<span class="stringliteral">&quot;Average DRAM read bandwidth in MiByte/s&quot;</span>)
<a name="l01627"></a>01627         .precision(2);
<a name="l01628"></a>01628 
<a name="l01629"></a>01629     <a class="code" href="classDRAMCtrl.html#a28dfaaa96a94257709a4f53f65ff6de8">avgRdBW</a> = (<a class="code" href="classDRAMCtrl.html#a4409b60f101f8ea21148966043864074">bytesReadDRAM</a> / 1000000) / <a class="code" href="stat__control_8cc.html#aaad77dbb4162ef5a66c24dcd1ce256d0">simSeconds</a>;
<a name="l01630"></a>01630 
<a name="l01631"></a>01631     <a class="code" href="classDRAMCtrl.html#a286267c923c741d2fb82bdf8e76ed309">avgWrBW</a>
<a name="l01632"></a>01632         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgWrBW&quot;</span>)
<a name="l01633"></a>01633         .desc(<span class="stringliteral">&quot;Average achieved write bandwidth in MiByte/s&quot;</span>)
<a name="l01634"></a>01634         .precision(2);
<a name="l01635"></a>01635 
<a name="l01636"></a>01636     <a class="code" href="classDRAMCtrl.html#a286267c923c741d2fb82bdf8e76ed309">avgWrBW</a> = (<a class="code" href="classDRAMCtrl.html#a98c4533d0a7053d00f6882f984ebdaef">bytesWritten</a> / 1000000) / <a class="code" href="stat__control_8cc.html#aaad77dbb4162ef5a66c24dcd1ce256d0">simSeconds</a>;
<a name="l01637"></a>01637 
<a name="l01638"></a>01638     <a class="code" href="classDRAMCtrl.html#a22abe27ebad6f2dff8823abcbfd821b8">avgRdBWSys</a>
<a name="l01639"></a>01639         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgRdBWSys&quot;</span>)
<a name="l01640"></a>01640         .desc(<span class="stringliteral">&quot;Average system read bandwidth in MiByte/s&quot;</span>)
<a name="l01641"></a>01641         .precision(2);
<a name="l01642"></a>01642 
<a name="l01643"></a>01643     <a class="code" href="classDRAMCtrl.html#a22abe27ebad6f2dff8823abcbfd821b8">avgRdBWSys</a> = (<a class="code" href="classDRAMCtrl.html#afd688f67c6a876a7b272e2ec9221fc8f">bytesReadSys</a> / 1000000) / <a class="code" href="stat__control_8cc.html#aaad77dbb4162ef5a66c24dcd1ce256d0">simSeconds</a>;
<a name="l01644"></a>01644 
<a name="l01645"></a>01645     <a class="code" href="classDRAMCtrl.html#ab3ccc99d9b3a33a2783095e6299af1d8">avgWrBWSys</a>
<a name="l01646"></a>01646         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgWrBWSys&quot;</span>)
<a name="l01647"></a>01647         .desc(<span class="stringliteral">&quot;Average system write bandwidth in MiByte/s&quot;</span>)
<a name="l01648"></a>01648         .precision(2);
<a name="l01649"></a>01649 
<a name="l01650"></a>01650     <a class="code" href="classDRAMCtrl.html#ab3ccc99d9b3a33a2783095e6299af1d8">avgWrBWSys</a> = (<a class="code" href="classDRAMCtrl.html#acaf3b49004885b5bc8d40fef342c14c1">bytesWrittenSys</a> / 1000000) / <a class="code" href="stat__control_8cc.html#aaad77dbb4162ef5a66c24dcd1ce256d0">simSeconds</a>;
<a name="l01651"></a>01651 
<a name="l01652"></a>01652     <a class="code" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a>
<a name="l01653"></a>01653         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.peakBW&quot;</span>)
<a name="l01654"></a>01654         .desc(<span class="stringliteral">&quot;Theoretical peak bandwidth in MiByte/s&quot;</span>)
<a name="l01655"></a>01655         .precision(2);
<a name="l01656"></a>01656 
<a name="l01657"></a>01657     <a class="code" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a> = (<a class="code" href="namespaceSimClock.html#af196276bdf8e65836e88981a33d57943" title="The simulated frequency of curTick(). (In ticks per second).">SimClock::Frequency</a> / <a class="code" href="classDRAMCtrl.html#a15520c5298cfcc33032b7f0e363f7a3d">tBURST</a>) * <a class="code" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a> / 1000000;
<a name="l01658"></a>01658 
<a name="l01659"></a>01659     <a class="code" href="classDRAMCtrl.html#a32757323249e0ec2fd96e77d543fc60d">busUtil</a>
<a name="l01660"></a>01660         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.busUtil&quot;</span>)
<a name="l01661"></a>01661         .desc(<span class="stringliteral">&quot;Data bus utilization in percentage&quot;</span>)
<a name="l01662"></a>01662         .precision(2);
<a name="l01663"></a>01663 
<a name="l01664"></a>01664     <a class="code" href="classDRAMCtrl.html#a32757323249e0ec2fd96e77d543fc60d">busUtil</a> = (<a class="code" href="classDRAMCtrl.html#a28dfaaa96a94257709a4f53f65ff6de8">avgRdBW</a> + <a class="code" href="classDRAMCtrl.html#a286267c923c741d2fb82bdf8e76ed309">avgWrBW</a>) / <a class="code" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a> * 100;
<a name="l01665"></a>01665 
<a name="l01666"></a>01666     <a class="code" href="classDRAMCtrl.html#ad5c827068947b103cac8503aa45cf6e5">totGap</a>
<a name="l01667"></a>01667         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.totGap&quot;</span>)
<a name="l01668"></a>01668         .desc(<span class="stringliteral">&quot;Total gap between requests&quot;</span>);
<a name="l01669"></a>01669 
<a name="l01670"></a>01670     <a class="code" href="classDRAMCtrl.html#ab29b83e3d43dd519d59172a842b673a3">avgGap</a>
<a name="l01671"></a>01671         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.avgGap&quot;</span>)
<a name="l01672"></a>01672         .desc(<span class="stringliteral">&quot;Average gap between requests&quot;</span>)
<a name="l01673"></a>01673         .precision(2);
<a name="l01674"></a>01674 
<a name="l01675"></a>01675     <a class="code" href="classDRAMCtrl.html#ab29b83e3d43dd519d59172a842b673a3">avgGap</a> = <a class="code" href="classDRAMCtrl.html#ad5c827068947b103cac8503aa45cf6e5">totGap</a> / (<a class="code" href="classDRAMCtrl.html#a8baa6fa0f23d432bebbbf1f3845c9cd5">readReqs</a> + <a class="code" href="classDRAMCtrl.html#afb65580143c89e0011c2878c20e8ed0a">writeReqs</a>);
<a name="l01676"></a>01676 
<a name="l01677"></a>01677     <span class="comment">// Stats for DRAM Power calculation based on Micron datasheet</span>
<a name="l01678"></a>01678     <a class="code" href="classDRAMCtrl.html#a578cf14141a41ca0c302331cf1641d4a">busUtilRead</a>
<a name="l01679"></a>01679         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.busUtilRead&quot;</span>)
<a name="l01680"></a>01680         .desc(<span class="stringliteral">&quot;Data bus utilization in percentage for reads&quot;</span>)
<a name="l01681"></a>01681         .precision(2);
<a name="l01682"></a>01682 
<a name="l01683"></a>01683     <a class="code" href="classDRAMCtrl.html#a578cf14141a41ca0c302331cf1641d4a">busUtilRead</a> = <a class="code" href="classDRAMCtrl.html#a28dfaaa96a94257709a4f53f65ff6de8">avgRdBW</a> / <a class="code" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a> * 100;
<a name="l01684"></a>01684 
<a name="l01685"></a>01685     <a class="code" href="classDRAMCtrl.html#a414d3be953606d246b346cc75032e7d5">busUtilWrite</a>
<a name="l01686"></a>01686         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.busUtilWrite&quot;</span>)
<a name="l01687"></a>01687         .desc(<span class="stringliteral">&quot;Data bus utilization in percentage for writes&quot;</span>)
<a name="l01688"></a>01688         .precision(2);
<a name="l01689"></a>01689 
<a name="l01690"></a>01690     <a class="code" href="classDRAMCtrl.html#a414d3be953606d246b346cc75032e7d5">busUtilWrite</a> = <a class="code" href="classDRAMCtrl.html#a286267c923c741d2fb82bdf8e76ed309">avgWrBW</a> / <a class="code" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a> * 100;
<a name="l01691"></a>01691 
<a name="l01692"></a>01692     <a class="code" href="classDRAMCtrl.html#a8ec7f3dd4d238e4283760a15dc16c965">pageHitRate</a>
<a name="l01693"></a>01693         .<a class="code" href="classStats_1_1DataWrap.html#a8eaf5c2b92132dfcacd7d9b10afb1726">name</a>(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.pageHitRate&quot;</span>)
<a name="l01694"></a>01694         .desc(<span class="stringliteral">&quot;Row buffer hit rate, read and write combined&quot;</span>)
<a name="l01695"></a>01695         .precision(2);
<a name="l01696"></a>01696 
<a name="l01697"></a>01697     <a class="code" href="classDRAMCtrl.html#a8ec7f3dd4d238e4283760a15dc16c965">pageHitRate</a> = (<a class="code" href="classDRAMCtrl.html#a5b75e7220ef0da8a50fe5777a9a1ae52">writeRowHits</a> + <a class="code" href="classDRAMCtrl.html#a7f3862d0c1944536c2ec30b0d012e288">readRowHits</a>) /
<a name="l01698"></a>01698         (<a class="code" href="classDRAMCtrl.html#a14baa61a63ebc1c4ce4aa1930aa9ba50">writeBursts</a> - <a class="code" href="classDRAMCtrl.html#accaed2ab83bb63d6ddff7bfa861ea537">mergedWrBursts</a> + <a class="code" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a> - <a class="code" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a>) * 100;
<a name="l01699"></a>01699 
<a name="l01700"></a>01700     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>
<a name="l01701"></a>01701         .<a class="code" href="classStats_1_1VectorBase.html#ae41cad1a02eeb7958df026d8e2cc7582">init</a>(5)
<a name="l01702"></a>01702         .name(<a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>() + <span class="stringliteral">&quot;.memoryStateTime&quot;</span>)
<a name="l01703"></a>01703         .desc(<span class="stringliteral">&quot;Time in different power states&quot;</span>);
<a name="l01704"></a>01704     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>.<a class="code" href="classStats_1_1DataWrapVec.html#a74726d23d92792c7c3cebdaf3bfd23f0">subname</a>(0, <span class="stringliteral">&quot;IDLE&quot;</span>);
<a name="l01705"></a>01705     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>.<a class="code" href="classStats_1_1DataWrapVec.html#a74726d23d92792c7c3cebdaf3bfd23f0">subname</a>(1, <span class="stringliteral">&quot;REF&quot;</span>);
<a name="l01706"></a>01706     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>.<a class="code" href="classStats_1_1DataWrapVec.html#a74726d23d92792c7c3cebdaf3bfd23f0">subname</a>(2, <span class="stringliteral">&quot;PRE_PDN&quot;</span>);
<a name="l01707"></a>01707     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>.<a class="code" href="classStats_1_1DataWrapVec.html#a74726d23d92792c7c3cebdaf3bfd23f0">subname</a>(3, <span class="stringliteral">&quot;ACT&quot;</span>);
<a name="l01708"></a>01708     <a class="code" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a>.<a class="code" href="classStats_1_1DataWrapVec.html#a74726d23d92792c7c3cebdaf3bfd23f0">subname</a>(4, <span class="stringliteral">&quot;ACT_PDN&quot;</span>);
<a name="l01709"></a>01709 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aabfe6aa48e67d5b5c21e77dfa8a7e965"></a><!-- doxytag: member="DRAMCtrl::reorderQueue" ref="aabfe6aa48e67d5b5c21e77dfa8a7e965" args="(std::deque&lt; DRAMPacket * &gt; &amp;queue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reorderQueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt; <a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a> * &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>queue</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>For FR-FCFS policy reorder the read/write queue depending on row buffer hits and earliest banks available in DRAM </p>

<p><div class="fragment"><pre class="fragment"><a name="l00673"></a>00673 {
<a name="l00674"></a>00674     <span class="comment">// Only determine this when needed</span>
<a name="l00675"></a>00675     uint64_t earliest_banks = 0;
<a name="l00676"></a>00676 
<a name="l00677"></a>00677     <span class="comment">// Search for row hits first, if no row hit is found then schedule the</span>
<a name="l00678"></a>00678     <span class="comment">// packet to one of the earliest banks available</span>
<a name="l00679"></a>00679     <span class="keywordtype">bool</span> found_earliest_pkt = <span class="keyword">false</span>;
<a name="l00680"></a>00680     <span class="keyword">auto</span> selected_pkt_it = queue.begin();
<a name="l00681"></a>00681 
<a name="l00682"></a>00682     <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = queue.begin(); <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> != queue.end() ; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00683"></a>00683         DRAMPacket* dram_pkt = *<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00684"></a>00684         <span class="keyword">const</span> Bank&amp; bank = dram_pkt-&gt;bankRef;
<a name="l00685"></a>00685         <span class="comment">// Check if it is a row hit</span>
<a name="l00686"></a>00686         <span class="keywordflow">if</span> (bank.openRow == dram_pkt-&gt;row) {
<a name="l00687"></a>00687             <span class="comment">// FCFS within the hits</span>
<a name="l00688"></a>00688             <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Row buffer hit\n&quot;</span>);
<a name="l00689"></a>00689             selected_pkt_it = <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00690"></a>00690             <span class="keywordflow">break</span>;
<a name="l00691"></a>00691         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!found_earliest_pkt) {
<a name="l00692"></a>00692             <span class="comment">// No row hit, go for first ready</span>
<a name="l00693"></a>00693             <span class="keywordflow">if</span> (earliest_banks == 0)
<a name="l00694"></a>00694                 earliest_banks = <a class="code" href="classDRAMCtrl.html#a29301d0e29279a6e233f15c13959b0de">minBankActAt</a>(queue);
<a name="l00695"></a>00695 
<a name="l00696"></a>00696             <span class="comment">// simplistic approximation of when the bank can issue an</span>
<a name="l00697"></a>00697             <span class="comment">// activate, this is calculated in minBankActAt and could</span>
<a name="l00698"></a>00698             <span class="comment">// be cached</span>
<a name="l00699"></a>00699             <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> act_at = bank.openRow == <a class="code" href="classDRAMCtrl_1_1Bank.html#a4c1f8277dd32c2b530a7acc4969310f1">Bank::NO_ROW</a> ?
<a name="l00700"></a>00700                 bank.actAllowedAt :
<a name="l00701"></a>00701                 std::max(bank.preAllowedAt, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>()) + <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>;
<a name="l00702"></a>00702 
<a name="l00703"></a>00703             <span class="comment">// Bank is ready or is the first available bank</span>
<a name="l00704"></a>00704             <span class="keywordflow">if</span> (act_at &lt;= <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() ||
<a name="l00705"></a>00705                 <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(earliest_banks, dram_pkt-&gt;bankId, dram_pkt-&gt;bankId)) {
<a name="l00706"></a>00706                 <span class="comment">// Remember the packet to be scheduled to one of the earliest</span>
<a name="l00707"></a>00707                 <span class="comment">// banks available, FCFS amongst the earliest banks</span>
<a name="l00708"></a>00708                 selected_pkt_it = <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00709"></a>00709                 found_earliest_pkt = <span class="keyword">true</span>;
<a name="l00710"></a>00710             }
<a name="l00711"></a>00711         }
<a name="l00712"></a>00712     }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     DRAMPacket* selected_pkt = *selected_pkt_it;
<a name="l00715"></a>00715     queue.erase(selected_pkt_it);
<a name="l00716"></a>00716     queue.push_front(selected_pkt);
<a name="l00717"></a>00717 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a233880f1f4b8f6455a2ff083dda871d3"></a><!-- doxytag: member="DRAMCtrl::schedulePowerEvent" ref="a233880f1f4b8f6455a2ff083dda871d3" args="(PowerState pwr_state, Tick tick)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void schedulePowerEvent </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a>&nbsp;</td>
          <td class="paramname"> <em>pwr_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>tick</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Schedule a power state transition in the future, and potentially override an already scheduled transition.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pwr_state</em>&nbsp;</td><td>Power state to transition to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>tick</em>&nbsp;</td><td>Tick when transition should take place </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l01372"></a>01372 {
<a name="l01373"></a>01373     <span class="comment">// respect causality</span>
<a name="l01374"></a>01374     assert(<a class="code" href="classClockedObject.html#a4daae57fbf09ee5423d123f5ce330e92">tick</a> &gt;= <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>());
<a name="l01375"></a>01375 
<a name="l01376"></a>01376     <span class="keywordflow">if</span> (!<a class="code" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a>.<a class="code" href="classEvent.html#a9cd69a6b10cb037550943f177a0da688" title="Determine if the current event is scheduled.">scheduled</a>()) {
<a name="l01377"></a>01377         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAMState, <span class="stringliteral">&quot;Scheduling power event at %llu to state %d\n&quot;</span>,
<a name="l01378"></a>01378                 <a class="code" href="classClockedObject.html#a4daae57fbf09ee5423d123f5ce330e92">tick</a>, pwr_state);
<a name="l01379"></a>01379 
<a name="l01380"></a>01380         <span class="comment">// insert the new transition</span>
<a name="l01381"></a>01381         <a class="code" href="classDRAMCtrl.html#ab31f48c472ee16c28fc62b8be41b740e">pwrStateTrans</a> = pwr_state;
<a name="l01382"></a>01382 
<a name="l01383"></a>01383         <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a>, <a class="code" href="classClockedObject.html#a4daae57fbf09ee5423d123f5ce330e92">tick</a>);
<a name="l01384"></a>01384     } <span class="keywordflow">else</span> {
<a name="l01385"></a>01385         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Scheduled power event at %llu to state %d, &quot;</span>
<a name="l01386"></a>01386               <span class="stringliteral">&quot;with scheduled event at %llu to %d\n&quot;</span>, <a class="code" href="classClockedObject.html#a4daae57fbf09ee5423d123f5ce330e92">tick</a>, pwr_state,
<a name="l01387"></a>01387               <a class="code" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a>.<a class="code" href="classEvent.html#a1883243a0117678c5695f2435dcabbdc" title="Get the time that the event is scheduled.">when</a>(), <a class="code" href="classDRAMCtrl.html#ab31f48c472ee16c28fc62b8be41b740e">pwrStateTrans</a>);
<a name="l01388"></a>01388     }
<a name="l01389"></a>01389 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aecc7d8debf54990ffeaaed5bac7d7d81"></a><!-- doxytag: member="DRAMCtrl::startup" ref="aecc7d8debf54990ffeaaed5bac7d7d81" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void startup </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classDRAMCtrl.html#aecc7d8debf54990ffeaaed5bac7d7d81">startup()</a> is the final initialization call before simulation. All state is initialized (including unserialized state, if any, such as the <a class="el" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick()</a> value), so this is the appropriate place to schedule initial event(s) for objects that need them. </p>

<p><a class="el" href="classSimObject.html#aecc7d8debf54990ffeaaed5bac7d7d81">SimObject</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00157"></a>00157 {
<a name="l00158"></a>00158     <span class="comment">// update the start tick for the precharge accounting to the</span>
<a name="l00159"></a>00159     <span class="comment">// current tick</span>
<a name="l00160"></a>00160     <a class="code" href="classDRAMCtrl.html#a06e80ba25d388ee981f9c88e27e189df">pwrStateTick</a> = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>();
<a name="l00161"></a>00161 
<a name="l00162"></a>00162     <span class="comment">// shift the bus busy time sufficiently far ahead that we never</span>
<a name="l00163"></a>00163     <span class="comment">// have to worry about negative values when computing the time for</span>
<a name="l00164"></a>00164     <span class="comment">// the next request, this will add an insignificant bubble at the</span>
<a name="l00165"></a>00165     <span class="comment">// start of simulation</span>
<a name="l00166"></a>00166     <a class="code" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a> = <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a> + <a class="code" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a> + <a class="code" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a>;
<a name="l00167"></a>00167 
<a name="l00168"></a>00168     <span class="comment">// kick off the refresh, and give ourselves enough time to</span>
<a name="l00169"></a>00169     <span class="comment">// precharge</span>
<a name="l00170"></a>00170     <a class="code" href="classEventManager.html#a4ddebbfe9a12b95be6fb993ce892dcd3">schedule</a>(<a class="code" href="classDRAMCtrl.html#a0bc8ce4f4a849871eb32bd983b5d2843">refreshEvent</a>, <a class="code" href="statistics_8hh.html#a7acdccbf0d35ce0c159c0cdd36371b22" title="The universal simulation clock.">curTick</a>() + <a class="code" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a> - <a class="code" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a>);
<a name="l00171"></a>00171 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a34f56ea41ba7accf7b75a46aa79b560c"></a><!-- doxytag: member="DRAMCtrl::writeQueueFull" ref="a34f56ea41ba7accf7b75a46aa79b560c" args="(unsigned int pktCount) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool writeQueueFull </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>pktCount</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classCheck.html">Check</a> if the write queue has room for more entries</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>pktCount</em>&nbsp;</td><td>The number of entries needed in the write queue </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>true if write queue is full, false otherwise </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00203"></a>00203 {
<a name="l00204"></a>00204     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(DRAM, <span class="stringliteral">&quot;Write queue limit %d, current size %d, entries needed %d\n&quot;</span>,
<a name="l00205"></a>00205             <a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>, <a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size(), neededEntries);
<a name="l00206"></a>00206     <span class="keywordflow">return</span> (<a class="code" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a>.size() + neededEntries) &gt; <a class="code" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a>;
<a name="l00207"></a>00207 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="ad15dbdabb028b909655b32ab9e322e50"></a><!-- doxytag: member="DRAMCtrl::activateEvent" ref="ad15dbdabb028b909655b32ab9e322e50" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>, &amp;DRAMCtrl::processActivateEvent&gt; <a class="el" href="classDRAMCtrl.html#ad15dbdabb028b909655b32ab9e322e50">activateEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aba56ec7c49633bf73f29b24ff6a18b38"></a><!-- doxytag: member="DRAMCtrl::activationLimit" ref="aba56ec7c49633bf73f29b24ff6a18b38" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#aba56ec7c49633bf73f29b24ff6a18b38">activationLimit</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4a4e224ac2ca35b6d47a3ff850e1ff3e"></a><!-- doxytag: member="DRAMCtrl::actTicks" ref="a4a4e224ac2ca35b6d47a3ff850e1ff3e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classstd_1_1deque.html">std::deque</a>&lt;<a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&gt; &gt; <a class="el" href="classDRAMCtrl.html#a4a4e224ac2ca35b6d47a3ff850e1ff3e">actTicks</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>List to keep track of activate ticks </p>

</div>
</div>
<a class="anchor" id="a39c22fc32946a97479fd50b6d4db1ed0"></a><!-- doxytag: member="DRAMCtrl::addrMapping" ref="a39c22fc32946a97479fd50b6d4db1ed0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Enums::AddrMap <a class="el" href="classDRAMCtrl.html#a39c22fc32946a97479fd50b6d4db1ed0">addrMapping</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad2f8163270cbb3392f2e10fb6c4f78c4"></a><!-- doxytag: member="DRAMCtrl::avgBusLat" ref="ad2f8163270cbb3392f2e10fb6c4f78c4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#ad2f8163270cbb3392f2e10fb6c4f78c4">avgBusLat</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab29b83e3d43dd519d59172a842b673a3"></a><!-- doxytag: member="DRAMCtrl::avgGap" ref="ab29b83e3d43dd519d59172a842b673a3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#ab29b83e3d43dd519d59172a842b673a3">avgGap</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac7abb815f3daf254a44904528d4e816b"></a><!-- doxytag: member="DRAMCtrl::avgMemAccLat" ref="ac7abb815f3daf254a44904528d4e816b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#ac7abb815f3daf254a44904528d4e816b">avgMemAccLat</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad594e3077a6ad256f07ab26b96b34c5f"></a><!-- doxytag: member="DRAMCtrl::avgQLat" ref="ad594e3077a6ad256f07ab26b96b34c5f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#ad594e3077a6ad256f07ab26b96b34c5f">avgQLat</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a28dfaaa96a94257709a4f53f65ff6de8"></a><!-- doxytag: member="DRAMCtrl::avgRdBW" ref="a28dfaaa96a94257709a4f53f65ff6de8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a28dfaaa96a94257709a4f53f65ff6de8">avgRdBW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a22abe27ebad6f2dff8823abcbfd821b8"></a><!-- doxytag: member="DRAMCtrl::avgRdBWSys" ref="a22abe27ebad6f2dff8823abcbfd821b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a22abe27ebad6f2dff8823abcbfd821b8">avgRdBWSys</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab0f0022a38b8ccefd6d4d17ed434fcea"></a><!-- doxytag: member="DRAMCtrl::avgRdQLen" ref="ab0f0022a38b8ccefd6d4d17ed434fcea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Average.html">Stats::Average</a> <a class="el" href="classDRAMCtrl.html#ab0f0022a38b8ccefd6d4d17ed434fcea">avgRdQLen</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a286267c923c741d2fb82bdf8e76ed309"></a><!-- doxytag: member="DRAMCtrl::avgWrBW" ref="a286267c923c741d2fb82bdf8e76ed309" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a286267c923c741d2fb82bdf8e76ed309">avgWrBW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab3ccc99d9b3a33a2783095e6299af1d8"></a><!-- doxytag: member="DRAMCtrl::avgWrBWSys" ref="ab3ccc99d9b3a33a2783095e6299af1d8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#ab3ccc99d9b3a33a2783095e6299af1d8">avgWrBWSys</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4cdec63bcb455cfe5f1d8e6db40b66f5"></a><!-- doxytag: member="DRAMCtrl::avgWrQLen" ref="a4cdec63bcb455cfe5f1d8e6db40b66f5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Average.html">Stats::Average</a> <a class="el" href="classDRAMCtrl.html#a4cdec63bcb455cfe5f1d8e6db40b66f5">avgWrQLen</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af7b0d4000762b26f57e6bdbbdf45cf6d"></a><!-- doxytag: member="DRAMCtrl::backendLatency" ref="af7b0d4000762b26f57e6bdbbdf45cf6d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#af7b0d4000762b26f57e6bdbbdf45cf6d">backendLatency</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pipeline latency of the backend and PHY. Along with the frontend contribution, this latency is added to reads serviced by the DRAM. </p>

</div>
</div>
<a class="anchor" id="ac4dd7a78e52bcaca6fb18d24b45bb7f3"></a><!-- doxytag: member="DRAMCtrl::banks" ref="ac4dd7a78e52bcaca6fb18d24b45bb7f3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classDRAMCtrl_1_1Bank.html">Bank</a>&gt; &gt; <a class="el" href="classDRAMCtrl.html#ac4dd7a78e52bcaca6fb18d24b45bb7f3">banks</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Multi-dimensional vector of banks, first dimension is ranks, second is bank </p>

</div>
</div>
<a class="anchor" id="abd3ef09f9d5c70e15763a9761c8a14ca"></a><!-- doxytag: member="DRAMCtrl::banksPerRank" ref="abd3ef09f9d5c70e15763a9761c8a14ca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#abd3ef09f9d5c70e15763a9761c8a14ca">banksPerRank</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7ac4e4b031082616f09700ea29168920"></a><!-- doxytag: member="DRAMCtrl::burstLength" ref="a7ac4e4b031082616f09700ea29168920" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a7ac4e4b031082616f09700ea29168920">burstLength</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aed1f7024fc9eeb4654afe54d86683d76"></a><!-- doxytag: member="DRAMCtrl::burstSize" ref="aed1f7024fc9eeb4654afe54d86683d76" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#aed1f7024fc9eeb4654afe54d86683d76">burstSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0a423ce73b4c78a0da7ce4ad9e60add6"></a><!-- doxytag: member="DRAMCtrl::busBusyUntil" ref="a0a423ce73b4c78a0da7ce4ad9e60add6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a0a423ce73b4c78a0da7ce4ad9e60add6">busBusyUntil</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Till when has the main data bus been spoken for already? </p>

</div>
</div>
<a class="anchor" id="a898cc5ed4c5a9ec9c13dbe52d1ea0eb2"></a><!-- doxytag: member="DRAMCtrl::busState" ref="a898cc5ed4c5a9ec9c13dbe52d1ea0eb2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl.html#a167375ed712267f43fee8fa5d1aa4f11">BusState</a> <a class="el" href="classDRAMCtrl.html#a898cc5ed4c5a9ec9c13dbe52d1ea0eb2">busState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a32757323249e0ec2fd96e77d543fc60d"></a><!-- doxytag: member="DRAMCtrl::busUtil" ref="a32757323249e0ec2fd96e77d543fc60d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a32757323249e0ec2fd96e77d543fc60d">busUtil</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a578cf14141a41ca0c302331cf1641d4a"></a><!-- doxytag: member="DRAMCtrl::busUtilRead" ref="a578cf14141a41ca0c302331cf1641d4a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a578cf14141a41ca0c302331cf1641d4a">busUtilRead</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a414d3be953606d246b346cc75032e7d5"></a><!-- doxytag: member="DRAMCtrl::busUtilWrite" ref="a414d3be953606d246b346cc75032e7d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a414d3be953606d246b346cc75032e7d5">busUtilWrite</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a097e6ef9437eaed0d05c3d0881455b1a"></a><!-- doxytag: member="DRAMCtrl::bytesPerActivate" ref="a097e6ef9437eaed0d05c3d0881455b1a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Histogram.html">Stats::Histogram</a> <a class="el" href="classDRAMCtrl.html#a097e6ef9437eaed0d05c3d0881455b1a">bytesPerActivate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4409b60f101f8ea21148966043864074"></a><!-- doxytag: member="DRAMCtrl::bytesReadDRAM" ref="a4409b60f101f8ea21148966043864074" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a4409b60f101f8ea21148966043864074">bytesReadDRAM</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afd688f67c6a876a7b272e2ec9221fc8f"></a><!-- doxytag: member="DRAMCtrl::bytesReadSys" ref="afd688f67c6a876a7b272e2ec9221fc8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#afd688f67c6a876a7b272e2ec9221fc8f">bytesReadSys</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae2ea884ed0a7e793cabc56748b833ed2"></a><!-- doxytag: member="DRAMCtrl::bytesReadWrQ" ref="ae2ea884ed0a7e793cabc56748b833ed2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#ae2ea884ed0a7e793cabc56748b833ed2">bytesReadWrQ</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a98c4533d0a7053d00f6882f984ebdaef"></a><!-- doxytag: member="DRAMCtrl::bytesWritten" ref="a98c4533d0a7053d00f6882f984ebdaef" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a98c4533d0a7053d00f6882f984ebdaef">bytesWritten</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of bytes written to this memory </p>

<p><a class="el" href="classAbstractMemory.html#ab89ec4a4876671ad5186d0e9c0e674ed">AbstractMemory</a>を再定義しています。</p>

</div>
</div>
<a class="anchor" id="acaf3b49004885b5bc8d40fef342c14c1"></a><!-- doxytag: member="DRAMCtrl::bytesWrittenSys" ref="acaf3b49004885b5bc8d40fef342c14c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#acaf3b49004885b5bc8d40fef342c14c1">bytesWrittenSys</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2fa7bea53e9bf8fb52623b494d814d30"></a><!-- doxytag: member="DRAMCtrl::channels" ref="a2fa7bea53e9bf8fb52623b494d814d30" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a2fa7bea53e9bf8fb52623b494d814d30">channels</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1f84aad3340018bfb3c46ace200df8cb"></a><!-- doxytag: member="DRAMCtrl::columnsPerRowBuffer" ref="a1f84aad3340018bfb3c46ace200df8cb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a1f84aad3340018bfb3c46ace200df8cb">columnsPerRowBuffer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9b8ba3e3a3cc11b904cd1b70e7a40ea5"></a><!-- doxytag: member="DRAMCtrl::deviceBusWidth" ref="a9b8ba3e3a3cc11b904cd1b70e7a40ea5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a9b8ba3e3a3cc11b904cd1b70e7a40ea5">deviceBusWidth</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The following are basic design parameters of the memory controller, and are initialized based on parameter values. The rowsPerBank is determined based on the capacity, number of ranks and banks, the burst size, and the row buffer size. </p>

</div>
</div>
<a class="anchor" id="afdaeeb74e1622ca1cc0f00dcf937a3b0"></a><!-- doxytag: member="DRAMCtrl::deviceRowBufferSize" ref="afdaeeb74e1622ca1cc0f00dcf937a3b0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#afdaeeb74e1622ca1cc0f00dcf937a3b0">deviceRowBufferSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a962c654402093dcbdd4b40fd32c0de69"></a><!-- doxytag: member="DRAMCtrl::devicesPerRank" ref="a962c654402093dcbdd4b40fd32c0de69" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a962c654402093dcbdd4b40fd32c0de69">devicesPerRank</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a329b71fb934a93312ca0aacbf5a3f982"></a><!-- doxytag: member="DRAMCtrl::drainManager" ref="a329b71fb934a93312ca0aacbf5a3f982" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDrainManager.html">DrainManager</a>* <a class="el" href="classDRAMCtrl.html#a329b71fb934a93312ca0aacbf5a3f982">drainManager</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>If we need to drain, keep the drain manager around until we're done here. </p>

</div>
</div>
<a class="anchor" id="ad88c33e41f0bdc247328c7420c515f30"></a><!-- doxytag: member="DRAMCtrl::frontendLatency" ref="ad88c33e41f0bdc247328c7420c515f30" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#ad88c33e41f0bdc247328c7420c515f30">frontendLatency</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pipeline latency of the controller frontend. The frontend contribution is added to writes (that complete when they are in the write buffer) and reads that are serviced the write buffer. </p>

</div>
</div>
<a class="anchor" id="ab0ff1e80c0fcb937ef53eee0175cbd13"></a><!-- doxytag: member="DRAMCtrl::maxAccessesPerRow" ref="ab0ff1e80c0fcb937ef53eee0175cbd13" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#ab0ff1e80c0fcb937ef53eee0175cbd13">maxAccessesPerRow</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Max column accesses (read and write) per row, before forefully closing it. </p>

</div>
</div>
<a class="anchor" id="a77153a963ea47f1f424595cbc94461e7"></a><!-- doxytag: member="DRAMCtrl::memSchedPolicy" ref="a77153a963ea47f1f424595cbc94461e7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Enums::MemSched <a class="el" href="classDRAMCtrl.html#a77153a963ea47f1f424595cbc94461e7">memSchedPolicy</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Memory controller configuration initialized based on parameter values. </p>

</div>
</div>
<a class="anchor" id="accaed2ab83bb63d6ddff7bfa861ea537"></a><!-- doxytag: member="DRAMCtrl::mergedWrBursts" ref="accaed2ab83bb63d6ddff7bfa861ea537" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#accaed2ab83bb63d6ddff7bfa861ea537">mergedWrBursts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2753a60747e9836fe5f5fec7b613385c"></a><!-- doxytag: member="DRAMCtrl::minWritesPerSwitch" ref="a2753a60747e9836fe5f5fec7b613385c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a2753a60747e9836fe5f5fec7b613385c">minWritesPerSwitch</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a10a3647b9ff175594214578eece1e1f7"></a><!-- doxytag: member="DRAMCtrl::neitherReadNorWrite" ref="a10a3647b9ff175594214578eece1e1f7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a10a3647b9ff175594214578eece1e1f7">neitherReadNorWrite</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6f6c894e157329404d6b23503c4fa62e"></a><!-- doxytag: member="DRAMCtrl::nextReqEvent" ref="a6f6c894e157329404d6b23503c4fa62e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processNextReqEvent&gt; <a class="el" href="classDRAMCtrl.html#a6f6c894e157329404d6b23503c4fa62e">nextReqEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a61a2436b0d2ca4872e69f76fecaeca7f"></a><!-- doxytag: member="DRAMCtrl::nextReqTime" ref="a61a2436b0d2ca4872e69f76fecaeca7f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a61a2436b0d2ca4872e69f76fecaeca7f">nextReqTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The soonest you have to start thinking about the next request is the longest access time that can occur before busBusyUntil. Assuming you need to precharge, open a new row, and access, it is tRP + tRCD + tCL. </p>

</div>
</div>
<a class="anchor" id="a2742d81312b2f4e257aaa3690989bc88"></a><!-- doxytag: member="DRAMCtrl::numBanksActive" ref="a2742d81312b2f4e257aaa3690989bc88" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classDRAMCtrl.html#a2742d81312b2f4e257aaa3690989bc88">numBanksActive</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="acc056895269ee73447f6e9d814a22319"></a><!-- doxytag: member="DRAMCtrl::numRdRetry" ref="acc056895269ee73447f6e9d814a22319" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#acc056895269ee73447f6e9d814a22319">numRdRetry</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a961b9dc82d0ef2814dbdbc498a20e9b3"></a><!-- doxytag: member="DRAMCtrl::numWrRetry" ref="a961b9dc82d0ef2814dbdbc498a20e9b3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a961b9dc82d0ef2814dbdbc498a20e9b3">numWrRetry</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a8ec7f3dd4d238e4283760a15dc16c965"></a><!-- doxytag: member="DRAMCtrl::pageHitRate" ref="a8ec7f3dd4d238e4283760a15dc16c965" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a8ec7f3dd4d238e4283760a15dc16c965">pageHitRate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0ad0ee34c37f7b1694ad9aa4495c2c0f"></a><!-- doxytag: member="DRAMCtrl::pageMgmt" ref="a0ad0ee34c37f7b1694ad9aa4495c2c0f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Enums::PageManage <a class="el" href="classDRAMCtrl.html#a0ad0ee34c37f7b1694ad9aa4495c2c0f">pageMgmt</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af80252f1fcfad371b526eac5f9bf7e4f"></a><!-- doxytag: member="DRAMCtrl::peakBW" ref="af80252f1fcfad371b526eac5f9bf7e4f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#af80252f1fcfad371b526eac5f9bf7e4f">peakBW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a21da4bea3554874b557428e4cce5d4a4"></a><!-- doxytag: member="DRAMCtrl::pendingDelete" ref="a21da4bea3554874b557428e4cce5d4a4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classPacket.html">PacketPtr</a>&gt; <a class="el" href="classDRAMCtrl.html#a21da4bea3554874b557428e4cce5d4a4">pendingDelete</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000083">TODO:</a></b></dt><dd>this is a temporary workaround until the 4-phase code is committed. upstream caches needs this packet until true is returned, so hold onto it for deletion until a subsequent call </dd></dl>

</div>
</div>
<a class="anchor" id="a1a6c6b88a19805ae5453e5811633f884"></a><!-- doxytag: member="DRAMCtrl::perBankRdBursts" ref="a1a6c6b88a19805ae5453e5811633f884" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#a1a6c6b88a19805ae5453e5811633f884">perBankRdBursts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae757d149b2ff05a908b6ceb28f53decc"></a><!-- doxytag: member="DRAMCtrl::perBankWrBursts" ref="ae757d149b2ff05a908b6ceb28f53decc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#ae757d149b2ff05a908b6ceb28f53decc">perBankWrBursts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a55c076720c982014096b57cadebf9a14"></a><!-- doxytag: member="DRAMCtrl::port" ref="a55c076720c982014096b57cadebf9a14" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl_1_1MemoryPort.html">MemoryPort</a> <a class="el" href="classDRAMCtrl.html#a55c076720c982014096b57cadebf9a14">port</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Our incoming port, for a multi-ported controller add a crossbar in front of it </p>

</div>
</div>
<a class="anchor" id="afb2cbddd4a31e9a3b11886230f18f44b"></a><!-- doxytag: member="DRAMCtrl::powerEvent" ref="afb2cbddd4a31e9a3b11886230f18f44b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>,&amp;DRAMCtrl::processPowerEvent&gt; <a class="el" href="classDRAMCtrl.html#afb2cbddd4a31e9a3b11886230f18f44b">powerEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a80cac8f63f85f5c7781367b8b728750f"></a><!-- doxytag: member="DRAMCtrl::prechargeEvent" ref="a80cac8f63f85f5c7781367b8b728750f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>, &amp;DRAMCtrl::processPrechargeEvent&gt; <a class="el" href="classDRAMCtrl.html#a80cac8f63f85f5c7781367b8b728750f">prechargeEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae3e56b38f5969512cd915824ec1d5740"></a><!-- doxytag: member="DRAMCtrl::prevArrival" ref="ae3e56b38f5969512cd915824ec1d5740" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#ae3e56b38f5969512cd915824ec1d5740">prevArrival</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9c9c5adc18a56a35103536d6afddfd5f"></a><!-- doxytag: member="DRAMCtrl::pwrState" ref="a9c9c5adc18a56a35103536d6afddfd5f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a> <a class="el" href="classDRAMCtrl.html#a9c9c5adc18a56a35103536d6afddfd5f">pwrState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Current power state. </p>

</div>
</div>
<a class="anchor" id="a06e80ba25d388ee981f9c88e27e189df"></a><!-- doxytag: member="DRAMCtrl::pwrStateTick" ref="a06e80ba25d388ee981f9c88e27e189df" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a06e80ba25d388ee981f9c88e27e189df">pwrStateTick</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad084b0fe354d053d0f369a72b8559291"></a><!-- doxytag: member="DRAMCtrl::pwrStateTime" ref="ad084b0fe354d053d0f369a72b8559291" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#ad084b0fe354d053d0f369a72b8559291">pwrStateTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab31f48c472ee16c28fc62b8be41b740e"></a><!-- doxytag: member="DRAMCtrl::pwrStateTrans" ref="ab31f48c472ee16c28fc62b8be41b740e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl.html#aa59b8ef6374ae587f3c228eba57bdf80">PowerState</a> <a class="el" href="classDRAMCtrl.html#ab31f48c472ee16c28fc62b8be41b740e">pwrStateTrans</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Since we are taking decisions out of order, we need to keep track of what power transition is happening at what time, such that we can go back in time and change history. For example, if we precharge all banks and schedule going to the idle state, we might at a later point decide to activate a bank before the transition to idle would have taken place. </p>

</div>
</div>
<a class="anchor" id="afb57a2b8af54b8949b2c14434c74bd98"></a><!-- doxytag: member="DRAMCtrl::ranksPerChannel" ref="afb57a2b8af54b8949b2c14434c74bd98" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#afb57a2b8af54b8949b2c14434c74bd98">ranksPerChannel</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aff56c8c0df213e51ad714cb2b0df2de3"></a><!-- doxytag: member="DRAMCtrl::rdPerTurnAround" ref="aff56c8c0df213e51ad714cb2b0df2de3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Histogram.html">Stats::Histogram</a> <a class="el" href="classDRAMCtrl.html#aff56c8c0df213e51ad714cb2b0df2de3">rdPerTurnAround</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a34cdc0482a9faf13f94abb3a37fa90b8"></a><!-- doxytag: member="DRAMCtrl::rdQLenPdf" ref="a34cdc0482a9faf13f94abb3a37fa90b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#a34cdc0482a9faf13f94abb3a37fa90b8">rdQLenPdf</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7a26078fba8217391c336c615ce8ab69"></a><!-- doxytag: member="DRAMCtrl::readBufferSize" ref="a7a26078fba8217391c336c615ce8ab69" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a7a26078fba8217391c336c615ce8ab69">readBufferSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a342b92d18cc1b861071c5b596f127de8"></a><!-- doxytag: member="DRAMCtrl::readBursts" ref="a342b92d18cc1b861071c5b596f127de8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a342b92d18cc1b861071c5b596f127de8">readBursts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aee4577f07fe67bcc60ba3c504b35c9f3"></a><!-- doxytag: member="DRAMCtrl::readPktSize" ref="aee4577f07fe67bcc60ba3c504b35c9f3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#aee4577f07fe67bcc60ba3c504b35c9f3">readPktSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af799cb4e1a6e82bcb68ff9354bdf6876"></a><!-- doxytag: member="DRAMCtrl::readQueue" ref="af799cb4e1a6e82bcb68ff9354bdf6876" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a>*&gt; <a class="el" href="classDRAMCtrl.html#af799cb4e1a6e82bcb68ff9354bdf6876">readQueue</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The controller's main read and write queues </p>

</div>
</div>
<a class="anchor" id="a8baa6fa0f23d432bebbbf1f3845c9cd5"></a><!-- doxytag: member="DRAMCtrl::readReqs" ref="a8baa6fa0f23d432bebbbf1f3845c9cd5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a8baa6fa0f23d432bebbbf1f3845c9cd5">readReqs</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a085bc7747d9a41218a9de406bf814c64"></a><!-- doxytag: member="DRAMCtrl::readRowHitRate" ref="a085bc7747d9a41218a9de406bf814c64" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#a085bc7747d9a41218a9de406bf814c64">readRowHitRate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7f3862d0c1944536c2ec30b0d012e288"></a><!-- doxytag: member="DRAMCtrl::readRowHits" ref="a7f3862d0c1944536c2ec30b0d012e288" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a7f3862d0c1944536c2ec30b0d012e288">readRowHits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a72f27fd33d5f9c72099763cf6c518b87"></a><!-- doxytag: member="DRAMCtrl::readsThisTime" ref="a72f27fd33d5f9c72099763cf6c518b87" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a72f27fd33d5f9c72099763cf6c518b87">readsThisTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adee1f5c3afbe3ccf89880cde10ff9478"></a><!-- doxytag: member="DRAMCtrl::refreshDueAt" ref="adee1f5c3afbe3ccf89880cde10ff9478" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#adee1f5c3afbe3ccf89880cde10ff9478">refreshDueAt</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Keep track of when a refresh is due. </p>

</div>
</div>
<a class="anchor" id="a0bc8ce4f4a849871eb32bd983b5d2843"></a><!-- doxytag: member="DRAMCtrl::refreshEvent" ref="a0bc8ce4f4a849871eb32bd983b5d2843" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>, &amp;DRAMCtrl::processRefreshEvent&gt; <a class="el" href="classDRAMCtrl.html#a0bc8ce4f4a849871eb32bd983b5d2843">refreshEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa74cbca6192755f3cec9950a97c90342"></a><!-- doxytag: member="DRAMCtrl::refreshState" ref="aa74cbca6192755f3cec9950a97c90342" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDRAMCtrl.html#a5f4b1f67c62d22fa4cb3ec1f98b8edf5">RefreshState</a> <a class="el" href="classDRAMCtrl.html#aa74cbca6192755f3cec9950a97c90342">refreshState</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a31bec941f92f261930a6df5cf9fb166e"></a><!-- doxytag: member="DRAMCtrl::respondEvent" ref="a31bec941f92f261930a6df5cf9fb166e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classEventWrapper.html">EventWrapper</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMCtrl.html">DRAMCtrl</a>, &amp;DRAMCtrl::processRespondEvent&gt; <a class="el" href="classDRAMCtrl.html#a31bec941f92f261930a6df5cf9fb166e">respondEvent</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a04637ab08ad048aa826537a67dba4654"></a><!-- doxytag: member="DRAMCtrl::respQueue" ref="a04637ab08ad048aa826537a67dba4654" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a>*&gt; <a class="el" href="classDRAMCtrl.html#a04637ab08ad048aa826537a67dba4654">respQueue</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Response queue where read packets wait after we're done working with them, but it's not time to send the response yet. The responses are stored seperately mostly to keep the code clean and help with events scheduling. For all logical purposes such as sizing the read queue, this and the main read queue need to be added together. </p>

</div>
</div>
<a class="anchor" id="aa4e05579e39e0e1ae7859ddba8538932"></a><!-- doxytag: member="DRAMCtrl::retryRdReq" ref="aa4e05579e39e0e1ae7859ddba8538932" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDRAMCtrl.html#aa4e05579e39e0e1ae7859ddba8538932">retryRdReq</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remember if we have to retry a request when available. </p>

</div>
</div>
<a class="anchor" id="acf0d3616b5317008b8248aa2245df220"></a><!-- doxytag: member="DRAMCtrl::retryWrReq" ref="acf0d3616b5317008b8248aa2245df220" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDRAMCtrl.html#acf0d3616b5317008b8248aa2245df220">retryWrReq</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abe6f704496dadf8c0b246eb57b4e25d5"></a><!-- doxytag: member="DRAMCtrl::rowBufferSize" ref="abe6f704496dadf8c0b246eb57b4e25d5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#abe6f704496dadf8c0b246eb57b4e25d5">rowBufferSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad878fffffe428b1673a17f489f5a4e94"></a><!-- doxytag: member="DRAMCtrl::rowsPerBank" ref="ad878fffffe428b1673a17f489f5a4e94" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#ad878fffffe428b1673a17f489f5a4e94">rowsPerBank</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a234c092fa122ea27676236c3b6f11bcb"></a><!-- doxytag: member="DRAMCtrl::servicedByWrQ" ref="a234c092fa122ea27676236c3b6f11bcb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a234c092fa122ea27676236c3b6f11bcb">servicedByWrQ</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a15520c5298cfcc33032b7f0e363f7a3d"></a><!-- doxytag: member="DRAMCtrl::tBURST" ref="a15520c5298cfcc33032b7f0e363f7a3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a15520c5298cfcc33032b7f0e363f7a3d">tBURST</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9cd12bc6d433964d98ff2386c03e5246"></a><!-- doxytag: member="DRAMCtrl::tCK" ref="a9cd12bc6d433964d98ff2386c03e5246" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a9cd12bc6d433964d98ff2386c03e5246">tCK</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Basic memory timing parameters initialized based on parameter values. </p>

</div>
</div>
<a class="anchor" id="a96c42cd586bf995db505fbb5c0252ac1"></a><!-- doxytag: member="DRAMCtrl::tCL" ref="a96c42cd586bf995db505fbb5c0252ac1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a96c42cd586bf995db505fbb5c0252ac1">tCL</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abbb23dd61d5f4a897a59ea51328ad3fd"></a><!-- doxytag: member="DRAMCtrl::totBusLat" ref="abbb23dd61d5f4a897a59ea51328ad3fd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#abbb23dd61d5f4a897a59ea51328ad3fd">totBusLat</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad5c827068947b103cac8503aa45cf6e5"></a><!-- doxytag: member="DRAMCtrl::totGap" ref="ad5c827068947b103cac8503aa45cf6e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#ad5c827068947b103cac8503aa45cf6e5">totGap</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a9aa73ba3e536064d1686b6489e57a4bf"></a><!-- doxytag: member="DRAMCtrl::totMemAccLat" ref="a9aa73ba3e536064d1686b6489e57a4bf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a9aa73ba3e536064d1686b6489e57a4bf">totMemAccLat</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3eea84ec922ff55ae38676da7222cd01"></a><!-- doxytag: member="DRAMCtrl::totQLat" ref="a3eea84ec922ff55ae38676da7222cd01" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a3eea84ec922ff55ae38676da7222cd01">totQLat</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a91e2a0dae0024646d5cf40c844996bcc"></a><!-- doxytag: member="DRAMCtrl::tRAS" ref="a91e2a0dae0024646d5cf40c844996bcc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a91e2a0dae0024646d5cf40c844996bcc">tRAS</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a482d43285a450eeb021dcb7065741b33"></a><!-- doxytag: member="DRAMCtrl::tRCD" ref="a482d43285a450eeb021dcb7065741b33" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a482d43285a450eeb021dcb7065741b33">tRCD</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2082aad1296022a7ff2d7b1a95bae882"></a><!-- doxytag: member="DRAMCtrl::tREFI" ref="a2082aad1296022a7ff2d7b1a95bae882" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a2082aad1296022a7ff2d7b1a95bae882">tREFI</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ada7c680f071957137175c60c125b929a"></a><!-- doxytag: member="DRAMCtrl::tRFC" ref="ada7c680f071957137175c60c125b929a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#ada7c680f071957137175c60c125b929a">tRFC</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa3828096d625ef4b6b497ce02b3fac85"></a><!-- doxytag: member="DRAMCtrl::tRP" ref="aa3828096d625ef4b6b497ce02b3fac85" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#aa3828096d625ef4b6b497ce02b3fac85">tRP</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac09c7763d97a33e93c89f266ed29df29"></a><!-- doxytag: member="DRAMCtrl::tRRD" ref="ac09c7763d97a33e93c89f266ed29df29" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#ac09c7763d97a33e93c89f266ed29df29">tRRD</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a850e39d6fd527d4992315e86a8978292"></a><!-- doxytag: member="DRAMCtrl::tRTP" ref="a850e39d6fd527d4992315e86a8978292" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a850e39d6fd527d4992315e86a8978292">tRTP</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a578e383b38a4b65988799b3c16c4c17d"></a><!-- doxytag: member="DRAMCtrl::tRTW" ref="a578e383b38a4b65988799b3c16c4c17d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a578e383b38a4b65988799b3c16c4c17d">tRTW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3c3ee9ca057928cc876fc54a20356535"></a><!-- doxytag: member="DRAMCtrl::tWR" ref="a3c3ee9ca057928cc876fc54a20356535" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a3c3ee9ca057928cc876fc54a20356535">tWR</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a33aeea1fd32ea7035fc8ca3a32f75473"></a><!-- doxytag: member="DRAMCtrl::tWTR" ref="a33aeea1fd32ea7035fc8ca3a32f75473" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a33aeea1fd32ea7035fc8ca3a32f75473">tWTR</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a32fe8eab168b3a01214255fde6091e0b"></a><!-- doxytag: member="DRAMCtrl::tXAW" ref="a32fe8eab168b3a01214255fde6091e0b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classDRAMCtrl.html#a32fe8eab168b3a01214255fde6091e0b">tXAW</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae1cedccfe0fe11c2bd10c28f4be1ea63"></a><!-- doxytag: member="DRAMCtrl::writeBufferSize" ref="ae1cedccfe0fe11c2bd10c28f4be1ea63" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#ae1cedccfe0fe11c2bd10c28f4be1ea63">writeBufferSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a14baa61a63ebc1c4ce4aa1930aa9ba50"></a><!-- doxytag: member="DRAMCtrl::writeBursts" ref="a14baa61a63ebc1c4ce4aa1930aa9ba50" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a14baa61a63ebc1c4ce4aa1930aa9ba50">writeBursts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a61f48157d680c1ddf7dd818c9008dd53"></a><!-- doxytag: member="DRAMCtrl::writeHighThreshold" ref="a61f48157d680c1ddf7dd818c9008dd53" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a61f48157d680c1ddf7dd818c9008dd53">writeHighThreshold</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a803b97da34c3b40357123d5713e6ab4a"></a><!-- doxytag: member="DRAMCtrl::writeLowThreshold" ref="a803b97da34c3b40357123d5713e6ab4a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a803b97da34c3b40357123d5713e6ab4a">writeLowThreshold</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aecc027383223e3500a37a9646607df81"></a><!-- doxytag: member="DRAMCtrl::writePktSize" ref="aecc027383223e3500a37a9646607df81" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#aecc027383223e3500a37a9646607df81">writePktSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3286652a16bd92e1fd02c6a5f42b83a1"></a><!-- doxytag: member="DRAMCtrl::writeQueue" ref="a3286652a16bd92e1fd02c6a5f42b83a1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1deque.html">std::deque</a>&lt;<a class="el" href="classDRAMCtrl_1_1DRAMPacket.html">DRAMPacket</a>*&gt; <a class="el" href="classDRAMCtrl.html#a3286652a16bd92e1fd02c6a5f42b83a1">writeQueue</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="afb65580143c89e0011c2878c20e8ed0a"></a><!-- doxytag: member="DRAMCtrl::writeReqs" ref="afb65580143c89e0011c2878c20e8ed0a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#afb65580143c89e0011c2878c20e8ed0a">writeReqs</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae193ec834aceec0ed536dc53ec409f22"></a><!-- doxytag: member="DRAMCtrl::writeRowHitRate" ref="ae193ec834aceec0ed536dc53ec409f22" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Formula.html">Stats::Formula</a> <a class="el" href="classDRAMCtrl.html#ae193ec834aceec0ed536dc53ec409f22">writeRowHitRate</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5b75e7220ef0da8a50fe5777a9a1ae52"></a><!-- doxytag: member="DRAMCtrl::writeRowHits" ref="a5b75e7220ef0da8a50fe5777a9a1ae52" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Scalar.html">Stats::Scalar</a> <a class="el" href="classDRAMCtrl.html#a5b75e7220ef0da8a50fe5777a9a1ae52">writeRowHits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a332d2848d0e28912ff8b0c8c9e09842a"></a><!-- doxytag: member="DRAMCtrl::writesThisTime" ref="a332d2848d0e28912ff8b0c8c9e09842a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="classDRAMCtrl.html#a332d2848d0e28912ff8b0c8c9e09842a">writesThisTime</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6f8f6528076f5f3f9d56b7658368a781"></a><!-- doxytag: member="DRAMCtrl::wrPerTurnAround" ref="a6f8f6528076f5f3f9d56b7658368a781" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Histogram.html">Stats::Histogram</a> <a class="el" href="classDRAMCtrl.html#a6f8f6528076f5f3f9d56b7658368a781">wrPerTurnAround</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ace3009d78850dc82f90724de8df96227"></a><!-- doxytag: member="DRAMCtrl::wrQLenPdf" ref="ace3009d78850dc82f90724de8df96227" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classStats_1_1Vector.html">Stats::Vector</a> <a class="el" href="classDRAMCtrl.html#ace3009d78850dc82f90724de8df96227">wrQLenPdf</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>mem/<a class="el" href="dram__ctrl_8hh_source.html">dram_ctrl.hh</a></li>
<li>mem/<a class="el" href="dram__ctrl_8cc.html">dram_ctrl.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
