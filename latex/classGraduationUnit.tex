\hypertarget{classGraduationUnit}{
\section{クラス GraduationUnit}
\label{classGraduationUnit}\index{GraduationUnit@{GraduationUnit}}
}


{\ttfamily \#include $<$graduation\_\-unit.hh$>$}GraduationUnitに対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classGraduationUnit}
\end{center}
\end{figure}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153}{Command} \{ \hyperlink{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153af5078e6f13b238ab8060c96938d6072b}{CheckFault}, 
\hyperlink{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153a0dbb578317cd51936a80b515cd969112}{GraduateInst}
 \}
\item 
typedef \hyperlink{classRefCountingPtr}{ThePipeline::DynInstPtr} \hyperlink{classGraduationUnit_af9d0c8a46736ba6aa2d8bb94da1a5e73}{DynInstPtr}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classGraduationUnit_a833d5b53b32caa0573f9df673f7348c4}{GraduationUnit} (std::string res\_\-name, int res\_\-id, int res\_\-width, \hyperlink{classCycles}{Cycles} res\_\-latency, \hyperlink{classInOrderCPU}{InOrderCPU} $\ast$\_\-cpu, \hyperlink{namespaceThePipeline_ab62ca16eeca26566ad2422b5df4943ce}{ThePipeline::Params} $\ast$params)
\item 
void \hyperlink{classGraduationUnit_a7b7fff82f8c9cbdb02add1346f60bb9e}{execute} (int slot\_\-num)
\end{DoxyCompactItemize}
\subsection*{Protected 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classGraduationUnit_a0ecb66fa77b766d3a2dcf951d7d592a2}{lastNonSpecTick} \mbox{[}\hyperlink{namespaceThePipeline_ac9c0bbe9cf27d93e08ea8ccc4096e633}{ThePipeline::MaxThreads}\mbox{]}
\item 
\hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classGraduationUnit_a06338b6a229a01ba08102d38224d0fbf}{lastFaultTick} \mbox{[}\hyperlink{namespaceThePipeline_ac9c0bbe9cf27d93e08ea8ccc4096e633}{ThePipeline::MaxThreads}\mbox{]}
\item 
bool $\ast$ \hyperlink{classGraduationUnit_aa27d1c9b589af0c77a81c490021c7dcb}{nonSpecInstActive} \mbox{[}\hyperlink{namespaceThePipeline_ac9c0bbe9cf27d93e08ea8ccc4096e633}{ThePipeline::MaxThreads}\mbox{]}
\item 
\hyperlink{inst__seq_8hh_a258d93d98edaedee089435c19ea2ea2e}{InstSeqNum} $\ast$ \hyperlink{classGraduationUnit_a899b1bc10d38a0f725495bf2108479a3}{nonSpecSeqNum} \mbox{[}\hyperlink{namespaceThePipeline_ac9c0bbe9cf27d93e08ea8ccc4096e633}{ThePipeline::MaxThreads}\mbox{]}
\end{DoxyCompactItemize}


\subsection{型定義}
\hypertarget{classGraduationUnit_af9d0c8a46736ba6aa2d8bb94da1a5e73}{
\index{GraduationUnit@{GraduationUnit}!DynInstPtr@{DynInstPtr}}
\index{DynInstPtr@{DynInstPtr}!GraduationUnit@{GraduationUnit}}
\subsubsection[{DynInstPtr}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf ThePipeline::DynInstPtr} {\bf DynInstPtr}}}
\label{classGraduationUnit_af9d0c8a46736ba6aa2d8bb94da1a5e73}


\hyperlink{classResource_af9d0c8a46736ba6aa2d8bb94da1a5e73}{Resource}を再定義しています。

\subsection{列挙型}
\hypertarget{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153}{
\index{GraduationUnit@{GraduationUnit}!Command@{Command}}
\index{Command@{Command}!GraduationUnit@{GraduationUnit}}
\subsubsection[{Command}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Command}}}
\label{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153}
\begin{Desc}
\item[列挙型の値: ]\par
\begin{description}
\index{CheckFault@{CheckFault}!GraduationUnit@{GraduationUnit}}\index{GraduationUnit@{GraduationUnit}!CheckFault@{CheckFault}}\item[{\em 
\hypertarget{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153af5078e6f13b238ab8060c96938d6072b}{
CheckFault}
\label{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153af5078e6f13b238ab8060c96938d6072b}
}]\index{GraduateInst@{GraduateInst}!GraduationUnit@{GraduationUnit}}\index{GraduationUnit@{GraduationUnit}!GraduateInst@{GraduateInst}}\item[{\em 
\hypertarget{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153a0dbb578317cd51936a80b515cd969112}{
GraduateInst}
\label{classGraduationUnit_a2afce0a47a93eee73a314d53e4890153a0dbb578317cd51936a80b515cd969112}
}]\end{description}
\end{Desc}




\begin{DoxyCode}
48                  {
49         CheckFault,
50         GraduateInst
51     };
\end{DoxyCode}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classGraduationUnit_a833d5b53b32caa0573f9df673f7348c4}{
\index{GraduationUnit@{GraduationUnit}!GraduationUnit@{GraduationUnit}}
\index{GraduationUnit@{GraduationUnit}!GraduationUnit@{GraduationUnit}}
\subsubsection[{GraduationUnit}]{\setlength{\rightskip}{0pt plus 5cm}{\bf GraduationUnit} (std::string {\em res\_\-name}, \/  int {\em res\_\-id}, \/  int {\em res\_\-width}, \/  {\bf Cycles} {\em res\_\-latency}, \/  {\bf InOrderCPU} $\ast$ {\em \_\-cpu}, \/  {\bf ThePipeline::Params} $\ast$ {\em params})}}
\label{classGraduationUnit_a833d5b53b32caa0573f9df673f7348c4}



\begin{DoxyCode}
40     : Resource(res_name, res_id, res_width, res_latency, _cpu)
41 {
42     for (ThreadID tid = 0; tid < ThePipeline::MaxThreads; tid++) {
43         nonSpecInstActive[tid] = &cpu->nonSpecInstActive[tid];
44         nonSpecSeqNum[tid] = &cpu->nonSpecSeqNum[tid];
45         lastNonSpecTick[tid] = 0;
46         lastFaultTick[tid] = 0;
47     }
48 }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classGraduationUnit_a7b7fff82f8c9cbdb02add1346f60bb9e}{
\index{GraduationUnit@{GraduationUnit}!execute@{execute}}
\index{execute@{execute}!GraduationUnit@{GraduationUnit}}
\subsubsection[{execute}]{\setlength{\rightskip}{0pt plus 5cm}void execute (int {\em slot\_\-idx})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classGraduationUnit_a7b7fff82f8c9cbdb02add1346f60bb9e}
Execute the function of this resource. The Default is action is to do nothing. More specific models will derive from this class and define their own execute function. 

\hyperlink{classResource_a39af49c5568d1db3f53c12d7d6914c32}{Resource}を再定義しています。


\begin{DoxyCode}
52 {
53     ResourceRequest* grad_req = reqs[slot_num];
54     DynInstPtr inst = reqs[slot_num]->inst;
55     ThreadID tid = inst->readTid();
56     int stage_num = inst->curSkedEntry->stageNum;
57     Tick cur_tick = curTick();
58 
59     //@todo: not the common case, anyway we can move this
60     //       check to the stage and just ignore instructions
61     //       after?
62     if (lastNonSpecTick[tid] == cur_tick) {
63         DPRINTF(InOrderGraduation, "Unable to graduate [sn:%i]. "
64                 "Only 1 nonspec inst. per cycle can graduate.\n");
65         grad_req->done(false);
66         return;
67     }
68 
69     //@todo: use trap Pending
70     if (cpu->trapPending[tid]) {
71         //if (lastFaultTick[tid] == cur_tick) {
72         DPRINTF(InOrderGraduation, "Unable to graduate [sn:%i]. "
73                 "Only 1 fault can be handled per tick.\n");
74         grad_req->done(false);
75         return;
76     }
77 
78 
79     switch (grad_req->cmd)
80     {
81       case CheckFault:
82         {
83             // Handle Any Faults Before Graduating Instruction
84             if (inst->fault != NoFault) {
85                 DPRINTF(InOrderGraduation, "[tid:%i]: [sn:%i]: fault %s found for
       %s\n",
86                         tid, inst->seqNum, inst->fault->name(),
87                         inst->instName());
88                 squashThenTrap(stage_num, inst);
89                 lastFaultTick[tid] = cur_tick;
90                 grad_req->done(false);
91                 return;
92             }
93 
94             DPRINTF(InOrderGraduation, "[tid:%i] [sn:%i]: No fault found for %s\n
      ",
95                     tid, inst->seqNum, inst->instName());
96             grad_req->done();
97         }
98         break;
99 
100       case GraduateInst:
101         {
102             DPRINTF(InOrderGraduation,
103                     "[tid:%i]:[sn:%i]: Graduating instruction %s.\n",
104                     tid, inst->seqNum, inst->staticInst->disassemble(inst->instAd
      dr()));
105 
106             // Release Non-Speculative "Block" on instructions that could not
107             // execute because there was a non-speculative inst. active.
108             // @TODO: Fix this functionality. Probably too conservative.
109             //        Maybe it should be, non-spec. insts should block other
110             //        non-spec insts because they can potentially be reading
111             //        system state that will be changed by the 1st non-spec inst.
      
112             if (inst->isNonSpeculative()) {
113                 *nonSpecInstActive[tid] = false;
114                 DPRINTF(InOrderGraduation,
115                         "[tid:%i] Non-speculative inst [sn:%i] graduated\n",
116                         tid, inst->seqNum);
117                 lastNonSpecTick[tid] = cur_tick;
118             }
119 
120             if (inst->traceData) {
121                 inst->traceData->setStageCycle(stage_num, cur_tick);
122             }
123 
124             // Tell CPU that instruction is finished processing
125             cpu->instDone(inst, tid);
126 
127             grad_req->done();
128         }
129         break;
130 
131       default:
132         fatal("Unrecognized command to %s", resName);
133     }
134 
135 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classGraduationUnit_a06338b6a229a01ba08102d38224d0fbf}{
\index{GraduationUnit@{GraduationUnit}!lastFaultTick@{lastFaultTick}}
\index{lastFaultTick@{lastFaultTick}!GraduationUnit@{GraduationUnit}}
\subsubsection[{lastFaultTick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} {\bf lastFaultTick}\mbox{[}{\bf ThePipeline::MaxThreads}\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classGraduationUnit_a06338b6a229a01ba08102d38224d0fbf}
\hypertarget{classGraduationUnit_a0ecb66fa77b766d3a2dcf951d7d592a2}{
\index{GraduationUnit@{GraduationUnit}!lastNonSpecTick@{lastNonSpecTick}}
\index{lastNonSpecTick@{lastNonSpecTick}!GraduationUnit@{GraduationUnit}}
\subsubsection[{lastNonSpecTick}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} {\bf lastNonSpecTick}\mbox{[}{\bf ThePipeline::MaxThreads}\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classGraduationUnit_a0ecb66fa77b766d3a2dcf951d7d592a2}
\hypertarget{classGraduationUnit_aa27d1c9b589af0c77a81c490021c7dcb}{
\index{GraduationUnit@{GraduationUnit}!nonSpecInstActive@{nonSpecInstActive}}
\index{nonSpecInstActive@{nonSpecInstActive}!GraduationUnit@{GraduationUnit}}
\subsubsection[{nonSpecInstActive}]{\setlength{\rightskip}{0pt plus 5cm}bool$\ast$ {\bf nonSpecInstActive}\mbox{[}{\bf ThePipeline::MaxThreads}\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classGraduationUnit_aa27d1c9b589af0c77a81c490021c7dcb}
\hypertarget{classGraduationUnit_a899b1bc10d38a0f725495bf2108479a3}{
\index{GraduationUnit@{GraduationUnit}!nonSpecSeqNum@{nonSpecSeqNum}}
\index{nonSpecSeqNum@{nonSpecSeqNum}!GraduationUnit@{GraduationUnit}}
\subsubsection[{nonSpecSeqNum}]{\setlength{\rightskip}{0pt plus 5cm}{\bf InstSeqNum}$\ast$ {\bf nonSpecSeqNum}\mbox{[}{\bf ThePipeline::MaxThreads}\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classGraduationUnit_a899b1bc10d38a0f725495bf2108479a3}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
cpu/inorder/resources/\hyperlink{graduation__unit_8hh}{graduation\_\-unit.hh}\item 
cpu/inorder/resources/\hyperlink{graduation__unit_8cc}{graduation\_\-unit.cc}\end{DoxyCompactItemize}
