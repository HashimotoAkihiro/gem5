<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス X86_64LiveProcess</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceX86ISA.html">X86ISA</a>::<a class="el" href="classX86ISA_1_1X86__64LiveProcess.html">X86_64LiveProcess</a>
  </div>
</div>
<div class="contents">
<h1>クラス X86_64LiveProcess</h1><!-- doxytag: class="X86ISA::X86_64LiveProcess" --><!-- doxytag: inherits="X86ISA::X86LiveProcess" -->
<p><code>#include &lt;<a class="el" href="arch_2x86_2process_8hh_source.html">process.hh</a>&gt;</code></p>
<div class="dynheader">
X86_64LiveProcessに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classX86ISA_1_1X86__64LiveProcess.gif" usemap="#X86_64LiveProcess_map" alt=""/>
  <map id="X86_64LiveProcess_map" name="X86_64LiveProcess_map">
<area href="classX86ISA_1_1X86LiveProcess.html" alt="X86LiveProcess" shape="rect" coords="142,224,274,248"/>
<area href="classLiveProcess.html" alt="LiveProcess" shape="rect" coords="142,168,274,192"/>
<area href="classProcess.html" alt="Process" shape="rect" coords="142,112,274,136"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="142,56,274,80"/>
<area href="classEventManager.html" alt="EventManager" shape="rect" coords="0,0,132,24"/>
<area href="classSerializable.html" alt="Serializable" shape="rect" coords="142,0,274,24"/>
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="284,0,416,24"/>
<area href="classX86ISA_1_1X86__64LinuxProcess.html" alt="X86_64LinuxProcess" shape="rect" coords="142,336,274,360"/>
</map>
 </div>
</div>

<p><a href="classX86ISA_1_1X86__64LiveProcess-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>構成</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html">VSyscallPage</a></td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a60e5314ffeede1e51c6bcb2cf606ca92">argsInit</a> (int intSize, int pageSize)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a3c34ea9b29f410748d4435a667484924">initState</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceX86ISA.html#a0e080577527fb3e9685399f75b5caf15">X86ISA::IntReg</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a6f33c62983b3e68106d1cdb43b9fc09c">getSyscallArg</a> (<a class="el" href="classThreadContext.html">ThreadContext</a> *tc, int &amp;i)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a834e8e05416e3487f87d942259506abe">setSyscallArg</a> (<a class="el" href="classThreadContext.html">ThreadContext</a> *tc, int i, <a class="el" href="namespaceX86ISA.html#a0e080577527fb3e9685399f75b5caf15">X86ISA::IntReg</a> <a class="el" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>)</td></tr>
<tr><td colspan="2"><h2>Protected メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a35212370da5f0cb7e3b7ddfcea68bced">X86_64LiveProcess</a> (LiveProcessParams *params, <a class="el" href="classObjectFile.html">ObjectFile</a> *<a class="el" href="classLiveProcess.html#ab6cfcfa7903c66267b3e0351c3caa809">objFile</a>, <a class="el" href="classSyscallDesc.html">SyscallDesc</a> *_syscallDescs, int _numSyscallDescs)</td></tr>
<tr><td colspan="2"><h2>Protected 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html">VSyscallPage</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a></td></tr>
</table>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="a35212370da5f0cb7e3b7ddfcea68bced"></a><!-- doxytag: member="X86ISA::X86_64LiveProcess::X86_64LiveProcess" ref="a35212370da5f0cb7e3b7ddfcea68bced" args="(LiveProcessParams *params, ObjectFile *objFile, SyscallDesc *_syscallDescs, int _numSyscallDescs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html">X86_64LiveProcess</a> </td>
          <td>(</td>
          <td class="paramtype">LiveProcessParams *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classObjectFile.html">ObjectFile</a> *&nbsp;</td>
          <td class="paramname"> <em>objFile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSyscallDesc.html">SyscallDesc</a> *&nbsp;</td>
          <td class="paramname"> <em>_syscallDescs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>_numSyscallDescs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00094"></a>00094                               :
<a name="l00095"></a>00095     <a class="code" href="classX86ISA_1_1X86LiveProcess.html#a6a12433fc14d1afa3744abbe3c019b7b">X86LiveProcess</a>(<a class="code" href="classSimObject.html#acd3c3feb78ae7a8f88fe0f110a718dff">params</a>, objFile, _syscallDescs, _numSyscallDescs)
<a name="l00096"></a>00096 {
<a name="l00097"></a>00097 
<a name="l00098"></a>00098     <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#acbb25a86d519ae439e2d01ddb0b85357">base</a> = 0xffffffffff600000<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>;
<a name="l00099"></a>00099     <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#a8ce507144b5ef53350af753eafb669f0">size</a> = <a class="code" href="namespaceX86ISA.html#a891eaf95159d764e6efae501c2860a3a">VMPageSize</a>;
<a name="l00100"></a>00100     <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#a38977531bcb83545c3c54ab5e2edbb14">vtimeOffset</a> = 0x400;
<a name="l00101"></a>00101     <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#aa6dd91974e908006a2e736f7cc343abe">vgettimeofdayOffset</a> = 0x0;
<a name="l00102"></a>00102 
<a name="l00103"></a>00103     <span class="comment">// Set up stack. On X86_64 Linux, stack goes from the top of memory</span>
<a name="l00104"></a>00104     <span class="comment">// downward, less the hole for the kernel address space plus one page</span>
<a name="l00105"></a>00105     <span class="comment">// for undertermined purposes.</span>
<a name="l00106"></a>00106     <a class="code" href="classProcess.html#a9301d238f8ee69de69d9a608f23b0ee2">stack_base</a> = (<a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>)0x7FFFFFFFF000ULL;
<a name="l00107"></a>00107 
<a name="l00108"></a>00108     <span class="comment">// Set pointer for next thread stack.  Reserve 8M for main stack.</span>
<a name="l00109"></a>00109     <a class="code" href="classProcess.html#a55a3705006af6c58cba9f9a23ba89864">next_thread_stack_base</a> = <a class="code" href="classProcess.html#a9301d238f8ee69de69d9a608f23b0ee2">stack_base</a> - (8 * 1024 * 1024);
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <span class="comment">// Set up region for mmaps. This was determined empirically and may not</span>
<a name="l00112"></a>00112     <span class="comment">// always be correct.</span>
<a name="l00113"></a>00113     <a class="code" href="classProcess.html#a39ba573f8e6f0a0f33a82245af695ffc">mmap_start</a> = <a class="code" href="classProcess.html#a41a18edd0dbae5a7bb12e20a30c2e3e1">mmap_end</a> = (<a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>)0x2aaaaaaab000ULL;
<a name="l00114"></a>00114 }

</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a60e5314ffeede1e51c6bcb2cf606ca92"></a><!-- doxytag: member="X86ISA::X86_64LiveProcess::argsInit" ref="a60e5314ffeede1e51c6bcb2cf606ca92" args="(int intSize, int pageSize)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void argsInit </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>intSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pageSize</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00661"></a>00661 {
<a name="l00662"></a>00662     <a class="code" href="classstd_1_1vector.html">std::vector&lt;AuxVector&lt;uint64_t&gt;</a> &gt; extraAuxvs;
<a name="l00663"></a>00663     extraAuxvs.push_back(<a class="code" href="structAuxVector.html">AuxVector&lt;uint64_t&gt;</a>(<a class="code" href="namespaceX86ISA.html#a220a5701eb61c9715f2a66aa880d30b9abd0818adabbd02d06de1065979ec4691">M5_AT_SYSINFO_EHDR</a>,
<a name="l00664"></a>00664                 <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#acbb25a86d519ae439e2d01ddb0b85357">base</a>));
<a name="l00665"></a>00665     X86LiveProcess::argsInit&lt;uint64_t&gt;(pageSize, extraAuxvs);
<a name="l00666"></a>00666 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6f33c62983b3e68106d1cdb43b9fc09c"></a><!-- doxytag: member="X86ISA::X86_64LiveProcess::getSyscallArg" ref="a6f33c62983b3e68106d1cdb43b9fc09c" args="(ThreadContext *tc, int &amp;i)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceX86ISA.html#a0e080577527fb3e9685399f75b5caf15">X86ISA::IntReg</a> getSyscallArg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&nbsp;</td>
          <td class="paramname"> <em>i</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classLiveProcess.html#aa001ff57ec460026facb89ba19c7bf96">LiveProcess</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00688"></a>00688 {
<a name="l00689"></a>00689     assert(<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="arch_2x86_2process_8cc.html#afce5b087d1b866c8f91317e6ddbe62dd">NumArgumentRegs</a>);
<a name="l00690"></a>00690     <span class="keywordflow">return</span> tc-&gt;<a class="code" href="classThreadContext.html#af80734776d68e6acd48e22f6c999394a">readIntReg</a>(<a class="code" href="arch_2x86_2process_8cc.html#af2bb90a23fc27d090cab65b3ade30883">ArgumentReg</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++]);
<a name="l00691"></a>00691 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c34ea9b29f410748d4435a667484924"></a><!-- doxytag: member="X86ISA::X86_64LiveProcess::initState" ref="a3c34ea9b29f410748d4435a667484924" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initState </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a3c34ea9b29f410748d4435a667484924">initState()</a> is called on each <a class="el" href="classSimObject.html">SimObject</a> when *not* restoring from a checkpoint. This provides a hook for state initializations that are only required for a "cold start". </p>

<p><a class="el" href="classProcess.html#a3c34ea9b29f410748d4435a667484924">Process</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00163"></a>00163 {
<a name="l00164"></a>00164     <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a3c34ea9b29f410748d4435a667484924">X86LiveProcess::initState</a>();
<a name="l00165"></a>00165 
<a name="l00166"></a>00166     <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a60e5314ffeede1e51c6bcb2cf606ca92">argsInit</a>(<span class="keyword">sizeof</span>(uint64_t), <a class="code" href="namespaceX86ISA.html#a891eaf95159d764e6efae501c2860a3a">VMPageSize</a>);
<a name="l00167"></a>00167 
<a name="l00168"></a>00168        <span class="comment">// Set up the vsyscall page for this process.</span>
<a name="l00169"></a>00169     <a class="code" href="classProcess.html#aaebf8af407502fcc035e598795f77089">allocateMem</a>(<a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#acbb25a86d519ae439e2d01ddb0b85357">base</a>, <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#a8ce507144b5ef53350af753eafb669f0">size</a>);
<a name="l00170"></a>00170     uint8_t vtimeBlob[] = {
<a name="l00171"></a>00171         0x48,0xc7,0xc0,0xc9,0x00,0x00,0x00,    <span class="comment">// mov    $0xc9,%rax</span>
<a name="l00172"></a>00172         0x0f,0x05,                             <span class="comment">// syscall</span>
<a name="l00173"></a>00173         0xc3                                   <span class="comment">// retq</span>
<a name="l00174"></a>00174     };
<a name="l00175"></a>00175     <a class="code" href="classProcess.html#a280be1c93dee29cd2c6d5d1502c60a9b" title="Memory proxy for initialization (image loading).">initVirtMem</a>.<a class="code" href="classSETranslatingPortProxy.html#ad2a72c978fca534c6afc8b0f6ac2fe19">writeBlob</a>(<a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#acbb25a86d519ae439e2d01ddb0b85357">base</a> + <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#a38977531bcb83545c3c54ab5e2edbb14">vtimeOffset</a>,
<a name="l00176"></a>00176             vtimeBlob, <span class="keyword">sizeof</span>(vtimeBlob));
<a name="l00177"></a>00177 
<a name="l00178"></a>00178     uint8_t vgettimeofdayBlob[] = {
<a name="l00179"></a>00179         0x48,0xc7,0xc0,0x60,0x00,0x00,0x00,    <span class="comment">// mov    $0x60,%rax</span>
<a name="l00180"></a>00180         0x0f,0x05,                             <span class="comment">// syscall</span>
<a name="l00181"></a>00181         0xc3                                   <span class="comment">// retq</span>
<a name="l00182"></a>00182     };
<a name="l00183"></a>00183     <a class="code" href="classProcess.html#a280be1c93dee29cd2c6d5d1502c60a9b" title="Memory proxy for initialization (image loading).">initVirtMem</a>.<a class="code" href="classSETranslatingPortProxy.html#ad2a72c978fca534c6afc8b0f6ac2fe19">writeBlob</a>(<a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#acbb25a86d519ae439e2d01ddb0b85357">base</a> + <a class="code" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a>.<a class="code" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html#aa6dd91974e908006a2e736f7cc343abe">vgettimeofdayOffset</a>,
<a name="l00184"></a>00184             vgettimeofdayBlob, <span class="keyword">sizeof</span>(vgettimeofdayBlob));
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classProcess.html#a64a72121f39c3cbc68bb1b863c3f43ed">contextIds</a>.size(); <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>++) {
<a name="l00187"></a>00187         <a class="code" href="classThreadContext.html">ThreadContext</a> * <a class="code" href="namespaceArmISA.html#a5aff829af55e65b802d83dfcef4e9dd0">tc</a> = <a class="code" href="classProcess.html#af27ccd765f13a4b7bd119dc7579e2746">system</a>-&gt;<a class="code" href="classSystem.html#af349994bde91bd82c98f31e10c495cd1">getThreadContext</a>(<a class="code" href="classProcess.html#a64a72121f39c3cbc68bb1b863c3f43ed">contextIds</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>]);
<a name="l00188"></a>00188 
<a name="l00189"></a>00189         SegAttr dataAttr = 0;
<a name="l00190"></a>00190         dataAttr.dpl = 3;
<a name="l00191"></a>00191         dataAttr.unusable = 0;
<a name="l00192"></a>00192         dataAttr.defaultSize = 1;
<a name="l00193"></a>00193         dataAttr.longMode = 1;
<a name="l00194"></a>00194         dataAttr.avl = 0;
<a name="l00195"></a>00195         dataAttr.granularity = 1;
<a name="l00196"></a>00196         dataAttr.present = 1;
<a name="l00197"></a>00197         dataAttr.type = 3;
<a name="l00198"></a>00198         dataAttr.writable = 1;
<a name="l00199"></a>00199         dataAttr.readable = 1;
<a name="l00200"></a>00200         dataAttr.expandDown = 0;
<a name="l00201"></a>00201         dataAttr.system = 1;
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="comment">//Initialize the segment registers.</span>
<a name="l00204"></a>00204         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#a93006a29bcdfcda7fdda27c7deec6618">seg</a> = 0; <a class="code" href="namespaceX86ISA.html#a93006a29bcdfcda7fdda27c7deec6618">seg</a> &lt; <a class="code" href="namespaceX86ISA.html#acea32b07c2303d31296b1c07a16c4795a43afe462b4625cd9754dacd2f25c6bf6">NUM_SEGMENTREGS</a>; <a class="code" href="namespaceX86ISA.html#a93006a29bcdfcda7fdda27c7deec6618">seg</a>++) {
<a name="l00205"></a>00205             tc-&gt;<a class="code" href="classThreadContext.html#a2987c1ff22ebdf6cdf354a31462bdbfb">setMiscRegNoEffect</a>(<a class="code" href="namespaceX86ISA.html#a310d36d3d8ec55a84d807cb7e1edf7d6">MISCREG_SEG_BASE</a>(<a class="code" href="namespaceX86ISA.html#a93006a29bcdfcda7fdda27c7deec6618">seg</a>), 0);
<a name="l00206"></a>00206             tc-&gt;<a class="code" href="classThreadContext.html#a2987c1ff22ebdf6cdf354a31462bdbfb">setMiscRegNoEffect</a>(<a class="code" href="namespaceX86ISA.html#a48969e78833727c474e77163559d3cc0">MISCREG_SEG_EFF_BASE</a>(<a class="code" href="namespaceX86ISA.html#a93006a29bcdfcda7fdda27c7deec6618">seg</a>), 0);
<a name="l00207"></a>00207             tc-&gt;<a class="code" href="classThreadContext.html#a2987c1ff22ebdf6cdf354a31462bdbfb">setMiscRegNoEffect</a>(<a class="code" href="namespaceX86ISA.html#abb8ec3742a54286da349c98a1a9c9755">MISCREG_SEG_ATTR</a>(<a class="code" href="namespaceX86ISA.html#a93006a29bcdfcda7fdda27c7deec6618">seg</a>), dataAttr);
<a name="l00208"></a>00208         }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210         SegAttr csAttr = 0;
<a name="l00211"></a>00211         csAttr.dpl = 3;
<a name="l00212"></a>00212         csAttr.unusable = 0;
<a name="l00213"></a>00213         csAttr.defaultSize = 0;
<a name="l00214"></a>00214         csAttr.longMode = 1;
<a name="l00215"></a>00215         csAttr.avl = 0;
<a name="l00216"></a>00216         csAttr.granularity = 1;
<a name="l00217"></a>00217         csAttr.present = 1;
<a name="l00218"></a>00218         csAttr.type = 10;
<a name="l00219"></a>00219         csAttr.writable = 0;
<a name="l00220"></a>00220         csAttr.readable = 1;
<a name="l00221"></a>00221         csAttr.expandDown = 0;
<a name="l00222"></a>00222         csAttr.system = 1;
<a name="l00223"></a>00223 
<a name="l00224"></a>00224         tc-&gt;<a class="code" href="classThreadContext.html#a2987c1ff22ebdf6cdf354a31462bdbfb">setMiscRegNoEffect</a>(<a class="code" href="namespaceX86ISA.html#a1e522017e015d4c7efd6b2360143aa67ad82143ad6015ca412c3bed9eb748395c">MISCREG_CS_ATTR</a>, csAttr);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         Efer efer = 0;
<a name="l00227"></a>00227         efer.sce = 1; <span class="comment">// Enable system call extensions.</span>
<a name="l00228"></a>00228         efer.lme = 1; <span class="comment">// Enable long mode.</span>
<a name="l00229"></a>00229         efer.lma = 1; <span class="comment">// Activate long mode.</span>
<a name="l00230"></a>00230         efer.nxe = 1; <span class="comment">// Enable nx support.</span>
<a name="l00231"></a>00231         efer.svme = 0; <span class="comment">// Disable svm support for now. It isn&apos;t implemented.</span>
<a name="l00232"></a>00232         efer.ffxsr = 1; <span class="comment">// Turn on fast fxsave and fxrstor.</span>
<a name="l00233"></a>00233         tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceX86ISA.html#a1e522017e015d4c7efd6b2360143aa67ac2bc7bba381e618f344c3047d968f5a7">MISCREG_EFER</a>, efer);
<a name="l00234"></a>00234 
<a name="l00235"></a>00235         <span class="comment">//Set up the registers that describe the operating mode.</span>
<a name="l00236"></a>00236         CR0 cr0 = 0;
<a name="l00237"></a>00237         cr0.pg = 1; <span class="comment">// Turn on paging.</span>
<a name="l00238"></a>00238         cr0.cd = 0; <span class="comment">// Don&apos;t disable caching.</span>
<a name="l00239"></a>00239         cr0.nw = 0; <span class="comment">// This is bit is defined to be ignored.</span>
<a name="l00240"></a>00240         cr0.am = 0; <span class="comment">// No alignment checking</span>
<a name="l00241"></a>00241         cr0.wp = 0; <span class="comment">// Supervisor mode can write read only pages</span>
<a name="l00242"></a>00242         cr0.ne = 1;
<a name="l00243"></a>00243         cr0.et = 1; <span class="comment">// This should always be 1</span>
<a name="l00244"></a>00244         cr0.ts = 0; <span class="comment">// We don&apos;t do task switching, so causing fp exceptions</span>
<a name="l00245"></a>00245                     <span class="comment">// would be pointless.</span>
<a name="l00246"></a>00246         cr0.em = 0; <span class="comment">// Allow x87 instructions to execute natively.</span>
<a name="l00247"></a>00247         cr0.mp = 1; <span class="comment">// This doesn&apos;t really matter, but the manual suggests</span>
<a name="l00248"></a>00248                     <span class="comment">// setting it to one.</span>
<a name="l00249"></a>00249         cr0.pe = 1; <span class="comment">// We&apos;re definitely in protected mode.</span>
<a name="l00250"></a>00250         tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceX86ISA.html#a1e522017e015d4c7efd6b2360143aa67ada26b29c24bab13bc6d77060ba44fb33">MISCREG_CR0</a>, cr0);
<a name="l00251"></a>00251 
<a name="l00252"></a>00252         tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceX86ISA.html#a1e522017e015d4c7efd6b2360143aa67a7346c48560738adc54cb595c3cb544ea">MISCREG_MXCSR</a>, 0x1f80);
<a name="l00253"></a>00253     }
<a name="l00254"></a>00254 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a834e8e05416e3487f87d942259506abe"></a><!-- doxytag: member="X86ISA::X86_64LiveProcess::setSyscallArg" ref="a834e8e05416e3487f87d942259506abe" args="(ThreadContext *tc, int i, X86ISA::IntReg val)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setSyscallArg </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespaceX86ISA.html#a0e080577527fb3e9685399f75b5caf15">X86ISA::IntReg</a>&nbsp;</td>
          <td class="paramname"> <em>val</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00695"></a>00695 {
<a name="l00696"></a>00696     assert(<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="arch_2x86_2process_8cc.html#afce5b087d1b866c8f91317e6ddbe62dd">NumArgumentRegs</a>);
<a name="l00697"></a>00697     <span class="keywordflow">return</span> tc-&gt;<a class="code" href="classThreadContext.html#a995ac11ab79af59e135d473df10c72da">setIntReg</a>(<a class="code" href="arch_2x86_2process_8cc.html#af2bb90a23fc27d090cab65b3ade30883">ArgumentReg</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>], <a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>);
<a name="l00698"></a>00698 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a9f7ed190dd32bddc3f1074ce39168abd"></a><!-- doxytag: member="X86ISA::X86_64LiveProcess::vsyscallPage" ref="a9f7ed190dd32bddc3f1074ce39168abd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classX86ISA_1_1X86__64LiveProcess_1_1VSyscallPage.html">VSyscallPage</a> <a class="el" href="classX86ISA_1_1X86__64LiveProcess.html#a9f7ed190dd32bddc3f1074ce39168abd">vsyscallPage</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>arch/x86/<a class="el" href="arch_2x86_2process_8hh_source.html">process.hh</a></li>
<li>arch/x86/<a class="el" href="arch_2x86_2process_8cc.html">process.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
