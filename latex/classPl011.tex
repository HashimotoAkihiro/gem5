\hypertarget{classPl011}{
\section{クラス Pl011}
\label{classPl011}\index{Pl011@{Pl011}}
}


{\ttfamily \#include $<$pl011.hh$>$}Pl011に対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=8cm]{classPl011}
\end{center}
\end{figure}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
typedef Pl011Params \hyperlink{classPl011_a7c50120eadc91b7f8522e0e4f1398769}{Params}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
const \hyperlink{classPl011_a7c50120eadc91b7f8522e0e4f1398769}{Params} $\ast$ \hyperlink{classPl011_acd3c3feb78ae7a8f88fe0f110a718dff}{params} () const 
\item 
\hyperlink{classPl011_ade5d2e96a72a0f063620be79a21dd12e}{Pl011} (const \hyperlink{classPl011_a7c50120eadc91b7f8522e0e4f1398769}{Params} $\ast$p)
\item 
virtual \hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classPl011_a613ec7d5e1ec64f8d21fec78ae8e568e}{read} (\hyperlink{classPacket}{PacketPtr} pkt)
\item 
virtual \hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classPl011_a4cefab464e72b5dd42c003a0a4341802}{write} (\hyperlink{classPacket}{PacketPtr} pkt)
\item 
virtual void \hyperlink{classPl011_a603e184f4f31471b76cff54303262aa8}{dataAvailable} ()
\item 
virtual bool \hyperlink{classPl011_a57f9c26cb4108beccb35bb1938990932}{intStatus} ()
\item 
virtual void \hyperlink{classPl011_a53e036786d17361be4c7320d39c99b84}{serialize} (std::ostream \&os)
\item 
virtual void \hyperlink{classPl011_af22e5d6d660b97db37003ac61ac4ee49}{unserialize} (\hyperlink{classCheckpoint}{Checkpoint} $\ast$cp, const std::string \&section)
\end{DoxyCompactItemize}
\subsection*{Protected メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classPl011_a0afce67c547c76c56a13cfc7323fe124}{BitUnion16} (INTREG) Bitfield$<$ 0 $>$ rimim
\item 
\hyperlink{classPl011_a0b479d35b44ed7045fe0849fc06ee395}{EndBitUnion} (INTREG) INTREG imsc
\item 
void \hyperlink{classPl011_ab251ef5c4d9e1f0239542a9d8aa0dc3e}{generateInterrupt} ()
\end{DoxyCompactItemize}
\subsection*{Protected 変数}
\begin{DoxyCompactItemize}
\item 
uint16\_\-t \hyperlink{classPl011_a10e251ca482543ec4f81f4006b000aed}{control}
\item 
uint16\_\-t \hyperlink{classPl011_aa3ac821540cc12f9e0436651df0b1642}{fbrd}
\item 
uint16\_\-t \hyperlink{classPl011_a2be86c72c0a31f12141cb12224bc04b8}{ibrd}
\item 
uint16\_\-t \hyperlink{classPl011_a56614119b1851bb3386d42f108644601}{lcrh}
\item 
uint16\_\-t \hyperlink{classPl011_a832059b95a1d4d0dc403ccf467926370}{ifls}
\item 
Bitfield$<$ 1 $>$ \hyperlink{classPl011_ac6a6841bbd78ac1a329c8e1e6a6dd51b}{ctsmim}
\item 
Bitfield$<$ 2 $>$ \hyperlink{classPl011_a40464feb8779903fa2eb809556b2c537}{dcdmim}
\item 
Bitfield$<$ 3 $>$ \hyperlink{classPl011_abdf5197925837e4ab21e9342961419d6}{dsrmim}
\item 
Bitfield$<$ 4 $>$ \hyperlink{classPl011_a38bbcf2758baf4ae6295a663465f65ce}{rxim}
\item 
Bitfield$<$ 5 $>$ \hyperlink{classPl011_a36c89652928b36336c1a9d4957e2813b}{txim}
\item 
Bitfield$<$ 6 $>$ \hyperlink{classPl011_a1f3d61050228be20dfe8ed8b9b94090d}{rtim}
\item 
Bitfield$<$ 7 $>$ \hyperlink{classPl011_a705d2bcd8e859d1b15dd6e128533b295}{feim}
\item 
Bitfield$<$ 8 $>$ \hyperlink{classPl011_ab3404a9d5be230ce73a00d31bdf777a0}{peim}
\item 
Bitfield$<$ 9 $>$ \hyperlink{classPl011_a8a3f2c2dd111d2dffbb1c54cbdc11e48}{beim}
\item 
Bitfield$<$ 10 $>$ \hyperlink{classPl011_aea5955c20392fa25a1c7a1359bcfc123}{oeim}
\item 
Bitfield$<$ 15, 11 $>$ \hyperlink{classPl011_a996c37eb2080c15ad39204ff8bb4c6dd}{rsvd}
\item 
INTREG \hyperlink{classPl011_ae2da020b580eb106d7e66a6b058a9e6d}{rawInt}
\item 
INTREG \hyperlink{classPl011_adca828df6ee9e8b800f1b5b229476304}{maskInt}
\item 
int \hyperlink{classPl011_a9bd4d49b818d8cf1a6dee0576d2ff039}{intNum}
\item 
\hyperlink{classBaseGic}{BaseGic} $\ast$ \hyperlink{classPl011_a2e2266dca56928f63667e994933169ee}{gic}
\item 
bool \hyperlink{classPl011_aad163d2d82e9b9e707ca4da55b667c1e}{endOnEOT}
\item 
\hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{classPl011_a0dad0b6dbada03eb5daf9c1ed859d62e}{intDelay}
\item 
\hyperlink{classEventWrapper}{EventWrapper}$<$ \hyperlink{classPl011}{Pl011},\&Pl011::generateInterrupt $>$ \hyperlink{classPl011_a2d115d060cc035b8f10239e7bcc104f0}{intEvent}
\end{DoxyCompactItemize}
\subsection*{Static Protected 変数}
\begin{DoxyCompactItemize}
\item 
static const uint64\_\-t \hyperlink{classPl011_ae438dff5177bb7a98567cd94061edab4}{AMBA\_\-ID} = ULL(0xb105f00d00341011)
\item 
static const int \hyperlink{classPl011_af74662958d5fcdb285fdf0d3b167eaaa}{UART\_\-DR} = 0x000
\item 
static const int \hyperlink{classPl011_afc10d1e9648d43b45f74ab80f2fe0fd9}{UART\_\-FR} = 0x018
\item 
static const int \hyperlink{classPl011_a38ebcfd24146cdf0bf0988abdf067605}{UART\_\-FR\_\-CTS} = 0x001
\item 
static const int \hyperlink{classPl011_a425fb28a4829a73986a5c01ea46190f7}{UART\_\-FR\_\-TXFE} = 0x080
\item 
static const int \hyperlink{classPl011_aeaf4ab07df0ff276fbf18e8a61c82ec4}{UART\_\-FR\_\-RXFE} = 0x010
\item 
static const int \hyperlink{classPl011_ace2f31c665cd2161671782939a9e2f1c}{UART\_\-IBRD} = 0x024
\item 
static const int \hyperlink{classPl011_a53ef29b47cbfbab3001682bb55198786}{UART\_\-FBRD} = 0x028
\item 
static const int \hyperlink{classPl011_aedd23dee902f909a96497e6a46cfe4d1}{UART\_\-LCRH} = 0x02C
\item 
static const int \hyperlink{classPl011_a6d01092295215e1cb41f34d2ed083816}{UART\_\-CR} = 0x030
\item 
static const int \hyperlink{classPl011_acc821871663cd6db6ee0b11dd16937a7}{UART\_\-IFLS} = 0x034
\item 
static const int \hyperlink{classPl011_ac02f58b5ec88452b14e2f0f89e0172ee}{UART\_\-IMSC} = 0x038
\item 
static const int \hyperlink{classPl011_a3ae85c77ab71dda8e8249f9081be71d8}{UART\_\-RIS} = 0x03C
\item 
static const int \hyperlink{classPl011_a41e42222af27e9de2191fd946e13e55a}{UART\_\-MIS} = 0x040
\item 
static const int \hyperlink{classPl011_ae4724cf215001c72eac36b98b5a09787}{UART\_\-ICR} = 0x044
\end{DoxyCompactItemize}


\subsection{型定義}
\hypertarget{classPl011_a7c50120eadc91b7f8522e0e4f1398769}{
\index{Pl011@{Pl011}!Params@{Params}}
\index{Params@{Params}!Pl011@{Pl011}}
\subsubsection[{Params}]{\setlength{\rightskip}{0pt plus 5cm}typedef Pl011Params {\bf Params}}}
\label{classPl011_a7c50120eadc91b7f8522e0e4f1398769}


\hyperlink{classUart_a20a580db9778bd0604704c3c6baabfa6}{Uart}を再定義しています。

\subsection{コンストラクタとデストラクタ}
\hypertarget{classPl011_ade5d2e96a72a0f063620be79a21dd12e}{
\index{Pl011@{Pl011}!Pl011@{Pl011}}
\index{Pl011@{Pl011}!Pl011@{Pl011}}
\subsubsection[{Pl011}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Pl011} (const {\bf Params} $\ast$ {\em p})}}
\label{classPl011_ade5d2e96a72a0f063620be79a21dd12e}



\begin{DoxyCode}
55     : Uart(p, 0xfff), control(0x300), fbrd(0), ibrd(0), lcrh(0), ifls(0x12),
56       imsc(0), rawInt(0), maskInt(0), intNum(p->int_num), gic(p->gic),
57       endOnEOT(p->end_on_eot), intDelay(p->int_delay), intEvent(this)
58 {
59 }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classPl011_a0afce67c547c76c56a13cfc7323fe124}{
\index{Pl011@{Pl011}!BitUnion16@{BitUnion16}}
\index{BitUnion16@{BitUnion16}!Pl011@{Pl011}}
\subsubsection[{BitUnion16}]{\setlength{\rightskip}{0pt plus 5cm}BitUnion16 (INTREG)\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a0afce67c547c76c56a13cfc7323fe124}
\hypertarget{classPl011_a603e184f4f31471b76cff54303262aa8}{
\index{Pl011@{Pl011}!dataAvailable@{dataAvailable}}
\index{dataAvailable@{dataAvailable}!Pl011@{Pl011}}
\subsubsection[{dataAvailable}]{\setlength{\rightskip}{0pt plus 5cm}void dataAvailable ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classPl011_a603e184f4f31471b76cff54303262aa8}
Inform the uart that there is data available. 

\hyperlink{classUart_a8e0026e4db90ce7efbddf2835f411b0b}{Uart}を実装しています。


\begin{DoxyCode}
252 {
253     /*@todo ignore the fifo, just say we have data now
254      * We might want to fix this, or we might not care */
255     rawInt.rxim = 1;
256     rawInt.rtim = 1;
257 
258     DPRINTF(Uart, "Data available, scheduling interrupt\n");
259 
260     if (!intEvent.scheduled())
261         schedule(intEvent, curTick() + intDelay);
262 }
\end{DoxyCode}
\hypertarget{classPl011_a0b479d35b44ed7045fe0849fc06ee395}{
\index{Pl011@{Pl011}!EndBitUnion@{EndBitUnion}}
\index{EndBitUnion@{EndBitUnion}!Pl011@{Pl011}}
\subsubsection[{EndBitUnion}]{\setlength{\rightskip}{0pt plus 5cm}EndBitUnion (INTREG)\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a0b479d35b44ed7045fe0849fc06ee395}
interrupt mask register. \hypertarget{classPl011_ab251ef5c4d9e1f0239542a9d8aa0dc3e}{
\index{Pl011@{Pl011}!generateInterrupt@{generateInterrupt}}
\index{generateInterrupt@{generateInterrupt}!Pl011@{Pl011}}
\subsubsection[{generateInterrupt}]{\setlength{\rightskip}{0pt plus 5cm}void generateInterrupt ()\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_ab251ef5c4d9e1f0239542a9d8aa0dc3e}
Function to generate interrupt 


\begin{DoxyCode}
266 {
267     DPRINTF(Uart, "Generate Interrupt: imsc=0x%x rawInt=0x%x maskInt=0x%x\n",
268             imsc, rawInt, maskInt);
269     maskInt = imsc & rawInt;
270 
271     if (maskInt.rxim || maskInt.rtim || maskInt.txim) {
272         gic->sendInt(intNum);
273         DPRINTF(Uart, " -- Generated\n");
274     }
275 
276 }
\end{DoxyCode}
\hypertarget{classPl011_a57f9c26cb4108beccb35bb1938990932}{
\index{Pl011@{Pl011}!intStatus@{intStatus}}
\index{intStatus@{intStatus}!Pl011@{Pl011}}
\subsubsection[{intStatus}]{\setlength{\rightskip}{0pt plus 5cm}virtual bool intStatus ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classPl011_a57f9c26cb4108beccb35bb1938990932}
Return if we have an interrupt pending \begin{DoxyReturn}{戻り値}
interrupt status 
\end{DoxyReturn}
\begin{Desc}
\item[\hyperlink{todo__todo000056}{TODO}]fix me when implementation improves \end{Desc}


\hyperlink{classUart_a73c7d9c634e4c31cda71a6dd2fa67381}{Uart}を再定義しています。


\begin{DoxyCode}
162 { return false; }
\end{DoxyCode}
\hypertarget{classPl011_acd3c3feb78ae7a8f88fe0f110a718dff}{
\index{Pl011@{Pl011}!params@{params}}
\index{params@{params}!Pl011@{Pl011}}
\subsubsection[{params}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Params}$\ast$ params () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classPl011_acd3c3feb78ae7a8f88fe0f110a718dff}


\hyperlink{classUart_acd3c3feb78ae7a8f88fe0f110a718dff}{Uart}を再定義しています。


\begin{DoxyCode}
143     {
144         return dynamic_cast<const Params *>(_params);
145     }
\end{DoxyCode}
\hypertarget{classPl011_a613ec7d5e1ec64f8d21fec78ae8e568e}{
\index{Pl011@{Pl011}!read@{read}}
\index{read@{read}!Pl011@{Pl011}}
\subsubsection[{read}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} read ({\bf PacketPtr} {\em pkt})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classPl011_a613ec7d5e1ec64f8d21fec78ae8e568e}
Pure virtual function that the device must implement. Called when a read command is recieved by the port. 
\begin{DoxyParams}{引数}
\item[{\em pkt}]\hyperlink{classPacket}{Packet} describing this request \end{DoxyParams}
\begin{DoxyReturn}{戻り値}
number of ticks it took to complete 
\end{DoxyReturn}


\hyperlink{classPioDevice_a842312590432036092c422c87a442358}{PioDevice}を実装しています。


\begin{DoxyCode}
63 {
64     assert(pkt->getAddr() >= pioAddr && pkt->getAddr() < pioAddr + pioSize);
65 
66     Addr daddr = pkt->getAddr() - pioAddr;
67     pkt->allocate();
68 
69     DPRINTF(Uart, " read register %#x size=%d\n", daddr, pkt->getSize());
70 
71     // use a temporary data since the uart registers are read/written with
72     // different size operations
73     //
74     uint32_t data = 0;
75 
76     switch(daddr) {
77       case UART_DR:
78         data = 0;
79         if (term->dataAvailable())
80             data = term->in();
81         break;
82       case UART_FR:
83         // For now we're infintely fast, so TX is never full, always empty,
84         // always clear to send
85         data = UART_FR_TXFE | UART_FR_CTS;
86         if (!term->dataAvailable())
87             data |= UART_FR_RXFE;
88         DPRINTF(Uart, "Reading FR register as %#x rawInt=0x%x imsc=0x%x maskInt=0
      x%x\n",
89                 data, rawInt, imsc, maskInt);
90         break;
91       case UART_CR:
92         data = control;
93         break;
94       case UART_IBRD:
95         data = ibrd;
96         break;
97       case UART_FBRD:
98         data = fbrd;
99         break;
100       case UART_LCRH:
101         data = lcrh;
102         break;
103       case UART_IFLS:
104         data = ifls;
105         break;
106       case UART_IMSC:
107         data = imsc;
108         break;
109       case UART_RIS:
110         data = rawInt;
111         DPRINTF(Uart, "Reading Raw Int status as 0x%x\n", rawInt);
112         break;
113       case UART_MIS:
114         DPRINTF(Uart, "Reading Masked Int status as 0x%x\n", rawInt);
115         data = maskInt;
116         break;
117       default:
118         if (readId(pkt, AMBA_ID, pioAddr)) {
119             // Hack for variable size accesses
120             data = pkt->get<uint32_t>();
121             break;
122         }
123 
124         panic("Tried to read PL011 at offset %#x that doesn't exist\n", daddr);
125         break;
126     }
127 
128     switch(pkt->getSize()) {
129       case 1:
130         pkt->set<uint8_t>(data);
131         break;
132       case 2:
133         pkt->set<uint16_t>(data);
134         break;
135       case 4:
136         pkt->set<uint32_t>(data);
137         break;
138       default:
139         panic("Uart read size too big?\n");
140         break;
141     }
142 
143 
144     pkt->makeAtomicResponse();
145     return pioDelay;
146 }
\end{DoxyCode}
\hypertarget{classPl011_a53e036786d17361be4c7320d39c99b84}{
\index{Pl011@{Pl011}!serialize@{serialize}}
\index{serialize@{serialize}!Pl011@{Pl011}}
\subsubsection[{serialize}]{\setlength{\rightskip}{0pt plus 5cm}void serialize (std::ostream \& {\em os})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classPl011_a53e036786d17361be4c7320d39c99b84}


\hyperlink{classSerializable_ad6272f80ae37e8331e3969b3f072a801}{Serializable}を再定義しています。


\begin{DoxyCode}
282 {
283     DPRINTF(Checkpoint, "Serializing Arm PL011\n");
284     SERIALIZE_SCALAR(control);
285     SERIALIZE_SCALAR(fbrd);
286     SERIALIZE_SCALAR(ibrd);
287     SERIALIZE_SCALAR(lcrh);
288     SERIALIZE_SCALAR(ifls);
289 
290     uint16_t imsc_serial = imsc;
291     SERIALIZE_SCALAR(imsc_serial);
292 
293     uint16_t rawInt_serial = rawInt;
294     SERIALIZE_SCALAR(rawInt_serial);
295 
296     uint16_t maskInt_serial = maskInt;
297     SERIALIZE_SCALAR(maskInt_serial);
298 
299     SERIALIZE_SCALAR(endOnEOT);
300     SERIALIZE_SCALAR(intDelay);
301 }
\end{DoxyCode}
\hypertarget{classPl011_af22e5d6d660b97db37003ac61ac4ee49}{
\index{Pl011@{Pl011}!unserialize@{unserialize}}
\index{unserialize@{unserialize}!Pl011@{Pl011}}
\subsubsection[{unserialize}]{\setlength{\rightskip}{0pt plus 5cm}void unserialize ({\bf Checkpoint} $\ast$ {\em cp}, \/  const std::string \& {\em section})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classPl011_af22e5d6d660b97db37003ac61ac4ee49}


\hyperlink{classSerializable_af100c4e9feabf3cd918619c88c718387}{Serializable}を再定義しています。


\begin{DoxyCode}
305 {
306     DPRINTF(Checkpoint, "Unserializing Arm PL011\n");
307 
308     UNSERIALIZE_SCALAR(control);
309     UNSERIALIZE_SCALAR(fbrd);
310     UNSERIALIZE_SCALAR(ibrd);
311     UNSERIALIZE_SCALAR(lcrh);
312     UNSERIALIZE_SCALAR(ifls);
313 
314     uint16_t imsc_serial;
315     UNSERIALIZE_SCALAR(imsc_serial);
316     imsc = imsc_serial;
317 
318     uint16_t rawInt_serial;
319     UNSERIALIZE_SCALAR(rawInt_serial);
320     rawInt = rawInt_serial;
321 
322     uint16_t maskInt_serial;
323     UNSERIALIZE_SCALAR(maskInt_serial);
324     maskInt = maskInt_serial;
325 
326     UNSERIALIZE_SCALAR(endOnEOT);
327     UNSERIALIZE_SCALAR(intDelay);
328 }
\end{DoxyCode}
\hypertarget{classPl011_a4cefab464e72b5dd42c003a0a4341802}{
\index{Pl011@{Pl011}!write@{write}}
\index{write@{write}!Pl011@{Pl011}}
\subsubsection[{write}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} write ({\bf PacketPtr} {\em pkt})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classPl011_a4cefab464e72b5dd42c003a0a4341802}
Pure virtual function that the device must implement. Called when a write command is recieved by the port. 
\begin{DoxyParams}{引数}
\item[{\em pkt}]\hyperlink{classPacket}{Packet} describing this request \end{DoxyParams}
\begin{DoxyReturn}{戻り値}
number of ticks it took to complete 
\end{DoxyReturn}


\hyperlink{classPioDevice_afe8371668d023bb2516b286e5e399b6f}{PioDevice}を実装しています。


\begin{DoxyCode}
150 {
151 
152     assert(pkt->getAddr() >= pioAddr && pkt->getAddr() < pioAddr + pioSize);
153 
154     Addr daddr = pkt->getAddr() - pioAddr;
155 
156     DPRINTF(Uart, " write register %#x value %#x size=%d\n", daddr,
157             pkt->get<uint8_t>(), pkt->getSize());
158 
159     // use a temporary data since the uart registers are read/written with
160     // different size operations
161     //
162     uint32_t data = 0;
163 
164     switch(pkt->getSize()) {
165       case 1:
166         data = pkt->get<uint8_t>();
167         break;
168       case 2:
169         data = pkt->get<uint16_t>();
170         break;
171       case 4:
172         data = pkt->get<uint32_t>();
173         break;
174       default:
175         panic("Uart write size too big?\n");
176         break;
177     }
178 
179 
180     switch (daddr) {
181         case UART_DR:
182           if ((data & 0xFF) == 0x04 && endOnEOT)
183             exitSimLoop("UART received EOT", 0);
184 
185         term->out(data & 0xFF);
186 
187         //raw interrupt is set regardless of imsc.txim
188         rawInt.txim = 1;
189         if (imsc.txim) {
190             DPRINTF(Uart, "TX int enabled, scheduling interruptt\n");
191             if (!intEvent.scheduled())
192                 schedule(intEvent, curTick() + intDelay);
193         }
194 
195         break;
196       case UART_CR:
197         control = data;
198         break;
199       case UART_IBRD:
200         ibrd = data;
201         break;
202       case UART_FBRD:
203         fbrd = data;
204         break;
205       case UART_LCRH:
206         lcrh = data;
207         break;
208       case UART_IFLS:
209         ifls = data;
210         break;
211       case UART_IMSC:
212         imsc = data;
213 
214         if (imsc.feim || imsc.peim || imsc.beim || imsc.oeim || imsc.rsvd)
215             panic("Unknown interrupt enabled\n");
216 
217         // rimim, ctsmim, dcdmim, dsrmim can be enabled but are ignored
218         // they are supposed to interrupt on a change of status in the line
219         // which we should never have since our terminal is happy to always
220         // receive bytes.
221 
222         if (imsc.txim) {
223             DPRINTF(Uart, "Writing to IMSC: TX int enabled, scheduling interruptt
      \n");
224             rawInt.txim = 1;
225             if (!intEvent.scheduled())
226                 schedule(intEvent, curTick() + intDelay);
227         }
228 
229         break;
230 
231       case UART_ICR:
232         DPRINTF(Uart, "Clearing interrupts 0x%x\n", data);
233         rawInt = rawInt & ~data;
234         maskInt = rawInt & imsc;
235 
236         DPRINTF(Uart, " -- Masked interrupts 0x%x\n", maskInt);
237 
238         if (!maskInt)
239             gic->clearInt(intNum);
240 
241         break;
242       default:
243         panic("Tried to write PL011 at offset %#x that doesn't exist\n", daddr);
244         break;
245     }
246     pkt->makeAtomicResponse();
247     return pioDelay;
248 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classPl011_ae438dff5177bb7a98567cd94061edab4}{
\index{Pl011@{Pl011}!AMBA\_\-ID@{AMBA\_\-ID}}
\index{AMBA\_\-ID@{AMBA\_\-ID}!Pl011@{Pl011}}
\subsubsection[{AMBA\_\-ID}]{\setlength{\rightskip}{0pt plus 5cm}const uint64\_\-t {\bf AMBA\_\-ID} = ULL(0xb105f00d00341011)\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_ae438dff5177bb7a98567cd94061edab4}
\hypertarget{classPl011_a8a3f2c2dd111d2dffbb1c54cbdc11e48}{
\index{Pl011@{Pl011}!beim@{beim}}
\index{beim@{beim}!Pl011@{Pl011}}
\subsubsection[{beim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$9$>$ {\bf beim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a8a3f2c2dd111d2dffbb1c54cbdc11e48}
\hypertarget{classPl011_a10e251ca482543ec4f81f4006b000aed}{
\index{Pl011@{Pl011}!control@{control}}
\index{control@{control}!Pl011@{Pl011}}
\subsubsection[{control}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t {\bf control}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a10e251ca482543ec4f81f4006b000aed}
\hypertarget{classPl011_ac6a6841bbd78ac1a329c8e1e6a6dd51b}{
\index{Pl011@{Pl011}!ctsmim@{ctsmim}}
\index{ctsmim@{ctsmim}!Pl011@{Pl011}}
\subsubsection[{ctsmim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$1$>$ {\bf ctsmim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_ac6a6841bbd78ac1a329c8e1e6a6dd51b}
\hypertarget{classPl011_a40464feb8779903fa2eb809556b2c537}{
\index{Pl011@{Pl011}!dcdmim@{dcdmim}}
\index{dcdmim@{dcdmim}!Pl011@{Pl011}}
\subsubsection[{dcdmim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$2$>$ {\bf dcdmim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a40464feb8779903fa2eb809556b2c537}
\hypertarget{classPl011_abdf5197925837e4ab21e9342961419d6}{
\index{Pl011@{Pl011}!dsrmim@{dsrmim}}
\index{dsrmim@{dsrmim}!Pl011@{Pl011}}
\subsubsection[{dsrmim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$3$>$ {\bf dsrmim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_abdf5197925837e4ab21e9342961419d6}
\hypertarget{classPl011_aad163d2d82e9b9e707ca4da55b667c1e}{
\index{Pl011@{Pl011}!endOnEOT@{endOnEOT}}
\index{endOnEOT@{endOnEOT}!Pl011@{Pl011}}
\subsubsection[{endOnEOT}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf endOnEOT}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_aad163d2d82e9b9e707ca4da55b667c1e}
Should the simulation end on an EOT \hypertarget{classPl011_aa3ac821540cc12f9e0436651df0b1642}{
\index{Pl011@{Pl011}!fbrd@{fbrd}}
\index{fbrd@{fbrd}!Pl011@{Pl011}}
\subsubsection[{fbrd}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t {\bf fbrd}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_aa3ac821540cc12f9e0436651df0b1642}
fractional baud rate divisor. Not used for anything but reporting written value \hypertarget{classPl011_a705d2bcd8e859d1b15dd6e128533b295}{
\index{Pl011@{Pl011}!feim@{feim}}
\index{feim@{feim}!Pl011@{Pl011}}
\subsubsection[{feim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$7$>$ {\bf feim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a705d2bcd8e859d1b15dd6e128533b295}
\hypertarget{classPl011_a2e2266dca56928f63667e994933169ee}{
\index{Pl011@{Pl011}!gic@{gic}}
\index{gic@{gic}!Pl011@{Pl011}}
\subsubsection[{gic}]{\setlength{\rightskip}{0pt plus 5cm}{\bf BaseGic}$\ast$ {\bf gic}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a2e2266dca56928f63667e994933169ee}
\hyperlink{namespaceGic}{Gic} to use for interrupting \hypertarget{classPl011_a2be86c72c0a31f12141cb12224bc04b8}{
\index{Pl011@{Pl011}!ibrd@{ibrd}}
\index{ibrd@{ibrd}!Pl011@{Pl011}}
\subsubsection[{ibrd}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t {\bf ibrd}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a2be86c72c0a31f12141cb12224bc04b8}
integer baud rate divisor. Not used for anything but reporting written value \hypertarget{classPl011_a832059b95a1d4d0dc403ccf467926370}{
\index{Pl011@{Pl011}!ifls@{ifls}}
\index{ifls@{ifls}!Pl011@{Pl011}}
\subsubsection[{ifls}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t {\bf ifls}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a832059b95a1d4d0dc403ccf467926370}
interrupt fifo level register. Not used for anything but reporting written value \hypertarget{classPl011_a0dad0b6dbada03eb5daf9c1ed859d62e}{
\index{Pl011@{Pl011}!intDelay@{intDelay}}
\index{intDelay@{intDelay}!Pl011@{Pl011}}
\subsubsection[{intDelay}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} {\bf intDelay}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a0dad0b6dbada03eb5daf9c1ed859d62e}
Delay before interrupting \hypertarget{classPl011_a2d115d060cc035b8f10239e7bcc104f0}{
\index{Pl011@{Pl011}!intEvent@{intEvent}}
\index{intEvent@{intEvent}!Pl011@{Pl011}}
\subsubsection[{intEvent}]{\setlength{\rightskip}{0pt plus 5cm}{\bf EventWrapper}$<${\bf Pl011}, \&Pl011::generateInterrupt$>$ {\bf intEvent}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a2d115d060cc035b8f10239e7bcc104f0}
Wrapper to create an event out of the thing \hypertarget{classPl011_a9bd4d49b818d8cf1a6dee0576d2ff039}{
\index{Pl011@{Pl011}!intNum@{intNum}}
\index{intNum@{intNum}!Pl011@{Pl011}}
\subsubsection[{intNum}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf intNum}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a9bd4d49b818d8cf1a6dee0576d2ff039}
Interrupt number to generate \hypertarget{classPl011_a56614119b1851bb3386d42f108644601}{
\index{Pl011@{Pl011}!lcrh@{lcrh}}
\index{lcrh@{lcrh}!Pl011@{Pl011}}
\subsubsection[{lcrh}]{\setlength{\rightskip}{0pt plus 5cm}uint16\_\-t {\bf lcrh}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a56614119b1851bb3386d42f108644601}
Line control register. Not used for anything but reporting written value \hypertarget{classPl011_adca828df6ee9e8b800f1b5b229476304}{
\index{Pl011@{Pl011}!maskInt@{maskInt}}
\index{maskInt@{maskInt}!Pl011@{Pl011}}
\subsubsection[{maskInt}]{\setlength{\rightskip}{0pt plus 5cm}INTREG {\bf maskInt}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_adca828df6ee9e8b800f1b5b229476304}
Masked interrupt status register \hypertarget{classPl011_aea5955c20392fa25a1c7a1359bcfc123}{
\index{Pl011@{Pl011}!oeim@{oeim}}
\index{oeim@{oeim}!Pl011@{Pl011}}
\subsubsection[{oeim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$10$>$ {\bf oeim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_aea5955c20392fa25a1c7a1359bcfc123}
\hypertarget{classPl011_ab3404a9d5be230ce73a00d31bdf777a0}{
\index{Pl011@{Pl011}!peim@{peim}}
\index{peim@{peim}!Pl011@{Pl011}}
\subsubsection[{peim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$8$>$ {\bf peim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_ab3404a9d5be230ce73a00d31bdf777a0}
\hypertarget{classPl011_ae2da020b580eb106d7e66a6b058a9e6d}{
\index{Pl011@{Pl011}!rawInt@{rawInt}}
\index{rawInt@{rawInt}!Pl011@{Pl011}}
\subsubsection[{rawInt}]{\setlength{\rightskip}{0pt plus 5cm}INTREG {\bf rawInt}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_ae2da020b580eb106d7e66a6b058a9e6d}
raw interrupt status register \hypertarget{classPl011_a996c37eb2080c15ad39204ff8bb4c6dd}{
\index{Pl011@{Pl011}!rsvd@{rsvd}}
\index{rsvd@{rsvd}!Pl011@{Pl011}}
\subsubsection[{rsvd}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$15,11$>$ {\bf rsvd}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a996c37eb2080c15ad39204ff8bb4c6dd}
\hypertarget{classPl011_a1f3d61050228be20dfe8ed8b9b94090d}{
\index{Pl011@{Pl011}!rtim@{rtim}}
\index{rtim@{rtim}!Pl011@{Pl011}}
\subsubsection[{rtim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$6$>$ {\bf rtim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a1f3d61050228be20dfe8ed8b9b94090d}
\hypertarget{classPl011_a38bbcf2758baf4ae6295a663465f65ce}{
\index{Pl011@{Pl011}!rxim@{rxim}}
\index{rxim@{rxim}!Pl011@{Pl011}}
\subsubsection[{rxim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$4$>$ {\bf rxim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a38bbcf2758baf4ae6295a663465f65ce}
\hypertarget{classPl011_a36c89652928b36336c1a9d4957e2813b}{
\index{Pl011@{Pl011}!txim@{txim}}
\index{txim@{txim}!Pl011@{Pl011}}
\subsubsection[{txim}]{\setlength{\rightskip}{0pt plus 5cm}Bitfield$<$5$>$ {\bf txim}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classPl011_a36c89652928b36336c1a9d4957e2813b}
\hypertarget{classPl011_a6d01092295215e1cb41f34d2ed083816}{
\index{Pl011@{Pl011}!UART\_\-CR@{UART\_\-CR}}
\index{UART\_\-CR@{UART\_\-CR}!Pl011@{Pl011}}
\subsubsection[{UART\_\-CR}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-CR} = 0x030\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_a6d01092295215e1cb41f34d2ed083816}
\hypertarget{classPl011_af74662958d5fcdb285fdf0d3b167eaaa}{
\index{Pl011@{Pl011}!UART\_\-DR@{UART\_\-DR}}
\index{UART\_\-DR@{UART\_\-DR}!Pl011@{Pl011}}
\subsubsection[{UART\_\-DR}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-DR} = 0x000\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_af74662958d5fcdb285fdf0d3b167eaaa}
\hypertarget{classPl011_a53ef29b47cbfbab3001682bb55198786}{
\index{Pl011@{Pl011}!UART\_\-FBRD@{UART\_\-FBRD}}
\index{UART\_\-FBRD@{UART\_\-FBRD}!Pl011@{Pl011}}
\subsubsection[{UART\_\-FBRD}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-FBRD} = 0x028\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_a53ef29b47cbfbab3001682bb55198786}
\hypertarget{classPl011_afc10d1e9648d43b45f74ab80f2fe0fd9}{
\index{Pl011@{Pl011}!UART\_\-FR@{UART\_\-FR}}
\index{UART\_\-FR@{UART\_\-FR}!Pl011@{Pl011}}
\subsubsection[{UART\_\-FR}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-FR} = 0x018\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_afc10d1e9648d43b45f74ab80f2fe0fd9}
\hypertarget{classPl011_a38ebcfd24146cdf0bf0988abdf067605}{
\index{Pl011@{Pl011}!UART\_\-FR\_\-CTS@{UART\_\-FR\_\-CTS}}
\index{UART\_\-FR\_\-CTS@{UART\_\-FR\_\-CTS}!Pl011@{Pl011}}
\subsubsection[{UART\_\-FR\_\-CTS}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-FR\_\-CTS} = 0x001\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_a38ebcfd24146cdf0bf0988abdf067605}
\hypertarget{classPl011_aeaf4ab07df0ff276fbf18e8a61c82ec4}{
\index{Pl011@{Pl011}!UART\_\-FR\_\-RXFE@{UART\_\-FR\_\-RXFE}}
\index{UART\_\-FR\_\-RXFE@{UART\_\-FR\_\-RXFE}!Pl011@{Pl011}}
\subsubsection[{UART\_\-FR\_\-RXFE}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-FR\_\-RXFE} = 0x010\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_aeaf4ab07df0ff276fbf18e8a61c82ec4}
\hypertarget{classPl011_a425fb28a4829a73986a5c01ea46190f7}{
\index{Pl011@{Pl011}!UART\_\-FR\_\-TXFE@{UART\_\-FR\_\-TXFE}}
\index{UART\_\-FR\_\-TXFE@{UART\_\-FR\_\-TXFE}!Pl011@{Pl011}}
\subsubsection[{UART\_\-FR\_\-TXFE}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-FR\_\-TXFE} = 0x080\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_a425fb28a4829a73986a5c01ea46190f7}
\hypertarget{classPl011_ace2f31c665cd2161671782939a9e2f1c}{
\index{Pl011@{Pl011}!UART\_\-IBRD@{UART\_\-IBRD}}
\index{UART\_\-IBRD@{UART\_\-IBRD}!Pl011@{Pl011}}
\subsubsection[{UART\_\-IBRD}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-IBRD} = 0x024\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_ace2f31c665cd2161671782939a9e2f1c}
\hypertarget{classPl011_ae4724cf215001c72eac36b98b5a09787}{
\index{Pl011@{Pl011}!UART\_\-ICR@{UART\_\-ICR}}
\index{UART\_\-ICR@{UART\_\-ICR}!Pl011@{Pl011}}
\subsubsection[{UART\_\-ICR}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-ICR} = 0x044\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_ae4724cf215001c72eac36b98b5a09787}
\hypertarget{classPl011_acc821871663cd6db6ee0b11dd16937a7}{
\index{Pl011@{Pl011}!UART\_\-IFLS@{UART\_\-IFLS}}
\index{UART\_\-IFLS@{UART\_\-IFLS}!Pl011@{Pl011}}
\subsubsection[{UART\_\-IFLS}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-IFLS} = 0x034\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_acc821871663cd6db6ee0b11dd16937a7}
\hypertarget{classPl011_ac02f58b5ec88452b14e2f0f89e0172ee}{
\index{Pl011@{Pl011}!UART\_\-IMSC@{UART\_\-IMSC}}
\index{UART\_\-IMSC@{UART\_\-IMSC}!Pl011@{Pl011}}
\subsubsection[{UART\_\-IMSC}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-IMSC} = 0x038\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_ac02f58b5ec88452b14e2f0f89e0172ee}
\hypertarget{classPl011_aedd23dee902f909a96497e6a46cfe4d1}{
\index{Pl011@{Pl011}!UART\_\-LCRH@{UART\_\-LCRH}}
\index{UART\_\-LCRH@{UART\_\-LCRH}!Pl011@{Pl011}}
\subsubsection[{UART\_\-LCRH}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-LCRH} = 0x02C\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_aedd23dee902f909a96497e6a46cfe4d1}
\hypertarget{classPl011_a41e42222af27e9de2191fd946e13e55a}{
\index{Pl011@{Pl011}!UART\_\-MIS@{UART\_\-MIS}}
\index{UART\_\-MIS@{UART\_\-MIS}!Pl011@{Pl011}}
\subsubsection[{UART\_\-MIS}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-MIS} = 0x040\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_a41e42222af27e9de2191fd946e13e55a}
\hypertarget{classPl011_a3ae85c77ab71dda8e8249f9081be71d8}{
\index{Pl011@{Pl011}!UART\_\-RIS@{UART\_\-RIS}}
\index{UART\_\-RIS@{UART\_\-RIS}!Pl011@{Pl011}}
\subsubsection[{UART\_\-RIS}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf UART\_\-RIS} = 0x03C\hspace{0.3cm}{\ttfamily  \mbox{[}static, protected\mbox{]}}}}
\label{classPl011_a3ae85c77ab71dda8e8249f9081be71d8}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
dev/arm/\hyperlink{pl011_8hh}{pl011.hh}\item 
dev/arm/\hyperlink{pl011_8cc}{pl011.cc}\end{DoxyCompactItemize}
