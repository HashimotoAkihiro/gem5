<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス MessageBuffer</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス MessageBuffer</h1><!-- doxytag: class="MessageBuffer" -->
<p><code>#include &lt;<a class="el" href="MessageBuffer_8hh_source.html">MessageBuffer.hh</a>&gt;</code></p>

<p><a href="classMessageBuffer-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a3ab015b49b89f6f1e8c9facc8441976f">MessageBuffer</a> (const std::string &amp;name=&quot;&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ad9be4b0fe9efff18c2e56a1705d99918">setRecycleLatency</a> (<a class="el" href="classCycles.html">Cycles</a> recycle_latency)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac8fc02d2f80c73a67e76577139daaaf9">reanalyzeMessages</a> (const <a class="el" href="classAddress.html">Address</a> &amp;addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#adfdac0293f076193ea9e70b12b54ecbe">reanalyzeAllMessages</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#abef10942dc67e1641651a1f9542b7303">stallMessage</a> (const <a class="el" href="classAddress.html">Address</a> &amp;addr)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac12eec09d47a89a1ddf3eb6bb19b5bd3">isReady</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ae20106ccbc4569ff9474570932956f7f">delayHead</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a3164aa5c5bbbd31b6b1963ef9c90756f">areNSlotsAvailable</a> (unsigned int n)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a8e1ac3494e27c30441640926f0f07b6f">getPriority</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a6f56c404ece2826d0b11ad759fdf0fb4">setPriority</a> (int rank)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a81e888318cb316e49e3b6c9989970bb0">setConsumer</a> (<a class="el" href="classConsumer.html">Consumer</a> *consumer)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a0a949993188bb0d51b80b714be944447">setSender</a> (<a class="el" href="classClockedObject.html">ClockedObject</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a1fbc695c465cc14aeb497a623951ba6d">setReceiver</a> (<a class="el" href="classClockedObject.html">ClockedObject</a> *obj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a9cdbe64eebafb111a124edec55ed2340">setDescription</a> (const std::string &amp;name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a73da75c3e5ec30855a02eae2ba824e38">getDescription</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classConsumer.html">Consumer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a2417fc7252a612b5c976ceaa2d1be4f7">getConsumer</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classMessage.html">Message</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a5e133f7f4632eccf4bb7145962bc89ca">peek</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const <a class="el" href="classRefCountingPtr.html">MsgPtr</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#add248ff5db7f0e5dac1501da94c4c83e">peekMsgPtr</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a3e66951ea4f67cc6837309bf2c962ad4">enqueue</a> (<a class="el" href="classRefCountingPtr.html">MsgPtr</a> message)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#acac1ced7e82669dca7bb95e66ca54fb9">enqueue</a> (<a class="el" href="classRefCountingPtr.html">MsgPtr</a> message, <a class="el" href="classCycles.html">Cycles</a> delta)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#af900ed471b929eca9aa2649b378086ba">dequeue</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a98102238652df03cf871c9766de96af2">recycle</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a479432127ee77145cc19d6a2d1590821">isEmpty</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ae93cbe20820d1830a52fceed6a4407dc">setOrdering</a> (bool order)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a80ad9f22f168208fada0b5d4b332e6a9">resize</a> (unsigned int size)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a5301d277181ca5f033a81035ff20c76b">getSize</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a746f6cbcd8fa14109bb37712f8dbd210">setRandomization</a> (bool random_flag)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac8bb3912a3ce86b15842e79d0b421204">clear</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac55fe386a101fbae38c716067c9966a0">print</a> (std::ostream &amp;out) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac7ec7476159db4e2bb0372e30010fc9e">clearStats</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#aee0eb866227b5e46be9a2c51c22bcb88">setIncomingLink</a> (int link_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a528d693acf172c3acd1f7fbf73a463f9">setVnet</a> (int net)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a729f57f557bb42c045c47d9388f1030e">functionalRead</a> (<a class="el" href="classPacket.html">Packet</a> *pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ad07b9def1d6f5e5f988a254c3a9d1ad9">functionalWrite</a> (<a class="el" href="classPacket.html">Packet</a> *pkt)</td></tr>
<tr><td colspan="2"><h2>Private 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; <a class="el" href="classAddress.html">Address</a>, <br class="typebreak"/>
<a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="classRefCountingPtr.html">MsgPtr</a> &gt; &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a4f77caf961eb3357bbaa1534420e8213">StallMsgMapType</a></td></tr>
<tr><td colspan="2"><h2>Private メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac278f790c547f9db8b4bedc853b8ae63">reanalyzeList</a> (<a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="classRefCountingPtr.html">MsgPtr</a> &gt; &amp;, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>)</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a896a9ceedfb77c22a82b490f05ae4624">m_recycle_latency</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classClockedObject.html">ClockedObject</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427">m_sender</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The two ends of the buffer.  <a href="#a8c9e563cbbe6ea97e8c1357a2dcce427"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classClockedObject.html">ClockedObject</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classConsumer.html">Consumer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245">m_consumer</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classConsumer.html">Consumer</a> to signal a wakeup(), can be NULL.  <a href="#a138db353766834771d05a09ab273f245"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classMessageBufferNode.html">MessageBufferNode</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classMessageBuffer.html#a4f77caf961eb3357bbaa1534420e8213">StallMsgMapType</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#adb41893ba19e889e56c559f25fc1a68a">m_name</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ac6512ff5a4845e1c7accef18b576f810">m_max_size</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a040f6bbf3cb647d2363ac247e2076126">m_time_last_time_size_checked</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ad240a365b18b543a74ce40475a9e7d74">m_size_last_time_size_checked</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ad99d9b33ed6c9adbe0b672c6af0a5bf7">m_time_last_time_enqueue</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a6d825eaf3c6cf89227a953fcb5e91af3">m_time_last_time_pop</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ad4ef3631d539c1c0a0434b51bdabf68c">m_size_at_cycle_start</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#af37dc7ab69d718640e0622b64136543f">m_msgs_this_cycle</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#adb933651b11421e2e911a352db8edc94">m_not_avail_count</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="TypeDefines_8hh.html#a29940ae63ec06c9998bba873e25407ad">uint64</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a4ac5345a63b7618a47b477b57cde5ca0">m_priority_rank</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a2d9ad769da997d66f23de51048f90566">m_strict_fifo</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ae6fd7f88210bae2cdbd67370062be24c">m_ordering_set</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#aa846ca9467116a26a879dc4b262cf36a">m_randomization</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#ad214be76cbb069cc3acb2a843fffb26f">m_input_link_id</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classMessageBuffer.html#a3cd373167bcac343aba16bd3525cc0a2">m_vnet_id</a></td></tr>
</table>
<hr/><h2>型定義</h2>
<a class="anchor" id="a4f77caf961eb3357bbaa1534420e8213"></a><!-- doxytag: member="MessageBuffer::StallMsgMapType" ref="a4f77caf961eb3357bbaa1534420e8213" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt; <a class="el" href="classAddress.html">Address</a>, <a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="classRefCountingPtr.html">MsgPtr</a>&gt; &gt; <a class="el" href="classMessageBuffer.html#a4f77caf961eb3357bbaa1534420e8213">StallMsgMapType</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="a3ab015b49b89f6f1e8c9facc8441976f"></a><!-- doxytag: member="MessageBuffer::MessageBuffer" ref="a3ab015b49b89f6f1e8c9facc8441976f" args="(const std::string &amp;name=&quot;&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMessageBuffer.html">MessageBuffer</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em> = <code>&quot;&quot;</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a3164aa5c5bbbd31b6b1963ef9c90756f"></a><!-- doxytag: member="MessageBuffer::areNSlotsAvailable" ref="a3164aa5c5bbbd31b6b1963ef9c90756f" args="(unsigned int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool areNSlotsAvailable </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>n</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00079"></a>00079 {
<a name="l00080"></a>00080 
<a name="l00081"></a>00081     <span class="comment">// fast path when message buffers have infinite size</span>
<a name="l00082"></a>00082     <span class="keywordflow">if</span> (<a class="code" href="classMessageBuffer.html#ac6512ff5a4845e1c7accef18b576f810">m_max_size</a> == 0) {
<a name="l00083"></a>00083         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     <span class="comment">// determine the correct size for the current cycle</span>
<a name="l00087"></a>00087     <span class="comment">// pop operations shouldn&apos;t effect the network&apos;s visible size</span>
<a name="l00088"></a>00088     <span class="comment">// until next cycle, but enqueue operations effect the visible</span>
<a name="l00089"></a>00089     <span class="comment">// size immediately</span>
<a name="l00090"></a>00090     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> current_size = 0;
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <span class="keywordflow">if</span> (m_time_last_time_pop &lt; m_sender-&gt;clockEdge()) {
<a name="l00093"></a>00093         <span class="comment">// no pops this cycle - heap size is correct</span>
<a name="l00094"></a>00094         current_size = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size();
<a name="l00095"></a>00095     } <span class="keywordflow">else</span> {
<a name="l00096"></a>00096         <span class="keywordflow">if</span> (m_time_last_time_enqueue &lt; m_sender-&gt;curCycle()) {
<a name="l00097"></a>00097             <span class="comment">// no enqueues this cycle - m_size_at_cycle_start is correct</span>
<a name="l00098"></a>00098             current_size = <a class="code" href="classMessageBuffer.html#ad4ef3631d539c1c0a0434b51bdabf68c">m_size_at_cycle_start</a>;
<a name="l00099"></a>00099         } <span class="keywordflow">else</span> {
<a name="l00100"></a>00100             <span class="comment">// both pops and enqueues occured this cycle - add new</span>
<a name="l00101"></a>00101             <span class="comment">// enqueued msgs to m_size_at_cycle_start</span>
<a name="l00102"></a>00102             current_size = <a class="code" href="classMessageBuffer.html#ad4ef3631d539c1c0a0434b51bdabf68c">m_size_at_cycle_start</a> + <a class="code" href="classMessageBuffer.html#af37dc7ab69d718640e0622b64136543f">m_msgs_this_cycle</a>;
<a name="l00103"></a>00103         }
<a name="l00104"></a>00104     }
<a name="l00105"></a>00105 
<a name="l00106"></a>00106     <span class="comment">// now compare the new size with our max size</span>
<a name="l00107"></a>00107     <span class="keywordflow">if</span> (current_size + <a class="code" href="namespaceArmISA.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a> &lt;= <a class="code" href="classMessageBuffer.html#ac6512ff5a4845e1c7accef18b576f810">m_max_size</a>) {
<a name="l00108"></a>00108         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00109"></a>00109     } <span class="keywordflow">else</span> {
<a name="l00110"></a>00110         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;n: %d, current_size: %d, heap size: %d, &quot;</span>
<a name="l00111"></a>00111                 <span class="stringliteral">&quot;m_max_size: %d\n&quot;</span>,
<a name="l00112"></a>00112                 <a class="code" href="namespaceArmISA.html#aeab71244afb687f16d8c4f5ee9d6ef0e">n</a>, current_size, <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size(), <a class="code" href="classMessageBuffer.html#ac6512ff5a4845e1c7accef18b576f810">m_max_size</a>);
<a name="l00113"></a>00113         <a class="code" href="classMessageBuffer.html#adb933651b11421e2e911a352db8edc94">m_not_avail_count</a>++;
<a name="l00114"></a>00114         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00115"></a>00115     }
<a name="l00116"></a>00116 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac8bb3912a3ce86b15842e79d0b421204"></a><!-- doxytag: member="MessageBuffer::clear" ref="ac8bb3912a3ce86b15842e79d0b421204" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00252"></a>00252 {
<a name="l00253"></a>00253     <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.clear();
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <a class="code" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a> = 0;
<a name="l00256"></a>00256     <a class="code" href="classMessageBuffer.html#ad99d9b33ed6c9adbe0b672c6af0a5bf7">m_time_last_time_enqueue</a> = <a class="code" href="classCycles.html">Cycles</a>(0);
<a name="l00257"></a>00257     <a class="code" href="classMessageBuffer.html#a6d825eaf3c6cf89227a953fcb5e91af3">m_time_last_time_pop</a> = 0;
<a name="l00258"></a>00258     <a class="code" href="classMessageBuffer.html#ad4ef3631d539c1c0a0434b51bdabf68c">m_size_at_cycle_start</a> = 0;
<a name="l00259"></a>00259     <a class="code" href="classMessageBuffer.html#af37dc7ab69d718640e0622b64136543f">m_msgs_this_cycle</a> = 0;
<a name="l00260"></a>00260 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac7ec7476159db4e2bb0372e30010fc9e"></a><!-- doxytag: member="MessageBuffer::clearStats" ref="ac7ec7476159db4e2bb0372e30010fc9e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearStats </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00141"></a>00141 { <a class="code" href="classMessageBuffer.html#adb933651b11421e2e911a352db8edc94">m_not_avail_count</a> = 0; <a class="code" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a> = 0; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae20106ccbc4569ff9474570932956f7f"></a><!-- doxytag: member="MessageBuffer::delayHead" ref="ae20106ccbc4569ff9474570932956f7f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void delayHead </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00069"></a>00069     {
<a name="l00070"></a>00070         <a class="code" href="classMessageBufferNode.html">MessageBufferNode</a> node = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front();
<a name="l00071"></a>00071         std::pop_heap(<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.begin(), <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.end(),
<a name="l00072"></a>00072                       std::greater&lt;MessageBufferNode&gt;());
<a name="l00073"></a>00073         <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.pop_back();
<a name="l00074"></a>00074         <a class="code" href="classMessageBuffer.html#a3e66951ea4f67cc6837309bf2c962ad4">enqueue</a>(node.<a class="code" href="classMessageBufferNode.html#a0190ebd96c557881596457a02c2f8743">m_msgptr</a>, <a class="code" href="classCycles.html">Cycles</a>(1));
<a name="l00075"></a>00075     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af900ed471b929eca9aa2649b378086ba"></a><!-- doxytag: member="MessageBuffer::dequeue" ref="af900ed471b929eca9aa2649b378086ba" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> dequeue </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Updates the delay cycles of the message at the head of the queue, removes it from the queue and returns its total delay. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00224"></a>00224 {
<a name="l00225"></a>00225     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;Popping\n&quot;</span>);
<a name="l00226"></a>00226     assert(<a class="code" href="classMessageBuffer.html#ac12eec09d47a89a1ddf3eb6bb19b5bd3">isReady</a>());
<a name="l00227"></a>00227 
<a name="l00228"></a>00228     <span class="comment">// get MsgPtr of the message about to be dequeued</span>
<a name="l00229"></a>00229     <a class="code" href="classRefCountingPtr.html">MsgPtr</a> message = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front().m_msgptr;
<a name="l00230"></a>00230 
<a name="l00231"></a>00231     <span class="comment">// get the delay cycles</span>
<a name="l00232"></a>00232     message-&gt;updateDelayedTicks(<a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>());
<a name="l00233"></a>00233     <a class="code" href="classCycles.html">Cycles</a> delayCycles =
<a name="l00234"></a>00234         <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a91cfeb85669839d1ecafb7e62cf9d57a">ticksToCycles</a>(message-&gt;getDelayedTicks());
<a name="l00235"></a>00235 
<a name="l00236"></a>00236     <span class="comment">// record previous size and time so the current buffer size isn&apos;t</span>
<a name="l00237"></a>00237     <span class="comment">// adjusted until next cycle</span>
<a name="l00238"></a>00238     <span class="keywordflow">if</span> (m_time_last_time_pop &lt; m_receiver-&gt;clockEdge()) {
<a name="l00239"></a>00239         <a class="code" href="classMessageBuffer.html#ad4ef3631d539c1c0a0434b51bdabf68c">m_size_at_cycle_start</a> = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size();
<a name="l00240"></a>00240         <a class="code" href="classMessageBuffer.html#a6d825eaf3c6cf89227a953fcb5e91af3">m_time_last_time_pop</a> = <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>();
<a name="l00241"></a>00241     }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243     pop_heap(<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.begin(), <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.end(),
<a name="l00244"></a>00244         greater&lt;MessageBufferNode&gt;());
<a name="l00245"></a>00245     <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.pop_back();
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <span class="keywordflow">return</span> delayCycles;
<a name="l00248"></a>00248 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acac1ced7e82669dca7bb95e66ca54fb9"></a><!-- doxytag: member="MessageBuffer::enqueue" ref="acac1ced7e82669dca7bb95e66ca54fb9" args="(MsgPtr message, Cycles delta)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enqueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">MsgPtr</a>&nbsp;</td>
          <td class="paramname"> <em>message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td>
          <td class="paramname"> <em>delta</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00145"></a>00145 {
<a name="l00146"></a>00146     <a class="code" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a>++;
<a name="l00147"></a>00147 
<a name="l00148"></a>00148     <span class="comment">// record current time incase we have a pop that also adjusts my size</span>
<a name="l00149"></a>00149     <span class="keywordflow">if</span> (m_time_last_time_enqueue &lt; m_sender-&gt;curCycle()) {
<a name="l00150"></a>00150         <a class="code" href="classMessageBuffer.html#af37dc7ab69d718640e0622b64136543f">m_msgs_this_cycle</a> = 0;  <span class="comment">// first msg this cycle</span>
<a name="l00151"></a>00151         <a class="code" href="classMessageBuffer.html#ad99d9b33ed6c9adbe0b672c6af0a5bf7">m_time_last_time_enqueue</a> = <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a3f6dfa1d3e7cd47666433b6caa4d34d6">curCycle</a>();
<a name="l00152"></a>00152     }
<a name="l00153"></a>00153     <a class="code" href="classMessageBuffer.html#af37dc7ab69d718640e0622b64136543f">m_msgs_this_cycle</a>++;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     assert(<a class="code" href="classMessageBuffer.html#ae6fd7f88210bae2cdbd67370062be24c">m_ordering_set</a>);
<a name="l00156"></a>00156 
<a name="l00157"></a>00157     <span class="comment">// Calculate the arrival time of the message, that is, the first</span>
<a name="l00158"></a>00158     <span class="comment">// cycle the message can be dequeued.</span>
<a name="l00159"></a>00159     assert(delta &gt; 0);
<a name="l00160"></a>00160     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> current_time = <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>();
<a name="l00161"></a>00161     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> arrival_time = 0;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <span class="keywordflow">if</span> (!<a class="code" href="classRubySystem.html#a2c9e274659748daf59b6e960456cea85">RubySystem::getRandomization</a>() || !<a class="code" href="classMessageBuffer.html#aa846ca9467116a26a879dc4b262cf36a">m_randomization</a>) {
<a name="l00164"></a>00164         <span class="comment">// No randomization</span>
<a name="l00165"></a>00165         arrival_time = current_time + delta * <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a78c89cef17196c60470c4f2f76d43d8a">clockPeriod</a>();
<a name="l00166"></a>00166     } <span class="keywordflow">else</span> {
<a name="l00167"></a>00167         <span class="comment">// Randomization - ignore delta</span>
<a name="l00168"></a>00168         <span class="keywordflow">if</span> (<a class="code" href="classMessageBuffer.html#a2d9ad769da997d66f23de51048f90566">m_strict_fifo</a>) {
<a name="l00169"></a>00169             <span class="keywordflow">if</span> (<a class="code" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a> &lt; current_time) {
<a name="l00170"></a>00170                 <a class="code" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a> = current_time;
<a name="l00171"></a>00171             }
<a name="l00172"></a>00172             arrival_time = <a class="code" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a> +
<a name="l00173"></a>00173                            <a class="code" href="MessageBuffer_8cc.html#a90ad9a05733c8b95a6f383ef561bd0d5">random_time</a>() * <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a78c89cef17196c60470c4f2f76d43d8a">clockPeriod</a>();
<a name="l00174"></a>00174         } <span class="keywordflow">else</span> {
<a name="l00175"></a>00175             arrival_time = current_time +
<a name="l00176"></a>00176                            <a class="code" href="MessageBuffer_8cc.html#a90ad9a05733c8b95a6f383ef561bd0d5">random_time</a>() * <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a78c89cef17196c60470c4f2f76d43d8a">clockPeriod</a>();
<a name="l00177"></a>00177         }
<a name="l00178"></a>00178     }
<a name="l00179"></a>00179 
<a name="l00180"></a>00180     <span class="comment">// Check the arrival time</span>
<a name="l00181"></a>00181     assert(arrival_time &gt; current_time);
<a name="l00182"></a>00182     <span class="keywordflow">if</span> (<a class="code" href="classMessageBuffer.html#a2d9ad769da997d66f23de51048f90566">m_strict_fifo</a>) {
<a name="l00183"></a>00183         <span class="keywordflow">if</span> (arrival_time &lt; <a class="code" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a>) {
<a name="l00184"></a>00184             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;FIFO ordering violated: %s name: %s current time: %d &quot;</span>
<a name="l00185"></a>00185                   <span class="stringliteral">&quot;delta: %d arrival_time: %d last arrival_time: %d\n&quot;</span>,
<a name="l00186"></a>00186                   *<span class="keyword">this</span>, <a class="code" href="classMessageBuffer.html#adb41893ba19e889e56c559f25fc1a68a">m_name</a>, current_time,
<a name="l00187"></a>00187                   delta * <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a78c89cef17196c60470c4f2f76d43d8a">clockPeriod</a>(),
<a name="l00188"></a>00188                   arrival_time, <a class="code" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a>);
<a name="l00189"></a>00189         }
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192     <span class="comment">// If running a cache trace, don&apos;t worry about the last arrival checks</span>
<a name="l00193"></a>00193     <span class="keywordflow">if</span> (!<a class="code" href="Global_8cc.html#ac7631ed7c7cc138c40a9e88e38d0ecb1">g_system_ptr</a>-&gt;<a class="code" href="classRubySystem.html#ae9051ba7e9770f4a2be7a20f6f185e86">m_warmup_enabled</a>) {
<a name="l00194"></a>00194         <a class="code" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a> = arrival_time;
<a name="l00195"></a>00195     }
<a name="l00196"></a>00196 
<a name="l00197"></a>00197     <span class="comment">// compute the delay cycles and set enqueue time</span>
<a name="l00198"></a>00198     <a class="code" href="classMessage.html">Message</a>* msg_ptr = message.<a class="code" href="classRefCountingPtr.html#a07f851191ad3a7c5c1598ef14f710f96" title="Directly access the pointer itself without taking a reference.">get</a>();
<a name="l00199"></a>00199     assert(msg_ptr != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>);
<a name="l00200"></a>00200 
<a name="l00201"></a>00201     assert(<a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>() &gt;= msg_ptr-&gt;<a class="code" href="classMessage.html#adbfd7f03977545143ecdcd4fef0f1d65">getLastEnqueueTime</a>() &amp;&amp;
<a name="l00202"></a>00202            <span class="stringliteral">&quot;ensure we aren&apos;t dequeued early&quot;</span>);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204     msg_ptr-&gt;<a class="code" href="classMessage.html#a505c1e462c299eb1ad016d74957777a2" title="Update the delay this message has experienced so far.">updateDelayedTicks</a>(<a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>());
<a name="l00205"></a>00205     msg_ptr-&gt;<a class="code" href="classMessage.html#a39eba4c6107adb64574da829d35df8c7">setLastEnqueueTime</a>(arrival_time);
<a name="l00206"></a>00206 
<a name="l00207"></a>00207     <span class="comment">// Insert the message into the priority heap</span>
<a name="l00208"></a>00208     <a class="code" href="classMessageBufferNode.html">MessageBufferNode</a> thisNode(arrival_time, <a class="code" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a>, message);
<a name="l00209"></a>00209     <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.push_back(thisNode);
<a name="l00210"></a>00210     push_heap(<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.begin(), <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.end(),
<a name="l00211"></a>00211         greater&lt;MessageBufferNode&gt;());
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;Enqueue arrival_time: %lld, Message: %s\n&quot;</span>,
<a name="l00214"></a>00214             arrival_time, *(message.<a class="code" href="classRefCountingPtr.html#a07f851191ad3a7c5c1598ef14f710f96" title="Directly access the pointer itself without taking a reference.">get</a>()));
<a name="l00215"></a>00215 
<a name="l00216"></a>00216     <span class="comment">// Schedule the wakeup</span>
<a name="l00217"></a>00217     assert(<a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a> != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>);
<a name="l00218"></a>00218     <a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a>-&gt;<a class="code" href="classConsumer.html#a0b26d8ce23c3ab271e7a746e57174721">scheduleEventAbsolute</a>(arrival_time);
<a name="l00219"></a>00219     <a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a>-&gt;<a class="code" href="classConsumer.html#a6f82fdec6e5674ac2254f16b8fa82afb">storeEventInfo</a>(<a class="code" href="classMessageBuffer.html#a3cd373167bcac343aba16bd3525cc0a2">m_vnet_id</a>);
<a name="l00220"></a>00220 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3e66951ea4f67cc6837309bf2c962ad4"></a><!-- doxytag: member="MessageBuffer::enqueue" ref="a3e66951ea4f67cc6837309bf2c962ad4" args="(MsgPtr message)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void enqueue </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRefCountingPtr.html">MsgPtr</a>&nbsp;</td>
          <td class="paramname"> <em>message</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00118"></a>00118 { <a class="code" href="classMessageBuffer.html#a3e66951ea4f67cc6837309bf2c962ad4">enqueue</a>(message, <a class="code" href="classCycles.html">Cycles</a>(1)); }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a729f57f557bb42c045c47d9388f1030e"></a><!-- doxytag: member="MessageBuffer::functionalRead" ref="a729f57f557bb42c045c47d9388f1030e" args="(Packet *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool functionalRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">Packet</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00367"></a>00367 {
<a name="l00368"></a>00368     <span class="comment">// Check the priority heap and read any messages that may</span>
<a name="l00369"></a>00369     <span class="comment">// correspond to the address in the packet.</span>
<a name="l00370"></a>00370     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size(); ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00371"></a>00371         <a class="code" href="classMessage.html">Message</a> *msg = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].m_msgptr.get();
<a name="l00372"></a>00372         <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="classMessage.html#a050cc08996aae4295aee40e8871788b7">functionalRead</a>(pkt)) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00373"></a>00373     }
<a name="l00374"></a>00374 
<a name="l00375"></a>00375     <span class="comment">// Read the messages in the stall queue that correspond</span>
<a name="l00376"></a>00376     <span class="comment">// to the address in the packet.</span>
<a name="l00377"></a>00377     <span class="keywordflow">for</span> (StallMsgMapType::iterator map_iter = <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.begin();
<a name="l00378"></a>00378          map_iter != <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.end();
<a name="l00379"></a>00379          ++map_iter) {
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         <span class="keywordflow">for</span> (<a class="code" href="classstd_1_1list.html">std::list&lt;MsgPtr&gt;::iterator</a> it = (map_iter-&gt;second).begin();
<a name="l00382"></a>00382             it != (map_iter-&gt;second).end(); ++it) {
<a name="l00383"></a>00383 
<a name="l00384"></a>00384             <a class="code" href="classMessage.html">Message</a> *msg = (*it).get();
<a name="l00385"></a>00385             <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="classMessage.html#a050cc08996aae4295aee40e8871788b7">functionalRead</a>(pkt)) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00386"></a>00386         }
<a name="l00387"></a>00387     }
<a name="l00388"></a>00388     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00389"></a>00389 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad07b9def1d6f5e5f988a254c3a9d1ad9"></a><!-- doxytag: member="MessageBuffer::functionalWrite" ref="ad07b9def1d6f5e5f988a254c3a9d1ad9" args="(Packet *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> functionalWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classPacket.html">Packet</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00393"></a>00393 {
<a name="l00394"></a>00394     <a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> num_functional_writes = 0;
<a name="l00395"></a>00395 
<a name="l00396"></a>00396     <span class="comment">// Check the priority heap and write any messages that may</span>
<a name="l00397"></a>00397     <span class="comment">// correspond to the address in the packet.</span>
<a name="l00398"></a>00398     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size(); ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00399"></a>00399         <a class="code" href="classMessage.html">Message</a> *msg = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].m_msgptr.get();
<a name="l00400"></a>00400         <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="classMessage.html#a1a7af86f43fb867628a3c3cf76e4dcc9">functionalWrite</a>(pkt)) {
<a name="l00401"></a>00401             num_functional_writes++;
<a name="l00402"></a>00402         }
<a name="l00403"></a>00403     }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405     <span class="comment">// Check the stall queue and write any messages that may</span>
<a name="l00406"></a>00406     <span class="comment">// correspond to the address in the packet.</span>
<a name="l00407"></a>00407     <span class="keywordflow">for</span> (StallMsgMapType::iterator map_iter = <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.begin();
<a name="l00408"></a>00408          map_iter != <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.end();
<a name="l00409"></a>00409          ++map_iter) {
<a name="l00410"></a>00410 
<a name="l00411"></a>00411         <span class="keywordflow">for</span> (<a class="code" href="classstd_1_1list.html">std::list&lt;MsgPtr&gt;::iterator</a> it = (map_iter-&gt;second).begin();
<a name="l00412"></a>00412             it != (map_iter-&gt;second).end(); ++it) {
<a name="l00413"></a>00413 
<a name="l00414"></a>00414             <a class="code" href="classMessage.html">Message</a> *msg = (*it).get();
<a name="l00415"></a>00415             <span class="keywordflow">if</span> (msg-&gt;<a class="code" href="classMessage.html#a1a7af86f43fb867628a3c3cf76e4dcc9">functionalWrite</a>(pkt)) {
<a name="l00416"></a>00416                 num_functional_writes++;
<a name="l00417"></a>00417             }
<a name="l00418"></a>00418         }
<a name="l00419"></a>00419     }
<a name="l00420"></a>00420 
<a name="l00421"></a>00421     <span class="keywordflow">return</span> num_functional_writes;
<a name="l00422"></a>00422 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2417fc7252a612b5c976ceaa2d1be4f7"></a><!-- doxytag: member="MessageBuffer::getConsumer" ref="a2417fc7252a612b5c976ceaa2d1be4f7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classConsumer.html">Consumer</a>* getConsumer </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00105"></a>00105 { <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a73da75c3e5ec30855a02eae2ba824e38"></a><!-- doxytag: member="MessageBuffer::getDescription" ref="a73da75c3e5ec30855a02eae2ba824e38" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string getDescription </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00103"></a>00103 { <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#adb41893ba19e889e56c559f25fc1a68a">m_name</a>;}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e1ac3494e27c30441640926f0f07b6f"></a><!-- doxytag: member="MessageBuffer::getPriority" ref="a8e1ac3494e27c30441640926f0f07b6f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getPriority </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00078"></a>00078 { <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#a4ac5345a63b7618a47b477b57cde5ca0">m_priority_rank</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5301d277181ca5f033a81035ff20c76b"></a><!-- doxytag: member="MessageBuffer::getSize" ref="a5301d277181ca5f033a81035ff20c76b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int getSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00068"></a>00068 {
<a name="l00069"></a>00069     <span class="keywordflow">if</span> (<a class="code" href="classMessageBuffer.html#a040f6bbf3cb647d2363ac247e2076126">m_time_last_time_size_checked</a> != <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a3f6dfa1d3e7cd47666433b6caa4d34d6">curCycle</a>()) {
<a name="l00070"></a>00070         <a class="code" href="classMessageBuffer.html#a040f6bbf3cb647d2363ac247e2076126">m_time_last_time_size_checked</a> = <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a3f6dfa1d3e7cd47666433b6caa4d34d6">curCycle</a>();
<a name="l00071"></a>00071         <a class="code" href="classMessageBuffer.html#ad240a365b18b543a74ce40475a9e7d74">m_size_last_time_size_checked</a> = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size();
<a name="l00072"></a>00072     }
<a name="l00073"></a>00073 
<a name="l00074"></a>00074     <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#ad240a365b18b543a74ce40475a9e7d74">m_size_last_time_size_checked</a>;
<a name="l00075"></a>00075 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a479432127ee77145cc19d6a2d1590821"></a><!-- doxytag: member="MessageBuffer::isEmpty" ref="a479432127ee77145cc19d6a2d1590821" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isEmpty </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00126"></a>00126 { <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size() == 0; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac12eec09d47a89a1ddf3eb6bb19b5bd3"></a><!-- doxytag: member="MessageBuffer::isReady" ref="ac12eec09d47a89a1ddf3eb6bb19b5bd3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool isReady </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00360"></a>00360 {
<a name="l00361"></a>00361     <span class="keywordflow">return</span> ((<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.size() &gt; 0) &amp;&amp;
<a name="l00362"></a>00362             (<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front().m_time &lt;= <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>()));
<a name="l00363"></a>00363 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a37627d5d5bba7f4a8690c71c2ab3cb07"></a><!-- doxytag: member="MessageBuffer::name" ref="a37627d5d5bba7f4a8690c71c2ab3cb07" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string name </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00055"></a>00055 { <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#adb41893ba19e889e56c559f25fc1a68a">m_name</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5e133f7f4632eccf4bb7145962bc89ca"></a><!-- doxytag: member="MessageBuffer::peek" ref="a5e133f7f4632eccf4bb7145962bc89ca" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classMessage.html">Message</a> * peek </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Function for extracting the message at the head of the message queue. The function assumes that the queue is nonempty. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00120"></a>00120 {
<a name="l00121"></a>00121     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;Peeking at head of queue.\n&quot;</span>);
<a name="l00122"></a>00122     assert(<a class="code" href="classMessageBuffer.html#ac12eec09d47a89a1ddf3eb6bb19b5bd3">isReady</a>());
<a name="l00123"></a>00123 
<a name="l00124"></a>00124     <span class="keyword">const</span> <a class="code" href="classMessage.html">Message</a>* msg_ptr = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front().m_msgptr.get();
<a name="l00125"></a>00125     assert(msg_ptr);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;Message: %s\n&quot;</span>, (*msg_ptr));
<a name="l00128"></a>00128     <span class="keywordflow">return</span> msg_ptr;
<a name="l00129"></a>00129 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="add248ff5db7f0e5dac1501da94c4c83e"></a><!-- doxytag: member="MessageBuffer::peekMsgPtr" ref="add248ff5db7f0e5dac1501da94c4c83e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classRefCountingPtr.html">MsgPtr</a>&amp; peekMsgPtr </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00113"></a>00113     {
<a name="l00114"></a>00114         assert(<a class="code" href="classMessageBuffer.html#ac12eec09d47a89a1ddf3eb6bb19b5bd3">isReady</a>());
<a name="l00115"></a>00115         <span class="keywordflow">return</span> <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front().m_msgptr;
<a name="l00116"></a>00116     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac55fe386a101fbae38c716067c9966a0"></a><!-- doxytag: member="MessageBuffer::print" ref="ac55fe386a101fbae38c716067c9966a0" args="(std::ostream &amp;out) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>out</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adfdac0293f076193ea9e70b12b54ecbe"></a><!-- doxytag: member="MessageBuffer::reanalyzeAllMessages" ref="adfdac0293f076193ea9e70b12b54ecbe" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reanalyzeAllMessages </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00312"></a>00312 {
<a name="l00313"></a>00313     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;ReanalyzeAllMessages\n&quot;</span>);
<a name="l00314"></a>00314     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> nextTick = <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>(<a class="code" href="classCycles.html">Cycles</a>(1));
<a name="l00315"></a>00315 
<a name="l00316"></a>00316     <span class="comment">//</span>
<a name="l00317"></a>00317     <span class="comment">// Put all stalled messages associated with this address back on the</span>
<a name="l00318"></a>00318     <span class="comment">// prio heap</span>
<a name="l00319"></a>00319     <span class="comment">//</span>
<a name="l00320"></a>00320     <span class="keywordflow">for</span> (StallMsgMapType::iterator map_iter = <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.begin();
<a name="l00321"></a>00321          map_iter != <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.end(); ++map_iter) {
<a name="l00322"></a>00322         <a class="code" href="classMessageBuffer.html#ac278f790c547f9db8b4bedc853b8ae63">reanalyzeList</a>(map_iter-&gt;second, nextTick);
<a name="l00323"></a>00323     }
<a name="l00324"></a>00324     <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.clear();
<a name="l00325"></a>00325 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac278f790c547f9db8b4bedc853b8ae63"></a><!-- doxytag: member="MessageBuffer::reanalyzeList" ref="ac278f790c547f9db8b4bedc853b8ae63" args="(std::list&lt; MsgPtr &gt; &amp;, Tick)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reanalyzeList </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="classRefCountingPtr.html">MsgPtr</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>lt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>nextTick</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00281"></a>00281 {
<a name="l00282"></a>00282     <span class="keywordflow">while</span>(!lt.empty()) {
<a name="l00283"></a>00283         <a class="code" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a>++;
<a name="l00284"></a>00284         <a class="code" href="classMessageBufferNode.html">MessageBufferNode</a> msgNode(nextTick, <a class="code" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a>, lt.front());
<a name="l00285"></a>00285 
<a name="l00286"></a>00286         <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.push_back(msgNode);
<a name="l00287"></a>00287         push_heap(<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.begin(), <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.end(),
<a name="l00288"></a>00288                   greater&lt;MessageBufferNode&gt;());
<a name="l00289"></a>00289 
<a name="l00290"></a>00290         <a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a>-&gt;<a class="code" href="classConsumer.html#a0b26d8ce23c3ab271e7a746e57174721">scheduleEventAbsolute</a>(nextTick);
<a name="l00291"></a>00291         lt.pop_front();
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac8fc02d2f80c73a67e76577139daaaf9"></a><!-- doxytag: member="MessageBuffer::reanalyzeMessages" ref="ac8fc02d2f80c73a67e76577139daaaf9" args="(const Address &amp;addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reanalyzeMessages </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAddress.html">Address</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00297"></a>00297 {
<a name="l00298"></a>00298     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;ReanalyzeMessages\n&quot;</span>);
<a name="l00299"></a>00299     assert(<a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.count(addr) &gt; 0);
<a name="l00300"></a>00300     <a class="code" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> nextTick = <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>(<a class="code" href="classCycles.html">Cycles</a>(1));
<a name="l00301"></a>00301 
<a name="l00302"></a>00302     <span class="comment">//</span>
<a name="l00303"></a>00303     <span class="comment">// Put all stalled messages associated with this address back on the</span>
<a name="l00304"></a>00304     <span class="comment">// prio heap</span>
<a name="l00305"></a>00305     <span class="comment">//</span>
<a name="l00306"></a>00306     <a class="code" href="classMessageBuffer.html#ac278f790c547f9db8b4bedc853b8ae63">reanalyzeList</a>(<a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>[addr], nextTick);
<a name="l00307"></a>00307     <a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>.erase(addr);
<a name="l00308"></a>00308 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a98102238652df03cf871c9766de96af2"></a><!-- doxytag: member="MessageBuffer::recycle" ref="a98102238652df03cf871c9766de96af2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void recycle </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00264"></a>00264 {
<a name="l00265"></a>00265     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;Recycling.\n&quot;</span>);
<a name="l00266"></a>00266     assert(<a class="code" href="classMessageBuffer.html#ac12eec09d47a89a1ddf3eb6bb19b5bd3">isReady</a>());
<a name="l00267"></a>00267     <a class="code" href="classMessageBufferNode.html">MessageBufferNode</a> node = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front();
<a name="l00268"></a>00268     pop_heap(<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.begin(), <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.end(),
<a name="l00269"></a>00269         greater&lt;MessageBufferNode&gt;());
<a name="l00270"></a>00270 
<a name="l00271"></a>00271     node.<a class="code" href="classMessageBufferNode.html#adb6d90850c7a231a52313b5bc7e5df68">m_time</a> = <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>(<a class="code" href="classMessageBuffer.html#a896a9ceedfb77c22a82b490f05ae4624">m_recycle_latency</a>);
<a name="l00272"></a>00272     <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.back() = node;
<a name="l00273"></a>00273     push_heap(<a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.begin(), <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.end(),
<a name="l00274"></a>00274         greater&lt;MessageBufferNode&gt;());
<a name="l00275"></a>00275     <a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a>-&gt;
<a name="l00276"></a>00276         scheduleEventAbsolute(<a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a>-&gt;<a class="code" href="classClockedObject.html#a773956693f216cafb7d4cad92ad582e5">clockEdge</a>(<a class="code" href="classMessageBuffer.html#a896a9ceedfb77c22a82b490f05ae4624">m_recycle_latency</a>));
<a name="l00277"></a>00277 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a80ad9f22f168208fada0b5d4b332e6a9"></a><!-- doxytag: member="MessageBuffer::resize" ref="a80ad9f22f168208fada0b5d4b332e6a9" args="(unsigned int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void resize </td>
          <td>(</td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>size</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00135"></a>00135 { <a class="code" href="classMessageBuffer.html#ac6512ff5a4845e1c7accef18b576f810">m_max_size</a> = size; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81e888318cb316e49e3b6c9989970bb0"></a><!-- doxytag: member="MessageBuffer::setConsumer" ref="a81e888318cb316e49e3b6c9989970bb0" args="(Consumer *consumer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setConsumer </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classConsumer.html">Consumer</a> *&nbsp;</td>
          <td class="paramname"> <em>consumer</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081     {
<a name="l00082"></a>00082         <span class="keywordflow">if</span> (<a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a> != <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>) {
<a name="l00083"></a>00083             <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Trying to connect %s to MessageBuffer %s. \</span>
<a name="l00084"></a>00084 <span class="stringliteral">                  \n%s already connected. Check the cntrl_id&apos;s.\n&quot;</span>,
<a name="l00085"></a>00085                   *consumer, *<span class="keyword">this</span>, *<a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a>);
<a name="l00086"></a>00086         }
<a name="l00087"></a>00087         <a class="code" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245" title="Consumer to signal a wakeup(), can be NULL.">m_consumer</a> = consumer;
<a name="l00088"></a>00088     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9cdbe64eebafb111a124edec55ed2340"></a><!-- doxytag: member="MessageBuffer::setDescription" ref="a9cdbe64eebafb111a124edec55ed2340" args="(const std::string &amp;name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setDescription </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00102"></a>00102 { <a class="code" href="classMessageBuffer.html#adb41893ba19e889e56c559f25fc1a68a">m_name</a> = <a class="code" href="classMessageBuffer.html#a37627d5d5bba7f4a8690c71c2ab3cb07">name</a>; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aee0eb866227b5e46be9a2c51c22bcb88"></a><!-- doxytag: member="MessageBuffer::setIncomingLink" ref="aee0eb866227b5e46be9a2c51c22bcb88" args="(int link_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setIncomingLink </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>link_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00143"></a>00143 { <a class="code" href="classMessageBuffer.html#ad214be76cbb069cc3acb2a843fffb26f">m_input_link_id</a> = link_id; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae93cbe20820d1830a52fceed6a4407dc"></a><!-- doxytag: member="MessageBuffer::setOrdering" ref="ae93cbe20820d1830a52fceed6a4407dc" args="(bool order)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setOrdering </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>order</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00130"></a>00130     {
<a name="l00131"></a>00131         <a class="code" href="classMessageBuffer.html#a2d9ad769da997d66f23de51048f90566">m_strict_fifo</a> = order;
<a name="l00132"></a>00132         <a class="code" href="classMessageBuffer.html#ae6fd7f88210bae2cdbd67370062be24c">m_ordering_set</a> = <span class="keyword">true</span>;
<a name="l00133"></a>00133     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6f56c404ece2826d0b11ad759fdf0fb4"></a><!-- doxytag: member="MessageBuffer::setPriority" ref="a6f56c404ece2826d0b11ad759fdf0fb4" args="(int rank)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setPriority </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rank</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00079"></a>00079 { <a class="code" href="classMessageBuffer.html#a4ac5345a63b7618a47b477b57cde5ca0">m_priority_rank</a> = rank; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a746f6cbcd8fa14109bb37712f8dbd210"></a><!-- doxytag: member="MessageBuffer::setRandomization" ref="a746f6cbcd8fa14109bb37712f8dbd210" args="(bool random_flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setRandomization </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>random_flag</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00137"></a>00137 { <a class="code" href="classMessageBuffer.html#aa846ca9467116a26a879dc4b262cf36a">m_randomization</a> = random_flag; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1fbc695c465cc14aeb497a623951ba6d"></a><!-- doxytag: member="MessageBuffer::setReceiver" ref="a1fbc695c465cc14aeb497a623951ba6d" args="(ClockedObject *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setReceiver </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classClockedObject.html">ClockedObject</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00097"></a>00097     {
<a name="l00098"></a>00098         assert(<a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a> == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a> || <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a> == obj);
<a name="l00099"></a>00099         <a class="code" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a> = obj;
<a name="l00100"></a>00100     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad9be4b0fe9efff18c2e56a1705d99918"></a><!-- doxytag: member="MessageBuffer::setRecycleLatency" ref="ad9be4b0fe9efff18c2e56a1705d99918" args="(Cycles recycle_latency)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setRecycleLatency </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td>
          <td class="paramname"> <em>recycle_latency</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00058"></a>00058     { <a class="code" href="classMessageBuffer.html#a896a9ceedfb77c22a82b490f05ae4624">m_recycle_latency</a> = recycle_latency; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0a949993188bb0d51b80b714be944447"></a><!-- doxytag: member="MessageBuffer::setSender" ref="a0a949993188bb0d51b80b714be944447" args="(ClockedObject *obj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setSender </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classClockedObject.html">ClockedObject</a> *&nbsp;</td>
          <td class="paramname"> <em>obj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00091"></a>00091     {
<a name="l00092"></a>00092         assert(<a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a> == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a> || <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a> == obj);
<a name="l00093"></a>00093         <a class="code" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427" title="The two ends of the buffer.">m_sender</a> = obj;
<a name="l00094"></a>00094     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a528d693acf172c3acd1f7fbf73a463f9"></a><!-- doxytag: member="MessageBuffer::setVnet" ref="a528d693acf172c3acd1f7fbf73a463f9" args="(int net)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setVnet </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>net</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00144"></a>00144 { <a class="code" href="classMessageBuffer.html#a3cd373167bcac343aba16bd3525cc0a2">m_vnet_id</a> = net; }
</pre></div></p>

</div>
</div>
<a class="anchor" id="abef10942dc67e1641651a1f9542b7303"></a><!-- doxytag: member="MessageBuffer::stallMessage" ref="abef10942dc67e1641651a1f9542b7303" args="(const Address &amp;addr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void stallMessage </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAddress.html">Address</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>addr</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00329"></a>00329 {
<a name="l00330"></a>00330     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(RubyQueue, <span class="stringliteral">&quot;Stalling due to %s\n&quot;</span>, addr);
<a name="l00331"></a>00331     assert(<a class="code" href="classMessageBuffer.html#ac12eec09d47a89a1ddf3eb6bb19b5bd3">isReady</a>());
<a name="l00332"></a>00332     assert(addr.<a class="code" href="classAddress.html#a7f7b431504ce24277fd98a99a51e7865">getOffset</a>() == 0);
<a name="l00333"></a>00333     <a class="code" href="classRefCountingPtr.html">MsgPtr</a> message = <a class="code" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a>.front().m_msgptr;
<a name="l00334"></a>00334 
<a name="l00335"></a>00335     <a class="code" href="classMessageBuffer.html#af900ed471b929eca9aa2649b378086ba">dequeue</a>();
<a name="l00336"></a>00336 
<a name="l00337"></a>00337     <span class="comment">//</span>
<a name="l00338"></a>00338     <span class="comment">// Note: no event is scheduled to analyze the map at a later time.</span>
<a name="l00339"></a>00339     <span class="comment">// Instead the controller is responsible to call reanalyzeMessages when</span>
<a name="l00340"></a>00340     <span class="comment">// these addresses change state.</span>
<a name="l00341"></a>00341     <span class="comment">//</span>
<a name="l00342"></a>00342     (<a class="code" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a>[addr]).push_back(message);
<a name="l00343"></a>00343 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a138db353766834771d05a09ab273f245"></a><!-- doxytag: member="MessageBuffer::m_consumer" ref="a138db353766834771d05a09ab273f245" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classConsumer.html">Consumer</a>* <a class="el" href="classMessageBuffer.html#a138db353766834771d05a09ab273f245">m_consumer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classConsumer.html">Consumer</a> to signal a wakeup(), can be NULL. </p>

</div>
</div>
<a class="anchor" id="ad214be76cbb069cc3acb2a843fffb26f"></a><!-- doxytag: member="MessageBuffer::m_input_link_id" ref="ad214be76cbb069cc3acb2a843fffb26f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMessageBuffer.html#ad214be76cbb069cc3acb2a843fffb26f">m_input_link_id</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a691773cf753228bbb617fc07019c45bb"></a><!-- doxytag: member="MessageBuffer::m_last_arrival_time" ref="a691773cf753228bbb617fc07019c45bb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classMessageBuffer.html#a691773cf753228bbb617fc07019c45bb">m_last_arrival_time</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac6512ff5a4845e1c7accef18b576f810"></a><!-- doxytag: member="MessageBuffer::m_max_size" ref="ac6512ff5a4845e1c7accef18b576f810" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classMessageBuffer.html#ac6512ff5a4845e1c7accef18b576f810">m_max_size</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3ee0247e7b99d743ac9ec4d45edba8af"></a><!-- doxytag: member="MessageBuffer::m_msg_counter" ref="a3ee0247e7b99d743ac9ec4d45edba8af" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="TypeDefines_8hh.html#a29940ae63ec06c9998bba873e25407ad">uint64</a> <a class="el" href="classMessageBuffer.html#a3ee0247e7b99d743ac9ec4d45edba8af">m_msg_counter</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af37dc7ab69d718640e0622b64136543f"></a><!-- doxytag: member="MessageBuffer::m_msgs_this_cycle" ref="af37dc7ab69d718640e0622b64136543f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classMessageBuffer.html#af37dc7ab69d718640e0622b64136543f">m_msgs_this_cycle</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adb41893ba19e889e56c559f25fc1a68a"></a><!-- doxytag: member="MessageBuffer::m_name" ref="adb41893ba19e889e56c559f25fc1a68a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="classMessageBuffer.html#adb41893ba19e889e56c559f25fc1a68a">m_name</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adb933651b11421e2e911a352db8edc94"></a><!-- doxytag: member="MessageBuffer::m_not_avail_count" ref="adb933651b11421e2e911a352db8edc94" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMessageBuffer.html#adb933651b11421e2e911a352db8edc94">m_not_avail_count</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae6fd7f88210bae2cdbd67370062be24c"></a><!-- doxytag: member="MessageBuffer::m_ordering_set" ref="ae6fd7f88210bae2cdbd67370062be24c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMessageBuffer.html#ae6fd7f88210bae2cdbd67370062be24c">m_ordering_set</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab02596c3ecacf48c081c7188a2e304ab"></a><!-- doxytag: member="MessageBuffer::m_prio_heap" ref="ab02596c3ecacf48c081c7188a2e304ab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classMessageBufferNode.html">MessageBufferNode</a>&gt; <a class="el" href="classMessageBuffer.html#ab02596c3ecacf48c081c7188a2e304ab">m_prio_heap</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4ac5345a63b7618a47b477b57cde5ca0"></a><!-- doxytag: member="MessageBuffer::m_priority_rank" ref="a4ac5345a63b7618a47b477b57cde5ca0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMessageBuffer.html#a4ac5345a63b7618a47b477b57cde5ca0">m_priority_rank</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa846ca9467116a26a879dc4b262cf36a"></a><!-- doxytag: member="MessageBuffer::m_randomization" ref="aa846ca9467116a26a879dc4b262cf36a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMessageBuffer.html#aa846ca9467116a26a879dc4b262cf36a">m_randomization</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a18393ec7ec37465d3c43d1de61fe7ea1"></a><!-- doxytag: member="MessageBuffer::m_receiver" ref="a18393ec7ec37465d3c43d1de61fe7ea1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classClockedObject.html">ClockedObject</a>* <a class="el" href="classMessageBuffer.html#a18393ec7ec37465d3c43d1de61fe7ea1">m_receiver</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a896a9ceedfb77c22a82b490f05ae4624"></a><!-- doxytag: member="MessageBuffer::m_recycle_latency" ref="a896a9ceedfb77c22a82b490f05ae4624" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classMessageBuffer.html#a896a9ceedfb77c22a82b490f05ae4624">m_recycle_latency</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a8c9e563cbbe6ea97e8c1357a2dcce427"></a><!-- doxytag: member="MessageBuffer::m_sender" ref="a8c9e563cbbe6ea97e8c1357a2dcce427" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classClockedObject.html">ClockedObject</a>* <a class="el" href="classMessageBuffer.html#a8c9e563cbbe6ea97e8c1357a2dcce427">m_sender</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The two ends of the buffer. </p>

</div>
</div>
<a class="anchor" id="ad4ef3631d539c1c0a0434b51bdabf68c"></a><!-- doxytag: member="MessageBuffer::m_size_at_cycle_start" ref="ad4ef3631d539c1c0a0434b51bdabf68c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classMessageBuffer.html#ad4ef3631d539c1c0a0434b51bdabf68c">m_size_at_cycle_start</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad240a365b18b543a74ce40475a9e7d74"></a><!-- doxytag: member="MessageBuffer::m_size_last_time_size_checked" ref="ad240a365b18b543a74ce40475a9e7d74" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classMessageBuffer.html#ad240a365b18b543a74ce40475a9e7d74">m_size_last_time_size_checked</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a588564bc2c906eaf69f9b34f18ff18ea"></a><!-- doxytag: member="MessageBuffer::m_stall_msg_map" ref="a588564bc2c906eaf69f9b34f18ff18ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classMessageBuffer.html#a4f77caf961eb3357bbaa1534420e8213">StallMsgMapType</a> <a class="el" href="classMessageBuffer.html#a588564bc2c906eaf69f9b34f18ff18ea">m_stall_msg_map</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a2d9ad769da997d66f23de51048f90566"></a><!-- doxytag: member="MessageBuffer::m_strict_fifo" ref="a2d9ad769da997d66f23de51048f90566" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classMessageBuffer.html#a2d9ad769da997d66f23de51048f90566">m_strict_fifo</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad99d9b33ed6c9adbe0b672c6af0a5bf7"></a><!-- doxytag: member="MessageBuffer::m_time_last_time_enqueue" ref="ad99d9b33ed6c9adbe0b672c6af0a5bf7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classMessageBuffer.html#ad99d9b33ed6c9adbe0b672c6af0a5bf7">m_time_last_time_enqueue</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6d825eaf3c6cf89227a953fcb5e91af3"></a><!-- doxytag: member="MessageBuffer::m_time_last_time_pop" ref="a6d825eaf3c6cf89227a953fcb5e91af3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> <a class="el" href="classMessageBuffer.html#a6d825eaf3c6cf89227a953fcb5e91af3">m_time_last_time_pop</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a040f6bbf3cb647d2363ac247e2076126"></a><!-- doxytag: member="MessageBuffer::m_time_last_time_size_checked" ref="a040f6bbf3cb647d2363ac247e2076126" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> <a class="el" href="classMessageBuffer.html#a040f6bbf3cb647d2363ac247e2076126">m_time_last_time_size_checked</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3cd373167bcac343aba16bd3525cc0a2"></a><!-- doxytag: member="MessageBuffer::m_vnet_id" ref="a3cd373167bcac343aba16bd3525cc0a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classMessageBuffer.html#a3cd373167bcac343aba16bd3525cc0a2">m_vnet_id</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>mem/ruby/buffers/<a class="el" href="MessageBuffer_8hh_source.html">MessageBuffer.hh</a></li>
<li>mem/ruby/buffers/<a class="el" href="MessageBuffer_8cc.html">MessageBuffer.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
