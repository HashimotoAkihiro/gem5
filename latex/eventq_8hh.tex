\hypertarget{eventq_8hh}{
\section{sim/eventq.hh}
\label{eventq_8hh}\index{sim/eventq.hh@{sim/eventq.hh}}
}
{\ttfamily \#include $<$algorithm$>$}\par
{\ttfamily \#include $<$cassert$>$}\par
{\ttfamily \#include $<$climits$>$}\par
{\ttfamily \#include $<$iosfwd$>$}\par
{\ttfamily \#include $<$mutex$>$}\par
{\ttfamily \#include $<$string$>$}\par
{\ttfamily \#include \char`\"{}base/flags.hh\char`\"{}}\par
{\ttfamily \#include \char`\"{}base/misc.hh\char`\"{}}\par
{\ttfamily \#include \char`\"{}base/types.hh\char`\"{}}\par
{\ttfamily \#include \char`\"{}debug/Event.hh\char`\"{}}\par
{\ttfamily \#include \char`\"{}sim/serialize.hh\char`\"{}}\par
\subsection*{構成}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classEventBase}{EventBase}
\item 
class \hyperlink{classEvent}{Event}
\item 
class \hyperlink{classEventQueue}{EventQueue}
\item 
class \hyperlink{classEventQueue_1_1ScopedMigration}{ScopedMigration}
\item 
class \hyperlink{classEventQueue_1_1ScopedRelease}{ScopedRelease}
\item 
class \hyperlink{classEventManager}{EventManager}
\item 
class \hyperlink{classEventWrapper}{EventWrapper$<$ T, F $>$}
\end{DoxyCompactItemize}
\subsection*{関数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classEventQueue}{EventQueue} $\ast$ \hyperlink{eventq_8hh_a5b4fbd623a1babda7d35802241f5f6cf}{getEventQueue} (\hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} index)
\item 
\hyperlink{classEventQueue}{EventQueue} $\ast$ \hyperlink{eventq_8hh_a64a8603a1af7020a19d30c54152fdcb2}{curEventQueue} ()
\item 
void \hyperlink{eventq_8hh_aa002a8d75c873915e60d96ac255f9df7}{curEventQueue} (\hyperlink{classEventQueue}{EventQueue} $\ast$q)
\item 
bool \hyperlink{eventq_8hh_a3c178da5a2521e397a938853b0381cfe}{operator$<$} (const \hyperlink{classEvent}{Event} \&l, const \hyperlink{classEvent}{Event} \&r)
\item 
bool \hyperlink{eventq_8hh_a4bec4ae1c2599b058e50d02e0bb08962}{operator$>$} (const \hyperlink{classEvent}{Event} \&l, const \hyperlink{classEvent}{Event} \&r)
\item 
bool \hyperlink{eventq_8hh_a321ab1717492451522fed22375ae8363}{operator$<$=} (const \hyperlink{classEvent}{Event} \&l, const \hyperlink{classEvent}{Event} \&r)
\item 
bool \hyperlink{eventq_8hh_a53cd3371f557c2fce6b6a65fc06d4d4e}{operator$>$=} (const \hyperlink{classEvent}{Event} \&l, const \hyperlink{classEvent}{Event} \&r)
\item 
bool \hyperlink{eventq_8hh_aa242d3b194771eaf0fd66a3c7b646816}{operator==} (const \hyperlink{classEvent}{Event} \&l, const \hyperlink{classEvent}{Event} \&r)
\item 
bool \hyperlink{eventq_8hh_a88186b54fd68bd48fb160ba30c0242ee}{operator!=} (const \hyperlink{classEvent}{Event} \&l, const \hyperlink{classEvent}{Event} \&r)
\item 
void \hyperlink{eventq_8hh_afa9cf950f7afca6dc9b1fc2328df2d43}{dumpMainQueue} ()
\item 
{\footnotesize template$<$class T , void(T::$\ast$)() F$>$ }\\void \hyperlink{eventq_8hh_a9992bd1a54709fbb3d7e0e8ab62702c0}{DelayFunction} (\hyperlink{classEventQueue}{EventQueue} $\ast$eventq, \hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} when, T $\ast$object)
\end{DoxyCompactItemize}
\subsection*{変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} \hyperlink{eventq_8hh_a1184f025d31220089a3af9dfc6eeb4d4}{simQuantum}
\item 
\hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} \hyperlink{eventq_8hh_a0cb37c490e14c37cdcc040c2392feda1}{numMainEventQueues}
\begin{DoxyCompactList}\small\item\em Current number of allocated main event queues. \item\end{DoxyCompactList}\item 
\hyperlink{classstd_1_1vector}{std::vector}$<$ \hyperlink{classEventQueue}{EventQueue} $\ast$ $>$ \hyperlink{eventq_8hh_a75c22a9e4871574133dae986c0a4527e}{mainEventQueue}
\begin{DoxyCompactList}\small\item\em Array for main event queues. \item\end{DoxyCompactList}\item 
\_\-\_\-thread \hyperlink{classEventQueue}{EventQueue} $\ast$ \hyperlink{eventq_8hh_a2a77d1fcaf54c702b80ae9c02d588333}{\_\-curEventQueue}
\item 
bool \hyperlink{eventq_8hh_a1a48f421470ff3e6db2b119ab1286b96}{inParallelMode}
\begin{DoxyCompactList}\small\item\em Current mode of execution: parallel / serial. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{関数}
\hypertarget{eventq_8hh_aa002a8d75c873915e60d96ac255f9df7}{
\index{eventq.hh@{eventq.hh}!curEventQueue@{curEventQueue}}
\index{curEventQueue@{curEventQueue}!eventq.hh@{eventq.hh}}
\subsubsection[{curEventQueue}]{\setlength{\rightskip}{0pt plus 5cm}void curEventQueue ({\bf EventQueue} $\ast$ {\em q})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_aa002a8d75c873915e60d96ac255f9df7}



\begin{DoxyCode}
88 { _curEventQueue = q; }
\end{DoxyCode}
\hypertarget{eventq_8hh_a64a8603a1af7020a19d30c54152fdcb2}{
\index{eventq.hh@{eventq.hh}!curEventQueue@{curEventQueue}}
\index{curEventQueue@{curEventQueue}!eventq.hh@{eventq.hh}}
\subsubsection[{curEventQueue}]{\setlength{\rightskip}{0pt plus 5cm}{\bf EventQueue}$\ast$ curEventQueue ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a64a8603a1af7020a19d30c54152fdcb2}



\begin{DoxyCode}
87 { return _curEventQueue; }
\end{DoxyCode}
\hypertarget{eventq_8hh_a9992bd1a54709fbb3d7e0e8ab62702c0}{
\index{eventq.hh@{eventq.hh}!DelayFunction@{DelayFunction}}
\index{DelayFunction@{DelayFunction}!eventq.hh@{eventq.hh}}
\subsubsection[{DelayFunction}]{\setlength{\rightskip}{0pt plus 5cm}void DelayFunction ({\bf EventQueue} $\ast$ {\em eventq}, \/  {\bf Tick} {\em when}, \/  T $\ast$ {\em object})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a9992bd1a54709fbb3d7e0e8ab62702c0}



\begin{DoxyCode}
697 {
698     class DelayEvent : public Event
699     {
700       private:
701         T *object;
702 
703       public:
704         DelayEvent(T *o)
705             : Event(Default_Pri, AutoDelete), object(o)
706         { }
707         void process() { (object->*F)(); }
708         const char *description() const { return "delay"; }
709     };
710 
711     eventq->schedule(new DelayEvent(object), when);
712 }
\end{DoxyCode}
\hypertarget{eventq_8hh_afa9cf950f7afca6dc9b1fc2328df2d43}{
\index{eventq.hh@{eventq.hh}!dumpMainQueue@{dumpMainQueue}}
\index{dumpMainQueue@{dumpMainQueue}!eventq.hh@{eventq.hh}}
\subsubsection[{dumpMainQueue}]{\setlength{\rightskip}{0pt plus 5cm}void dumpMainQueue ()}}
\label{eventq_8hh_afa9cf950f7afca6dc9b1fc2328df2d43}



\begin{DoxyCode}
416 {
417     for (uint32_t i = 0; i < numMainEventQueues; ++i) {
418         mainEventQueue[i]->dump();
419     }
420 }
\end{DoxyCode}
\hypertarget{eventq_8hh_a5b4fbd623a1babda7d35802241f5f6cf}{
\index{eventq.hh@{eventq.hh}!getEventQueue@{getEventQueue}}
\index{getEventQueue@{getEventQueue}!eventq.hh@{eventq.hh}}
\subsubsection[{getEventQueue}]{\setlength{\rightskip}{0pt plus 5cm}{\bf EventQueue}$\ast$ getEventQueue ({\bf uint32\_\-t} {\em index})}}
\label{eventq_8hh_a5b4fbd623a1babda7d35802241f5f6cf}
Function for returning eventq queue for the provided index. The function allocates a new queue in case one does not exist for the index, provided that the index is with in bounds. 


\begin{DoxyCode}
65 {
66     while (numMainEventQueues <= index) {
67         numMainEventQueues++;
68         mainEventQueue.push_back(
69             new EventQueue(csprintf("MainEventQueue-%d", index)));
70     }
71 
72     return mainEventQueue[index];
73 }
\end{DoxyCode}
\hypertarget{eventq_8hh_a88186b54fd68bd48fb160ba30c0242ee}{
\index{eventq.hh@{eventq.hh}!operator!=@{operator!=}}
\index{operator!=@{operator!=}!eventq.hh@{eventq.hh}}
\subsubsection[{operator!=}]{\setlength{\rightskip}{0pt plus 5cm}bool operator!= (const {\bf Event} \& {\em l}, \/  const {\bf Event} \& {\em r})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a88186b54fd68bd48fb160ba30c0242ee}



\begin{DoxyCode}
396 {
397     return l.when() != r.when() || l.priority() != r.priority();
398 }
\end{DoxyCode}
\hypertarget{eventq_8hh_a3c178da5a2521e397a938853b0381cfe}{
\index{eventq.hh@{eventq.hh}!operator$<$@{operator$<$}}
\index{operator$<$@{operator$<$}!eventq.hh@{eventq.hh}}
\subsubsection[{operator$<$}]{\setlength{\rightskip}{0pt plus 5cm}bool operator$<$ (const {\bf Event} \& {\em l}, \/  const {\bf Event} \& {\em r})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a3c178da5a2521e397a938853b0381cfe}



\begin{DoxyCode}
363 {
364     return l.when() < r.when() ||
365         (l.when() == r.when() && l.priority() < r.priority());
366 }
\end{DoxyCode}
\hypertarget{eventq_8hh_a321ab1717492451522fed22375ae8363}{
\index{eventq.hh@{eventq.hh}!operator$<$=@{operator$<$=}}
\index{operator$<$=@{operator$<$=}!eventq.hh@{eventq.hh}}
\subsubsection[{operator$<$=}]{\setlength{\rightskip}{0pt plus 5cm}bool operator$<$= (const {\bf Event} \& {\em l}, \/  const {\bf Event} \& {\em r})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a321ab1717492451522fed22375ae8363}



\begin{DoxyCode}
377 {
378     return l.when() < r.when() ||
379         (l.when() == r.when() && l.priority() <= r.priority());
380 }
\end{DoxyCode}
\hypertarget{eventq_8hh_aa242d3b194771eaf0fd66a3c7b646816}{
\index{eventq.hh@{eventq.hh}!operator==@{operator==}}
\index{operator==@{operator==}!eventq.hh@{eventq.hh}}
\subsubsection[{operator==}]{\setlength{\rightskip}{0pt plus 5cm}bool operator== (const {\bf Event} \& {\em l}, \/  const {\bf Event} \& {\em r})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_aa242d3b194771eaf0fd66a3c7b646816}



\begin{DoxyCode}
390 {
391     return l.when() == r.when() && l.priority() == r.priority();
392 }
\end{DoxyCode}
\hypertarget{eventq_8hh_a4bec4ae1c2599b058e50d02e0bb08962}{
\index{eventq.hh@{eventq.hh}!operator$>$@{operator$>$}}
\index{operator$>$@{operator$>$}!eventq.hh@{eventq.hh}}
\subsubsection[{operator$>$}]{\setlength{\rightskip}{0pt plus 5cm}bool operator$>$ (const {\bf Event} \& {\em l}, \/  const {\bf Event} \& {\em r})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a4bec4ae1c2599b058e50d02e0bb08962}



\begin{DoxyCode}
370 {
371     return l.when() > r.when() ||
372         (l.when() == r.when() && l.priority() > r.priority());
373 }
\end{DoxyCode}
\hypertarget{eventq_8hh_a53cd3371f557c2fce6b6a65fc06d4d4e}{
\index{eventq.hh@{eventq.hh}!operator$>$=@{operator$>$=}}
\index{operator$>$=@{operator$>$=}!eventq.hh@{eventq.hh}}
\subsubsection[{operator$>$=}]{\setlength{\rightskip}{0pt plus 5cm}bool operator$>$= (const {\bf Event} \& {\em l}, \/  const {\bf Event} \& {\em r})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{eventq_8hh_a53cd3371f557c2fce6b6a65fc06d4d4e}



\begin{DoxyCode}
383 {
384     return l.when() > r.when() ||
385         (l.when() == r.when() && l.priority() >= r.priority());
386 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{eventq_8hh_a2a77d1fcaf54c702b80ae9c02d588333}{
\index{eventq.hh@{eventq.hh}!\_\-curEventQueue@{\_\-curEventQueue}}
\index{\_\-curEventQueue@{\_\-curEventQueue}!eventq.hh@{eventq.hh}}
\subsubsection[{\_\-curEventQueue}]{\setlength{\rightskip}{0pt plus 5cm}\_\-\_\-thread {\bf EventQueue}$\ast$ {\bf \_\-curEventQueue}}}
\label{eventq_8hh_a2a77d1fcaf54c702b80ae9c02d588333}
The current event queue for the running thread. Access to this queue does not require any locking from the thread. \hypertarget{eventq_8hh_a1a48f421470ff3e6db2b119ab1286b96}{
\index{eventq.hh@{eventq.hh}!inParallelMode@{inParallelMode}}
\index{inParallelMode@{inParallelMode}!eventq.hh@{eventq.hh}}
\subsubsection[{inParallelMode}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf inParallelMode}}}
\label{eventq_8hh_a1a48f421470ff3e6db2b119ab1286b96}


Current mode of execution: parallel / serial. \hypertarget{eventq_8hh_a75c22a9e4871574133dae986c0a4527e}{
\index{eventq.hh@{eventq.hh}!mainEventQueue@{mainEventQueue}}
\index{mainEventQueue@{mainEventQueue}!eventq.hh@{eventq.hh}}
\subsubsection[{mainEventQueue}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std::vector}$<${\bf EventQueue} $\ast$$>$ {\bf mainEventQueue}}}
\label{eventq_8hh_a75c22a9e4871574133dae986c0a4527e}


Array for main event queues. \hypertarget{eventq_8hh_a0cb37c490e14c37cdcc040c2392feda1}{
\index{eventq.hh@{eventq.hh}!numMainEventQueues@{numMainEventQueues}}
\index{numMainEventQueues@{numMainEventQueues}!eventq.hh@{eventq.hh}}
\subsubsection[{numMainEventQueues}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint32\_\-t} {\bf numMainEventQueues}}}
\label{eventq_8hh_a0cb37c490e14c37cdcc040c2392feda1}


Current number of allocated main event queues. \hypertarget{eventq_8hh_a1184f025d31220089a3af9dfc6eeb4d4}{
\index{eventq.hh@{eventq.hh}!simQuantum@{simQuantum}}
\index{simQuantum@{simQuantum}!eventq.hh@{eventq.hh}}
\subsubsection[{simQuantum}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Tick} {\bf simQuantum}}}
\label{eventq_8hh_a1184f025d31220089a3af9dfc6eeb4d4}
Simulation Quantum for multiple eventq simulation. The quantum value is the period length after which the queues synchronize themselves with each other. This means that any event to scheduled on Queue A which is generated by an event on Queue B should be at least simQuantum ticks away in future. 