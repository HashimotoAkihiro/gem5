\hypertarget{classDmaDevice}{
\section{クラス DmaDevice}
\label{classDmaDevice}\index{DmaDevice@{DmaDevice}}
}


{\ttfamily \#include $<$dma\_\-device.hh$>$}DmaDeviceに対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=6.5812cm]{classDmaDevice}
\end{center}
\end{figure}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
typedef DmaDeviceParams \hyperlink{classDmaDevice_aea7daf6105ab956443385f5f5a9b88c5}{Params}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDmaDevice_af4b097d003744f742495ee91bee709da}{DmaDevice} (const \hyperlink{classDmaDevice_aea7daf6105ab956443385f5f5a9b88c5}{Params} $\ast$p)
\item 
virtual \hyperlink{classDmaDevice_a28cd9afaa9eacf209f0380ffcce5ec72}{$\sim$DmaDevice} ()
\item 
void \hyperlink{classDmaDevice_a4a2db8a9eb52a00a9a2e19c2eb3753dc}{dmaWrite} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, int size, \hyperlink{classEvent}{Event} $\ast$event, uint8\_\-t $\ast$data, \hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} delay=0)
\item 
void \hyperlink{classDmaDevice_a8ca93dacaa427cede08842a958aa1b23}{dmaRead} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addr, int size, \hyperlink{classEvent}{Event} $\ast$event, uint8\_\-t $\ast$data, \hyperlink{base_2types_8hh_a5c8ed81b7d238c9083e1037ba6d61643}{Tick} delay=0)
\item 
bool \hyperlink{classDmaDevice_a481b9352c138101d0f84f163a760c6e5}{dmaPending} () const 
\item 
virtual void \hyperlink{classDmaDevice_a02fd73d861ef2e4aabb38c0c9ff82947}{init} ()
\item 
unsigned int \hyperlink{classDmaDevice_a6bf479c521c7c3eb473822d953275b26}{drain} (\hyperlink{classDrainManager}{DrainManager} $\ast$drainManger)
\item 
unsigned int \hyperlink{classDmaDevice_a3e6e4aa434d2b5c83de3660307a49001}{cacheBlockSize} () const 
\item 
virtual \hyperlink{classBaseMasterPort}{BaseMasterPort} \& \hyperlink{classDmaDevice_adc4e675e51defbdd1e354dac729d0703}{getMasterPort} (const std::string \&if\_\-name, \hyperlink{base_2types_8hh_acef4d7d41cb21fdc252e20c04cd7bb8e}{PortID} idx=\hyperlink{base_2types_8hh_a65bf40f138cf863f0c5e2d8ca1144126}{InvalidPortID})
\end{DoxyCompactItemize}
\subsection*{Protected 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classDmaPort}{DmaPort} \hyperlink{classDmaDevice_a0e844de222006d2f1aadb8f01d8f383b}{dmaPort}
\end{DoxyCompactItemize}


\subsection{型定義}
\hypertarget{classDmaDevice_aea7daf6105ab956443385f5f5a9b88c5}{
\index{DmaDevice@{DmaDevice}!Params@{Params}}
\index{Params@{Params}!DmaDevice@{DmaDevice}}
\subsubsection[{Params}]{\setlength{\rightskip}{0pt plus 5cm}typedef DmaDeviceParams {\bf Params}}}
\label{classDmaDevice_aea7daf6105ab956443385f5f5a9b88c5}


\hyperlink{classPioDevice_a9cdbda5b5cc24147ce82b7d07bf03cd1}{PioDevice}を再定義しています。

\hyperlink{classAmbaDmaDevice_ab612ceb7381438552927b7ed0aed5099}{AmbaDmaDevice}, \hyperlink{classHDLcd_a31ccb03af3b5962a67bed42eca6ce2f0}{HDLcd}, \hyperlink{classPl111_a98df8e62be26dfc2009a7e53d5d0841d}{Pl111}, \hyperlink{classCopyEngine_a0b0580d58d6a0384646682653aefb97a}{CopyEngine}, \hyperlink{classEtherDevice_afcf43c7944288000e850f783bdd66b9d}{EtherDevice}, \hyperlink{classIGbE_ad27b5cfed87f35a483863a73336d8258}{IGbE}, \hyperlink{classIdeController_ac3896424d9bf2d8a838f1e2c38870d02}{IdeController}, \hyperlink{classNSGigE_a3d96e676dc626c146631b6fa53a9d823}{NSGigE}, \hyperlink{classPciDevice_aefbfd3f2d9daf3173b779eeff32e8112}{PciDevice}, と \hyperlink{classSinic_1_1Base_ae32fbee6dea75ffbb01b7d869c7bedad}{Base}で再定義されています。

\subsection{コンストラクタとデストラクタ}
\hypertarget{classDmaDevice_af4b097d003744f742495ee91bee709da}{
\index{DmaDevice@{DmaDevice}!DmaDevice@{DmaDevice}}
\index{DmaDevice@{DmaDevice}!DmaDevice@{DmaDevice}}
\subsubsection[{DmaDevice}]{\setlength{\rightskip}{0pt plus 5cm}{\bf DmaDevice} (const {\bf Params} $\ast$ {\em p})}}
\label{classDmaDevice_af4b097d003744f742495ee91bee709da}



\begin{DoxyCode}
116     : PioDevice(p), dmaPort(this, sys)
117 { }
\end{DoxyCode}
\hypertarget{classDmaDevice_a28cd9afaa9eacf209f0380ffcce5ec72}{
\index{DmaDevice@{DmaDevice}!$\sim$DmaDevice@{$\sim$DmaDevice}}
\index{$\sim$DmaDevice@{$\sim$DmaDevice}!DmaDevice@{DmaDevice}}
\subsubsection[{$\sim$DmaDevice}]{\setlength{\rightskip}{0pt plus 5cm}virtual $\sim${\bf DmaDevice} ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classDmaDevice_a28cd9afaa9eacf209f0380ffcce5ec72}



\begin{DoxyCode}
161 { }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classDmaDevice_a3e6e4aa434d2b5c83de3660307a49001}{
\index{DmaDevice@{DmaDevice}!cacheBlockSize@{cacheBlockSize}}
\index{cacheBlockSize@{cacheBlockSize}!DmaDevice@{DmaDevice}}
\subsubsection[{cacheBlockSize}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int cacheBlockSize () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classDmaDevice_a3e6e4aa434d2b5c83de3660307a49001}



\begin{DoxyCode}
181 { return sys->cacheLineSize(); }
\end{DoxyCode}
\hypertarget{classDmaDevice_a481b9352c138101d0f84f163a760c6e5}{
\index{DmaDevice@{DmaDevice}!dmaPending@{dmaPending}}
\index{dmaPending@{dmaPending}!DmaDevice@{DmaDevice}}
\subsubsection[{dmaPending}]{\setlength{\rightskip}{0pt plus 5cm}bool dmaPending () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classDmaDevice_a481b9352c138101d0f84f163a760c6e5}



\begin{DoxyCode}
175 { return dmaPort.dmaPending(); }
\end{DoxyCode}
\hypertarget{classDmaDevice_a8ca93dacaa427cede08842a958aa1b23}{
\index{DmaDevice@{DmaDevice}!dmaRead@{dmaRead}}
\index{dmaRead@{dmaRead}!DmaDevice@{DmaDevice}}
\subsubsection[{dmaRead}]{\setlength{\rightskip}{0pt plus 5cm}void dmaRead ({\bf Addr} {\em addr}, \/  int {\em size}, \/  {\bf Event} $\ast$ {\em event}, \/  uint8\_\-t $\ast$ {\em data}, \/  {\bf Tick} {\em delay} = {\ttfamily 0})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classDmaDevice_a8ca93dacaa427cede08842a958aa1b23}



\begin{DoxyCode}
171     {
172         dmaPort.dmaAction(MemCmd::ReadReq, addr, size, event, data, delay);
173     }
\end{DoxyCode}
\hypertarget{classDmaDevice_a4a2db8a9eb52a00a9a2e19c2eb3753dc}{
\index{DmaDevice@{DmaDevice}!dmaWrite@{dmaWrite}}
\index{dmaWrite@{dmaWrite}!DmaDevice@{DmaDevice}}
\subsubsection[{dmaWrite}]{\setlength{\rightskip}{0pt plus 5cm}void dmaWrite ({\bf Addr} {\em addr}, \/  int {\em size}, \/  {\bf Event} $\ast$ {\em event}, \/  uint8\_\-t $\ast$ {\em data}, \/  {\bf Tick} {\em delay} = {\ttfamily 0})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classDmaDevice_a4a2db8a9eb52a00a9a2e19c2eb3753dc}



\begin{DoxyCode}
165     {
166         dmaPort.dmaAction(MemCmd::WriteReq, addr, size, event, data, delay);
167     }
\end{DoxyCode}
\hypertarget{classDmaDevice_a6bf479c521c7c3eb473822d953275b26}{
\index{DmaDevice@{DmaDevice}!drain@{drain}}
\index{drain@{drain}!DmaDevice@{DmaDevice}}
\subsubsection[{drain}]{\setlength{\rightskip}{0pt plus 5cm}unsigned int drain ({\bf DrainManager} $\ast$ {\em drainManger})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classDmaDevice_a6bf479c521c7c3eb473822d953275b26}
Provide a default implementation of the drain interface that simply returns 0 (draining completed) and sets the drain state to Drained. 

\hyperlink{classPioDevice_a6bf479c521c7c3eb473822d953275b26}{PioDevice}を再定義しています。

\hyperlink{classCopyEngine_a6bf479c521c7c3eb473822d953275b26}{CopyEngine}, \hyperlink{classIGbE_aa8a18d230dba7a674ac8a0b4f35bc36a}{IGbE}, と \hyperlink{classPciDevice_aa8a18d230dba7a674ac8a0b4f35bc36a}{PciDevice}で再定義されています。


\begin{DoxyCode}
129 {
130     unsigned int count = pioPort.drain(dm) + dmaPort.drain(dm);
131     if (count)
132         setDrainState(Drainable::Draining);
133     else
134         setDrainState(Drainable::Drained);
135     return count;
136 }
\end{DoxyCode}
\hypertarget{classDmaDevice_adc4e675e51defbdd1e354dac729d0703}{
\index{DmaDevice@{DmaDevice}!getMasterPort@{getMasterPort}}
\index{getMasterPort@{getMasterPort}!DmaDevice@{DmaDevice}}
\subsubsection[{getMasterPort}]{\setlength{\rightskip}{0pt plus 5cm}{\bf BaseMasterPort} \& getMasterPort (const std::string \& {\em if\_\-name}, \/  {\bf PortID} {\em idx} = {\ttfamily {\bf InvalidPortID}})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classDmaDevice_adc4e675e51defbdd1e354dac729d0703}
Get a master port with a given name and index. This is used at binding time and returns a reference to a protocol-\/agnostic base master port.


\begin{DoxyParams}{引数}
\item[{\em if\_\-name}]\hyperlink{classPort}{Port} name \item[{\em idx}]Index in the case of a VectorPort\end{DoxyParams}
\begin{DoxyReturn}{戻り値}
A reference to the given port 
\end{DoxyReturn}


\hyperlink{classMemObject_adc4e675e51defbdd1e354dac729d0703}{MemObject}を再定義しています。

\hyperlink{classCopyEngine_adc4e675e51defbdd1e354dac729d0703}{CopyEngine}で再定義されています。


\begin{DoxyCode}
263 {
264     if (if_name == "dma") {
265         return dmaPort;
266     }
267     return PioDevice::getMasterPort(if_name, idx);
268 }
\end{DoxyCode}
\hypertarget{classDmaDevice_a02fd73d861ef2e4aabb38c0c9ff82947}{
\index{DmaDevice@{DmaDevice}!init@{init}}
\index{init@{init}!DmaDevice@{DmaDevice}}
\subsubsection[{init}]{\setlength{\rightskip}{0pt plus 5cm}void init ()\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classDmaDevice_a02fd73d861ef2e4aabb38c0c9ff82947}
\hyperlink{classDmaDevice_a02fd73d861ef2e4aabb38c0c9ff82947}{init()} is called after all C++ SimObjects have been created and all ports are connected. Initializations that are independent of unserialization but rely on a fully instantiated and connected \hyperlink{classSimObject}{SimObject} graph should be done here. 

\hyperlink{classPioDevice_a02fd73d861ef2e4aabb38c0c9ff82947}{PioDevice}を再定義しています。

\hyperlink{classIGbE_a02fd73d861ef2e4aabb38c0c9ff82947}{IGbE}, と \hyperlink{classPciDevice_a02fd73d861ef2e4aabb38c0c9ff82947}{PciDevice}で再定義されています。


\begin{DoxyCode}
121 {
122     if (!dmaPort.isConnected())
123         panic("DMA port of %s not connected to anything!", name());
124     PioDevice::init();
125 }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classDmaDevice_a0e844de222006d2f1aadb8f01d8f383b}{
\index{DmaDevice@{DmaDevice}!dmaPort@{dmaPort}}
\index{dmaPort@{dmaPort}!DmaDevice@{DmaDevice}}
\subsubsection[{dmaPort}]{\setlength{\rightskip}{0pt plus 5cm}{\bf DmaPort} {\bf dmaPort}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classDmaDevice_a0e844de222006d2f1aadb8f01d8f383b}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
dev/\hyperlink{dma__device_8hh}{dma\_\-device.hh}\item 
dev/\hyperlink{dma__device_8cc}{dma\_\-device.cc}\end{DoxyCompactItemize}
