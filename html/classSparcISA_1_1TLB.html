<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス TLB</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceSparcISA.html">SparcISA</a>::<a class="el" href="classSparcISA_1_1TLB.html">TLB</a>
  </div>
</div>
<div class="contents">
<h1>クラス TLB</h1><!-- doxytag: class="SparcISA::TLB" --><!-- doxytag: inherits="BaseTLB" -->
<p><code>#include &lt;<a class="el" href="arch_2sparc_2tlb_8hh_source.html">tlb.hh</a>&gt;</code></p>
<div class="dynheader">
TLBに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classSparcISA_1_1TLB.gif" usemap="#TLB_map" alt=""/>
  <map id="TLB_map" name="TLB_map">
<area href="classBaseTLB.html" alt="BaseTLB" shape="rect" coords="105,112,200,136"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="105,56,200,80"/>
<area href="classEventManager.html" alt="EventManager" shape="rect" coords="0,0,95,24"/>
<area href="classSerializable.html" alt="Serializable" shape="rect" coords="105,0,200,24"/>
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="210,0,305,24"/>
</map>
 </div>
</div>

<p><a href="classSparcISA_1_1TLB-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef SparcTLBParams&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a3073524452e67556982db4c27c5f18ea">Params</a></td></tr>
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a74fbbb81cfaa89e81165a62736e4311a">lookup</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> va, int partition_id, bool real, int context_id=0, bool update_used=true)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#aca1483a67aee5a91e442f7131d66bcbd">flushAll</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a> (const <a class="el" href="classSparcISA_1_1TLB.html#a3073524452e67556982db4c27c5f18ea">Params</a> *p)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a15b6c15c1be2ca4de3e65772a02aa29f">takeOverFrom</a> (<a class="el" href="classBaseTLB.html">BaseTLB</a> *otlb)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a2d698ff909513b48a1263f8a5440e067">demapPage</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> vaddr, uint64_t asn)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a8cb66fc5f158a5d28cb9e5d73ecd26cc">dumpAll</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">Fault</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ad54e01e3c0a1613098a76b7f92e5be93">translateAtomic</a> (<a class="el" href="classRequest.html">RequestPtr</a> req, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a> mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ae52f7e465748883695d2b4f432a13652">translateTiming</a> (<a class="el" href="classRequest.html">RequestPtr</a> req, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="classBaseTLB_1_1Translation.html">Translation</a> *translation, <a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a> mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">Fault</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a26658814c6c9034665aae19cf25545bb">translateFunctional</a> (<a class="el" href="classRequest.html">RequestPtr</a> req, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a> mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">Fault</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ae199d95c42e036851a8a0543c6d6d2e3">finalizePhysical</a> (<a class="el" href="classRequest.html">RequestPtr</a> req, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a> mode) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ac90a1eb3091d70b4d1465154d799db46">doMmuRegRead</a> (<a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="classPacket.html">Packet</a> *pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCycles.html">Cycles</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#acdfde16dc50b29fe74f4b7c3f9711d43">doMmuRegWrite</a> (<a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="classPacket.html">Packet</a> *pkt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ab52a39898286d036febd5dcb6d0b376a">GetTsbPtr</a> (<a class="el" href="classThreadContext.html">ThreadContext</a> *tc, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> addr, int ctx, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> *ptrs)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a53e036786d17361be4c7320d39c99b84">serialize</a> (std::ostream &amp;os)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#af22e5d6d660b97db37003ac61ac4ee49">unserialize</a> (<a class="el" href="classCheckpoint.html">Checkpoint</a> *cp, const std::string &amp;section)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a62b717ca770fe6713cdde68d76694f44">TteRead</a> (int entry)</td></tr>
<tr><td colspan="2"><h2>Protected 型</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822">FaultTypes</a> { <br/>
&nbsp;&nbsp;<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af">OtherFault</a> =  0, 
<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822afdc36f7178e8d04d90ec745400f5d5e7">PrivViolation</a> =  0x1, 
<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a24949c2da237f4437ec8254b313fa9e1">SideEffect</a> =  0x2, 
<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a385d55ed81ad94372aeb0ca764c50bb8">AtomicToIo</a> =  0x4, 
<br/>
&nbsp;&nbsp;<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a> =  0x8, 
<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a95f50e219a840e80a9a1915b7f8b959d">LoadFromNfo</a> =  0x10, 
<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a218b85059c614ecbbee4628b16ff49da">VaOutOfRange</a> =  0x20, 
<a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a6b3372addb0e74f2071f8e2ae4402676">VaOutOfRangeJmp</a> =  0x40
<br/>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a> { <a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a> =  0, 
<a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5acdd030c6485c7b0801d32116fd9d7103">Secondary</a> =  1, 
<a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a> =  2
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">enum &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadd">TsbPageSize</a> { <a class="el" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>, 
<a class="el" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>
 }</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef <a class="el" href="classSparcISA_1_1TlbMap.html#ae61c5513b9ac04615ba7927f47c3ec69">TlbMap::iterator</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a></td></tr>
<tr><td colspan="2"><h2>Protected メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a2b2db94fc3a8f3652866d0dc2aabcf87">insert</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> vpn, int partition_id, int context_id, bool real, const <a class="el" href="classSparcISA_1_1PageTableEntry.html">PageTableEntry</a> &amp;PTE, int entry=-1)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#aaf85d399be0a94d95fa3282faff835ea">TagRead</a> (int entry)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a787d07e454d0dddde90f226346065ade">demapAll</a> (int partition_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#af7e91d9c8e43607b3064697810576e28">demapContext</a> (int partition_id, int context_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a81a25ef373ef91ac81bb1717e4c9dcb0">demapPage</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> va, int partition_id, bool real, int context_id)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#aa5cff14a14bcb47f10bb095035bd6290">validVirtualAddress</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> va, bool <a class="el" href="namespaceSparcISA.html#a221d874609a3a07e22447f60e33cffdb">am</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a> (bool write, <a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a> ct, bool se, <a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822">FaultTypes</a> ft, int asi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#aa4eb1561faa47c66c28555cbf26f4d8f">clearUsedBits</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> va, int context)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">Fault</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a072afd8ed455dade4c25a85510e5a4da">translateInst</a> (<a class="el" href="classRequest.html">RequestPtr</a> req, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classRefCountingPtr.html">Fault</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ad54aef66412f77e2a15a621a126dfb52">translateData</a> (<a class="el" href="classRequest.html">RequestPtr</a> req, <a class="el" href="classThreadContext.html">ThreadContext</a> *tc, bool write)</td></tr>
<tr><td colspan="2"><h2>Protected 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classSparcISA_1_1TlbMap.html">TlbMap</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1list.html">std::list</a>&lt; <a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a> * &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a></td></tr>
<tr><td colspan="2"><h2>Private メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a3c55ffc205560c3c945248eda4e0a62d">writeSfsr</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> a, bool write, <a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a> ct, bool se, <a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822">FaultTypes</a> ft, int asi)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint64_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a> (<a class="el" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadd">TsbPageSize</a> ps, uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>, uint64_t c0_tsb, uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>, uint64_t cX_tsb, uint64_t cX_config)</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a> [2]</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a> [2]</td></tr>
<tr><td colspan="2"><h2>フレンド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#af8c3b0d2687d5c17d60fee3e4e77e20f">FastInstructionAccessMMUMiss</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classSparcISA_1_1TLB.html#a3d497ded3c85659ec4b013e2cae38c71">FastDataAccessMMUMiss</a></td></tr>
</table>
<hr/><h2>型定義</h2>
<a class="anchor" id="a52ffc8e6c7bc8d7037f59391c2a93750"></a><!-- doxytag: member="SparcISA::TLB::MapIter" ref="a52ffc8e6c7bc8d7037f59391c2a93750" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="classSparcISA_1_1TlbMap.html#ae61c5513b9ac04615ba7927f47c3ec69">TlbMap::iterator</a> <a class="el" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3073524452e67556982db4c27c5f18ea"></a><!-- doxytag: member="SparcISA::TLB::Params" ref="a3073524452e67556982db4c27c5f18ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef SparcTLBParams <a class="el" href="classSparcISA_1_1TLB.html#a3073524452e67556982db4c27c5f18ea">Params</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classSimObject.html#a0f0761d2db586a23bb2a2880b8f387bb">SimObject</a>を再定義しています。</p>

</div>
</div>
<hr/><h2>列挙型</h2>
<a class="anchor" id="a856bf0f48d7d9c89d1e4216a6f0394e5"></a><!-- doxytag: member="SparcISA::TLB::ContextType" ref="a856bf0f48d7d9c89d1e4216a6f0394e5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c"></a><!-- doxytag: member="Primary" ref="a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c" args="" -->Primary</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a856bf0f48d7d9c89d1e4216a6f0394e5acdd030c6485c7b0801d32116fd9d7103"></a><!-- doxytag: member="Secondary" ref="a856bf0f48d7d9c89d1e4216a6f0394e5acdd030c6485c7b0801d32116fd9d7103" args="" -->Secondary</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7"></a><!-- doxytag: member="Nucleus" ref="a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7" args="" -->Nucleus</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00093"></a>00093                      {
<a name="l00094"></a>00094         <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a> = 0,
<a name="l00095"></a>00095         <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5acdd030c6485c7b0801d32116fd9d7103">Secondary</a> = 1,
<a name="l00096"></a>00096         <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a> = 2
<a name="l00097"></a>00097     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822"></a><!-- doxytag: member="SparcISA::TLB::FaultTypes" ref="a8e661b580d73f1e008c8ea6fc5823822" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822">FaultTypes</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af"></a><!-- doxytag: member="OtherFault" ref="a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af" args="" -->OtherFault</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822afdc36f7178e8d04d90ec745400f5d5e7"></a><!-- doxytag: member="PrivViolation" ref="a8e661b580d73f1e008c8ea6fc5823822afdc36f7178e8d04d90ec745400f5d5e7" args="" -->PrivViolation</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822a24949c2da237f4437ec8254b313fa9e1"></a><!-- doxytag: member="SideEffect" ref="a8e661b580d73f1e008c8ea6fc5823822a24949c2da237f4437ec8254b313fa9e1" args="" -->SideEffect</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822a385d55ed81ad94372aeb0ca764c50bb8"></a><!-- doxytag: member="AtomicToIo" ref="a8e661b580d73f1e008c8ea6fc5823822a385d55ed81ad94372aeb0ca764c50bb8" args="" -->AtomicToIo</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14"></a><!-- doxytag: member="IllegalAsi" ref="a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14" args="" -->IllegalAsi</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822a95f50e219a840e80a9a1915b7f8b959d"></a><!-- doxytag: member="LoadFromNfo" ref="a8e661b580d73f1e008c8ea6fc5823822a95f50e219a840e80a9a1915b7f8b959d" args="" -->LoadFromNfo</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822a218b85059c614ecbbee4628b16ff49da"></a><!-- doxytag: member="VaOutOfRange" ref="a8e661b580d73f1e008c8ea6fc5823822a218b85059c614ecbbee4628b16ff49da" args="" -->VaOutOfRange</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a8e661b580d73f1e008c8ea6fc5823822a6b3372addb0e74f2071f8e2ae4402676"></a><!-- doxytag: member="VaOutOfRangeJmp" ref="a8e661b580d73f1e008c8ea6fc5823822a6b3372addb0e74f2071f8e2ae4402676" args="" -->VaOutOfRangeJmp</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00082"></a>00082                     {
<a name="l00083"></a>00083         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af">OtherFault</a> = 0,
<a name="l00084"></a>00084         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822afdc36f7178e8d04d90ec745400f5d5e7">PrivViolation</a> = 0x1,
<a name="l00085"></a>00085         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a24949c2da237f4437ec8254b313fa9e1">SideEffect</a> = 0x2,
<a name="l00086"></a>00086         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a385d55ed81ad94372aeb0ca764c50bb8">AtomicToIo</a> = 0x4,
<a name="l00087"></a>00087         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a> = 0x8,
<a name="l00088"></a>00088         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a95f50e219a840e80a9a1915b7f8b959d">LoadFromNfo</a> = 0x10,
<a name="l00089"></a>00089         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a218b85059c614ecbbee4628b16ff49da">VaOutOfRange</a> = 0x20,
<a name="l00090"></a>00090         <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a6b3372addb0e74f2071f8e2ae4402676">VaOutOfRangeJmp</a> = 0x40
<a name="l00091"></a>00091     };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a639a136c8fa30e45275bd7354e95eadd"></a><!-- doxytag: member="SparcISA::TLB::TsbPageSize" ref="a639a136c8fa30e45275bd7354e95eadd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadd">TsbPageSize</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>列挙型の値: </b></dt><dd><table border="0" cellspacing="2" cellpadding="0">
<tr><td valign="top"><em><a class="anchor" id="a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048"></a><!-- doxytag: member="Ps0" ref="a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048" args="" -->Ps0</em>&nbsp;</td><td>
</td></tr>
<tr><td valign="top"><em><a class="anchor" id="a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033"></a><!-- doxytag: member="Ps1" ref="a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033" args="" -->Ps1</em>&nbsp;</td><td>
</td></tr>
</table>
</dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00099"></a>00099                      {
<a name="l00100"></a>00100         <a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>,
<a name="l00101"></a>00101         <a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>
<a name="l00102"></a>00102     };
</pre></div></p>

</div>
</div>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="acb886bd3c59f00c21be9ceaaf25dab97"></a><!-- doxytag: member="SparcISA::TLB::TLB" ref="acb886bd3c59f00c21be9ceaaf25dab97" args="(const Params *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSparcISA_1_1TLB.html">TLB</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classSparcISA_1_1TLB.html#a3073524452e67556982db4c27c5f18ea">Params</a> *&nbsp;</td>
          <td class="paramname"> <em>p</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00053"></a>00053     : <a class="code" href="classBaseTLB.html#ac8e9bca1fe09b54b17069200cac8c9d3">BaseTLB</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>), <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>(<a class="code" href="namespaceMipsISA.html#a37d3f683959086eac7bcf24a002a9fb8">p</a>-&gt;size), <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>(0), <a class="code" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a>(0),
<a name="l00054"></a>00054       <a class="code" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a>(0), <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a>(<span class="keyword">false</span>)
<a name="l00055"></a>00055 {
<a name="l00056"></a>00056     <span class="comment">// To make this work you&apos;ll have to change the hypervisor and OS</span>
<a name="l00057"></a>00057     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a> &gt; 64)
<a name="l00058"></a>00058         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;SPARC T1 TLB registers don&apos;t support more than 64 TLB entries&quot;</span>);
<a name="l00059"></a>00059 
<a name="l00060"></a>00060     <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a> = <span class="keyword">new</span> TlbEntry[<a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>];
<a name="l00061"></a>00061     std::memset(<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>, 0, <span class="keyword">sizeof</span>(TlbEntry) * <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);
<a name="l00062"></a>00062 
<a name="l00063"></a>00063     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++)
<a name="l00064"></a>00064         <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_back(&amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>]);
<a name="l00065"></a>00065 
<a name="l00066"></a>00066     <a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a> = 0;
<a name="l00067"></a>00067     <a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a> = 0;
<a name="l00068"></a>00068     <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a> = 0;
<a name="l00069"></a>00069     <a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a> = 0;
<a name="l00070"></a>00070     <a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a> = 0;
<a name="l00071"></a>00071     <a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a> = 0;
<a name="l00072"></a>00072     <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> = 0;
<a name="l00073"></a>00073     <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a> = 0;
<a name="l00074"></a>00074     <a class="code" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a> = 0;
<a name="l00075"></a>00075     <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00076"></a>00076     <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[1] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00077"></a>00077 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="aa4eb1561faa47c66c28555cbf26f4d8f"></a><!-- doxytag: member="SparcISA::TLB::clearUsedBits" ref="aa4eb1561faa47c66c28555cbf26f4d8f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearUsedBits </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00081"></a>00081 {
<a name="l00082"></a>00082     <a class="code" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00083"></a>00083     <span class="keywordflow">for</span> (i = <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.begin(); i != <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.end(); i++) {
<a name="l00084"></a>00084         TlbEntry *<a class="code" href="namespaceArmISA.html#af5dfd7e551f8c5b461816e813dab252f">t</a> = i-&gt;second;
<a name="l00085"></a>00085         <span class="keywordflow">if</span> (!t-&gt;pte.locked()) {
<a name="l00086"></a>00086             t-&gt;used = <span class="keyword">false</span>;
<a name="l00087"></a>00087             <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>--;
<a name="l00088"></a>00088         }
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a787d07e454d0dddde90f226346065ade"></a><!-- doxytag: member="SparcISA::TLB::demapAll" ref="a787d07e454d0dddde90f226346065ade" args="(int partition_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void demapAll </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>partition_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remove all non-locked entries from the tlb that match partition id. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00308"></a>00308 {
<a name="l00309"></a>00309     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: Demapping All pid=%#d\n&quot;</span>, partition_id);
<a name="l00310"></a>00310     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">false</span>;
<a name="l00311"></a>00311     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++) {
<a name="l00312"></a>00312         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].valid &amp;&amp; !<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].pte.locked() &amp;&amp;
<a name="l00313"></a>00313                 <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].range.partitionId == partition_id) {
<a name="l00314"></a>00314             <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_front(&amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>]);
<a name="l00315"></a>00315             <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].valid = <span class="keyword">false</span>;
<a name="l00316"></a>00316             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].used) {
<a name="l00317"></a>00317                 <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].used = <span class="keyword">false</span>;
<a name="l00318"></a>00318                 <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>--;
<a name="l00319"></a>00319             }
<a name="l00320"></a>00320             <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.erase(<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range);
<a name="l00321"></a>00321         }
<a name="l00322"></a>00322     }
<a name="l00323"></a>00323 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af7e91d9c8e43607b3064697810576e28"></a><!-- doxytag: member="SparcISA::TLB::demapContext" ref="af7e91d9c8e43607b3064697810576e28" args="(int partition_id, int context_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void demapContext </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>partition_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>context_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remove all entries that match a given context/partition id. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00286"></a>00286 {
<a name="l00287"></a>00287     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(IPR, <span class="stringliteral">&quot;TLB: Demapping Context pid=%#d cid=%d\n&quot;</span>,
<a name="l00288"></a>00288             partition_id, context_id);
<a name="l00289"></a>00289     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">false</span>;
<a name="l00290"></a>00290     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++) {
<a name="l00291"></a>00291         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].range.contextId == context_id &amp;&amp;
<a name="l00292"></a>00292             <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].range.partitionId == partition_id) {
<a name="l00293"></a>00293             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].valid) {
<a name="l00294"></a>00294                 <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_front(&amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>]);
<a name="l00295"></a>00295             }
<a name="l00296"></a>00296             <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].valid = <span class="keyword">false</span>;
<a name="l00297"></a>00297             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].used) {
<a name="l00298"></a>00298                 <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].used = <span class="keyword">false</span>;
<a name="l00299"></a>00299                 <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>--;
<a name="l00300"></a>00300             }
<a name="l00301"></a>00301             <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.erase(<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].range);
<a name="l00302"></a>00302         }
<a name="l00303"></a>00303     }
<a name="l00304"></a>00304 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2d698ff909513b48a1263f8a5440e067"></a><!-- doxytag: member="SparcISA::TLB::demapPage" ref="a2d698ff909513b48a1263f8a5440e067" args="(Addr vaddr, uint64_t asn)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void demapPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>vaddr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>asn</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classBaseTLB.html#aff4b9d01b9a4712c699cfb2dd9b3b8cd">BaseTLB</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00161"></a>00161     {
<a name="l00162"></a>00162         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;demapPage(Addr) is not implemented.\n&quot;</span>);
<a name="l00163"></a>00163     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a81a25ef373ef91ac81bb1717e4c9dcb0"></a><!-- doxytag: member="SparcISA::TLB::demapPage" ref="a81a25ef373ef91ac81bb1717e4c9dcb0" args="(Addr va, int partition_id, bool real, int context_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void demapPage </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>partition_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>context_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remve all entries that match a certain partition id, (contextid), and va). </p>

<p><div class="fragment"><pre class="fragment"><a name="l00254"></a>00254 {
<a name="l00255"></a>00255     TlbRange tr;
<a name="l00256"></a>00256     <a class="code" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(IPR, <span class="stringliteral">&quot;TLB: Demapping Page va=%#x pid=%#d cid=%d r=%d\n&quot;</span>,
<a name="l00259"></a>00259             <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>, partition_id, context_id, real);
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">false</span>;
<a name="l00262"></a>00262 
<a name="l00263"></a>00263     <span class="comment">// Assemble full address structure</span>
<a name="l00264"></a>00264     tr.va = <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>;
<a name="l00265"></a>00265     tr.size = 1;
<a name="l00266"></a>00266     tr.contextId = context_id;
<a name="l00267"></a>00267     tr.partitionId = partition_id;
<a name="l00268"></a>00268     tr.real = real;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270     <span class="comment">// Demap any entry that conflicts</span>
<a name="l00271"></a>00271     i = <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.find(tr);
<a name="l00272"></a>00272     <span class="keywordflow">if</span> (i != <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.end()) {
<a name="l00273"></a>00273         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(IPR, <span class="stringliteral">&quot;TLB: Demapped page\n&quot;</span>);
<a name="l00274"></a>00274         i-&gt;second-&gt;valid = <span class="keyword">false</span>;
<a name="l00275"></a>00275         <span class="keywordflow">if</span> (i-&gt;second-&gt;used) {
<a name="l00276"></a>00276             i-&gt;second-&gt;used = <span class="keyword">false</span>;
<a name="l00277"></a>00277             <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>--;
<a name="l00278"></a>00278         }
<a name="l00279"></a>00279         <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_front(i-&gt;second);
<a name="l00280"></a>00280         <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.erase(i);
<a name="l00281"></a>00281     }
<a name="l00282"></a>00282 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ac90a1eb3091d70b4d1465154d799db46"></a><!-- doxytag: member="SparcISA::TLB::doMmuRegRead" ref="ac90a1eb3091d70b4d1465154d799db46" args="(ThreadContext *tc, Packet *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> doMmuRegRead </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPacket.html">Packet</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00859"></a>00859 {
<a name="l00860"></a>00860     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> = pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>();
<a name="l00861"></a>00861     <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a> asi = (<a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a>)pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#aefd0ec4015a880de7bbf555b15e242b1">getArchFlags</a>();
<a name="l00862"></a>00862     uint64_t temp;
<a name="l00863"></a>00863 
<a name="l00864"></a>00864     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(IPR, <span class="stringliteral">&quot;Memory Mapped IPR Read: asi=%#X a=%#x\n&quot;</span>,
<a name="l00865"></a>00865          (<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#aefd0ec4015a880de7bbf555b15e242b1">getArchFlags</a>(), pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>());
<a name="l00866"></a>00866 
<a name="l00867"></a>00867     <a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a> *itb = tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>();
<a name="l00868"></a>00868 
<a name="l00869"></a>00869     <span class="keywordflow">switch</span> (asi) {
<a name="l00870"></a>00870       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a398eddc0651fd2d1a7bdc5e4875e7014">ASI_LSU_CONTROL_REG</a>:
<a name="l00871"></a>00871         assert(va == 0);
<a name="l00872"></a>00872         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a4a6707e46e0beb2a7224bc0616d5971d">MISCREG_MMU_LSU_CTRL</a>));
<a name="l00873"></a>00873         <span class="keywordflow">break</span>;
<a name="l00874"></a>00874       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aa3c5a664053947b87ec49c0faae2506a">ASI_MMU</a>:
<a name="l00875"></a>00875         <span class="keywordflow">switch</span> (va) {
<a name="l00876"></a>00876           <span class="keywordflow">case</span> 0x8:
<a name="l00877"></a>00877             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a478dbe5c19351f5d7ce762be37fe0113">MISCREG_MMU_P_CONTEXT</a>));
<a name="l00878"></a>00878             <span class="keywordflow">break</span>;
<a name="l00879"></a>00879           <span class="keywordflow">case</span> 0x10:
<a name="l00880"></a>00880             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67aec4547f75bde7ae68baa50fbfdeb4478">MISCREG_MMU_S_CONTEXT</a>));
<a name="l00881"></a>00881             <span class="keywordflow">break</span>;
<a name="l00882"></a>00882           <span class="keywordflow">default</span>:
<a name="l00883"></a>00883             <span class="keywordflow">goto</span> doMmuReadError;
<a name="l00884"></a>00884         }
<a name="l00885"></a>00885         <span class="keywordflow">break</span>;
<a name="l00886"></a>00886       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ad4d4afc40a6d7eb77ef1a442ab9017a6">ASI_QUEUE</a>:
<a name="l00887"></a>00887         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a81ca66cee2aadc5cd33b8138db307849">MISCREG_QUEUE_CPU_MONDO_HEAD</a> +
<a name="l00888"></a>00888                     (va &gt;&gt; 4) - 0x3c));
<a name="l00889"></a>00889         <span class="keywordflow">break</span>;
<a name="l00890"></a>00890       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a79d80f1dc735b1bf94db306867765cf0">ASI_DMMU_CTXT_ZERO_TSB_BASE_PS0</a>:
<a name="l00891"></a>00891         assert(va == 0);
<a name="l00892"></a>00892         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a>);
<a name="l00893"></a>00893         <span class="keywordflow">break</span>;
<a name="l00894"></a>00894       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a02ffd985f08d0f930403e9e3183997de">ASI_DMMU_CTXT_ZERO_TSB_BASE_PS1</a>:
<a name="l00895"></a>00895         assert(va == 0);
<a name="l00896"></a>00896         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a>);
<a name="l00897"></a>00897         <span class="keywordflow">break</span>;
<a name="l00898"></a>00898       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a9127fbcda67c82b315d3a91fc245a42e">ASI_DMMU_CTXT_ZERO_CONFIG</a>:
<a name="l00899"></a>00899         assert(va == 0);
<a name="l00900"></a>00900         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>);
<a name="l00901"></a>00901         <span class="keywordflow">break</span>;
<a name="l00902"></a>00902       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ad6d094185ca66a67ce2d96a07b27b9df">ASI_IMMU_CTXT_ZERO_TSB_BASE_PS0</a>:
<a name="l00903"></a>00903         assert(va == 0);
<a name="l00904"></a>00904         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;c0_tsb_ps0);
<a name="l00905"></a>00905         <span class="keywordflow">break</span>;
<a name="l00906"></a>00906       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aed27b34cf4c8494150a1159c04139356">ASI_IMMU_CTXT_ZERO_TSB_BASE_PS1</a>:
<a name="l00907"></a>00907         assert(va == 0);
<a name="l00908"></a>00908         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;c0_tsb_ps1);
<a name="l00909"></a>00909         <span class="keywordflow">break</span>;
<a name="l00910"></a>00910       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ad4cee8abff015247865fd75aff81dd5b">ASI_IMMU_CTXT_ZERO_CONFIG</a>:
<a name="l00911"></a>00911         assert(va == 0);
<a name="l00912"></a>00912         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;c0_config);
<a name="l00913"></a>00913         <span class="keywordflow">break</span>;
<a name="l00914"></a>00914       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a3a09de027e5e8d32fe1d8f036f44038a">ASI_DMMU_CTXT_NONZERO_TSB_BASE_PS0</a>:
<a name="l00915"></a>00915         assert(va == 0);
<a name="l00916"></a>00916         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a>);
<a name="l00917"></a>00917         <span class="keywordflow">break</span>;
<a name="l00918"></a>00918       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ae485b3d0dcadda627264a2b94293d0dd">ASI_DMMU_CTXT_NONZERO_TSB_BASE_PS1</a>:
<a name="l00919"></a>00919         assert(va == 0);
<a name="l00920"></a>00920         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a>);
<a name="l00921"></a>00921         <span class="keywordflow">break</span>;
<a name="l00922"></a>00922       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a9e6fd0719e3846fca804369478bf8d69">ASI_DMMU_CTXT_NONZERO_CONFIG</a>:
<a name="l00923"></a>00923         assert(va == 0);
<a name="l00924"></a>00924         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>);
<a name="l00925"></a>00925         <span class="keywordflow">break</span>;
<a name="l00926"></a>00926       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aeeb6893031be8b60b1c4d695e9afd72e">ASI_IMMU_CTXT_NONZERO_TSB_BASE_PS0</a>:
<a name="l00927"></a>00927         assert(va == 0);
<a name="l00928"></a>00928         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;cx_tsb_ps0);
<a name="l00929"></a>00929         <span class="keywordflow">break</span>;
<a name="l00930"></a>00930       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a058db0e724aefaf2ebf5e6d8ee7089aa">ASI_IMMU_CTXT_NONZERO_TSB_BASE_PS1</a>:
<a name="l00931"></a>00931         assert(va == 0);
<a name="l00932"></a>00932         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;cx_tsb_ps1);
<a name="l00933"></a>00933         <span class="keywordflow">break</span>;
<a name="l00934"></a>00934       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a8faf2433e4ee4a065b5f9931c37d4cd2">ASI_IMMU_CTXT_NONZERO_CONFIG</a>:
<a name="l00935"></a>00935         assert(va == 0);
<a name="l00936"></a>00936         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;cx_config);
<a name="l00937"></a>00937         <span class="keywordflow">break</span>;
<a name="l00938"></a>00938       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a647533f39b702d2b941cca947424010b">ASI_SPARC_ERROR_STATUS_REG</a>:
<a name="l00939"></a>00939         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>((uint64_t)0);
<a name="l00940"></a>00940         <span class="keywordflow">break</span>;
<a name="l00941"></a>00941       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a711c94f5d67294ae30136ffb73ef95e0">ASI_HYP_SCRATCHPAD</a>:
<a name="l00942"></a>00942       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a25874ec8febf8f142d4c3bd62656bfa9">ASI_SCRATCHPAD</a>:
<a name="l00943"></a>00943         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67affc310b430a8d17b7eb47af9a193e41a">MISCREG_SCRATCHPAD_R0</a> + (va &gt;&gt; 3)));
<a name="l00944"></a>00944         <span class="keywordflow">break</span>;
<a name="l00945"></a>00945       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a337bf91156b14a4b25905f1a0b2f5142">ASI_IMMU</a>:
<a name="l00946"></a>00946         <span class="keywordflow">switch</span> (va) {
<a name="l00947"></a>00947           <span class="keywordflow">case</span> 0x0:
<a name="l00948"></a>00948             temp = itb-&gt;tag_access;
<a name="l00949"></a>00949             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(temp,63,22) | <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(temp,12,0) &lt;&lt; 48);
<a name="l00950"></a>00950             <span class="keywordflow">break</span>;
<a name="l00951"></a>00951           <span class="keywordflow">case</span> 0x18:
<a name="l00952"></a>00952             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;sfsr);
<a name="l00953"></a>00953             <span class="keywordflow">break</span>;
<a name="l00954"></a>00954           <span class="keywordflow">case</span> 0x30:
<a name="l00955"></a>00955             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(itb-&gt;tag_access);
<a name="l00956"></a>00956             <span class="keywordflow">break</span>;
<a name="l00957"></a>00957           <span class="keywordflow">default</span>:
<a name="l00958"></a>00958             <span class="keywordflow">goto</span> doMmuReadError;
<a name="l00959"></a>00959         }
<a name="l00960"></a>00960         <span class="keywordflow">break</span>;
<a name="l00961"></a>00961       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a46474a3165406b7157c198ba554512e2">ASI_DMMU</a>:
<a name="l00962"></a>00962         <span class="keywordflow">switch</span> (va) {
<a name="l00963"></a>00963           <span class="keywordflow">case</span> 0x0:
<a name="l00964"></a>00964             temp = <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>;
<a name="l00965"></a>00965             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(temp,63,22) | <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(temp,12,0) &lt;&lt; 48);
<a name="l00966"></a>00966             <span class="keywordflow">break</span>;
<a name="l00967"></a>00967           <span class="keywordflow">case</span> 0x18:
<a name="l00968"></a>00968             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a>);
<a name="l00969"></a>00969             <span class="keywordflow">break</span>;
<a name="l00970"></a>00970           <span class="keywordflow">case</span> 0x20:
<a name="l00971"></a>00971             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a>);
<a name="l00972"></a>00972             <span class="keywordflow">break</span>;
<a name="l00973"></a>00973           <span class="keywordflow">case</span> 0x30:
<a name="l00974"></a>00974             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>);
<a name="l00975"></a>00975             <span class="keywordflow">break</span>;
<a name="l00976"></a>00976           <span class="keywordflow">case</span> 0x80:
<a name="l00977"></a>00977             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67abd6a0732761545e40b05fcd41bdfb340">MISCREG_MMU_PART_ID</a>));
<a name="l00978"></a>00978             <span class="keywordflow">break</span>;
<a name="l00979"></a>00979           <span class="keywordflow">default</span>:
<a name="l00980"></a>00980                 <span class="keywordflow">goto</span> doMmuReadError;
<a name="l00981"></a>00981         }
<a name="l00982"></a>00982         <span class="keywordflow">break</span>;
<a name="l00983"></a>00983       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a8db433fb34a04fb3fc15cb4e8cc95fb7">ASI_DMMU_TSB_PS0_PTR_REG</a>:
<a name="l00984"></a>00984         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>,
<a name="l00985"></a>00985             <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>,
<a name="l00986"></a>00986             <a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a>,
<a name="l00987"></a>00987             <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>,
<a name="l00988"></a>00988             <a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a>,
<a name="l00989"></a>00989             <a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>));
<a name="l00990"></a>00990         <span class="keywordflow">break</span>;
<a name="l00991"></a>00991       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a8736fd444e044bedb9bc22dd6938d0ee">ASI_DMMU_TSB_PS1_PTR_REG</a>:
<a name="l00992"></a>00992         pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>,
<a name="l00993"></a>00993                 <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>,
<a name="l00994"></a>00994                 <a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a>,
<a name="l00995"></a>00995                 <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>,
<a name="l00996"></a>00996                 <a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a>,
<a name="l00997"></a>00997                 <a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>));
<a name="l00998"></a>00998         <span class="keywordflow">break</span>;
<a name="l00999"></a>00999       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a9fe30ba6c52e99c829f793a837aba380">ASI_IMMU_TSB_PS0_PTR_REG</a>:
<a name="l01000"></a>01000           pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>,
<a name="l01001"></a>01001                 itb-&gt;tag_access,
<a name="l01002"></a>01002                 itb-&gt;c0_tsb_ps0,
<a name="l01003"></a>01003                 itb-&gt;c0_config,
<a name="l01004"></a>01004                 itb-&gt;cx_tsb_ps0,
<a name="l01005"></a>01005                 itb-&gt;cx_config));
<a name="l01006"></a>01006         <span class="keywordflow">break</span>;
<a name="l01007"></a>01007       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a58af1ebeb5420602be796503655d627a">ASI_IMMU_TSB_PS1_PTR_REG</a>:
<a name="l01008"></a>01008           pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(<a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>,
<a name="l01009"></a>01009                 itb-&gt;tag_access,
<a name="l01010"></a>01010                 itb-&gt;c0_tsb_ps1,
<a name="l01011"></a>01011                 itb-&gt;c0_config,
<a name="l01012"></a>01012                 itb-&gt;cx_tsb_ps1,
<a name="l01013"></a>01013                 itb-&gt;cx_config));
<a name="l01014"></a>01014         <span class="keywordflow">break</span>;
<a name="l01015"></a>01015       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a05669b9b99806fc02f7b9aba7309658f">ASI_SWVR_INTR_RECEIVE</a>:
<a name="l01016"></a>01016         {
<a name="l01017"></a>01017             <a class="code" href="classSparcISA_1_1Interrupts.html">SparcISA::Interrupts</a> * interrupts =
<a name="l01018"></a>01018                 <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSparcISA_1_1Interrupts.html">SparcISA::Interrupts</a> *<span class="keyword">&gt;</span>(
<a name="l01019"></a>01019                         tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;getInterruptController());
<a name="l01020"></a>01020             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(interrupts-&gt;<a class="code" href="classSparcISA_1_1Interrupts.html#a87abae3604f8bd69ae89e91881110a39">get_vec</a>(<a class="code" href="namespaceSparcISA.html#acdad6d81b9a94402ce3979d531ae4f40a0807b145d67d73e999f80760688319f6">IT_INT_VEC</a>));
<a name="l01021"></a>01021         }
<a name="l01022"></a>01022         <span class="keywordflow">break</span>;
<a name="l01023"></a>01023       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3af692dc2c4c99d6ae0248b83b9c7d9343">ASI_SWVR_UDB_INTR_R</a>:
<a name="l01024"></a>01024         {
<a name="l01025"></a>01025             <a class="code" href="classSparcISA_1_1Interrupts.html">SparcISA::Interrupts</a> * interrupts =
<a name="l01026"></a>01026                 <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSparcISA_1_1Interrupts.html">SparcISA::Interrupts</a> *<span class="keyword">&gt;</span>(
<a name="l01027"></a>01027                         tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;getInterruptController());
<a name="l01028"></a>01028             temp = <a class="code" href="bitfield_8hh.html#aa8f1ff3b89ba9c337baeef12d161580f">findMsbSet</a>(interrupts-&gt;<a class="code" href="classSparcISA_1_1Interrupts.html#a87abae3604f8bd69ae89e91881110a39">get_vec</a>(<a class="code" href="namespaceSparcISA.html#acdad6d81b9a94402ce3979d531ae4f40a0807b145d67d73e999f80760688319f6">IT_INT_VEC</a>));
<a name="l01029"></a>01029             tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;clearInterrupt(<a class="code" href="namespaceSparcISA.html#acdad6d81b9a94402ce3979d531ae4f40a0807b145d67d73e999f80760688319f6">IT_INT_VEC</a>, temp);
<a name="l01030"></a>01030             pkt-&gt;<a class="code" href="classPacket.html#a64d947d8dd285398050238bf26c1d8d2">set</a>(temp);
<a name="l01031"></a>01031         }
<a name="l01032"></a>01032         <span class="keywordflow">break</span>;
<a name="l01033"></a>01033       <span class="keywordflow">default</span>:
<a name="l01034"></a>01034 doMmuReadError:
<a name="l01035"></a>01035         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;need to impl DTB::doMmuRegRead() got asi=%#x, va=%#x\n&quot;</span>,
<a name="l01036"></a>01036             (<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)asi, va);
<a name="l01037"></a>01037     }
<a name="l01038"></a>01038     pkt-&gt;<a class="code" href="classPacket.html#ad664e704f09d6bb5c116573721034ebd">makeAtomicResponse</a>();
<a name="l01039"></a>01039     <span class="keywordflow">return</span> <a class="code" href="classCycles.html">Cycles</a>(1);
<a name="l01040"></a>01040 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acdfde16dc50b29fe74f4b7c3f9711d43"></a><!-- doxytag: member="SparcISA::TLB::doMmuRegWrite" ref="acdfde16dc50b29fe74f4b7c3f9711d43" args="(ThreadContext *tc, Packet *pkt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCycles.html">Cycles</a> doMmuRegWrite </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classPacket.html">Packet</a> *&nbsp;</td>
          <td class="paramname"> <em>pkt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01044"></a>01044 {
<a name="l01045"></a>01045     uint64_t data = pkt-&gt;<a class="code" href="classPacket.html#af6ea056c8af82f08af9fd0d857967f9b">get</a>&lt;uint64_t&gt;();
<a name="l01046"></a>01046     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> = pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>();
<a name="l01047"></a>01047     <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a> asi = (<a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a>)pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#aefd0ec4015a880de7bbf555b15e242b1">getArchFlags</a>();
<a name="l01048"></a>01048 
<a name="l01049"></a>01049     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> ta_insert;
<a name="l01050"></a>01050     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> va_insert;
<a name="l01051"></a>01051     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> ct_insert;
<a name="l01052"></a>01052     <span class="keywordtype">int</span> part_insert;
<a name="l01053"></a>01053     <span class="keywordtype">int</span> entry_insert = -1;
<a name="l01054"></a>01054     <span class="keywordtype">bool</span> real_insert;
<a name="l01055"></a>01055     <span class="keywordtype">bool</span> <a class="code" href="namespaceTrace.html#a827db600690db919f77af4e28514a655">ignore</a>;
<a name="l01056"></a>01056     <span class="keywordtype">int</span> part_id;
<a name="l01057"></a>01057     <span class="keywordtype">int</span> ctx_id;
<a name="l01058"></a>01058     PageTableEntry pte;
<a name="l01059"></a>01059 
<a name="l01060"></a>01060     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(IPR, <span class="stringliteral">&quot;Memory Mapped IPR Write: asi=%#X a=%#x d=%#X\n&quot;</span>,
<a name="l01061"></a>01061          (<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)asi, va, data);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063     <a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a> *itb = tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>();
<a name="l01064"></a>01064 
<a name="l01065"></a>01065     <span class="keywordflow">switch</span> (asi) {
<a name="l01066"></a>01066       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a398eddc0651fd2d1a7bdc5e4875e7014">ASI_LSU_CONTROL_REG</a>:
<a name="l01067"></a>01067         assert(va == 0);
<a name="l01068"></a>01068         tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a4a6707e46e0beb2a7224bc0616d5971d">MISCREG_MMU_LSU_CTRL</a>, data);
<a name="l01069"></a>01069         <span class="keywordflow">break</span>;
<a name="l01070"></a>01070       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aa3c5a664053947b87ec49c0faae2506a">ASI_MMU</a>:
<a name="l01071"></a>01071         <span class="keywordflow">switch</span> (va) {
<a name="l01072"></a>01072           <span class="keywordflow">case</span> 0x8:
<a name="l01073"></a>01073             tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a478dbe5c19351f5d7ce762be37fe0113">MISCREG_MMU_P_CONTEXT</a>, data);
<a name="l01074"></a>01074             <span class="keywordflow">break</span>;
<a name="l01075"></a>01075           <span class="keywordflow">case</span> 0x10:
<a name="l01076"></a>01076             tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67aec4547f75bde7ae68baa50fbfdeb4478">MISCREG_MMU_S_CONTEXT</a>, data);
<a name="l01077"></a>01077             <span class="keywordflow">break</span>;
<a name="l01078"></a>01078           <span class="keywordflow">default</span>:
<a name="l01079"></a>01079             <span class="keywordflow">goto</span> doMmuWriteError;
<a name="l01080"></a>01080         }
<a name="l01081"></a>01081         <span class="keywordflow">break</span>;
<a name="l01082"></a>01082       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ad4d4afc40a6d7eb77ef1a442ab9017a6">ASI_QUEUE</a>:
<a name="l01083"></a>01083         assert(<a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(data,13,6) == data);
<a name="l01084"></a>01084         tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a81ca66cee2aadc5cd33b8138db307849">MISCREG_QUEUE_CPU_MONDO_HEAD</a> +
<a name="l01085"></a>01085                     (va &gt;&gt; 4) - 0x3c, data);
<a name="l01086"></a>01086         <span class="keywordflow">break</span>;
<a name="l01087"></a>01087       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a79d80f1dc735b1bf94db306867765cf0">ASI_DMMU_CTXT_ZERO_TSB_BASE_PS0</a>:
<a name="l01088"></a>01088         assert(va == 0);
<a name="l01089"></a>01089         <a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a> = data;
<a name="l01090"></a>01090         <span class="keywordflow">break</span>;
<a name="l01091"></a>01091       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a02ffd985f08d0f930403e9e3183997de">ASI_DMMU_CTXT_ZERO_TSB_BASE_PS1</a>:
<a name="l01092"></a>01092         assert(va == 0);
<a name="l01093"></a>01093         <a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a> = data;
<a name="l01094"></a>01094         <span class="keywordflow">break</span>;
<a name="l01095"></a>01095       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a9127fbcda67c82b315d3a91fc245a42e">ASI_DMMU_CTXT_ZERO_CONFIG</a>:
<a name="l01096"></a>01096         assert(va == 0);
<a name="l01097"></a>01097         <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a> = data;
<a name="l01098"></a>01098         <span class="keywordflow">break</span>;
<a name="l01099"></a>01099       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ad6d094185ca66a67ce2d96a07b27b9df">ASI_IMMU_CTXT_ZERO_TSB_BASE_PS0</a>:
<a name="l01100"></a>01100         assert(va == 0);
<a name="l01101"></a>01101         itb-&gt;c0_tsb_ps0 = data;
<a name="l01102"></a>01102         <span class="keywordflow">break</span>;
<a name="l01103"></a>01103       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aed27b34cf4c8494150a1159c04139356">ASI_IMMU_CTXT_ZERO_TSB_BASE_PS1</a>:
<a name="l01104"></a>01104         assert(va == 0);
<a name="l01105"></a>01105         itb-&gt;c0_tsb_ps1 = data;
<a name="l01106"></a>01106         <span class="keywordflow">break</span>;
<a name="l01107"></a>01107       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ad4cee8abff015247865fd75aff81dd5b">ASI_IMMU_CTXT_ZERO_CONFIG</a>:
<a name="l01108"></a>01108         assert(va == 0);
<a name="l01109"></a>01109         itb-&gt;c0_config = data;
<a name="l01110"></a>01110         <span class="keywordflow">break</span>;
<a name="l01111"></a>01111       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a3a09de027e5e8d32fe1d8f036f44038a">ASI_DMMU_CTXT_NONZERO_TSB_BASE_PS0</a>:
<a name="l01112"></a>01112         assert(va == 0);
<a name="l01113"></a>01113         <a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a> = data;
<a name="l01114"></a>01114         <span class="keywordflow">break</span>;
<a name="l01115"></a>01115       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ae485b3d0dcadda627264a2b94293d0dd">ASI_DMMU_CTXT_NONZERO_TSB_BASE_PS1</a>:
<a name="l01116"></a>01116         assert(va == 0);
<a name="l01117"></a>01117         <a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a> = data;
<a name="l01118"></a>01118         <span class="keywordflow">break</span>;
<a name="l01119"></a>01119       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a9e6fd0719e3846fca804369478bf8d69">ASI_DMMU_CTXT_NONZERO_CONFIG</a>:
<a name="l01120"></a>01120         assert(va == 0);
<a name="l01121"></a>01121         <a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a> = data;
<a name="l01122"></a>01122         <span class="keywordflow">break</span>;
<a name="l01123"></a>01123       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aeeb6893031be8b60b1c4d695e9afd72e">ASI_IMMU_CTXT_NONZERO_TSB_BASE_PS0</a>:
<a name="l01124"></a>01124         assert(va == 0);
<a name="l01125"></a>01125         itb-&gt;cx_tsb_ps0 = data;
<a name="l01126"></a>01126         <span class="keywordflow">break</span>;
<a name="l01127"></a>01127       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a058db0e724aefaf2ebf5e6d8ee7089aa">ASI_IMMU_CTXT_NONZERO_TSB_BASE_PS1</a>:
<a name="l01128"></a>01128         assert(va == 0);
<a name="l01129"></a>01129         itb-&gt;cx_tsb_ps1 = data;
<a name="l01130"></a>01130         <span class="keywordflow">break</span>;
<a name="l01131"></a>01131       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a8faf2433e4ee4a065b5f9931c37d4cd2">ASI_IMMU_CTXT_NONZERO_CONFIG</a>:
<a name="l01132"></a>01132         assert(va == 0);
<a name="l01133"></a>01133         itb-&gt;cx_config = data;
<a name="l01134"></a>01134         <span class="keywordflow">break</span>;
<a name="l01135"></a>01135       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a8c09673cdcd8679f70b23acf234aebfa">ASI_SPARC_ERROR_EN_REG</a>:
<a name="l01136"></a>01136       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a647533f39b702d2b941cca947424010b">ASI_SPARC_ERROR_STATUS_REG</a>:
<a name="l01137"></a>01137         <a class="code" href="base_2misc_8hh.html#ae7d790080fa18103d7582effff570b9e">inform</a>(<span class="stringliteral">&quot;Ignoring write to SPARC ERROR regsiter\n&quot;</span>);
<a name="l01138"></a>01138         <span class="keywordflow">break</span>;
<a name="l01139"></a>01139       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a711c94f5d67294ae30136ffb73ef95e0">ASI_HYP_SCRATCHPAD</a>:
<a name="l01140"></a>01140       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a25874ec8febf8f142d4c3bd62656bfa9">ASI_SCRATCHPAD</a>:
<a name="l01141"></a>01141         tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67affc310b430a8d17b7eb47af9a193e41a">MISCREG_SCRATCHPAD_R0</a> + (va &gt;&gt; 3), data);
<a name="l01142"></a>01142         <span class="keywordflow">break</span>;
<a name="l01143"></a>01143       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a337bf91156b14a4b25905f1a0b2f5142">ASI_IMMU</a>:
<a name="l01144"></a>01144         <span class="keywordflow">switch</span> (va) {
<a name="l01145"></a>01145           <span class="keywordflow">case</span> 0x18:
<a name="l01146"></a>01146             itb-&gt;sfsr = data;
<a name="l01147"></a>01147             <span class="keywordflow">break</span>;
<a name="l01148"></a>01148           <span class="keywordflow">case</span> 0x30:
<a name="l01149"></a>01149             sext&lt;59&gt;(<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(data, 59,0));
<a name="l01150"></a>01150             itb-&gt;tag_access = data;
<a name="l01151"></a>01151             <span class="keywordflow">break</span>;
<a name="l01152"></a>01152           <span class="keywordflow">default</span>:
<a name="l01153"></a>01153             <span class="keywordflow">goto</span> doMmuWriteError;
<a name="l01154"></a>01154         }
<a name="l01155"></a>01155         <span class="keywordflow">break</span>;
<a name="l01156"></a>01156       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3adacedf312d74ca082fe306ca99f16537">ASI_ITLB_DATA_ACCESS_REG</a>:
<a name="l01157"></a>01157         entry_insert = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va, 8,3);
<a name="l01158"></a>01158       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ab15563200e5ce30af30ec4aa756b6bc9">ASI_ITLB_DATA_IN_REG</a>:
<a name="l01159"></a>01159         assert(entry_insert != -1 || <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(va,10,9) == va);
<a name="l01160"></a>01160         ta_insert = itb-&gt;tag_access;
<a name="l01161"></a>01161         va_insert = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(ta_insert, 63,13);
<a name="l01162"></a>01162         ct_insert = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(ta_insert, 12,0);
<a name="l01163"></a>01163         part_insert = tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67abd6a0732761545e40b05fcd41bdfb340">MISCREG_MMU_PART_ID</a>);
<a name="l01164"></a>01164         real_insert = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va, 9,9);
<a name="l01165"></a>01165         pte.populate(data, <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,10,10) ? <a class="code" href="classSparcISA_1_1PageTableEntry.html#a9ed8d16c9ae7fae285dd2146c3159023a3b309a2e8c75af19cfced3b66b535eb6">PageTableEntry::sun4v</a> :
<a name="l01166"></a>01166                 <a class="code" href="classSparcISA_1_1PageTableEntry.html#a9ed8d16c9ae7fae285dd2146c3159023aef2b71a9a817d2bfc89fef7007765293">PageTableEntry::sun4u</a>);
<a name="l01167"></a>01167         tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>()-&gt;insert(va_insert, part_insert, ct_insert, real_insert,
<a name="l01168"></a>01168                 pte, entry_insert);
<a name="l01169"></a>01169         <span class="keywordflow">break</span>;
<a name="l01170"></a>01170       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ac41ca1d1e3c5d22e4d360bd4d74f0c98">ASI_DTLB_DATA_ACCESS_REG</a>:
<a name="l01171"></a>01171         entry_insert = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va, 8,3);
<a name="l01172"></a>01172       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a59d36f43c8056ddb8cba9e50bf0c3997">ASI_DTLB_DATA_IN_REG</a>:
<a name="l01173"></a>01173         assert(entry_insert != -1 || <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(va,10,9) == va);
<a name="l01174"></a>01174         ta_insert = <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>;
<a name="l01175"></a>01175         va_insert = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(ta_insert, 63,13);
<a name="l01176"></a>01176         ct_insert = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(ta_insert, 12,0);
<a name="l01177"></a>01177         part_insert = tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67abd6a0732761545e40b05fcd41bdfb340">MISCREG_MMU_PART_ID</a>);
<a name="l01178"></a>01178         real_insert = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va, 9,9);
<a name="l01179"></a>01179         pte.populate(data, <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,10,10) ? <a class="code" href="classSparcISA_1_1PageTableEntry.html#a9ed8d16c9ae7fae285dd2146c3159023a3b309a2e8c75af19cfced3b66b535eb6">PageTableEntry::sun4v</a> :
<a name="l01180"></a>01180                 PageTableEntry::sun4u);
<a name="l01181"></a>01181         <a class="code" href="classSparcISA_1_1TLB.html#a2b2db94fc3a8f3652866d0dc2aabcf87">insert</a>(va_insert, part_insert, ct_insert, real_insert, pte,
<a name="l01182"></a>01182                entry_insert);
<a name="l01183"></a>01183         <span class="keywordflow">break</span>;
<a name="l01184"></a>01184       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3abebdb32d4c9dbcc9092004d1d7361f88">ASI_IMMU_DEMAP</a>:
<a name="l01185"></a>01185         ignore = <span class="keyword">false</span>;
<a name="l01186"></a>01186         ctx_id = -1;
<a name="l01187"></a>01187         part_id =  tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67abd6a0732761545e40b05fcd41bdfb340">MISCREG_MMU_PART_ID</a>);
<a name="l01188"></a>01188         <span class="keywordflow">switch</span> (<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,5,4)) {
<a name="l01189"></a>01189           <span class="keywordflow">case</span> 0:
<a name="l01190"></a>01190             ctx_id = tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a478dbe5c19351f5d7ce762be37fe0113">MISCREG_MMU_P_CONTEXT</a>);
<a name="l01191"></a>01191             <span class="keywordflow">break</span>;
<a name="l01192"></a>01192           <span class="keywordflow">case</span> 1:
<a name="l01193"></a>01193             ignore = <span class="keyword">true</span>;
<a name="l01194"></a>01194             <span class="keywordflow">break</span>;
<a name="l01195"></a>01195           <span class="keywordflow">case</span> 3:
<a name="l01196"></a>01196             ctx_id = 0;
<a name="l01197"></a>01197             <span class="keywordflow">break</span>;
<a name="l01198"></a>01198           <span class="keywordflow">default</span>:
<a name="l01199"></a>01199             ignore = <span class="keyword">true</span>;
<a name="l01200"></a>01200         }
<a name="l01201"></a>01201 
<a name="l01202"></a>01202         <span class="keywordflow">switch</span> (<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,7,6)) {
<a name="l01203"></a>01203           <span class="keywordflow">case</span> 0: <span class="comment">// demap page</span>
<a name="l01204"></a>01204             <span class="keywordflow">if</span> (!ignore)
<a name="l01205"></a>01205                 tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>()-&gt;demapPage(<a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(va,63,13), part_id,
<a name="l01206"></a>01206                         <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,9,9), ctx_id);
<a name="l01207"></a>01207             <span class="keywordflow">break</span>;
<a name="l01208"></a>01208           <span class="keywordflow">case</span> 1: <span class="comment">// demap context</span>
<a name="l01209"></a>01209             <span class="keywordflow">if</span> (!ignore)
<a name="l01210"></a>01210                 tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>()-&gt;demapContext(part_id, ctx_id);
<a name="l01211"></a>01211             <span class="keywordflow">break</span>;
<a name="l01212"></a>01212           <span class="keywordflow">case</span> 2:
<a name="l01213"></a>01213             tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>()-&gt;demapAll(part_id);
<a name="l01214"></a>01214             <span class="keywordflow">break</span>;
<a name="l01215"></a>01215           <span class="keywordflow">default</span>:
<a name="l01216"></a>01216             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Invalid type for IMMU demap\n&quot;</span>);
<a name="l01217"></a>01217         }
<a name="l01218"></a>01218         <span class="keywordflow">break</span>;
<a name="l01219"></a>01219       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a46474a3165406b7157c198ba554512e2">ASI_DMMU</a>:
<a name="l01220"></a>01220         <span class="keywordflow">switch</span> (va) {
<a name="l01221"></a>01221           <span class="keywordflow">case</span> 0x18:
<a name="l01222"></a>01222             <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> = data;
<a name="l01223"></a>01223             <span class="keywordflow">break</span>;
<a name="l01224"></a>01224           <span class="keywordflow">case</span> 0x30:
<a name="l01225"></a>01225             sext&lt;59&gt;(<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(data, 59,0));
<a name="l01226"></a>01226             <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a> = data;
<a name="l01227"></a>01227             <span class="keywordflow">break</span>;
<a name="l01228"></a>01228           <span class="keywordflow">case</span> 0x80:
<a name="l01229"></a>01229             tc-&gt;<a class="code" href="classThreadContext.html#a074166dc2fe3c4aea3ad588ed9883c51">setMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67abd6a0732761545e40b05fcd41bdfb340">MISCREG_MMU_PART_ID</a>, data);
<a name="l01230"></a>01230             <span class="keywordflow">break</span>;
<a name="l01231"></a>01231           <span class="keywordflow">default</span>:
<a name="l01232"></a>01232             <span class="keywordflow">goto</span> doMmuWriteError;
<a name="l01233"></a>01233         }
<a name="l01234"></a>01234         <span class="keywordflow">break</span>;
<a name="l01235"></a>01235       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a4e57082a0002e2dda9f475f33629b99e">ASI_DMMU_DEMAP</a>:
<a name="l01236"></a>01236         ignore = <span class="keyword">false</span>;
<a name="l01237"></a>01237         ctx_id = -1;
<a name="l01238"></a>01238         part_id =  tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67abd6a0732761545e40b05fcd41bdfb340">MISCREG_MMU_PART_ID</a>);
<a name="l01239"></a>01239         <span class="keywordflow">switch</span> (<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,5,4)) {
<a name="l01240"></a>01240           <span class="keywordflow">case</span> 0:
<a name="l01241"></a>01241             ctx_id = tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a478dbe5c19351f5d7ce762be37fe0113">MISCREG_MMU_P_CONTEXT</a>);
<a name="l01242"></a>01242             <span class="keywordflow">break</span>;
<a name="l01243"></a>01243           <span class="keywordflow">case</span> 1:
<a name="l01244"></a>01244             ctx_id = tc-&gt;<a class="code" href="classThreadContext.html#a6888f4bff21e34892e59654ea80073b2">readMiscReg</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67aec4547f75bde7ae68baa50fbfdeb4478">MISCREG_MMU_S_CONTEXT</a>);
<a name="l01245"></a>01245             <span class="keywordflow">break</span>;
<a name="l01246"></a>01246           <span class="keywordflow">case</span> 3:
<a name="l01247"></a>01247             ctx_id = 0;
<a name="l01248"></a>01248             <span class="keywordflow">break</span>;
<a name="l01249"></a>01249           <span class="keywordflow">default</span>:
<a name="l01250"></a>01250             ignore = <span class="keyword">true</span>;
<a name="l01251"></a>01251         }
<a name="l01252"></a>01252 
<a name="l01253"></a>01253         <span class="keywordflow">switch</span> (<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,7,6)) {
<a name="l01254"></a>01254           <span class="keywordflow">case</span> 0: <span class="comment">// demap page</span>
<a name="l01255"></a>01255             <span class="keywordflow">if</span> (!ignore)
<a name="l01256"></a>01256                 <a class="code" href="classSparcISA_1_1TLB.html#a81a25ef373ef91ac81bb1717e4c9dcb0">demapPage</a>(<a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(va,63,13), part_id, <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(va,9,9), ctx_id);
<a name="l01257"></a>01257             <span class="keywordflow">break</span>;
<a name="l01258"></a>01258           <span class="keywordflow">case</span> 1: <span class="comment">// demap context</span>
<a name="l01259"></a>01259             <span class="keywordflow">if</span> (!ignore)
<a name="l01260"></a>01260                 <a class="code" href="classSparcISA_1_1TLB.html#af7e91d9c8e43607b3064697810576e28">demapContext</a>(part_id, ctx_id);
<a name="l01261"></a>01261             <span class="keywordflow">break</span>;
<a name="l01262"></a>01262           <span class="keywordflow">case</span> 2:
<a name="l01263"></a>01263             <a class="code" href="classSparcISA_1_1TLB.html#a787d07e454d0dddde90f226346065ade">demapAll</a>(part_id);
<a name="l01264"></a>01264             <span class="keywordflow">break</span>;
<a name="l01265"></a>01265           <span class="keywordflow">default</span>:
<a name="l01266"></a>01266             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Invalid type for IMMU demap\n&quot;</span>);
<a name="l01267"></a>01267         }
<a name="l01268"></a>01268         <span class="keywordflow">break</span>;
<a name="l01269"></a>01269        <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a05669b9b99806fc02f7b9aba7309658f">ASI_SWVR_INTR_RECEIVE</a>:
<a name="l01270"></a>01270         {
<a name="l01271"></a>01271             <span class="keywordtype">int</span> msb;
<a name="l01272"></a>01272             <span class="comment">// clear all the interrupts that aren&apos;t set in the write</span>
<a name="l01273"></a>01273             <a class="code" href="classSparcISA_1_1Interrupts.html">SparcISA::Interrupts</a> * interrupts =
<a name="l01274"></a>01274                 <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSparcISA_1_1Interrupts.html">SparcISA::Interrupts</a> *<span class="keyword">&gt;</span>(
<a name="l01275"></a>01275                         tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;getInterruptController());
<a name="l01276"></a>01276             <span class="keywordflow">while</span> (interrupts-&gt;<a class="code" href="classSparcISA_1_1Interrupts.html#a87abae3604f8bd69ae89e91881110a39">get_vec</a>(<a class="code" href="namespaceSparcISA.html#acdad6d81b9a94402ce3979d531ae4f40a0807b145d67d73e999f80760688319f6">IT_INT_VEC</a>) &amp; data) {
<a name="l01277"></a>01277                 msb = <a class="code" href="bitfield_8hh.html#aa8f1ff3b89ba9c337baeef12d161580f">findMsbSet</a>(interrupts-&gt;<a class="code" href="classSparcISA_1_1Interrupts.html#a87abae3604f8bd69ae89e91881110a39">get_vec</a>(<a class="code" href="namespaceSparcISA.html#acdad6d81b9a94402ce3979d531ae4f40a0807b145d67d73e999f80760688319f6">IT_INT_VEC</a>) &amp; data);
<a name="l01278"></a>01278                 tc-&gt;<a class="code" href="classThreadContext.html#ad10a7ef049c2d2ffadfc809341e66d4e">getCpuPtr</a>()-&gt;clearInterrupt(<a class="code" href="namespaceSparcISA.html#acdad6d81b9a94402ce3979d531ae4f40a0807b145d67d73e999f80760688319f6">IT_INT_VEC</a>, msb);
<a name="l01279"></a>01279             }
<a name="l01280"></a>01280         }
<a name="l01281"></a>01281         <span class="keywordflow">break</span>;
<a name="l01282"></a>01282       <span class="keywordflow">case</span> <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a035868467ef161363dc8cb039f22c9e1">ASI_SWVR_UDB_INTR_W</a>:
<a name="l01283"></a>01283             tc-&gt;<a class="code" href="classThreadContext.html#a4585cb7174e215741001b70fafe6662e">getSystemPtr</a>()-&gt;<a class="code" href="classSystem.html#a19840a204c4d6f67b45a07073e8b41df">threadContexts</a>[<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(data,12,8)]-&gt;getCpuPtr()-&gt;
<a name="l01284"></a>01284             postInterrupt(<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(data, 5, 0), 0);
<a name="l01285"></a>01285         <span class="keywordflow">break</span>;
<a name="l01286"></a>01286       <span class="keywordflow">default</span>:
<a name="l01287"></a>01287 doMmuWriteError:
<a name="l01288"></a>01288         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;need to impl DTB::doMmuRegWrite() got asi=%#x, va=%#x d=%#x\n&quot;</span>,
<a name="l01289"></a>01289             (<a class="code" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>)pkt-&gt;<a class="code" href="classPacket.html#a956cd41d82347558b9c0a5b0474903f2" title="A pointer to the original request.">req</a>-&gt;<a class="code" href="classRequest.html#aefd0ec4015a880de7bbf555b15e242b1">getArchFlags</a>(), pkt-&gt;<a class="code" href="classPacket.html#afca9af4d83a57836baba87603463a6e0">getAddr</a>(), data);
<a name="l01290"></a>01290     }
<a name="l01291"></a>01291     pkt-&gt;<a class="code" href="classPacket.html#ad664e704f09d6bb5c116573721034ebd">makeAtomicResponse</a>();
<a name="l01292"></a>01292     <span class="keywordflow">return</span> <a class="code" href="classCycles.html">Cycles</a>(1);
<a name="l01293"></a>01293 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8cb66fc5f158a5d28cb9e5d73ecd26cc"></a><!-- doxytag: member="SparcISA::TLB::dumpAll" ref="a8cb66fc5f158a5d28cb9e5d73ecd26cc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dumpAll </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00240"></a>00240 {
<a name="l00241"></a>00241     <a class="code" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00242"></a>00242     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++) {
<a name="l00243"></a>00243         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].valid) {
<a name="l00244"></a>00244            <a class="code" href="trace_8hh.html#a8743588cbe0ed2266fabe1090b16da34">DPRINTFN</a>(<span class="stringliteral">&quot;%4d:  %#2x:%#2x %c %#4x %#8x %#8x %#16x\n&quot;</span>,
<a name="l00245"></a>00245                    <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>, <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].range.partitionId, <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.contextId,
<a name="l00246"></a>00246                    <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.real ? <span class="charliteral">&apos;R&apos;</span> : <span class="charliteral">&apos; &apos;</span>, <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.size,
<a name="l00247"></a>00247                    <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.va, <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].pte.paddr(), <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].pte());
<a name="l00248"></a>00248         }
<a name="l00249"></a>00249     }
<a name="l00250"></a>00250 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae199d95c42e036851a8a0543c6d6d2e3"></a><!-- doxytag: member="SparcISA::TLB::finalizePhysical" ref="ae199d95c42e036851a8a0543c6d6d2e3" args="(RequestPtr req, ThreadContext *tc, Mode mode) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">Fault</a> finalizePhysical </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00853"></a>00853 {
<a name="l00854"></a>00854     <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00855"></a>00855 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aca1483a67aee5a91e442f7131d66bcbd"></a><!-- doxytag: member="SparcISA::TLB::flushAll" ref="aca1483a67aee5a91e442f7131d66bcbd" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void flushAll </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remove all entries from the <a class="el" href="classSparcISA_1_1TLB.html">TLB</a> </p>

<p><a class="el" href="classBaseTLB.html#a5958bc92949a47d1be1088468abdc006">BaseTLB</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00327"></a>00327 {
<a name="l00328"></a>00328     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">false</span>;
<a name="l00329"></a>00329     <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.clear();
<a name="l00330"></a>00330 
<a name="l00331"></a>00331     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++) {
<a name="l00332"></a>00332         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].valid)
<a name="l00333"></a>00333             <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_back(&amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>]);
<a name="l00334"></a>00334         <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].valid = <span class="keyword">false</span>;
<a name="l00335"></a>00335         <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].used = <span class="keyword">false</span>;
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337     <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a> = 0;
<a name="l00338"></a>00338 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab52a39898286d036febd5dcb6d0b376a"></a><!-- doxytag: member="SparcISA::TLB::GetTsbPtr" ref="ab52a39898286d036febd5dcb6d0b376a" args="(ThreadContext *tc, Addr addr, int ctx, Addr *ptrs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetTsbPtr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ctx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> *&nbsp;</td>
          <td class="paramname"> <em>ptrs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01297"></a>01297 {
<a name="l01298"></a>01298     uint64_t <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a> = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(<a class="code" href="namespaceX86ISA.html#ab705917f60c5566f9ce56a93f798b2e2">addr</a>,63,13) | <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(ctx,12,0);
<a name="l01299"></a>01299     <a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a> * itb = tc-&gt;<a class="code" href="classThreadContext.html#aaae22e0dcf2f312619915bbf34509ba4">getITBPtr</a>();
<a name="l01300"></a>01300     ptrs[0] = <a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>, tag_access,
<a name="l01301"></a>01301                 <a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a>,
<a name="l01302"></a>01302                 <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>,
<a name="l01303"></a>01303                 <a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a>,
<a name="l01304"></a>01304                 <a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>);
<a name="l01305"></a>01305     ptrs[1] = <a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>, tag_access,
<a name="l01306"></a>01306                 <a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a>,
<a name="l01307"></a>01307                 <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>,
<a name="l01308"></a>01308                 <a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a>,
<a name="l01309"></a>01309                 <a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>);
<a name="l01310"></a>01310     ptrs[2] = <a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>, tag_access,
<a name="l01311"></a>01311                 itb-&gt;c0_tsb_ps0,
<a name="l01312"></a>01312                 itb-&gt;c0_config,
<a name="l01313"></a>01313                 itb-&gt;cx_tsb_ps0,
<a name="l01314"></a>01314                 itb-&gt;cx_config);
<a name="l01315"></a>01315     ptrs[3] = <a class="code" href="classSparcISA_1_1TLB.html#a69c520e9f2bec8ddb4eb5121cf10a94c">MakeTsbPtr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>, tag_access,
<a name="l01316"></a>01316                 itb-&gt;c0_tsb_ps1,
<a name="l01317"></a>01317                 itb-&gt;c0_config,
<a name="l01318"></a>01318                 itb-&gt;cx_tsb_ps1,
<a name="l01319"></a>01319                 itb-&gt;cx_config);
<a name="l01320"></a>01320 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2b2db94fc3a8f3652866d0dc2aabcf87"></a><!-- doxytag: member="SparcISA::TLB::insert" ref="a2b2db94fc3a8f3652866d0dc2aabcf87" args="(Addr vpn, int partition_id, int context_id, bool real, const PageTableEntry &amp;PTE, int entry=&#45;1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void insert </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>vpn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>partition_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>context_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classSparcISA_1_1PageTableEntry.html">PageTableEntry</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>PTE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>entry</em> = <code>-1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Insert a PTE into the <a class="el" href="classSparcISA_1_1TLB.html">TLB</a>. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00096"></a>00096 {
<a name="l00097"></a>00097     <a class="code" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00098"></a>00098     TlbEntry *new_entry = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00099"></a>00099 <span class="comment">//    TlbRange tr;</span>
<a name="l00100"></a>00100     <span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>;
<a name="l00101"></a>00101 
<a name="l00102"></a>00102     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">false</span>;
<a name="l00103"></a>00103     <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> &amp;= ~(PTE.size()-1);
<a name="l00104"></a>00104  <span class="comment">/*   tr.va = va;</span>
<a name="l00105"></a>00105 <span class="comment">    tr.size = PTE.size() - 1;</span>
<a name="l00106"></a>00106 <span class="comment">    tr.contextId = context_id;</span>
<a name="l00107"></a>00107 <span class="comment">    tr.partitionId = partition_id;</span>
<a name="l00108"></a>00108 <span class="comment">    tr.real = real;</span>
<a name="l00109"></a>00109 <span class="comment">*/</span>
<a name="l00110"></a>00110 
<a name="l00111"></a>00111     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>,
<a name="l00112"></a>00112         <span class="stringliteral">&quot;TLB: Inserting Entry; va=%#x pa=%#x pid=%d cid=%d r=%d entryid=%d\n&quot;</span>,
<a name="l00113"></a>00113         <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>, PTE.paddr(), partition_id, context_id, (int)real, entry);
<a name="l00114"></a>00114 
<a name="l00115"></a>00115     <span class="comment">// Demap any entry that conflicts</span>
<a name="l00116"></a>00116     <span class="keywordflow">for</span> (x = 0; x &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; x++) {
<a name="l00117"></a>00117         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.real == real &amp;&amp;
<a name="l00118"></a>00118             <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.partitionId == partition_id &amp;&amp;
<a name="l00119"></a>00119             <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.va &lt; <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> + PTE.size() - 1 &amp;&amp;
<a name="l00120"></a>00120             <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.va + <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.size &gt;= <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> &amp;&amp;
<a name="l00121"></a>00121             (real || <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range.contextId == context_id ))
<a name="l00122"></a>00122         {
<a name="l00123"></a>00123             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].valid) {
<a name="l00124"></a>00124                 <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_front(&amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x]);
<a name="l00125"></a>00125                 <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: Conflicting entry %#X , deleting it\n&quot;</span>, x);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127                 <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].valid = <span class="keyword">false</span>;
<a name="l00128"></a>00128                 <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].used) {
<a name="l00129"></a>00129                     <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].used = <span class="keyword">false</span>;
<a name="l00130"></a>00130                     <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>--;
<a name="l00131"></a>00131                 }
<a name="l00132"></a>00132                 <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.erase(<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range);
<a name="l00133"></a>00133             }
<a name="l00134"></a>00134         }
<a name="l00135"></a>00135     }
<a name="l00136"></a>00136 
<a name="l00137"></a>00137     <span class="keywordflow">if</span> (entry != -1) {
<a name="l00138"></a>00138         assert(entry &lt; size &amp;&amp; entry &gt;= 0);
<a name="l00139"></a>00139         new_entry = &amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry];
<a name="l00140"></a>00140     } <span class="keywordflow">else</span> {
<a name="l00141"></a>00141         <span class="keywordflow">if</span> (!<a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.empty()) {
<a name="l00142"></a>00142             new_entry = <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.front();
<a name="l00143"></a>00143         } <span class="keywordflow">else</span> {
<a name="l00144"></a>00144             x = <a class="code" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a>;
<a name="l00145"></a>00145             <span class="keywordflow">do</span> {
<a name="l00146"></a>00146                 ++x;
<a name="l00147"></a>00147                 <span class="keywordflow">if</span> (x == size)
<a name="l00148"></a>00148                     x = 0;
<a name="l00149"></a>00149                 <span class="keywordflow">if</span> (x == <a class="code" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a>)
<a name="l00150"></a>00150                     <span class="keywordflow">goto</span> insertAllLocked;
<a name="l00151"></a>00151             } <span class="keywordflow">while</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].pte.locked());
<a name="l00152"></a>00152             <a class="code" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a> = x;
<a name="l00153"></a>00153             new_entry = &amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x];
<a name="l00154"></a>00154         }
<a name="l00155"></a>00155     }
<a name="l00156"></a>00156 
<a name="l00157"></a>00157 insertAllLocked:
<a name="l00158"></a>00158     <span class="comment">// Update the last ently if their all locked</span>
<a name="l00159"></a>00159     <span class="keywordflow">if</span> (!new_entry) {
<a name="l00160"></a>00160         new_entry = &amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[size-1];
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162 
<a name="l00163"></a>00163     <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.remove(new_entry);
<a name="l00164"></a>00164     <span class="keywordflow">if</span> (new_entry-&gt;valid &amp;&amp; new_entry-&gt;used)
<a name="l00165"></a>00165         <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>--;
<a name="l00166"></a>00166     <span class="keywordflow">if</span> (new_entry-&gt;valid)
<a name="l00167"></a>00167         <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.erase(new_entry-&gt;range);
<a name="l00168"></a>00168 
<a name="l00169"></a>00169 
<a name="l00170"></a>00170     assert(PTE.valid());
<a name="l00171"></a>00171     new_entry-&gt;range.va = <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>;
<a name="l00172"></a>00172     new_entry-&gt;range.size = PTE.size() - 1;
<a name="l00173"></a>00173     new_entry-&gt;range.partitionId = partition_id;
<a name="l00174"></a>00174     new_entry-&gt;range.contextId = context_id;
<a name="l00175"></a>00175     new_entry-&gt;range.real = real;
<a name="l00176"></a>00176     new_entry-&gt;pte = PTE;
<a name="l00177"></a>00177     new_entry-&gt;used = <span class="keyword">true</span>;;
<a name="l00178"></a>00178     new_entry-&gt;valid = <span class="keyword">true</span>;
<a name="l00179"></a>00179     <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>++;
<a name="l00180"></a>00180 
<a name="l00181"></a>00181     i = <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.insert(new_entry-&gt;range, new_entry);
<a name="l00182"></a>00182     assert(i != <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.end());
<a name="l00183"></a>00183 
<a name="l00184"></a>00184     <span class="comment">// If all entries have their used bit set, clear it on them all,</span>
<a name="l00185"></a>00185     <span class="comment">// but the one we just inserted</span>
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a> == size) {
<a name="l00187"></a>00187         <a class="code" href="classSparcISA_1_1TLB.html#aa4eb1561faa47c66c28555cbf26f4d8f">clearUsedBits</a>();
<a name="l00188"></a>00188         new_entry-&gt;used = <span class="keyword">true</span>;
<a name="l00189"></a>00189         <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>++;
<a name="l00190"></a>00190     }
<a name="l00191"></a>00191 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a74fbbb81cfaa89e81165a62736e4311a"></a><!-- doxytag: member="SparcISA::TLB::lookup" ref="a74fbbb81cfaa89e81165a62736e4311a" args="(Addr va, int partition_id, bool real, int context_id=0, bool update_used=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a> * lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>partition_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>real</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>context_id</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>update_used</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>lookup an entry in the <a class="el" href="classSparcISA_1_1TLB.html">TLB</a> based on the partition id, and real bit if real is true or the partition id, and context id if real is false. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>va</em>&nbsp;</td><td>the virtual address not shifted (e.g. bottom 13 bits are 0) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>paritition_id</em>&nbsp;</td><td>partition this entry is for </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>real</em>&nbsp;</td><td>is this a real-&gt;phys or virt-&gt;phys translation </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>context_id</em>&nbsp;</td><td>if this is virt-&gt;phys what context </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>update_used</em>&nbsp;</td><td>should ew update the used bits in the entries on not useful if we are trying to do a va-&gt;pa without mucking with any state for a debug read for example. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>A pointer to a tlb entry </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00197"></a>00197 {
<a name="l00198"></a>00198     <a class="code" href="classSparcISA_1_1TLB.html#a52ffc8e6c7bc8d7037f59391c2a93750">MapIter</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l00199"></a>00199     TlbRange tr;
<a name="l00200"></a>00200     TlbEntry *<a class="code" href="namespaceArmISA.html#af5dfd7e551f8c5b461816e813dab252f">t</a>;
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: Looking up entry va=%#x pid=%d cid=%d r=%d\n&quot;</span>,
<a name="l00203"></a>00203             <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>, partition_id, context_id, real);
<a name="l00204"></a>00204     <span class="comment">// Assemble full address structure</span>
<a name="l00205"></a>00205     tr.va = <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>;
<a name="l00206"></a>00206     tr.size = 1;
<a name="l00207"></a>00207     tr.contextId = context_id;
<a name="l00208"></a>00208     tr.partitionId = partition_id;
<a name="l00209"></a>00209     tr.real = real;
<a name="l00210"></a>00210 
<a name="l00211"></a>00211     <span class="comment">// Try to find the entry</span>
<a name="l00212"></a>00212     i = <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.find(tr);
<a name="l00213"></a>00213     <span class="keywordflow">if</span> (i == <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.end()) {
<a name="l00214"></a>00214         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: No valid entry found\n&quot;</span>);
<a name="l00215"></a>00215         <span class="keywordflow">return</span> <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00216"></a>00216     }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218     <span class="comment">// Mark the entries used bit and clear other used bits in needed</span>
<a name="l00219"></a>00219     t = i-&gt;second;
<a name="l00220"></a>00220     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: Valid entry found pa: %#x size: %#x\n&quot;</span>, t-&gt;pte.paddr(),
<a name="l00221"></a>00221             t-&gt;pte.size());
<a name="l00222"></a>00222 
<a name="l00223"></a>00223     <span class="comment">// Update the used bits only if this is a real access (not a fake</span>
<a name="l00224"></a>00224     <span class="comment">// one from virttophys()</span>
<a name="l00225"></a>00225     <span class="keywordflow">if</span> (!t-&gt;used &amp;&amp; update_used) {
<a name="l00226"></a>00226         t-&gt;used = <span class="keyword">true</span>;
<a name="l00227"></a>00227         <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>++;
<a name="l00228"></a>00228         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a> == <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>) {
<a name="l00229"></a>00229             <a class="code" href="classSparcISA_1_1TLB.html#aa4eb1561faa47c66c28555cbf26f4d8f">clearUsedBits</a>();
<a name="l00230"></a>00230             t-&gt;used = <span class="keyword">true</span>;
<a name="l00231"></a>00231             <a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>++;
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233     }
<a name="l00234"></a>00234 
<a name="l00235"></a>00235     <span class="keywordflow">return</span> t;
<a name="l00236"></a>00236 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a69c520e9f2bec8ddb4eb5121cf10a94c"></a><!-- doxytag: member="SparcISA::TLB::MakeTsbPtr" ref="a69c520e9f2bec8ddb4eb5121cf10a94c" args="(TsbPageSize ps, uint64_t tag_access, uint64_t c0_tsb, uint64_t c0_config, uint64_t cX_tsb, uint64_t cX_config)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t MakeTsbPtr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadd">TsbPageSize</a>&nbsp;</td>
          <td class="paramname"> <em>ps</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>tag_access</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>c0_tsb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>c0_config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>cX_tsb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&nbsp;</td>
          <td class="paramname"> <em>cX_config</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01325"></a>01325 {
<a name="l01326"></a>01326     uint64_t tsb;
<a name="l01327"></a>01327     uint64_t config;
<a name="l01328"></a>01328 
<a name="l01329"></a>01329     <span class="keywordflow">if</span> (<a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(<a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>, 12,0) == 0) {
<a name="l01330"></a>01330         tsb = c0_tsb;
<a name="l01331"></a>01331         config = <a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>;
<a name="l01332"></a>01332     } <span class="keywordflow">else</span> {
<a name="l01333"></a>01333         tsb = cX_tsb;
<a name="l01334"></a>01334         config = cX_config;
<a name="l01335"></a>01335     }
<a name="l01336"></a>01336 
<a name="l01337"></a>01337     uint64_t ptr = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(tsb,63,13);
<a name="l01338"></a>01338     <span class="keywordtype">bool</span> split = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tsb,12,12);
<a name="l01339"></a>01339     <span class="keywordtype">int</span> tsb_size = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tsb,3,0);
<a name="l01340"></a>01340     <span class="keywordtype">int</span> page_size = (<a class="code" href="namespaceArmISA.html#a605ede8bf0f2ccf5b3928adf311a964a">ps</a> == <a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda3a7edc18be042f9f093c3c4fd03b6048">Ps0</a>) ? <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(config, 2,0) : <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(config,10,8);
<a name="l01341"></a>01341 
<a name="l01342"></a>01342     <span class="keywordflow">if</span> (<a class="code" href="namespaceArmISA.html#a605ede8bf0f2ccf5b3928adf311a964a">ps</a> == <a class="code" href="classSparcISA_1_1TLB.html#a639a136c8fa30e45275bd7354e95eadda0955a6897849c661b0454ad02ad7f033">Ps1</a>  &amp;&amp; split)
<a name="l01343"></a>01343         ptr |= <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(1) &lt;&lt; (13 + tsb_size);
<a name="l01344"></a>01344     ptr |= (<a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a> &gt;&gt; (9 + page_size * 3)) &amp; <a class="code" href="namespaceArmISA.html#a9534dbda5e7db9881c7955c6e08cfdc0">mask</a>(12+tsb_size, 4);
<a name="l01345"></a>01345 
<a name="l01346"></a>01346     <span class="keywordflow">return</span> ptr;
<a name="l01347"></a>01347 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a53e036786d17361be4c7320d39c99b84"></a><!-- doxytag: member="SparcISA::TLB::serialize" ref="a53e036786d17361be4c7320d39c99b84" args="(std::ostream &amp;os)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void serialize </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classSerializable.html#ad6272f80ae37e8331e3969b3f072a801">Serializable</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l01351"></a>01351 {
<a name="l01352"></a>01352     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);
<a name="l01353"></a>01353     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>);
<a name="l01354"></a>01354     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a>);
<a name="l01355"></a>01355 
<a name="l01356"></a>01356     <span class="comment">// convert the pointer based free list into an index based one</span>
<a name="l01357"></a>01357     <span class="keywordtype">int</span> *free_list = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);
<a name="l01358"></a>01358     <span class="keywordtype">int</span> cntr = 0;
<a name="l01359"></a>01359     <a class="code" href="classstd_1_1list.html">std::list&lt;TlbEntry*&gt;::iterator</a> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>;
<a name="l01360"></a>01360     i = <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.begin();
<a name="l01361"></a>01361     <span class="keywordflow">while</span> (i != <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.end()) {
<a name="l01362"></a>01362         free_list[cntr++] = ((size_t)*i - (<span class="keywordtype">size_t</span>)<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>)/ <span class="keyword">sizeof</span>(TlbEntry);
<a name="l01363"></a>01363         i++;
<a name="l01364"></a>01364     }
<a name="l01365"></a>01365     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(cntr);
<a name="l01366"></a>01366     <a class="code" href="serialize_8hh.html#a9aa03522128bc19a3bc0294501226f8b">SERIALIZE_ARRAY</a>(free_list,  cntr);
<a name="l01367"></a>01367 
<a name="l01368"></a>01368     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a>);
<a name="l01369"></a>01369     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a>);
<a name="l01370"></a>01370     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>);
<a name="l01371"></a>01371     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a>);
<a name="l01372"></a>01372     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a>);
<a name="l01373"></a>01373     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>);
<a name="l01374"></a>01374     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a>);
<a name="l01375"></a>01375     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>);
<a name="l01376"></a>01376 
<a name="l01377"></a>01377     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++) {
<a name="l01378"></a>01378         <a class="code" href="classSerializable.html#a02882ba301442518e82872ad4574a3f0">nameOut</a>(<a class="code" href="namespaceX86ISA.html#a6b6e6ba763e7eaf46ac5b6372ca98d30">os</a>, <a class="code" href="cprintf_8hh.html#ace22d1c39f2df58e593bc49d1613eca2">csprintf</a>(<span class="stringliteral">&quot;%s.PTE%d&quot;</span>, <a class="code" href="classSimObject.html#adbcff144e5e199d332a1352af1798148">name</a>(), <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>));
<a name="l01379"></a>01379         <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>].serialize(<a class="code" href="namespaceX86ISA.html#a6b6e6ba763e7eaf46ac5b6372ca98d30">os</a>);
<a name="l01380"></a>01380     }
<a name="l01381"></a>01381     <a class="code" href="serialize_8hh.html#a49163149ec656ffecff0e46aee418e29">SERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a>);
<a name="l01382"></a>01382 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaf85d399be0a94d95fa3282faff835ea"></a><!-- doxytag: member="SparcISA::TLB::TagRead" ref="aaf85d399be0a94d95fa3282faff835ea" args="(int entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t TagRead </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>entry</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Given an entry id, read that tlb entries' tag. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00355"></a>00355 {
<a name="l00356"></a>00356     assert(entry &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);
<a name="l00357"></a>00357     uint64_t tag;
<a name="l00358"></a>00358     <span class="keywordflow">if</span> (!<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].valid)
<a name="l00359"></a>00359         <span class="keywordflow">return</span> (uint64_t)-1ll;
<a name="l00360"></a>00360 
<a name="l00361"></a>00361     tag = <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].range.contextId;
<a name="l00362"></a>00362     tag |= <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].range.va;
<a name="l00363"></a>00363     tag |= (uint64_t)<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].range.partitionId &lt;&lt; 61;
<a name="l00364"></a>00364     tag |= <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].range.real ? <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(1) &lt;&lt; 60 : 0;
<a name="l00365"></a>00365     tag |= (uint64_t)~<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].pte._size() &lt;&lt; 56;
<a name="l00366"></a>00366     <span class="keywordflow">return</span> tag;
<a name="l00367"></a>00367 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a15b6c15c1be2ca4de3e65772a02aa29f"></a><!-- doxytag: member="SparcISA::TLB::takeOverFrom" ref="a15b6c15c1be2ca4de3e65772a02aa29f" args="(BaseTLB *otlb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void takeOverFrom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseTLB.html">BaseTLB</a> *&nbsp;</td>
          <td class="paramname"> <em>otlb</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00157"></a>00157 {}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad54e01e3c0a1613098a76b7f92e5be93"></a><!-- doxytag: member="SparcISA::TLB::translateAtomic" ref="ad54e01e3c0a1613098a76b7f92e5be93" args="(RequestPtr req, ThreadContext *tc, Mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">Fault</a> translateAtomic </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00829"></a>00829 {
<a name="l00830"></a>00830     <span class="keywordflow">if</span> (<a class="code" href="namespaceArmISA.html#a5f3b9b97eb2dfa29d33e74878455f90d">mode</a> == <a class="code" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911a31b7313c05d32519f3869a3de8be95e6">Execute</a>)
<a name="l00831"></a>00831         <span class="keywordflow">return</span> <a class="code" href="classSparcISA_1_1TLB.html#a072afd8ed455dade4c25a85510e5a4da">translateInst</a>(req, tc);
<a name="l00832"></a>00832     <span class="keywordflow">else</span>
<a name="l00833"></a>00833         <span class="keywordflow">return</span> <a class="code" href="classSparcISA_1_1TLB.html#ad54aef66412f77e2a15a621a126dfb52">translateData</a>(req, tc, <a class="code" href="namespaceArmISA.html#a5f3b9b97eb2dfa29d33e74878455f90d">mode</a> == <a class="code" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911aa56670174817e3fed92bfd8182d7c0d1">Write</a>);
<a name="l00834"></a>00834 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad54aef66412f77e2a15a621a126dfb52"></a><!-- doxytag: member="SparcISA::TLB::translateData" ref="ad54aef66412f77e2a15a621a126dfb52" args="(RequestPtr req, ThreadContext *tc, bool write)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">Fault</a> translateData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>write</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>Normal flow ends here. </p>
</p>

<p><div class="fragment"><pre class="fragment"><a name="l00530"></a>00530 {
<a name="l00531"></a>00531     <span class="comment">/*</span>
<a name="l00532"></a>00532 <span class="comment">     * @todo this could really use some profiling and fixing to make</span>
<a name="l00533"></a>00533 <span class="comment">     * it faster!</span>
<a name="l00534"></a>00534 <span class="comment">     */</span>
<a name="l00535"></a>00535     uint64_t tlbdata = tc-&gt;<a class="code" href="classThreadContext.html#a93c9c97261cb7289d5976b8222f70c4c">readMiscRegNoEffect</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a34e96fb9ddfda445e0f7f353b647e55f">MISCREG_TLB_DATA</a>);
<a name="l00536"></a>00536     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceMipsISA.html#ac78d9788b3f9a366df64485c9afaf1b1">vaddr</a> = req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>();
<a name="l00537"></a>00537     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a> = req-&gt;<a class="code" href="classRequest.html#a3c4029b904a61a9873e6d12785ce19a1">getSize</a>();
<a name="l00538"></a>00538     <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a> asi;
<a name="l00539"></a>00539     asi = (<a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a>)req-&gt;<a class="code" href="classRequest.html#aefd0ec4015a880de7bbf555b15e242b1">getArchFlags</a>();
<a name="l00540"></a>00540     <span class="keywordtype">bool</span> implicit = <span class="keyword">false</span>;
<a name="l00541"></a>00541     <span class="keywordtype">bool</span> <a class="code" href="namespaceSparcISA.html#a0ee6b47193187a7e02e4231aaa050d97">hpriv</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,0,0);
<a name="l00542"></a>00542     <span class="keywordtype">bool</span> unaligned = vaddr &amp; (size - 1);
<a name="l00543"></a>00543 
<a name="l00544"></a>00544     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: DTB Request to translate va=%#x size=%d asi=%#x\n&quot;</span>,
<a name="l00545"></a>00545             vaddr, size, asi);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.size() != 64 - <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.size())
<a name="l00548"></a>00548        <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Lookup table size: %d tlb size: %d\n&quot;</span>, <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.size(),
<a name="l00549"></a>00549                <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.size());
<a name="l00550"></a>00550     <span class="keywordflow">if</span> (asi == <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aa054fb8d87e1ceec4e273f4636690a17">ASI_IMPLICIT</a>)
<a name="l00551"></a>00551         implicit = <span class="keyword">true</span>;
<a name="l00552"></a>00552 
<a name="l00553"></a>00553     <span class="comment">// Only use the fast path here if there doesn&apos;t need to be an unaligned</span>
<a name="l00554"></a>00554     <span class="comment">// trap later</span>
<a name="l00555"></a>00555     <span class="keywordflow">if</span> (!unaligned) {
<a name="l00556"></a>00556         <span class="keywordflow">if</span> (hpriv &amp;&amp; implicit) {
<a name="l00557"></a>00557             req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(vaddr &amp; <a class="code" href="namespaceSparcISA.html#abb8b7685b079953e35015543262458e2">PAddrImplMask</a>);
<a name="l00558"></a>00558             <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00559"></a>00559         }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561         <span class="comment">// Be fast if we can!</span>
<a name="l00562"></a>00562         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> &amp;&amp;  <a class="code" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a> == tlbdata) {
<a name="l00563"></a>00563 
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 
<a name="l00566"></a>00566             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0]) {
<a name="l00567"></a>00567                 TlbEntry *<a class="code" href="namespaceMipsISA.html#a5e7d4c894937b23c448e900d42f68004">ce</a> = <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0];
<a name="l00568"></a>00568                 <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> ce_va = ce-&gt;range.va;
<a name="l00569"></a>00569                 <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[0] == asi &amp;&amp;
<a name="l00570"></a>00570                     ce_va &lt; vaddr + size &amp;&amp; ce_va + ce-&gt;range.size &gt; vaddr &amp;&amp;
<a name="l00571"></a>00571                     (!write || ce-&gt;pte.writable())) {
<a name="l00572"></a>00572                     req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(ce-&gt;pte.translate(vaddr));
<a name="l00573"></a>00573                     <span class="keywordflow">if</span> (ce-&gt;pte.sideffect() || (ce-&gt;pte.paddr() &gt;&gt; 39) &amp; 1)
<a name="l00574"></a>00574                         req-&gt;<a class="code" href="classRequest.html#a33971d22712c9c80177e4362dffd5580">setFlags</a>(<a class="code" href="classRequest.html#a0fc1d6bc92a0567b05130468e04f05f8">Request::UNCACHEABLE</a>);
<a name="l00575"></a>00575                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: %#X -&gt; %#X\n&quot;</span>, vaddr, req-&gt;<a class="code" href="classRequest.html#a744ef11a5afe9d3651ce5f954259cb43">getPaddr</a>());
<a name="l00576"></a>00576                     <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00577"></a>00577                 } <span class="comment">// if matched</span>
<a name="l00578"></a>00578             } <span class="comment">// if cache entry valid</span>
<a name="l00579"></a>00579             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[1]) {
<a name="l00580"></a>00580                 TlbEntry *ce = <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[1];
<a name="l00581"></a>00581                 <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> ce_va = ce-&gt;range.va;
<a name="l00582"></a>00582                 <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[1] == asi &amp;&amp;
<a name="l00583"></a>00583                     ce_va &lt; vaddr + size &amp;&amp; ce_va + ce-&gt;range.size &gt; vaddr &amp;&amp;
<a name="l00584"></a>00584                     (!write || ce-&gt;pte.writable())) {
<a name="l00585"></a>00585                     req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(ce-&gt;pte.translate(vaddr));
<a name="l00586"></a>00586                     <span class="keywordflow">if</span> (ce-&gt;pte.sideffect() || (ce-&gt;pte.paddr() &gt;&gt; 39) &amp; 1)
<a name="l00587"></a>00587                         req-&gt;<a class="code" href="classRequest.html#a33971d22712c9c80177e4362dffd5580">setFlags</a>(<a class="code" href="classRequest.html#a0fc1d6bc92a0567b05130468e04f05f8">Request::UNCACHEABLE</a>);
<a name="l00588"></a>00588                     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: %#X -&gt; %#X\n&quot;</span>, vaddr, req-&gt;<a class="code" href="classRequest.html#a744ef11a5afe9d3651ce5f954259cb43">getPaddr</a>());
<a name="l00589"></a>00589                     <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00590"></a>00590                 } <span class="comment">// if matched</span>
<a name="l00591"></a>00591             } <span class="comment">// if cache entry valid</span>
<a name="l00592"></a>00592         }
<a name="l00593"></a>00593     }
<a name="l00594"></a>00594 
<a name="l00595"></a>00595     <span class="keywordtype">bool</span> <a class="code" href="namespaceSparcISA.html#a3daf539b069b3e0d79ce6137bac5a47f">red</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,1,1);
<a name="l00596"></a>00596     <span class="keywordtype">bool</span> <a class="code" href="namespaceSparcISA.html#a9d8b751eeaa798163459309b2f3d0b80">priv</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,2,2);
<a name="l00597"></a>00597     <span class="keywordtype">bool</span> addr_mask = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,3,3);
<a name="l00598"></a>00598     <span class="keywordtype">bool</span> lsu_dm = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,5,5);
<a name="l00599"></a>00599 
<a name="l00600"></a>00600     <span class="keywordtype">int</span> part_id = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,15,8);
<a name="l00601"></a>00601     <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#a054bc5cc3193b2c04ef65c0abe135191">tl</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,18,16);
<a name="l00602"></a>00602     <span class="keywordtype">int</span> pri_context = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,47,32);
<a name="l00603"></a>00603     <span class="keywordtype">int</span> sec_context = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,63,48);
<a name="l00604"></a>00604 
<a name="l00605"></a>00605     <span class="keywordtype">bool</span> real = <span class="keyword">false</span>;
<a name="l00606"></a>00606     <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a> ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>;
<a name="l00607"></a>00607     <span class="keywordtype">int</span> context = 0;
<a name="l00608"></a>00608 
<a name="l00609"></a>00609     TlbEntry *<a class="code" href="namespaceArmISA.html#a55520507919005a961edbe8b177f3bba">e</a>;
<a name="l00610"></a>00610 
<a name="l00611"></a>00611     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: priv:%d hpriv:%d red:%d lsudm:%d part_id: %#X\n&quot;</span>,
<a name="l00612"></a>00612             priv, hpriv, red, lsu_dm, part_id);
<a name="l00613"></a>00613 
<a name="l00614"></a>00614     <span class="keywordflow">if</span> (implicit) {
<a name="l00615"></a>00615         <span class="keywordflow">if</span> (tl &gt; 0) {
<a name="l00616"></a>00616             asi = <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a0401a622da9ee06093be26c0f7916f30">ASI_N</a>;
<a name="l00617"></a>00617             ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a>;
<a name="l00618"></a>00618             context = 0;
<a name="l00619"></a>00619         } <span class="keywordflow">else</span> {
<a name="l00620"></a>00620             asi = <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a2b7422efe9682fe69ba53cda687a3666">ASI_P</a>;
<a name="l00621"></a>00621             ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>;
<a name="l00622"></a>00622             context = pri_context;
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624     } <span class="keywordflow">else</span> {
<a name="l00625"></a>00625         <span class="comment">// We need to check for priv level/asi priv</span>
<a name="l00626"></a>00626         <span class="keywordflow">if</span> (!priv &amp;&amp; !hpriv &amp;&amp; !<a class="code" href="namespaceSparcISA.html#a36fc5916dec11c97ac8e2c55a2faec03">asiIsUnPriv</a>(asi)) {
<a name="l00627"></a>00627             <span class="comment">// It appears that context should be Nucleus in these cases?</span>
<a name="l00628"></a>00628             <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a>, <span class="keyword">false</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00629"></a>00629             <span class="keywordflow">return</span> <span class="keyword">new</span> PrivilegedAction;
<a name="l00630"></a>00630         }
<a name="l00631"></a>00631 
<a name="l00632"></a>00632         <span class="keywordflow">if</span> (!hpriv &amp;&amp; <a class="code" href="namespaceSparcISA.html#a555f3112a89b6856275a44365d2ebd26">asiIsHPriv</a>(asi)) {
<a name="l00633"></a>00633             <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a>, <span class="keyword">false</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00634"></a>00634             <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00635"></a>00635         }
<a name="l00636"></a>00636 
<a name="l00637"></a>00637         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#ac7434308e8dc3fc6c7dae78c6ac710b3">asiIsPrimary</a>(asi)) {
<a name="l00638"></a>00638             context = pri_context;
<a name="l00639"></a>00639             ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>;
<a name="l00640"></a>00640         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#adc1ad600b03009207cc4337448c950a6">asiIsSecondary</a>(asi)) {
<a name="l00641"></a>00641             context = sec_context;
<a name="l00642"></a>00642             ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5acdd030c6485c7b0801d32116fd9d7103">Secondary</a>;
<a name="l00643"></a>00643         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#adb17635c66d11c5c6423bb77af7c481b">asiIsNucleus</a>(asi)) {
<a name="l00644"></a>00644             ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a>;
<a name="l00645"></a>00645             context = 0;
<a name="l00646"></a>00646         } <span class="keywordflow">else</span> {  <span class="comment">// ????</span>
<a name="l00647"></a>00647             ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>;
<a name="l00648"></a>00648             context = pri_context;
<a name="l00649"></a>00649         }
<a name="l00650"></a>00650     }
<a name="l00651"></a>00651 
<a name="l00652"></a>00652     <span class="keywordflow">if</span> (!implicit &amp;&amp; asi != <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a2b7422efe9682fe69ba53cda687a3666">ASI_P</a> &amp;&amp; asi != <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3ace4f571bb3cf23865d6c2a0634819c0b">ASI_S</a>) {
<a name="l00653"></a>00653         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#a2376d99d5b5a3ebe74c0d4b7585929c2">asiIsLittle</a>(asi))
<a name="l00654"></a>00654             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Little Endian ASIs not supported\n&quot;</span>);
<a name="l00655"></a>00655 
<a name="l00656"></a>00656         <span class="comment">//XXX It&apos;s unclear from looking at the documentation how a no fault</span>
<a name="l00657"></a>00657         <span class="comment">// load differs from a regular one, other than what happens concerning</span>
<a name="l00658"></a>00658         <span class="comment">// nfo and e bits in the TTE</span>
<a name="l00659"></a>00659 <span class="comment">//        if (asiIsNoFault(asi))</span>
<a name="l00660"></a>00660 <span class="comment">//            panic(&quot;No Fault ASIs not supported\n&quot;);</span>
<a name="l00661"></a>00661 
<a name="l00662"></a>00662         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#aa17d361a7b759ca0415a9c85b4e77b56">asiIsPartialStore</a>(asi))
<a name="l00663"></a>00663             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Partial Store ASIs not supported\n&quot;</span>);
<a name="l00664"></a>00664 
<a name="l00665"></a>00665         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#a9531fb3db93ff00372571a055d094ddc">asiIsCmt</a>(asi))
<a name="l00666"></a>00666             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Cmt ASI registers not implmented\n&quot;</span>);
<a name="l00667"></a>00667 
<a name="l00668"></a>00668         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#a9ae7d061a2e4abcab3fbc6240ff2dbe5">asiIsInterrupt</a>(asi))
<a name="l00669"></a>00669             <span class="keywordflow">goto</span> handleIntRegAccess;
<a name="l00670"></a>00670         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#a89468421f86725b3dabc030976d7d66a">asiIsMmu</a>(asi))
<a name="l00671"></a>00671             <span class="keywordflow">goto</span> handleMmuRegAccess;
<a name="l00672"></a>00672         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#adee3e63d7c8a89574a10d0da306c1be1">asiIsScratchPad</a>(asi))
<a name="l00673"></a>00673             <span class="keywordflow">goto</span> handleScratchRegAccess;
<a name="l00674"></a>00674         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#a5360b39b7131894da3d9678add217ad9">asiIsQueue</a>(asi))
<a name="l00675"></a>00675             <span class="keywordflow">goto</span> handleQueueRegAccess;
<a name="l00676"></a>00676         <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#ae656441d838f9206db0f8c80b0fea60c">asiIsSparcError</a>(asi))
<a name="l00677"></a>00677             <span class="keywordflow">goto</span> handleSparcErrorRegAccess;
<a name="l00678"></a>00678 
<a name="l00679"></a>00679         <span class="keywordflow">if</span> (!<a class="code" href="namespaceSparcISA.html#a90ff92b6c0cfc52e5c210526eb5753d4">asiIsReal</a>(asi) &amp;&amp; !<a class="code" href="namespaceSparcISA.html#adb17635c66d11c5c6423bb77af7c481b">asiIsNucleus</a>(asi) &amp;&amp; !<a class="code" href="namespaceSparcISA.html#a4e89e6ead9db1ab06ded3dc574747942">asiIsAsIfUser</a>(asi) &amp;&amp;
<a name="l00680"></a>00680                 !<a class="code" href="namespaceSparcISA.html#af6b0e385f0a748a47752cb8fd823d8fb">asiIsTwin</a>(asi) &amp;&amp; !<a class="code" href="namespaceSparcISA.html#a51a8c3cd909314c647c40ff58e2fa175">asiIsBlock</a>(asi) &amp;&amp; !<a class="code" href="namespaceSparcISA.html#a0bfa477f1265e8c4f862c16cd6ff54e5">asiIsNoFault</a>(asi))
<a name="l00681"></a>00681             <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Accessing ASI %#X. Should we?\n&quot;</span>, asi);
<a name="l00682"></a>00682     }
<a name="l00683"></a>00683 
<a name="l00684"></a>00684     <span class="comment">// If the asi is unaligned trap</span>
<a name="l00685"></a>00685     <span class="keywordflow">if</span> (unaligned) {
<a name="l00686"></a>00686         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, <span class="keyword">false</span>, ct, <span class="keyword">false</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af">OtherFault</a>, asi);
<a name="l00687"></a>00687         <span class="keywordflow">return</span> <span class="keyword">new</span> MemAddressNotAligned;
<a name="l00688"></a>00688     }
<a name="l00689"></a>00689 
<a name="l00690"></a>00690     <span class="keywordflow">if</span> (addr_mask)
<a name="l00691"></a>00691         vaddr = vaddr &amp; <a class="code" href="namespaceSparcISA.html#a23f8389b82b2ea7be78d3f123b91ec4c">VAddrAMask</a>;
<a name="l00692"></a>00692 
<a name="l00693"></a>00693     <span class="keywordflow">if</span> (!<a class="code" href="classSparcISA_1_1TLB.html#aa5cff14a14bcb47f10bb095035bd6290">validVirtualAddress</a>(vaddr, addr_mask)) {
<a name="l00694"></a>00694         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, <span class="keyword">false</span>, ct, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a218b85059c614ecbbee4628b16ff49da">VaOutOfRange</a>, asi);
<a name="l00695"></a>00695         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00696"></a>00696     }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698     <span class="keywordflow">if</span> ((!lsu_dm &amp;&amp; !hpriv &amp;&amp; !red) || <a class="code" href="namespaceSparcISA.html#a90ff92b6c0cfc52e5c210526eb5753d4">asiIsReal</a>(asi)) {
<a name="l00699"></a>00699         real = <span class="keyword">true</span>;
<a name="l00700"></a>00700         context = 0;
<a name="l00701"></a>00701     }
<a name="l00702"></a>00702 
<a name="l00703"></a>00703     <span class="keywordflow">if</span> (hpriv &amp;&amp; (implicit || (!<a class="code" href="namespaceSparcISA.html#a4e89e6ead9db1ab06ded3dc574747942">asiIsAsIfUser</a>(asi) &amp;&amp; !<a class="code" href="namespaceSparcISA.html#a90ff92b6c0cfc52e5c210526eb5753d4">asiIsReal</a>(asi)))) {
<a name="l00704"></a>00704         req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(vaddr &amp; <a class="code" href="namespaceSparcISA.html#abb8b7685b079953e35015543262458e2">PAddrImplMask</a>);
<a name="l00705"></a>00705         <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00706"></a>00706     }
<a name="l00707"></a>00707 
<a name="l00708"></a>00708     e = <a class="code" href="classSparcISA_1_1TLB.html#a74fbbb81cfaa89e81165a62736e4311a">lookup</a>(vaddr, part_id, real, context);
<a name="l00709"></a>00709 
<a name="l00710"></a>00710     <span class="keywordflow">if</span> (e == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a> || !e-&gt;valid) {
<a name="l00711"></a>00711         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00712"></a>00712         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: DTB Failed to find matching TLB entry\n&quot;</span>);
<a name="l00713"></a>00713         <span class="keywordflow">if</span> (real) {
<a name="l00714"></a>00714             <span class="keywordflow">return</span> <span class="keyword">new</span> DataRealTranslationMiss;
<a name="l00715"></a>00715         } <span class="keywordflow">else</span> {
<a name="l00716"></a>00716             <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370">FullSystem</a>)
<a name="l00717"></a>00717                 <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classSparcISA_1_1TLB.html#a3d497ded3c85659ec4b013e2cae38c71">FastDataAccessMMUMiss</a>;
<a name="l00718"></a>00718             <span class="keywordflow">else</span>
<a name="l00719"></a>00719                 <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classSparcISA_1_1TLB.html#a3d497ded3c85659ec4b013e2cae38c71">FastDataAccessMMUMiss</a>(req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>());
<a name="l00720"></a>00720         }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722     }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724     <span class="keywordflow">if</span> (!priv &amp;&amp; e-&gt;pte.priv()) {
<a name="l00725"></a>00725         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00726"></a>00726         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, ct, e-&gt;pte.sideffect(), <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822afdc36f7178e8d04d90ec745400f5d5e7">PrivViolation</a>, asi);
<a name="l00727"></a>00727         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729 
<a name="l00730"></a>00730     <span class="keywordflow">if</span> (write &amp;&amp; !e-&gt;pte.writable()) {
<a name="l00731"></a>00731         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00732"></a>00732         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, ct, e-&gt;pte.sideffect(), <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af">OtherFault</a>, asi);
<a name="l00733"></a>00733         <span class="keywordflow">return</span> <span class="keyword">new</span> FastDataAccessProtection;
<a name="l00734"></a>00734     }
<a name="l00735"></a>00735 
<a name="l00736"></a>00736     <span class="keywordflow">if</span> (e-&gt;pte.nofault() &amp;&amp; !<a class="code" href="namespaceSparcISA.html#a0bfa477f1265e8c4f862c16cd6ff54e5">asiIsNoFault</a>(asi)) {
<a name="l00737"></a>00737         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00738"></a>00738         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, ct, e-&gt;pte.sideffect(), <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a95f50e219a840e80a9a1915b7f8b959d">LoadFromNfo</a>, asi);
<a name="l00739"></a>00739         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00740"></a>00740     }
<a name="l00741"></a>00741 
<a name="l00742"></a>00742     <span class="keywordflow">if</span> (e-&gt;pte.sideffect() &amp;&amp; <a class="code" href="namespaceSparcISA.html#a0bfa477f1265e8c4f862c16cd6ff54e5">asiIsNoFault</a>(asi)) {
<a name="l00743"></a>00743         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00744"></a>00744         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, ct, e-&gt;pte.sideffect(), <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a24949c2da237f4437ec8254b313fa9e1">SideEffect</a>, asi);
<a name="l00745"></a>00745         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00746"></a>00746     }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748     <span class="keywordflow">if</span> (e-&gt;pte.sideffect() || (e-&gt;pte.paddr() &gt;&gt; 39) &amp; 1)
<a name="l00749"></a>00749         req-&gt;<a class="code" href="classRequest.html#a33971d22712c9c80177e4362dffd5580">setFlags</a>(<a class="code" href="classRequest.html#a0fc1d6bc92a0567b05130468e04f05f8">Request::UNCACHEABLE</a>);
<a name="l00750"></a>00750 
<a name="l00751"></a>00751     <span class="comment">// cache translation date for next translation</span>
<a name="l00752"></a>00752     <a class="code" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a> = tlbdata;
<a name="l00753"></a>00753     <span class="keywordflow">if</span> (!<a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a>) {
<a name="l00754"></a>00754         <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[1] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00755"></a>00755         <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00756"></a>00756     }
<a name="l00757"></a>00757 
<a name="l00758"></a>00758     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0] != e &amp;&amp; <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[1] != e) {
<a name="l00759"></a>00759         <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[1] = <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0];
<a name="l00760"></a>00760         <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0] = e;
<a name="l00761"></a>00761         <a class="code" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[1] = <a class="code" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[0];
<a name="l00762"></a>00762         <a class="code" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[0] = asi;
<a name="l00763"></a>00763         <span class="keywordflow">if</span> (implicit)
<a name="l00764"></a>00764             <a class="code" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[0] = (<a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a>)0;
<a name="l00765"></a>00765     }
<a name="l00766"></a>00766     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">true</span>;
<a name="l00767"></a>00767     req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(e-&gt;pte.translate(vaddr));
<a name="l00768"></a>00768     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: %#X -&gt; %#X\n&quot;</span>, vaddr, req-&gt;<a class="code" href="classRequest.html#a744ef11a5afe9d3651ce5f954259cb43">getPaddr</a>());
<a name="l00769"></a>00769     <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00770"></a>00770 
<a name="l00772"></a>00772 handleIntRegAccess:
<a name="l00773"></a>00773     <span class="keywordflow">if</span> (!hpriv) {
<a name="l00774"></a>00774         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00775"></a>00775         <span class="keywordflow">if</span> (priv)
<a name="l00776"></a>00776             <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00777"></a>00777          <span class="keywordflow">else</span>
<a name="l00778"></a>00778             <span class="keywordflow">return</span> <span class="keyword">new</span> PrivilegedAction;
<a name="l00779"></a>00779     }
<a name="l00780"></a>00780 
<a name="l00781"></a>00781     <span class="keywordflow">if</span> ((asi == <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a035868467ef161363dc8cb039f22c9e1">ASI_SWVR_UDB_INTR_W</a> &amp;&amp; !write) ||
<a name="l00782"></a>00782         (asi == <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3af692dc2c4c99d6ae0248b83b9c7d9343">ASI_SWVR_UDB_INTR_R</a> &amp;&amp; write)) {
<a name="l00783"></a>00783         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00784"></a>00784         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00785"></a>00785     }
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="keywordflow">goto</span> regAccessOk;
<a name="l00788"></a>00788 
<a name="l00789"></a>00789 
<a name="l00790"></a>00790 handleScratchRegAccess:
<a name="l00791"></a>00791     <span class="keywordflow">if</span> (vaddr &gt; 0x38 || (vaddr &gt;= 0x20 &amp;&amp; vaddr &lt; 0x30 &amp;&amp; !hpriv)) {
<a name="l00792"></a>00792         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00793"></a>00793         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00794"></a>00794     }
<a name="l00795"></a>00795     <span class="keywordflow">goto</span> regAccessOk;
<a name="l00796"></a>00796 
<a name="l00797"></a>00797 handleQueueRegAccess:
<a name="l00798"></a>00798     <span class="keywordflow">if</span> (!priv  &amp;&amp; !hpriv) {
<a name="l00799"></a>00799         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00800"></a>00800         <span class="keywordflow">return</span> <span class="keyword">new</span> PrivilegedAction;
<a name="l00801"></a>00801     }
<a name="l00802"></a>00802     <span class="keywordflow">if</span> ((!hpriv &amp;&amp; vaddr &amp; 0xF) || vaddr &gt; 0x3f8 || vaddr &lt; 0x3c0) {
<a name="l00803"></a>00803         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00804"></a>00804         <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00805"></a>00805     }
<a name="l00806"></a>00806     <span class="keywordflow">goto</span> regAccessOk;
<a name="l00807"></a>00807 
<a name="l00808"></a>00808 handleSparcErrorRegAccess:
<a name="l00809"></a>00809     <span class="keywordflow">if</span> (!hpriv) {
<a name="l00810"></a>00810         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(vaddr, write, <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>, <span class="keyword">true</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a15e185ce6e96161d3b8cd69c4e404c14">IllegalAsi</a>, asi);
<a name="l00811"></a>00811         <span class="keywordflow">if</span> (priv)
<a name="l00812"></a>00812             <span class="keywordflow">return</span> <span class="keyword">new</span> DataAccessException;
<a name="l00813"></a>00813          <span class="keywordflow">else</span>
<a name="l00814"></a>00814             <span class="keywordflow">return</span> <span class="keyword">new</span> PrivilegedAction;
<a name="l00815"></a>00815     }
<a name="l00816"></a>00816     <span class="keywordflow">goto</span> regAccessOk;
<a name="l00817"></a>00817 
<a name="l00818"></a>00818 
<a name="l00819"></a>00819 regAccessOk:
<a name="l00820"></a>00820 handleMmuRegAccess:
<a name="l00821"></a>00821     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: DTB Translating MM IPR access\n&quot;</span>);
<a name="l00822"></a>00822     req-&gt;<a class="code" href="classRequest.html#a33971d22712c9c80177e4362dffd5580">setFlags</a>(<a class="code" href="classRequest.html#a49ba1ff56158133aba02dce7a13952cb">Request::MMAPPED_IPR</a>);
<a name="l00823"></a>00823     req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>());
<a name="l00824"></a>00824     <span class="keywordflow">return</span> NoFault;
<a name="l00825"></a>00825 };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a26658814c6c9034665aae19cf25545bb"></a><!-- doxytag: member="SparcISA::TLB::translateFunctional" ref="a26658814c6c9034665aae19cf25545bb" args="(RequestPtr req, ThreadContext *tc, Mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">Fault</a> translateFunctional </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Stub function for compilation support with <a class="el" href="classCheckerCPU.html">CheckerCPU</a>. SPARC <a class="el" href="classSparcISA_1_1ISA.html">ISA</a> does not support the <a class="el" href="classChecker.html">Checker</a> model at the moment </p>

<p><div class="fragment"><pre class="fragment"><a name="l00846"></a>00846 {
<a name="l00847"></a>00847     <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Not implemented\n&quot;</span>);
<a name="l00848"></a>00848     <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00849"></a>00849 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a072afd8ed455dade4c25a85510e5a4da"></a><!-- doxytag: member="SparcISA::TLB::translateInst" ref="a072afd8ed455dade4c25a85510e5a4da" args="(RequestPtr req, ThreadContext *tc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classRefCountingPtr.html">Fault</a> translateInst </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00417"></a>00417 {
<a name="l00418"></a>00418     uint64_t tlbdata = tc-&gt;<a class="code" href="classThreadContext.html#a93c9c97261cb7289d5976b8222f70c4c">readMiscRegNoEffect</a>(<a class="code" href="namespaceSparcISA.html#a1e522017e015d4c7efd6b2360143aa67a34e96fb9ddfda445e0f7f353b647e55f">MISCREG_TLB_DATA</a>);
<a name="l00419"></a>00419 
<a name="l00420"></a>00420     <a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="code" href="namespaceMipsISA.html#ac78d9788b3f9a366df64485c9afaf1b1">vaddr</a> = req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>();
<a name="l00421"></a>00421     TlbEntry *<a class="code" href="namespaceArmISA.html#a55520507919005a961edbe8b177f3bba">e</a>;
<a name="l00422"></a>00422 
<a name="l00423"></a>00423     assert(req-&gt;<a class="code" href="classRequest.html#aefd0ec4015a880de7bbf555b15e242b1">getArchFlags</a>() == <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3aa054fb8d87e1ceec4e273f4636690a17">ASI_IMPLICIT</a>);
<a name="l00424"></a>00424 
<a name="l00425"></a>00425     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: ITB Request to translate va=%#x size=%d\n&quot;</span>,
<a name="l00426"></a>00426             vaddr, req-&gt;<a class="code" href="classRequest.html#a3c4029b904a61a9873e6d12785ce19a1">getSize</a>());
<a name="l00427"></a>00427 
<a name="l00428"></a>00428     <span class="comment">// Be fast if we can!</span>
<a name="l00429"></a>00429     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> &amp;&amp; <a class="code" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a> == tlbdata) {
<a name="l00430"></a>00430         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0]) {
<a name="l00431"></a>00431             <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0]-&gt;range.va &lt; vaddr + <span class="keyword">sizeof</span>(<a class="code" href="namespaceSparcISA.html#a301c22ea09fa33dcfe6ddf22f203699c">MachInst</a>) &amp;&amp;
<a name="l00432"></a>00432                 <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0]-&gt;range.va + <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0]-&gt;range.size &gt;= vaddr) {
<a name="l00433"></a>00433                 req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(<a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0]-&gt;pte.translate(vaddr));
<a name="l00434"></a>00434                 <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00435"></a>00435             }
<a name="l00436"></a>00436         } <span class="keywordflow">else</span> {
<a name="l00437"></a>00437             req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(vaddr &amp; <a class="code" href="namespaceSparcISA.html#abb8b7685b079953e35015543262458e2">PAddrImplMask</a>);
<a name="l00438"></a>00438             <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00439"></a>00439         }
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442     <span class="keywordtype">bool</span> <a class="code" href="namespaceSparcISA.html#a0ee6b47193187a7e02e4231aaa050d97">hpriv</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,0,0);
<a name="l00443"></a>00443     <span class="keywordtype">bool</span> <a class="code" href="namespaceSparcISA.html#a3daf539b069b3e0d79ce6137bac5a47f">red</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,1,1);
<a name="l00444"></a>00444     <span class="keywordtype">bool</span> <a class="code" href="namespaceSparcISA.html#a9d8b751eeaa798163459309b2f3d0b80">priv</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,2,2);
<a name="l00445"></a>00445     <span class="keywordtype">bool</span> addr_mask = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,3,3);
<a name="l00446"></a>00446     <span class="keywordtype">bool</span> lsu_im = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,4,4);
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     <span class="keywordtype">int</span> part_id = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,15,8);
<a name="l00449"></a>00449     <span class="keywordtype">int</span> <a class="code" href="namespaceMipsISA.html#a054bc5cc3193b2c04ef65c0abe135191">tl</a> = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,18,16);
<a name="l00450"></a>00450     <span class="keywordtype">int</span> pri_context = <a class="code" href="bitfield_8hh.html#a4ee0dc0723e11679c52429d5f8e05123">bits</a>(tlbdata,47,32);
<a name="l00451"></a>00451     <span class="keywordtype">int</span> context;
<a name="l00452"></a>00452     <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a> ct;
<a name="l00453"></a>00453     <span class="keywordtype">int</span> asi;
<a name="l00454"></a>00454     <span class="keywordtype">bool</span> real = <span class="keyword">false</span>;
<a name="l00455"></a>00455 
<a name="l00456"></a>00456     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: priv:%d hpriv:%d red:%d lsuim:%d part_id: %#X\n&quot;</span>,
<a name="l00457"></a>00457            priv, hpriv, red, lsu_im, part_id);
<a name="l00458"></a>00458 
<a name="l00459"></a>00459     <span class="keywordflow">if</span> (tl &gt; 0) {
<a name="l00460"></a>00460         asi = <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a0401a622da9ee06093be26c0f7916f30">ASI_N</a>;
<a name="l00461"></a>00461         ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5af5d1689599ccf08b174b36cfd0c3b6c7">Nucleus</a>;
<a name="l00462"></a>00462         context = 0;
<a name="l00463"></a>00463     } <span class="keywordflow">else</span> {
<a name="l00464"></a>00464         asi = <a class="code" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3a2b7422efe9682fe69ba53cda687a3666">ASI_P</a>;
<a name="l00465"></a>00465         ct = <a class="code" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5a35c33effed98e564ad1bd10ef61d302c">Primary</a>;
<a name="l00466"></a>00466         context = pri_context;
<a name="l00467"></a>00467     }
<a name="l00468"></a>00468 
<a name="l00469"></a>00469     <span class="keywordflow">if</span> ( hpriv || red ) {
<a name="l00470"></a>00470         <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">true</span>;
<a name="l00471"></a>00471         <a class="code" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a> = tlbdata;
<a name="l00472"></a>00472         <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0] = <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>;
<a name="l00473"></a>00473         req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(vaddr &amp; <a class="code" href="namespaceSparcISA.html#abb8b7685b079953e35015543262458e2">PAddrImplMask</a>);
<a name="l00474"></a>00474         <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00475"></a>00475     }
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     <span class="comment">// If the access is unaligned trap</span>
<a name="l00478"></a>00478     <span class="keywordflow">if</span> (vaddr &amp; 0x3) {
<a name="l00479"></a>00479         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(<span class="keyword">false</span>, ct, <span class="keyword">false</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822ad787a45173579300e6a023f2de7291af">OtherFault</a>, asi);
<a name="l00480"></a>00480         <span class="keywordflow">return</span> <span class="keyword">new</span> MemAddressNotAligned;
<a name="l00481"></a>00481     }
<a name="l00482"></a>00482 
<a name="l00483"></a>00483     <span class="keywordflow">if</span> (addr_mask)
<a name="l00484"></a>00484         vaddr = vaddr &amp; <a class="code" href="namespaceSparcISA.html#a23f8389b82b2ea7be78d3f123b91ec4c">VAddrAMask</a>;
<a name="l00485"></a>00485 
<a name="l00486"></a>00486     <span class="keywordflow">if</span> (!<a class="code" href="classSparcISA_1_1TLB.html#aa5cff14a14bcb47f10bb095035bd6290">validVirtualAddress</a>(vaddr, addr_mask)) {
<a name="l00487"></a>00487         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(<span class="keyword">false</span>, ct, <span class="keyword">false</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822a218b85059c614ecbbee4628b16ff49da">VaOutOfRange</a>, asi);
<a name="l00488"></a>00488         <span class="keywordflow">return</span> <span class="keyword">new</span> InstructionAccessException;
<a name="l00489"></a>00489     }
<a name="l00490"></a>00490 
<a name="l00491"></a>00491     <span class="keywordflow">if</span> (!lsu_im) {
<a name="l00492"></a>00492         e = <a class="code" href="classSparcISA_1_1TLB.html#a74fbbb81cfaa89e81165a62736e4311a">lookup</a>(vaddr, part_id, <span class="keyword">true</span>);
<a name="l00493"></a>00493         real = <span class="keyword">true</span>;
<a name="l00494"></a>00494         context = 0;
<a name="l00495"></a>00495     } <span class="keywordflow">else</span> {
<a name="l00496"></a>00496         e = <a class="code" href="classSparcISA_1_1TLB.html#a74fbbb81cfaa89e81165a62736e4311a">lookup</a>(vaddr, part_id, <span class="keyword">false</span>, context);
<a name="l00497"></a>00497     }
<a name="l00498"></a>00498 
<a name="l00499"></a>00499     <span class="keywordflow">if</span> (e == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a> || !e-&gt;valid) {
<a name="l00500"></a>00500         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00501"></a>00501         <span class="keywordflow">if</span> (real) {
<a name="l00502"></a>00502             <span class="keywordflow">return</span> <span class="keyword">new</span> InstructionRealTranslationMiss;
<a name="l00503"></a>00503         } <span class="keywordflow">else</span> {
<a name="l00504"></a>00504             <span class="keywordflow">if</span> (<a class="code" href="full__system_8hh.html#af929576af6f85c8849704b66d04b8370">FullSystem</a>)
<a name="l00505"></a>00505                 <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classSparcISA_1_1TLB.html#af8c3b0d2687d5c17d60fee3e4e77e20f">FastInstructionAccessMMUMiss</a>;
<a name="l00506"></a>00506             <span class="keywordflow">else</span>
<a name="l00507"></a>00507                 <span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classSparcISA_1_1TLB.html#af8c3b0d2687d5c17d60fee3e4e77e20f">FastInstructionAccessMMUMiss</a>(req-&gt;<a class="code" href="classRequest.html#a68d2230b37b30d25462093fefdd813ac">getVaddr</a>());
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509     }
<a name="l00510"></a>00510 
<a name="l00511"></a>00511     <span class="comment">// were not priviledged accesing priv page</span>
<a name="l00512"></a>00512     <span class="keywordflow">if</span> (!priv &amp;&amp; e-&gt;pte.priv()) {
<a name="l00513"></a>00513         <a class="code" href="classSparcISA_1_1TLB.html#a7f076e15ef97f1dd3f5e128b48cb4974">writeTagAccess</a>(vaddr, context);
<a name="l00514"></a>00514         <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">writeSfsr</a>(<span class="keyword">false</span>, ct, <span class="keyword">false</span>, <a class="code" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822afdc36f7178e8d04d90ec745400f5d5e7">PrivViolation</a>, asi);
<a name="l00515"></a>00515         <span class="keywordflow">return</span> <span class="keyword">new</span> InstructionAccessException;
<a name="l00516"></a>00516     }
<a name="l00517"></a>00517 
<a name="l00518"></a>00518     <span class="comment">// cache translation date for next translation</span>
<a name="l00519"></a>00519     <a class="code" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a> = <span class="keyword">true</span>;
<a name="l00520"></a>00520     <a class="code" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a> = tlbdata;
<a name="l00521"></a>00521     <a class="code" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[0] = e;
<a name="l00522"></a>00522 
<a name="l00523"></a>00523     req-&gt;<a class="code" href="classRequest.html#a688b841276b48f5c420569e62a090130">setPaddr</a>(e-&gt;pte.translate(vaddr));
<a name="l00524"></a>00524     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: %#X -&gt; %#X\n&quot;</span>, vaddr, req-&gt;<a class="code" href="classRequest.html#a744ef11a5afe9d3651ce5f954259cb43">getPaddr</a>());
<a name="l00525"></a>00525     <span class="keywordflow">return</span> <a class="code" href="fault__fwd_8hh.html#ab8ce3b69a6737f63fcdcf99910feb153">NoFault</a>;
<a name="l00526"></a>00526 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae52f7e465748883695d2b4f432a13652"></a><!-- doxytag: member="SparcISA::TLB::translateTiming" ref="ae52f7e465748883695d2b4f432a13652" args="(RequestPtr req, ThreadContext *tc, Translation *translation, Mode mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void translateTiming </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classRequest.html">RequestPtr</a>&nbsp;</td>
          <td class="paramname"> <em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classThreadContext.html">ThreadContext</a> *&nbsp;</td>
          <td class="paramname"> <em>tc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseTLB_1_1Translation.html">Translation</a> *&nbsp;</td>
          <td class="paramname"> <em>translation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBaseTLB.html#a46c8a310cf4c094f8c80e1cb8dc1f911">Mode</a>&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00839"></a>00839 {
<a name="l00840"></a>00840     assert(translation);
<a name="l00841"></a>00841     translation-&gt;finish(<a class="code" href="classSparcISA_1_1TLB.html#ad54e01e3c0a1613098a76b7f92e5be93">translateAtomic</a>(req, tc, <a class="code" href="namespaceArmISA.html#a5f3b9b97eb2dfa29d33e74878455f90d">mode</a>), req, tc, <a class="code" href="namespaceArmISA.html#a5f3b9b97eb2dfa29d33e74878455f90d">mode</a>);
<a name="l00842"></a>00842 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a62b717ca770fe6713cdde68d76694f44"></a><!-- doxytag: member="SparcISA::TLB::TteRead" ref="a62b717ca770fe6713cdde68d76694f44" args="(int entry)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t TteRead </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>entry</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Give an entry id, read that tlb entries' tte </p>

<p><div class="fragment"><pre class="fragment"><a name="l00342"></a>00342 {
<a name="l00343"></a>00343     <span class="keywordflow">if</span> (entry &gt;= <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)
<a name="l00344"></a>00344         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;entry: %d\n&quot;</span>, entry);
<a name="l00345"></a>00345 
<a name="l00346"></a>00346     assert(entry &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>);
<a name="l00347"></a>00347     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].valid)
<a name="l00348"></a>00348         <span class="keywordflow">return</span> <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[entry].pte();
<a name="l00349"></a>00349     <span class="keywordflow">else</span>
<a name="l00350"></a>00350         <span class="keywordflow">return</span> (uint64_t)-1ll;
<a name="l00351"></a>00351 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af22e5d6d660b97db37003ac61ac4ee49"></a><!-- doxytag: member="SparcISA::TLB::unserialize" ref="af22e5d6d660b97db37003ac61ac4ee49" args="(Checkpoint *cp, const std::string &amp;section)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void unserialize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCheckpoint.html">Checkpoint</a> *&nbsp;</td>
          <td class="paramname"> <em>cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>section</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classSerializable.html#af100c4e9feabf3cd918619c88c718387">Serializable</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l01386"></a>01386 {
<a name="l01387"></a>01387     <span class="keywordtype">int</span> oldSize;
<a name="l01388"></a>01388 
<a name="l01389"></a>01389     <a class="code" href="arch_2x86_2types_8cc.html#a2c99d2d69578d585494e1182085cb158">paramIn</a>(cp, section, <span class="stringliteral">&quot;size&quot;</span>, oldSize);
<a name="l01390"></a>01390     <span class="keywordflow">if</span> (oldSize != <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>)
<a name="l01391"></a>01391         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Don&apos;t support unserializing different sized TLBs\n&quot;</span>);
<a name="l01392"></a>01392     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a>);
<a name="l01393"></a>01393     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a>);
<a name="l01394"></a>01394 
<a name="l01395"></a>01395     <span class="keywordtype">int</span> cntr;
<a name="l01396"></a>01396     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(cntr);
<a name="l01397"></a>01397 
<a name="l01398"></a>01398     <span class="keywordtype">int</span> *free_list = (<span class="keywordtype">int</span>*)malloc(<span class="keyword">sizeof</span>(<span class="keywordtype">int</span>) * cntr);
<a name="l01399"></a>01399     <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.clear();
<a name="l01400"></a>01400     <a class="code" href="serialize_8hh.html#a8de12bf68d0f92f7ab8585820607932e">UNSERIALIZE_ARRAY</a>(free_list,  cntr);
<a name="l01401"></a>01401     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> = 0; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a> &lt; cntr; <a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>++)
<a name="l01402"></a>01402         <a class="code" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a>.push_back(&amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[free_list[<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>]]);
<a name="l01403"></a>01403 
<a name="l01404"></a>01404     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a>);
<a name="l01405"></a>01405     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a>);
<a name="l01406"></a>01406     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a>);
<a name="l01407"></a>01407     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a>);
<a name="l01408"></a>01408     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a>);
<a name="l01409"></a>01409     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a>);
<a name="l01410"></a>01410     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a>);
<a name="l01411"></a>01411     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a>);
<a name="l01412"></a>01412 
<a name="l01413"></a>01413     <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.clear();
<a name="l01414"></a>01414     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> x = 0; x &lt; <a class="code" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a>; x++) {
<a name="l01415"></a>01415         <a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].unserialize(cp, <a class="code" href="cprintf_8hh.html#ace22d1c39f2df58e593bc49d1613eca2">csprintf</a>(<span class="stringliteral">&quot;%s.PTE%d&quot;</span>, section, x));
<a name="l01416"></a>01416         <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].valid)
<a name="l01417"></a>01417             <a class="code" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a>.insert(<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x].range, &amp;<a class="code" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a>[x]);
<a name="l01418"></a>01418 
<a name="l01419"></a>01419     }
<a name="l01420"></a>01420     <a class="code" href="serialize_8hh.html#a13d18ccba3d8bcbcd5aab2e37c380bff">UNSERIALIZE_SCALAR</a>(<a class="code" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a>);
<a name="l01421"></a>01421 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa5cff14a14bcb47f10bb095035bd6290"></a><!-- doxytag: member="SparcISA::TLB::validVirtualAddress" ref="aa5cff14a14bcb47f10bb095035bd6290" args="(Addr va, bool am)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool validVirtualAddress </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>am</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks if the virtual address provided is a valid one. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00371"></a>00371 {
<a name="l00372"></a>00372     <span class="keywordflow">if</span> (<a class="code" href="namespaceSparcISA.html#a221d874609a3a07e22447f60e33cffdb">am</a>)
<a name="l00373"></a>00373         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00374"></a>00374     <span class="keywordflow">if</span> (<a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> &gt;= <a class="code" href="namespaceSparcISA.html#ab232c3f77d12da8f20157152adc977bd">StartVAddrHole</a> &amp;&amp; <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a> &lt;= <a class="code" href="namespaceSparcISA.html#a4d93696a5ef64a474d95daebd255181b">EndVAddrHole</a>)
<a name="l00375"></a>00375         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00376"></a>00376     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00377"></a>00377 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3c55ffc205560c3c945248eda4e0a62d"></a><!-- doxytag: member="SparcISA::TLB::writeSfsr" ref="a3c55ffc205560c3c945248eda4e0a62d" args="(Addr a, bool write, ContextType ct, bool se, FaultTypes ft, int asi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeSfsr </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a>&nbsp;</td>
          <td class="paramname"> <em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>se</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822">FaultTypes</a>&nbsp;</td>
          <td class="paramname"> <em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>asi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00408"></a>00408 {
<a name="l00409"></a>00409     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: Fault: A=%#x w=%d ct=%d ft=%d asi=%d\n&quot;</span>,
<a name="l00410"></a>00410             <a class="code" href="namespaceArmISA.html#a468da4d7330577ee8746df2acfa40959">a</a>, (<span class="keywordtype">int</span>)write, ct, ft, asi);
<a name="l00411"></a>00411     <a class="code" href="classSparcISA_1_1TLB.html#afd0c300a55c5f8ae2a678bcac2179afb">TLB::writeSfsr</a>(write, ct, se, ft, asi);
<a name="l00412"></a>00412     <a class="code" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a> = <a class="code" href="namespaceArmISA.html#a468da4d7330577ee8746df2acfa40959">a</a>;
<a name="l00413"></a>00413 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="afd0c300a55c5f8ae2a678bcac2179afb"></a><!-- doxytag: member="SparcISA::TLB::writeSfsr" ref="afd0c300a55c5f8ae2a678bcac2179afb" args="(bool write, ContextType ct, bool se, FaultTypes ft, int asi)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeSfsr </td>
          <td>(</td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>write</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSparcISA_1_1TLB.html#a856bf0f48d7d9c89d1e4216a6f0394e5">ContextType</a>&nbsp;</td>
          <td class="paramname"> <em>ct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>se</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classSparcISA_1_1TLB.html#a8e661b580d73f1e008c8ea6fc5823822">FaultTypes</a>&nbsp;</td>
          <td class="paramname"> <em>ft</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>asi</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00381"></a>00381 {
<a name="l00382"></a>00382     <span class="keywordflow">if</span> (<a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> &amp; 0x1)
<a name="l00383"></a>00383         <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> = 0x3;
<a name="l00384"></a>00384     <span class="keywordflow">else</span>
<a name="l00385"></a>00385         <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> = 1;
<a name="l00386"></a>00386 
<a name="l00387"></a>00387     <span class="keywordflow">if</span> (write)
<a name="l00388"></a>00388         <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> |= 1 &lt;&lt; 2;
<a name="l00389"></a>00389     <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> |= ct &lt;&lt; 4;
<a name="l00390"></a>00390     <span class="keywordflow">if</span> (se)
<a name="l00391"></a>00391         <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> |= 1 &lt;&lt; 6;
<a name="l00392"></a>00392     <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> |= ft &lt;&lt; 7;
<a name="l00393"></a>00393     <a class="code" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a> |= asi &lt;&lt; 16;
<a name="l00394"></a>00394 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7f076e15ef97f1dd3f5e128b48cb4974"></a><!-- doxytag: member="SparcISA::TLB::writeTagAccess" ref="a7f076e15ef97f1dd3f5e128b48cb4974" args="(Addr va, int context)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void writeTagAccess </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>va</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>context</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00398"></a>00398 {
<a name="l00399"></a>00399     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classSparcISA_1_1TLB.html#acb886bd3c59f00c21be9ceaaf25dab97">TLB</a>, <span class="stringliteral">&quot;TLB: Writing Tag Access: va: %#X ctx: %#X value: %#X\n&quot;</span>,
<a name="l00400"></a>00400             <a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>, context, <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(<a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>, 63,13) | <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(context,12,0));
<a name="l00401"></a>00401 
<a name="l00402"></a>00402     <a class="code" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a> = <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(<a class="code" href="namespaceArmISA.html#a441099e13f407fadb6bcb0447107de87">va</a>, 63,13) | <a class="code" href="bitfield_8hh.html#acaa3c424fec3407f14a01fe1ec22c2d4">mbits</a>(context,12,0);
<a name="l00403"></a>00403 }
</pre></div></p>

</div>
</div>
<hr/><h2>フレンドと関連する関数</h2>
<a class="anchor" id="a3d497ded3c85659ec4b013e2cae38c71"></a><!-- doxytag: member="SparcISA::TLB::FastDataAccessMMUMiss" ref="a3d497ded3c85659ec4b013e2cae38c71" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classSparcISA_1_1FastDataAccessMMUMiss.html">FastDataAccessMMUMiss</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="af8c3b0d2687d5c17d60fee3e4e77e20f"></a><!-- doxytag: member="SparcISA::TLB::FastInstructionAccessMMUMiss" ref="af8c3b0d2687d5c17d60fee3e4e77e20f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classSparcISA_1_1FastInstructionAccessMMUMiss.html">FastInstructionAccessMMUMiss</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a9395cf2ea615ba767ab8a677ee13d29c"></a><!-- doxytag: member="SparcISA::TLB::c0_config" ref="a9395cf2ea615ba767ab8a677ee13d29c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a9395cf2ea615ba767ab8a677ee13d29c">c0_config</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac1b9fd2f6c65e41f4f5b85b1b50d3a4e"></a><!-- doxytag: member="SparcISA::TLB::c0_tsb_ps0" ref="ac1b9fd2f6c65e41f4f5b85b1b50d3a4e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#ac1b9fd2f6c65e41f4f5b85b1b50d3a4e">c0_tsb_ps0</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1ab61f1741b5a3c2f81fe87fe3908e7e"></a><!-- doxytag: member="SparcISA::TLB::c0_tsb_ps1" ref="a1ab61f1741b5a3c2f81fe87fe3908e7e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a1ab61f1741b5a3c2f81fe87fe3908e7e">c0_tsb_ps1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad1ec0943e2f511b3a252ca0b824eb3e6"></a><!-- doxytag: member="SparcISA::TLB::cacheAsi" ref="ad1ec0943e2f511b3a252ca0b824eb3e6" args="[2]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceSparcISA.html#a6dd43f1311515252b283f56d7095a1f3">ASI</a> <a class="el" href="classSparcISA_1_1TLB.html#ad1ec0943e2f511b3a252ca0b824eb3e6">cacheAsi</a>[2]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5c9e9ce37f7a50fb908752ece801110f"></a><!-- doxytag: member="SparcISA::TLB::cacheEntry" ref="a5c9e9ce37f7a50fb908752ece801110f" args="[2]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a>* <a class="el" href="classSparcISA_1_1TLB.html#a5c9e9ce37f7a50fb908752ece801110f">cacheEntry</a>[2]<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a426d36e3a37393acd76bb3f1b14c2be9"></a><!-- doxytag: member="SparcISA::TLB::cacheState" ref="a426d36e3a37393acd76bb3f1b14c2be9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a426d36e3a37393acd76bb3f1b14c2be9">cacheState</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7d50962c0e8dea3232b1929d48065a3d"></a><!-- doxytag: member="SparcISA::TLB::cacheValid" ref="a7d50962c0e8dea3232b1929d48065a3d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classSparcISA_1_1TLB.html#a7d50962c0e8dea3232b1929d48065a3d">cacheValid</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a7388d84b8f9e8e4f6c8b3b8723d12b4a"></a><!-- doxytag: member="SparcISA::TLB::cx_config" ref="a7388d84b8f9e8e4f6c8b3b8723d12b4a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a7388d84b8f9e8e4f6c8b3b8723d12b4a">cx_config</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a3a0b3ccfe08de626e122e8db329e6cde"></a><!-- doxytag: member="SparcISA::TLB::cx_tsb_ps0" ref="a3a0b3ccfe08de626e122e8db329e6cde" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a3a0b3ccfe08de626e122e8db329e6cde">cx_tsb_ps0</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1551a0ec5dad394042a5f1384b582ff3"></a><!-- doxytag: member="SparcISA::TLB::cx_tsb_ps1" ref="a1551a0ec5dad394042a5f1384b582ff3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a1551a0ec5dad394042a5f1384b582ff3">cx_tsb_ps1</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa3dc4ef7249a728d9d8d717427985532"></a><!-- doxytag: member="SparcISA::TLB::freeList" ref="aa3dc4ef7249a728d9d8d717427985532" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1list.html">std::list</a>&lt;<a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a>*&gt; <a class="el" href="classSparcISA_1_1TLB.html#aa3dc4ef7249a728d9d8d717427985532">freeList</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a943cc0b274cf0720dad94d3469de39c3"></a><!-- doxytag: member="SparcISA::TLB::lastReplaced" ref="a943cc0b274cf0720dad94d3469de39c3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classSparcISA_1_1TLB.html#a943cc0b274cf0720dad94d3469de39c3">lastReplaced</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac52ea914d25a72d4c33298b8d64603c1"></a><!-- doxytag: member="SparcISA::TLB::lookupTable" ref="ac52ea914d25a72d4c33298b8d64603c1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classSparcISA_1_1TlbMap.html">TlbMap</a> <a class="el" href="classSparcISA_1_1TLB.html#ac52ea914d25a72d4c33298b8d64603c1">lookupTable</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a81cff85924ab4191c84c9818d90eb0a2"></a><!-- doxytag: member="SparcISA::TLB::sfar" ref="a81cff85924ab4191c84c9818d90eb0a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a81cff85924ab4191c84c9818d90eb0a2">sfar</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="aa93fbd043dbccd30bf6f78f83bb088eb"></a><!-- doxytag: member="SparcISA::TLB::sfsr" ref="aa93fbd043dbccd30bf6f78f83bb088eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#aa93fbd043dbccd30bf6f78f83bb088eb">sfsr</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a439227feff9d7f55384e8780cfc2eb82"></a><!-- doxytag: member="SparcISA::TLB::size" ref="a439227feff9d7f55384e8780cfc2eb82" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classSparcISA_1_1TLB.html#a439227feff9d7f55384e8780cfc2eb82">size</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a5d2c5251a072e8aef04cf78fdd6432d7"></a><!-- doxytag: member="SparcISA::TLB::tag_access" ref="a5d2c5251a072e8aef04cf78fdd6432d7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t <a class="el" href="classSparcISA_1_1TLB.html#a5d2c5251a072e8aef04cf78fdd6432d7">tag_access</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4651b9a4f432960d77d8e3d30175aab3"></a><!-- doxytag: member="SparcISA::TLB::tlb" ref="a4651b9a4f432960d77d8e3d30175aab3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structSparcISA_1_1TlbEntry.html">TlbEntry</a>* <a class="el" href="classSparcISA_1_1TLB.html#a4651b9a4f432960d77d8e3d30175aab3">tlb</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad85f3aef77516b13c75af59a1887f8b7"></a><!-- doxytag: member="SparcISA::TLB::usedEntries" ref="ad85f3aef77516b13c75af59a1887f8b7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="classSparcISA_1_1TLB.html#ad85f3aef77516b13c75af59a1887f8b7">usedEntries</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>arch/sparc/<a class="el" href="arch_2sparc_2tlb_8hh_source.html">tlb.hh</a></li>
<li>arch/sparc/<a class="el" href="arch_2sparc_2tlb_8cc.html">tlb.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
