\hypertarget{classEcoffObject}{
\section{クラス EcoffObject}
\label{classEcoffObject}\index{EcoffObject@{EcoffObject}}
}


{\ttfamily \#include $<$ecoff\_\-object.hh$>$}EcoffObjectに対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classEcoffObject}
\end{center}
\end{figure}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
virtual \hyperlink{classEcoffObject_a64f472690e786340ddbcc64b9a8e5597}{$\sim$EcoffObject} ()
\item 
virtual bool \hyperlink{classEcoffObject_a1de102f86bbb53d20455d9e78be53935}{loadGlobalSymbols} (SymbolTable $\ast$symtab, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addrMask=std::numeric\_\-limits$<$ \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} $>$::max())
\item 
virtual bool \hyperlink{classEcoffObject_aab9393b89c15838ac1b842e642f981bb}{loadLocalSymbols} (SymbolTable $\ast$symtab, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} addrMask=std::numeric\_\-limits$<$ \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} $>$::max())
\end{DoxyCompactItemize}
\subsection*{Static Public メソッド}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classObjectFile}{ObjectFile} $\ast$ \hyperlink{classEcoffObject_af96c4ced69d653731f78ba9d9006e251}{tryFile} (const std::string \&fname, int fd, size\_\-t \hyperlink{classObjectFile_a7360b55975153b822efc5217b7734e6a}{len}, uint8\_\-t $\ast$\hyperlink{classObjectFile_abbae3bd152e2d64768026e03593e64f3}{data})
\end{DoxyCompactItemize}
\subsection*{Protected メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classEcoffObject_a35e8abc28c36228972feaf9e9bd606cb}{EcoffObject} (const std::string \&\_\-filename, int \_\-fd, size\_\-t \_\-len, uint8\_\-t $\ast$\_\-data, \hyperlink{classObjectFile_a0ac03ab06a859320a9072002bdf3aa0f}{Arch} \_\-arch, \hyperlink{classObjectFile_aafc438343baf22e5884dde40c41331e8}{OpSys} \_\-opSys)
\end{DoxyCompactItemize}
\subsection*{Protected 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{structecoff__exechdr}{ecoff\_\-exechdr} $\ast$ \hyperlink{classEcoffObject_a0447939fdd24d55b8641d1f4c90ca28b}{execHdr}
\item 
\hyperlink{structecoff__filehdr}{ecoff\_\-filehdr} $\ast$ \hyperlink{classEcoffObject_a6f58ada2e9fe9c6fd1bff41680fcb88e}{fileHdr}
\item 
\hyperlink{structecoff__aouthdr}{ecoff\_\-aouthdr} $\ast$ \hyperlink{classEcoffObject_a472dfe6c2f3be923540cd3e090062f5d}{aoutHdr}
\end{DoxyCompactItemize}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classEcoffObject_a35e8abc28c36228972feaf9e9bd606cb}{
\index{EcoffObject@{EcoffObject}!EcoffObject@{EcoffObject}}
\index{EcoffObject@{EcoffObject}!EcoffObject@{EcoffObject}}
\subsubsection[{EcoffObject}]{\setlength{\rightskip}{0pt plus 5cm}{\bf EcoffObject} (const std::string \& {\em \_\-filename}, \/  int {\em \_\-fd}, \/  size\_\-t {\em \_\-len}, \/  uint8\_\-t $\ast$ {\em \_\-data}, \/  {\bf Arch} {\em \_\-arch}, \/  {\bf OpSys} {\em \_\-opSys})\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classEcoffObject_a35e8abc28c36228972feaf9e9bd606cb}
\hypertarget{classEcoffObject_a64f472690e786340ddbcc64b9a8e5597}{
\index{EcoffObject@{EcoffObject}!$\sim$EcoffObject@{$\sim$EcoffObject}}
\index{$\sim$EcoffObject@{$\sim$EcoffObject}!EcoffObject@{EcoffObject}}
\subsubsection[{$\sim$EcoffObject}]{\setlength{\rightskip}{0pt plus 5cm}virtual $\sim${\bf EcoffObject} ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline, virtual\mbox{]}}}}
\label{classEcoffObject_a64f472690e786340ddbcc64b9a8e5597}



\begin{DoxyCode}
53 {}
\end{DoxyCode}


\subsection{関数}
\hypertarget{classEcoffObject_a1de102f86bbb53d20455d9e78be53935}{
\index{EcoffObject@{EcoffObject}!loadGlobalSymbols@{loadGlobalSymbols}}
\index{loadGlobalSymbols@{loadGlobalSymbols}!EcoffObject@{EcoffObject}}
\subsubsection[{loadGlobalSymbols}]{\setlength{\rightskip}{0pt plus 5cm}bool loadGlobalSymbols (SymbolTable $\ast$ {\em symtab}, \/  {\bf Addr} {\em addrMask} = {\ttfamily std::numeric\_\-limits$<${\bf Addr}$>$::max()})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classEcoffObject_a1de102f86bbb53d20455d9e78be53935}


\hyperlink{classObjectFile_abd8b86c98494f055ba7e0babbd55f4a0}{ObjectFile}を実装しています。


\begin{DoxyCode}
96 {
97     if (!symtab)
98         return false;
99 
100     if (fileHdr->f_magic != ECOFF_MAGIC_ALPHA) {
101         warn("loadGlobalSymbols: wrong magic on %s\n", filename);
102         return false;
103     }
104 
105     ecoff_symhdr *syms = (ecoff_symhdr *)(fileData + fileHdr->f_symptr);
106     if (syms->magic != magicSym2) {
107         warn("loadGlobalSymbols: bad symbol header magic on %s\n", filename);
108         return false;
109     }
110 
111     ecoff_extsym *ext_syms = (ecoff_extsym *)(fileData + syms->cbExtOffset);
112 
113     char *ext_strings = (char *)(fileData + syms->cbSsExtOffset);
114     for (int i = 0; i < syms->iextMax; i++) {
115         ecoff_sym *entry = &(ext_syms[i].asym);
116         if (entry->iss != -1)
117             symtab->insert(entry->value, ext_strings + entry->iss);
118     }
119 
120     return true;
121 }
\end{DoxyCode}
\hypertarget{classEcoffObject_aab9393b89c15838ac1b842e642f981bb}{
\index{EcoffObject@{EcoffObject}!loadLocalSymbols@{loadLocalSymbols}}
\index{loadLocalSymbols@{loadLocalSymbols}!EcoffObject@{EcoffObject}}
\subsubsection[{loadLocalSymbols}]{\setlength{\rightskip}{0pt plus 5cm}bool loadLocalSymbols (SymbolTable $\ast$ {\em symtab}, \/  {\bf Addr} {\em addrMask} = {\ttfamily std::numeric\_\-limits$<${\bf Addr}$>$::max()})\hspace{0.3cm}{\ttfamily  \mbox{[}virtual\mbox{]}}}}
\label{classEcoffObject_aab9393b89c15838ac1b842e642f981bb}


\hyperlink{classObjectFile_a15e7fbacc339ac9a4d50e4aa36591339}{ObjectFile}を実装しています。


\begin{DoxyCode}
125 {
126     if (!symtab)
127         return false;
128 
129     if (fileHdr->f_magic != ECOFF_MAGIC_ALPHA) {
130         warn("loadGlobalSymbols: wrong magic on %s\n", filename);
131         return false;
132     }
133 
134     ecoff_symhdr *syms = (ecoff_symhdr *)(fileData + fileHdr->f_symptr);
135     if (syms->magic != magicSym2) {
136         warn("loadGlobalSymbols: bad symbol header magic on %s\n", filename);
137         return false;
138     }
139 
140     ecoff_sym *local_syms = (ecoff_sym *)(fileData + syms->cbSymOffset);
141     char *local_strings = (char *)(fileData + syms->cbSsOffset);
142     ecoff_fdr *fdesc = (ecoff_fdr *)(fileData + syms->cbFdOffset);
143 
144     for (int i = 0; i < syms->ifdMax; i++) {
145         ecoff_sym *entry = (ecoff_sym *)(local_syms + fdesc[i].isymBase);
146         char *strings = (char *)(local_strings + fdesc[i].issBase);
147         for (int j = 0; j < fdesc[i].csym; j++) {
148             if (entry[j].st == stGlobal || entry[j].st == stProc)
149                 if (entry[j].iss != -1)
150                     symtab->insert(entry[j].value, strings + entry[j].iss);
151         }
152     }
153 
154     for (int i = 0; i < syms->isymMax; i++) {
155         ecoff_sym *entry = &(local_syms[i]);
156         if (entry->st == stProc)
157             symtab->insert(entry->value, local_strings + entry->iss);
158     }
159 
160     return true;
161 }
\end{DoxyCode}
\hypertarget{classEcoffObject_af96c4ced69d653731f78ba9d9006e251}{
\index{EcoffObject@{EcoffObject}!tryFile@{tryFile}}
\index{tryFile@{tryFile}!EcoffObject@{EcoffObject}}
\subsubsection[{tryFile}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf ObjectFile}$\ast$ tryFile (const std::string \& {\em fname}, \/  int {\em fd}, \/  size\_\-t {\em len}, \/  uint8\_\-t $\ast$ {\em data})\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}
\label{classEcoffObject_af96c4ced69d653731f78ba9d9006e251}


\subsection{変数}
\hypertarget{classEcoffObject_a472dfe6c2f3be923540cd3e090062f5d}{
\index{EcoffObject@{EcoffObject}!aoutHdr@{aoutHdr}}
\index{aoutHdr@{aoutHdr}!EcoffObject@{EcoffObject}}
\subsubsection[{aoutHdr}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ecoff\_\-aouthdr}$\ast$ {\bf aoutHdr}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classEcoffObject_a472dfe6c2f3be923540cd3e090062f5d}
\hypertarget{classEcoffObject_a0447939fdd24d55b8641d1f4c90ca28b}{
\index{EcoffObject@{EcoffObject}!execHdr@{execHdr}}
\index{execHdr@{execHdr}!EcoffObject@{EcoffObject}}
\subsubsection[{execHdr}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ecoff\_\-exechdr}$\ast$ {\bf execHdr}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classEcoffObject_a0447939fdd24d55b8641d1f4c90ca28b}
\hypertarget{classEcoffObject_a6f58ada2e9fe9c6fd1bff41680fcb88e}{
\index{EcoffObject@{EcoffObject}!fileHdr@{fileHdr}}
\index{fileHdr@{fileHdr}!EcoffObject@{EcoffObject}}
\subsubsection[{fileHdr}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ecoff\_\-filehdr}$\ast$ {\bf fileHdr}\hspace{0.3cm}{\ttfamily  \mbox{[}protected\mbox{]}}}}
\label{classEcoffObject_a6f58ada2e9fe9c6fd1bff41680fcb88e}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
base/loader/\hyperlink{ecoff__object_8hh}{ecoff\_\-object.hh}\item 
base/loader/\hyperlink{ecoff__object_8cc}{ecoff\_\-object.cc}\end{DoxyCompactItemize}
