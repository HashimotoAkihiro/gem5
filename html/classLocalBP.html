<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス LocalBP</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス LocalBP</h1><!-- doxytag: class="LocalBP" --><!-- doxytag: inherits="BPredUnit" -->
<p><code>#include &lt;<a class="el" href="2bit__local_8hh_source.html">2bit_local.hh</a>&gt;</code></p>
<div class="dynheader">
LocalBPに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classLocalBP.gif" usemap="#LocalBP_map" alt=""/>
  <map id="LocalBP_map" name="LocalBP_map">
<area href="classBPredUnit.html" alt="BPredUnit" shape="rect" coords="105,112,200,136"/>
<area href="classSimObject.html" alt="SimObject" shape="rect" coords="105,56,200,80"/>
<area href="classEventManager.html" alt="EventManager" shape="rect" coords="0,0,95,24"/>
<area href="classSerializable.html" alt="Serializable" shape="rect" coords="105,0,200,24"/>
<area href="classDrainable.html" alt="Drainable" shape="rect" coords="210,0,305,24"/>
</map>
 </div>
</div>

<p><a href="classLocalBP-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#aec0c0965d267585d311300273d8976d0">LocalBP</a> (const <a class="el" href="classBPredUnit.html#aa715df0f49f029439cca4c7bd6e3d4fb">Params</a> *params)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#ad3d898a5eab93d923a1073fe6a0f0030">uncondBranch</a> (void *&amp;bp_history)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a9c30d728e49473b5a3825835e98a10bc">lookup</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> branch_addr, void *&amp;bp_history)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a101ada238eecd07cc6905c60272e2693">btbUpdate</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> branch_addr, void *&amp;bp_history)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a590e0fd17d5b663e25f0e956fadc7062">update</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> branch_addr, bool taken, void *bp_history, bool squashed)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#aeb215cee5cdccdf52d02b73fffe80220">squash</a> (void *bp_history)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#ad20897c5c8bd47f5d4005989bead0e55">reset</a> ()</td></tr>
<tr><td colspan="2"><h2>Private メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#ad0f11a4da5ded93ef111f9d8a1d40a54">getPrediction</a> (uint8_t &amp;count)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a60ccaea333f32c53f3645a2f7c7e6737">getLocalIndex</a> (<a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> &amp;PC)</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt; <a class="el" href="classSatCounter.html">SatCounter</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#ad980634448337df2bf521bc96fd5653d">localPredictorSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#a8ad2ee60a6143561753205840ad144e7">instShiftAmt</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLocalBP.html#af74847baefa86f9623cf55bb28803c99">indexMask</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p>Implements a local predictor that uses the PC to index into a table of counters. Note that any time a pointer to the bp_history is given, it should be NULL using this predictor because it does not have any branch predictor state that needs to be recorded or updated; the update can be determined solely by the branch being taken or not taken. </p>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="aec0c0965d267585d311300273d8976d0"></a><!-- doxytag: member="LocalBP::LocalBP" ref="aec0c0965d267585d311300273d8976d0" args="(const Params *params)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLocalBP.html">LocalBP</a> </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classBPredUnit.html#aa715df0f49f029439cca4c7bd6e3d4fb">Params</a> *&nbsp;</td>
          <td class="paramname"> <em>params</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Default branch predictor constructor. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00038"></a>00038     : <a class="code" href="classBPredUnit.html#a1061023e2f959cf88ef9064923a4667f">BPredUnit</a>(<a class="code" href="classSimObject.html#acd3c3feb78ae7a8f88fe0f110a718dff">params</a>),
<a name="l00039"></a>00039       <a class="code" href="classLocalBP.html#ad980634448337df2bf521bc96fd5653d">localPredictorSize</a>(<a class="code" href="classSimObject.html#acd3c3feb78ae7a8f88fe0f110a718dff">params</a>-&gt;localPredictorSize),
<a name="l00040"></a>00040       <a class="code" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a>(<a class="code" href="classSimObject.html#acd3c3feb78ae7a8f88fe0f110a718dff">params</a>-&gt;localCtrBits),
<a name="l00041"></a>00041       <a class="code" href="classLocalBP.html#a8ad2ee60a6143561753205840ad144e7">instShiftAmt</a>(<a class="code" href="classSimObject.html#acd3c3feb78ae7a8f88fe0f110a718dff">params</a>-&gt;instShiftAmt)
<a name="l00042"></a>00042 {
<a name="l00043"></a>00043     <span class="keywordflow">if</span> (!<a class="code" href="intmath_8hh.html#aa73a8269f3cc1853f96c7a9210f61f0e">isPowerOf2</a>(<a class="code" href="classLocalBP.html#ad980634448337df2bf521bc96fd5653d">localPredictorSize</a>)) {
<a name="l00044"></a>00044         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Invalid local predictor size!\n&quot;</span>);
<a name="l00045"></a>00045     }
<a name="l00046"></a>00046 
<a name="l00047"></a>00047     <a class="code" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a> = <a class="code" href="classLocalBP.html#ad980634448337df2bf521bc96fd5653d">localPredictorSize</a> / <a class="code" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a>;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049     <span class="keywordflow">if</span> (!<a class="code" href="intmath_8hh.html#aa73a8269f3cc1853f96c7a9210f61f0e">isPowerOf2</a>(<a class="code" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a>)) {
<a name="l00050"></a>00050         <a class="code" href="base_2misc_8hh.html#acad519418dbfdd70c1208711e609c80e">fatal</a>(<span class="stringliteral">&quot;Invalid number of local predictor sets! Check localCtrBits.\n&quot;</span>);
<a name="l00051"></a>00051     }
<a name="l00052"></a>00052 
<a name="l00053"></a>00053     <span class="comment">// Setup the index mask.</span>
<a name="l00054"></a>00054     <a class="code" href="classLocalBP.html#af74847baefa86f9623cf55bb28803c99">indexMask</a> = <a class="code" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a> - 1;
<a name="l00055"></a>00055 
<a name="l00056"></a>00056     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;index mask: %#x\n&quot;</span>, <a class="code" href="classLocalBP.html#af74847baefa86f9623cf55bb28803c99">indexMask</a>);
<a name="l00057"></a>00057 
<a name="l00058"></a>00058     <span class="comment">// Setup the array of counters for the local predictor.</span>
<a name="l00059"></a>00059     <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>.resize(<a class="code" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a>);
<a name="l00060"></a>00060 
<a name="l00061"></a>00061     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>)
<a name="l00062"></a>00062         <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].setBits(<a class="code" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a>);
<a name="l00063"></a>00063 
<a name="l00064"></a>00064     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;local predictor size: %i\n&quot;</span>,
<a name="l00065"></a>00065             <a class="code" href="classLocalBP.html#ad980634448337df2bf521bc96fd5653d">localPredictorSize</a>);
<a name="l00066"></a>00066 
<a name="l00067"></a>00067     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;local counter bits: %i\n&quot;</span>, <a class="code" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a>);
<a name="l00068"></a>00068 
<a name="l00069"></a>00069     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;instruction shift amount: %i\n&quot;</span>,
<a name="l00070"></a>00070             <a class="code" href="classLocalBP.html#a8ad2ee60a6143561753205840ad144e7">instShiftAmt</a>);
<a name="l00071"></a>00071 }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a101ada238eecd07cc6905c60272e2693"></a><!-- doxytag: member="LocalBP::btbUpdate" ref="a101ada238eecd07cc6905c60272e2693" args="(Addr branch_addr, void *&amp;bp_history)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void btbUpdate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>branch_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&amp;&nbsp;</td>
          <td class="paramname"> <em>bp_history</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Updates the branch predictor to Not Taken if a BTB entry is invalid or not found. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>branch_addr</em>&nbsp;</td><td>The address of the branch to look up. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bp_history</em>&nbsp;</td><td>Pointer to any bp history state. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Whether or not the branch is taken. </dd></dl>

<p><a class="el" href="classBPredUnit.html#a7b687ebde63095b00a0b083ba6607cd4">BPredUnit</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00083"></a>00083 {
<a name="l00084"></a>00084 <span class="comment">// Place holder for a function that is called to update predictor history when</span>
<a name="l00085"></a>00085 <span class="comment">// a BTB entry is invalid or not found.</span>
<a name="l00086"></a>00086 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a60ccaea333f32c53f3645a2f7c7e6737"></a><!-- doxytag: member="LocalBP::getLocalIndex" ref="a60ccaea333f32c53f3645a2f7c7e6737" args="(Addr &amp;PC)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned getLocalIndex </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>PC</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Calculates the local index based on the PC. </p>

<p><div class="fragment"><pre class="fragment"><a name="l00151"></a>00151 {
<a name="l00152"></a>00152     <span class="keywordflow">return</span> (branch_addr &gt;&gt; <a class="code" href="classLocalBP.html#a8ad2ee60a6143561753205840ad144e7">instShiftAmt</a>) &amp; <a class="code" href="classLocalBP.html#af74847baefa86f9623cf55bb28803c99">indexMask</a>;
<a name="l00153"></a>00153 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad0f11a4da5ded93ef111f9d8a1d40a54"></a><!-- doxytag: member="LocalBP::getPrediction" ref="ad0f11a4da5ded93ef111f9d8a1d40a54" args="(uint8_t &amp;count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool getPrediction </td>
          <td>(</td>
          <td class="paramtype">uint8_t &amp;&nbsp;</td>
          <td class="paramname"> <em>count</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Returns the taken/not taken prediction given the value of the counter. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>count</em>&nbsp;</td><td>The value of the counter. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>The prediction based on the counter value. </dd></dl>

<p><div class="fragment"><pre class="fragment"><a name="l00143"></a>00143 {
<a name="l00144"></a>00144     <span class="comment">// Get the MSB of the count</span>
<a name="l00145"></a>00145     <span class="keywordflow">return</span> (<a class="code" href="namespaceX86ISA.html#a668f84c330035fdb72824eb18e09cd09">count</a> &gt;&gt; (<a class="code" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a> - 1));
<a name="l00146"></a>00146 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c30d728e49473b5a3825835e98a10bc"></a><!-- doxytag: member="LocalBP::lookup" ref="a9c30d728e49473b5a3825835e98a10bc" args="(Addr branch_addr, void *&amp;bp_history)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool lookup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>branch_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&amp;&nbsp;</td>
          <td class="paramname"> <em>bp_history</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Looks up the given address in the branch predictor and returns a true/false value as to whether it is taken. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>branch_addr</em>&nbsp;</td><td>The address of the branch to look up. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bp_history</em>&nbsp;</td><td>Pointer to any bp history state. </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>戻り値:</b></dt><dd>Whether or not the branch is taken. </dd></dl>

<p><a class="el" href="classBPredUnit.html#a5632fdea0abc34f7d68d8445a7a6c166">BPredUnit</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00091"></a>00091 {
<a name="l00092"></a>00092     <span class="keywordtype">bool</span> taken;
<a name="l00093"></a>00093     uint8_t counter_val;
<a name="l00094"></a>00094     <span class="keywordtype">unsigned</span> local_predictor_idx = <a class="code" href="classLocalBP.html#a60ccaea333f32c53f3645a2f7c7e6737">getLocalIndex</a>(branch_addr);
<a name="l00095"></a>00095 
<a name="l00096"></a>00096     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Looking up index %#x\n&quot;</span>,
<a name="l00097"></a>00097             local_predictor_idx);
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     counter_val = <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[local_predictor_idx].read();
<a name="l00100"></a>00100 
<a name="l00101"></a>00101     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;prediction is %i.\n&quot;</span>,
<a name="l00102"></a>00102             (<span class="keywordtype">int</span>)counter_val);
<a name="l00103"></a>00103 
<a name="l00104"></a>00104     taken = <a class="code" href="classLocalBP.html#ad0f11a4da5ded93ef111f9d8a1d40a54">getPrediction</a>(counter_val);
<a name="l00105"></a>00105 
<a name="l00106"></a>00106 <span class="preprocessor">#if 0</span>
<a name="l00107"></a>00107 <span class="preprocessor"></span>    <span class="comment">// Speculative update.</span>
<a name="l00108"></a>00108     <span class="keywordflow">if</span> (taken) {
<a name="l00109"></a>00109         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Branch updated as taken.\n&quot;</span>);
<a name="l00110"></a>00110         <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[local_predictor_idx].increment();
<a name="l00111"></a>00111     } <span class="keywordflow">else</span> {
<a name="l00112"></a>00112         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Branch updated as not taken.\n&quot;</span>);
<a name="l00113"></a>00113         <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[local_predictor_idx].decrement();
<a name="l00114"></a>00114     }
<a name="l00115"></a>00115 <span class="preprocessor">#endif</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00117"></a>00117     <span class="keywordflow">return</span> taken;
<a name="l00118"></a>00118 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad20897c5c8bd47f5d4005989bead0e55"></a><!-- doxytag: member="LocalBP::reset" ref="ad20897c5c8bd47f5d4005989bead0e55" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00075"></a>00075 {
<a name="l00076"></a>00076     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> = 0; <a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a> &lt; <a class="code" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a>; ++<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>) {
<a name="l00077"></a>00077         <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[<a class="code" href="namespaceArmISA.html#aca8175497376fbb9f0e71fefa122cef7">i</a>].reset();
<a name="l00078"></a>00078     }
<a name="l00079"></a>00079 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aeb215cee5cdccdf52d02b73fffe80220"></a><!-- doxytag: member="LocalBP::squash" ref="aeb215cee5cdccdf52d02b73fffe80220" args="(void *bp_history)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void squash </td>
          <td>(</td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>bp_history</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>bp_history</em>&nbsp;</td><td>Pointer to the history object. The predictor will need to update any state and delete the object. </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="classBPredUnit.html#a2af63ba741727bdf58e2b2dc22a912ed">BPredUnit</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00096"></a>00096     { assert(bp_history == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>); }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad3d898a5eab93d923a1073fe6a0f0030"></a><!-- doxytag: member="LocalBP::uncondBranch" ref="ad3d898a5eab93d923a1073fe6a0f0030" args="(void *&amp;bp_history)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void uncondBranch </td>
          <td>(</td>
          <td class="paramtype">void *&amp;&nbsp;</td>
          <td class="paramname"> <em>bp_history</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classBPredUnit.html#a17161e0c51444f148e49e4df2ba89704">BPredUnit</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00157"></a>00157 {
<a name="l00158"></a>00158 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a590e0fd17d5b663e25f0e956fadc7062"></a><!-- doxytag: member="LocalBP::update" ref="a590e0fd17d5b663e25f0e956fadc7062" args="(Addr branch_addr, bool taken, void *bp_history, bool squashed)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void update </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>branch_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>taken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>bp_history</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>squashed</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Updates the branch predictor with the actual result of a branch. </p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>branch_addr</em>&nbsp;</td><td>The address of the branch to update. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>taken</em>&nbsp;</td><td>Whether or not the branch was taken. </td></tr>
  </table>
  </dd>
</dl>

<p><a class="el" href="classBPredUnit.html#ab00dd76dc9f830cdae0edc72357c013a">BPredUnit</a>を実装しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00122"></a>00122 {
<a name="l00123"></a>00123     assert(bp_history == <a class="code" href="namespacem5_1_1params.html#a1e2e219ac4e913a2c59019be3094d3ca">NULL</a>);
<a name="l00124"></a>00124     <span class="keywordtype">unsigned</span> local_predictor_idx;
<a name="l00125"></a>00125 
<a name="l00126"></a>00126     <span class="comment">// Update the local predictor.</span>
<a name="l00127"></a>00127     local_predictor_idx = <a class="code" href="classLocalBP.html#a60ccaea333f32c53f3645a2f7c7e6737">getLocalIndex</a>(branch_addr);
<a name="l00128"></a>00128 
<a name="l00129"></a>00129     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Looking up index %#x\n&quot;</span>, local_predictor_idx);
<a name="l00130"></a>00130 
<a name="l00131"></a>00131     <span class="keywordflow">if</span> (taken) {
<a name="l00132"></a>00132         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Branch updated as taken.\n&quot;</span>);
<a name="l00133"></a>00133         <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[local_predictor_idx].increment();
<a name="l00134"></a>00134     } <span class="keywordflow">else</span> {
<a name="l00135"></a>00135         <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(Fetch, <span class="stringliteral">&quot;Branch updated as not taken.\n&quot;</span>);
<a name="l00136"></a>00136         <a class="code" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a>[local_predictor_idx].decrement();
<a name="l00137"></a>00137     }
<a name="l00138"></a>00138 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="af74847baefa86f9623cf55bb28803c99"></a><!-- doxytag: member="LocalBP::indexMask" ref="af74847baefa86f9623cf55bb28803c99" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLocalBP.html#af74847baefa86f9623cf55bb28803c99">indexMask</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Mask to get index bits. </p>

</div>
</div>
<a class="anchor" id="a8ad2ee60a6143561753205840ad144e7"></a><!-- doxytag: member="LocalBP::instShiftAmt" ref="a8ad2ee60a6143561753205840ad144e7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLocalBP.html#a8ad2ee60a6143561753205840ad144e7">instShiftAmt</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of bits to shift the PC when calculating index. </p>

</div>
</div>
<a class="anchor" id="a815998927bcd79afe7f787b90f9954f5"></a><!-- doxytag: member="LocalBP::localCtrBits" ref="a815998927bcd79afe7f787b90f9954f5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLocalBP.html#a815998927bcd79afe7f787b90f9954f5">localCtrBits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of bits of the local predictor's counters. </p>

</div>
</div>
<a class="anchor" id="a639a100e0452520604d19db58d98721d"></a><!-- doxytag: member="LocalBP::localCtrs" ref="a639a100e0452520604d19db58d98721d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classstd_1_1vector.html">std::vector</a>&lt;<a class="el" href="classSatCounter.html">SatCounter</a>&gt; <a class="el" href="classLocalBP.html#a639a100e0452520604d19db58d98721d">localCtrs</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Array of counters that make up the local predictor. </p>

</div>
</div>
<a class="anchor" id="a82806c3c6e4b9e285b11f8739a692665"></a><!-- doxytag: member="LocalBP::localPredictorSets" ref="a82806c3c6e4b9e285b11f8739a692665" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLocalBP.html#a82806c3c6e4b9e285b11f8739a692665">localPredictorSets</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of sets. </p>

</div>
</div>
<a class="anchor" id="ad980634448337df2bf521bc96fd5653d"></a><!-- doxytag: member="LocalBP::localPredictorSize" ref="ad980634448337df2bf521bc96fd5653d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned <a class="el" href="classLocalBP.html#ad980634448337df2bf521bc96fd5653d">localPredictorSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Size of the local predictor. </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>cpu/pred/<a class="el" href="2bit__local_8hh_source.html">2bit_local.hh</a></li>
<li>cpu/pred/<a class="el" href="2bit__local_8cc.html">2bit_local.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
