\hypertarget{namespacem5_1_1util}{
\section{ネームスペース m5::util}
\label{namespacem5_1_1util}\index{m5::util@{m5::util}}
}
\subsection*{ネームスペース}
\begin{DoxyCompactItemize}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1attrdict}{attrdict}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1code__formatter}{code\_\-formatter}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1convert}{convert}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1dot__writer}{dot\_\-writer}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1grammar}{grammar}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1jobfile}{jobfile}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1multidict}{multidict}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1orderdict}{orderdict}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1region}{region}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1smartdict}{smartdict}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1sorteddict}{sorteddict}
\item 
namespace \hyperlink{namespacem5_1_1util_1_1terminal}{terminal}
\end{DoxyCompactItemize}
\subsection*{構成}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classm5_1_1util_1_1Singleton}{Singleton}
\end{DoxyCompactItemize}
\subsection*{関数}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacem5_1_1util_aa2cb9615f3da634982552408620a1b99}{panic}
\item 
def \hyperlink{namespacem5_1_1util_ae1c80955a028fc0aec505dbd4fa9e09c}{fatal}
\item 
def \hyperlink{namespacem5_1_1util_af8ddd678b5f4fc6b3d4d6e06291b4bb4}{warn}
\item 
def \hyperlink{namespacem5_1_1util_a93d91fcd263b81cfcf7cdbf726f106d6}{inform}
\item 
def \hyperlink{namespacem5_1_1util_a263a170421c97dbc23812718b71ee70d}{addToPath}
\item 
def \hyperlink{namespacem5_1_1util_ab1c0a698e0ba669fe3ef6c18e4c93f65}{applyMethod}
\item 
def \hyperlink{namespacem5_1_1util_a7334481c369897a3fdc6df753972f5f8}{applyOrMap}
\item 
def \hyperlink{namespacem5_1_1util_a5b6cc0ea95b0e707231a420d9bd57f07}{compareVersions}
\item 
def \hyperlink{namespacem5_1_1util_a15681e303c0d9c6c1bc489f4197e4814}{crossproduct}
\item 
def \hyperlink{namespacem5_1_1util_a3a48f3283686eb13056318134122a74a}{flatten}
\item 
def \hyperlink{namespacem5_1_1util_a21a8ae7bb1334e05e9b870de5f0675f8}{makeList}
\item 
def \hyperlink{namespacem5_1_1util_a375ec1766215b51a41c8f07219728164}{printList}
\item 
def \hyperlink{namespacem5_1_1util_a9c9d966763727d2b9e9311eae3d8f112}{readCommand}
\item 
def \hyperlink{namespacem5_1_1util_a25ec95943ee170ca910bafa9376613ff}{makeDir}
\end{DoxyCompactItemize}


\subsection{関数}
\hypertarget{namespacem5_1_1util_a263a170421c97dbc23812718b71ee70d}{
\index{m5::util@{m5::util}!addToPath@{addToPath}}
\index{addToPath@{addToPath}!m5::util@{m5::util}}
\subsubsection[{addToPath}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::addToPath ( {\em path})}}
\label{namespacem5_1_1util_a263a170421c97dbc23812718b71ee70d}
\begin{DoxyVerb}Prepend given directory to system module search path.  We may not
need this anymore if we can structure our config library more like a
Python package.\end{DoxyVerb}
 


\begin{DoxyCode}
78                    :
79     """Prepend given directory to system module search path.  We may not
80     need this anymore if we can structure our config library more like a
81     Python package."""
82 
83     # if it's a relative path and we know what directory the current
84     # python script is in, make the path relative to that directory.
85     if not os.path.isabs(path) and sys.path[0]:
86         path = os.path.join(sys.path[0], path)
87     path = os.path.realpath(path)
88     # sys.path[0] should always refer to the current script's directory,
89     # so place the new dir right after that.
90     sys.path.insert(1, path)
91 
92 # Apply method to object.
93 # applyMethod(obj, 'meth', <args>) is equivalent to obj.meth(<args>)
def applyMethod(obj, meth, *args, **kwargs):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_ab1c0a698e0ba669fe3ef6c18e4c93f65}{
\index{m5::util@{m5::util}!applyMethod@{applyMethod}}
\index{applyMethod@{applyMethod}!m5::util@{m5::util}}
\subsubsection[{applyMethod}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::applyMethod ( {\em obj}, \/   {\em meth}, \/   {\em args}, \/   {\em kwargs})}}
\label{namespacem5_1_1util_ab1c0a698e0ba669fe3ef6c18e4c93f65}



\begin{DoxyCode}
94                                            :
95     return getattr(obj, meth)(*args, **kwargs)
96 
97 # If the first argument is an (non-sequence) object, apply the named
98 # method with the given arguments.  If the first argument is a
99 # sequence, apply the method to each element of the sequence (a la
100 # 'map').
def applyOrMap(objOrSeq, meth, *args, **kwargs):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a7334481c369897a3fdc6df753972f5f8}{
\index{m5::util@{m5::util}!applyOrMap@{applyOrMap}}
\index{applyOrMap@{applyOrMap}!m5::util@{m5::util}}
\subsubsection[{applyOrMap}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::applyOrMap ( {\em objOrSeq}, \/   {\em meth}, \/   {\em args}, \/   {\em kwargs})}}
\label{namespacem5_1_1util_a7334481c369897a3fdc6df753972f5f8}



\begin{DoxyCode}
101                                                :
102     if not isinstance(objOrSeq, (list, tuple)):
103         return applyMethod(objOrSeq, meth, *args, **kwargs)
104     else:
105         return [applyMethod(o, meth, *args, **kwargs) for o in objOrSeq]
106 
def compareVersions(v1, v2):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a5b6cc0ea95b0e707231a420d9bd57f07}{
\index{m5::util@{m5::util}!compareVersions@{compareVersions}}
\index{compareVersions@{compareVersions}!m5::util@{m5::util}}
\subsubsection[{compareVersions}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::compareVersions ( {\em v1}, \/   {\em v2})}}
\label{namespacem5_1_1util_a5b6cc0ea95b0e707231a420d9bd57f07}
\begin{DoxyVerb}helper function: compare arrays or strings of version numbers.
E.g., compare_version((1,3,25), (1,4,1)')
returns -1, 0, 1 if v1 is <, ==, > v2
\end{DoxyVerb}
 


\begin{DoxyCode}
107                            :
108     """helper function: compare arrays or strings of version numbers.
109     E.g., compare_version((1,3,25), (1,4,1)')
110     returns -1, 0, 1 if v1 is <, ==, > v2
111     """
112     def make_version_list(v):
113         if isinstance(v, (list,tuple)):
114             return v
115         elif isinstance(v, str):
116             return map(lambda x: int(re.match('\d+', x).group()), v.split('.'))
117         else:
118             raise TypeError
119 
120     v1 = make_version_list(v1)
121     v2 = make_version_list(v2)
122     # Compare corresponding elements of lists
123     for n1,n2 in zip(v1, v2):
124         if n1 < n2: return -1
125         if n1 > n2: return  1
126     # all corresponding values are equal... see if one has extra values
127     if len(v1) < len(v2): return -1
128     if len(v1) > len(v2): return  1
129     return 0
130 
def crossproduct(items):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a15681e303c0d9c6c1bc489f4197e4814}{
\index{m5::util@{m5::util}!crossproduct@{crossproduct}}
\index{crossproduct@{crossproduct}!m5::util@{m5::util}}
\subsubsection[{crossproduct}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::crossproduct ( {\em items})}}
\label{namespacem5_1_1util_a15681e303c0d9c6c1bc489f4197e4814}



\begin{DoxyCode}
131                        :
132     if len(items) == 1:
133         for i in items[0]:
134             yield (i,)
135     else:
136         for i in items[0]:
137             for j in crossproduct(items[1:]):
138                 yield (i,) + j
139 
def flatten(items):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_ae1c80955a028fc0aec505dbd4fa9e09c}{
\index{m5::util@{m5::util}!fatal@{fatal}}
\index{fatal@{fatal}!m5::util@{m5::util}}
\subsubsection[{fatal}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::fatal ( {\em fmt}, \/   {\em args})}}
\label{namespacem5_1_1util_ae1c80955a028fc0aec505dbd4fa9e09c}



\begin{DoxyCode}
55                      :
56     print >>sys.stderr, 'fatal:', fmt % args
57     sys.exit(1)
58 
59 # warn() should be called when the user should be warned about some condition
60 # that may or may not be the user's fault, but that they should be made aware
61 # of as it may affect the simulation or results.
def warn(fmt, *args):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a3a48f3283686eb13056318134122a74a}{
\index{m5::util@{m5::util}!flatten@{flatten}}
\index{flatten@{flatten}!m5::util@{m5::util}}
\subsubsection[{flatten}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::flatten ( {\em items})}}
\label{namespacem5_1_1util_a3a48f3283686eb13056318134122a74a}



\begin{DoxyCode}
140                   :
141     while items:
142         item = items.pop(0)
143         if isinstance(item, (list, tuple)):
144             items[0:0] = item
145         else:
146             yield item
147 
148 # force scalars to one-element lists for uniformity
def makeList(objOrList):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a93d91fcd263b81cfcf7cdbf726f106d6}{
\index{m5::util@{m5::util}!inform@{inform}}
\index{inform@{inform}!m5::util@{m5::util}}
\subsubsection[{inform}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::inform ( {\em fmt}, \/   {\em args})}}
\label{namespacem5_1_1util_a93d91fcd263b81cfcf7cdbf726f106d6}



\begin{DoxyCode}
67                       :
68     print >>sys.stdout, 'info:', fmt % args
69 
class Singleton(type):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a25ec95943ee170ca910bafa9376613ff}{
\index{m5::util@{m5::util}!makeDir@{makeDir}}
\index{makeDir@{makeDir}!m5::util@{m5::util}}
\subsubsection[{makeDir}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::makeDir ( {\em path})}}
\label{namespacem5_1_1util_a25ec95943ee170ca910bafa9376613ff}
\begin{DoxyVerb}Make a directory if it doesn't exist.  If the path does exist,
ensure that it is a directory\end{DoxyVerb}
 


\begin{DoxyCode}
191                  :
192     """Make a directory if it doesn't exist.  If the path does exist,
193     ensure that it is a directory"""
194     if os.path.exists(path):
195         if not os.path.isdir(path):
196             raise AttributeError, "%s exists but is not directory" % path
197     else:
198         os.mkdir(path)
        os.mkdir(path)
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a21a8ae7bb1334e05e9b870de5f0675f8}{
\index{m5::util@{m5::util}!makeList@{makeList}}
\index{makeList@{makeList}!m5::util@{m5::util}}
\subsubsection[{makeList}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::makeList ( {\em objOrList})}}
\label{namespacem5_1_1util_a21a8ae7bb1334e05e9b870de5f0675f8}



\begin{DoxyCode}
149                        :
150     if isinstance(objOrList, list):
151         return objOrList
152     return [objOrList]
153 
def printList(items, indent=4):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_aa2cb9615f3da634982552408620a1b99}{
\index{m5::util@{m5::util}!panic@{panic}}
\index{panic@{panic}!m5::util@{m5::util}}
\subsubsection[{panic}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::panic ( {\em fmt}, \/   {\em args})}}
\label{namespacem5_1_1util_aa2cb9615f3da634982552408620a1b99}



\begin{DoxyCode}
48                      :
49     print >>sys.stderr, 'panic:', fmt % args
50     sys.exit(1)
51 
52 # fatal() should be called when the simulation cannot continue due to
53 # some condition that is the user's fault (bad configuration, invalid
54 # arguments, etc.) and not a simulator bug.
def fatal(fmt, *args):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a375ec1766215b51a41c8f07219728164}{
\index{m5::util@{m5::util}!printList@{printList}}
\index{printList@{printList}!m5::util@{m5::util}}
\subsubsection[{printList}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::printList ( {\em items}, \/   {\em indent} = {\ttfamily 4})}}
\label{namespacem5_1_1util_a375ec1766215b51a41c8f07219728164}



\begin{DoxyCode}
154                               :
155     line = ' ' * indent
156     for i,item in enumerate(items):
157         if len(line) + len(item) > 76:
158             print line
159             line = ' ' * indent
160 
161         if i < len(items) - 1:
162             line += '%s, ' % item
163         else:
164             line += item
165             print line
166 
def readCommand(cmd, **kwargs):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_a9c9d966763727d2b9e9311eae3d8f112}{
\index{m5::util@{m5::util}!readCommand@{readCommand}}
\index{readCommand@{readCommand}!m5::util@{m5::util}}
\subsubsection[{readCommand}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::readCommand ( {\em cmd}, \/   {\em kwargs})}}
\label{namespacem5_1_1util_a9c9d966763727d2b9e9311eae3d8f112}
\begin{DoxyVerb}run the command cmd, read the results and return them
this is sorta like `cmd` in shell\end{DoxyVerb}
 


\begin{DoxyCode}
167                               :
168     """run the command cmd, read the results and return them
169     this is sorta like `cmd` in shell"""
170     from subprocess import Popen, PIPE, STDOUT
171 
172     if isinstance(cmd, str):
173         cmd = cmd.split()
174 
175     no_exception = 'exception' in kwargs
176     exception = kwargs.pop('exception', None)
177     
178     kwargs.setdefault('shell', False)
179     kwargs.setdefault('stdout', PIPE)
180     kwargs.setdefault('stderr', STDOUT)
181     kwargs.setdefault('close_fds', True)
182     try:
183         subp = Popen(cmd, **kwargs)
184     except Exception, e:
185         if no_exception:
186             return exception
187         raise
188 
189     return subp.communicate()[0]
190 
def makeDir(path):
\end{DoxyCode}
\hypertarget{namespacem5_1_1util_af8ddd678b5f4fc6b3d4d6e06291b4bb4}{
\index{m5::util@{m5::util}!warn@{warn}}
\index{warn@{warn}!m5::util@{m5::util}}
\subsubsection[{warn}]{\setlength{\rightskip}{0pt plus 5cm}def m5::util::warn ( {\em fmt}, \/   {\em args})}}
\label{namespacem5_1_1util_af8ddd678b5f4fc6b3d4d6e06291b4bb4}



\begin{DoxyCode}
62                     :
63     print >>sys.stderr, 'warn:', fmt % args
64 
65 # inform() should be called when the user should be informed about some
66 # condition that they may be interested in.
def inform(fmt, *args):
\end{DoxyCode}
