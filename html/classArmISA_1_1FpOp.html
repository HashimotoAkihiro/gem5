<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス FpOp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="namespaceArmISA.html">ArmISA</a>::<a class="el" href="classArmISA_1_1FpOp.html">FpOp</a>
  </div>
</div>
<div class="contents">
<h1>クラス FpOp</h1><!-- doxytag: class="ArmISA::FpOp" --><!-- doxytag: inherits="ArmISA::PredOp" -->
<p><code>#include &lt;<a class="el" href="vfp_8hh_source.html">vfp.hh</a>&gt;</code></p>
<div class="dynheader">
FpOpに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classArmISA_1_1FpOp.gif" usemap="#FpOp_map" alt=""/>
  <map id="FpOp_map" name="FpOp_map">
<area href="classArmISA_1_1PredOp.html" alt="PredOp" shape="rect" coords="0,168,132,192"/>
<area href="classArmISA_1_1ArmStaticInst.html" alt="ArmStaticInst" shape="rect" coords="0,112,132,136"/>
<area href="classStaticInst.html" alt="StaticInst" shape="rect" coords="0,56,132,80"/>
<area href="classRefCounted.html" alt="RefCounted" shape="rect" coords="0,0,132,24"/>
<area href="classArmISA_1_1FpCondCompRegOp.html" alt="FpCondCompRegOp" shape="rect" coords="142,280,274,304"/>
<area href="classArmISA_1_1FpCondSelOp.html" alt="FpCondSelOp" shape="rect" coords="142,336,274,360"/>
<area href="classArmISA_1_1FpRegImmOp.html" alt="FpRegImmOp" shape="rect" coords="142,392,274,416"/>
<area href="classArmISA_1_1FpRegRegImmOp.html" alt="FpRegRegImmOp" shape="rect" coords="142,448,274,472"/>
<area href="classArmISA_1_1FpRegRegOp.html" alt="FpRegRegOp" shape="rect" coords="142,504,274,528"/>
<area href="classArmISA_1_1FpRegRegRegImmOp.html" alt="FpRegRegRegImmOp" shape="rect" coords="142,560,274,584"/>
<area href="classArmISA_1_1FpRegRegRegOp.html" alt="FpRegRegRegOp" shape="rect" coords="142,616,274,640"/>
<area href="classArmISA_1_1FpRegRegRegRegOp.html" alt="FpRegRegRegRegOp" shape="rect" coords="142,672,274,696"/>
</map>
 </div>
</div>

<p><a href="classArmISA_1_1FpOp-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Protected メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#ad806871f6f7f01a9f4f4f4326f6d3f70">FpOp</a> (const char *mnem, <a class="el" href="classStaticInst.html#a5605d4fc727eae9e595325c90c0ec108">ExtMachInst</a> _machInst, OpClass __opClass)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#ae6e7fab9137bf946035338c924967bde">doOp</a> (float op1, float op2) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#aec4d44856f9781717b36125acfcc45d3">doOp</a> (float op1) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a42bfa4e0c737bc1df68d12362d927535">doOp</a> (double op1, double op2) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#ad1ec33e89716d3410e023846aaab378e">doOp</a> (double op1) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a8b883fad84db432c4e6291c8db223e5e">dbl</a> (<a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> low, <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> high) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#af317a029a04e1eb855f20b3c76aa2d79">dblLow</a> (double val) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a0a20a848b3881593f6250834f4c4e53d">dblHi</a> (double val) const </td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class fpType &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">fpType&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a0bb9efaddc2b7ac41cd08d497657e092">processNans</a> (FPSCR &amp;fpscr, bool &amp;done, bool defaultNan, fpType op1, fpType op2) const </td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class fpType &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">fpType&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a90767d472cab7e40d318351bf1aa8c12">ternaryOp</a> (FPSCR &amp;fpscr, fpType op1, fpType op2, fpType op3, fpType(*func)(fpType, fpType, fpType), bool flush, bool defaultNan, <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a>) const </td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class fpType &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">fpType&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#acd464f48fab5cc85b99d2f45897149ba">binaryOp</a> (FPSCR &amp;fpscr, fpType op1, fpType op2, fpType(*func)(fpType, fpType), bool flush, bool defaultNan, <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a>) const </td></tr>
<tr><td class="memTemplParams" colspan="2">template&lt;class fpType &gt; </td></tr>
<tr><td class="memTemplItemLeft" align="right" valign="top">fpType&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a0129111f707a89446f721aafe6b11748">unaryOp</a> (FPSCR &amp;fpscr, fpType op1, fpType(*func)(fpType), bool flush, <a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> <a class="el" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a>) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#af04cd01429462d48e635f3e01ced6257">advancePC</a> (PCState &amp;pcState) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">float&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#a9a613f482c9fae6ba0296c19fe21a40d">fpSqrt</a> (FPSCR fpscr, float x) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classArmISA_1_1FpOp.html#add67ed9b4396f7bde492ceaaf6af403d">fpSqrt</a> (FPSCR fpscr, double x) const </td></tr>
</table>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="ad806871f6f7f01a9f4f4f4326f6d3f70"></a><!-- doxytag: member="ArmISA::FpOp::FpOp" ref="ad806871f6f7f01a9f4f4f4326f6d3f70" args="(const char *mnem, ExtMachInst _machInst, OpClass __opClass)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classArmISA_1_1FpOp.html">FpOp</a> </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mnem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classStaticInst.html#a5605d4fc727eae9e595325c90c0ec108">ExtMachInst</a>&nbsp;</td>
          <td class="paramname"> <em>_machInst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">OpClass&nbsp;</td>
          <td class="paramname"> <em>__opClass</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00780"></a>00780                                                                      :
<a name="l00781"></a>00781         <a class="code" href="classArmISA_1_1PredOp.html#a6b53ece381567170e964e803a710a329" title="Constructor.">PredOp</a>(mnem, _machInst, __opClass)
<a name="l00782"></a>00782     {}

</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="af04cd01429462d48e635f3e01ced6257"></a><!-- doxytag: member="ArmISA::FpOp::advancePC" ref="af04cd01429462d48e635f3e01ced6257" args="(PCState &amp;pcState) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void advancePC </td>
          <td>(</td>
          <td class="paramtype">PCState &amp;&nbsp;</td>
          <td class="paramname"> <em>pcState</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classArmISA_1_1ArmStaticInst.html#af04cd01429462d48e635f3e01ced6257">ArmStaticInst</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00852"></a>00852     {
<a name="l00853"></a>00853         <span class="keywordflow">if</span> (<a class="code" href="classStaticInst.html#a0bf9c8a3dba6ab3f4a4b1bee48ebd0be" title="Flag values for this instruction.">flags</a>[IsLastMicroop]) {
<a name="l00854"></a>00854             pcState.uEnd();
<a name="l00855"></a>00855         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classStaticInst.html#a0bf9c8a3dba6ab3f4a4b1bee48ebd0be" title="Flag values for this instruction.">flags</a>[IsMicroop]) {
<a name="l00856"></a>00856             pcState.uAdvance();
<a name="l00857"></a>00857         } <span class="keywordflow">else</span> {
<a name="l00858"></a>00858             pcState.advance();
<a name="l00859"></a>00859         }
<a name="l00860"></a>00860     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="acd464f48fab5cc85b99d2f45897149ba"></a><!-- doxytag: member="ArmISA::FpOp::binaryOp" ref="acd464f48fab5cc85b99d2f45897149ba" args="(FPSCR &amp;fpscr, fpType op1, fpType op2, fpType(*func)(fpType, fpType), bool flush, bool defaultNan, uint32_t rMode) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fpType binaryOp </td>
          <td>(</td>
          <td class="paramtype">FPSCR &amp;&nbsp;</td>
          <td class="paramname"> <em>fpscr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType(*)(fpType, fpType)&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>flush</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>defaultNan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>rMode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01006"></a>01006 {
<a name="l01007"></a>01007     <span class="keyword">const</span> <span class="keywordtype">bool</span> single = (<span class="keyword">sizeof</span>(fpType) == <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l01008"></a>01008     fpType junk = 0.0;
<a name="l01009"></a>01009 
<a name="l01010"></a>01010     <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(op1, op2))
<a name="l01011"></a>01011         fpscr.idc = 1;
<a name="l01012"></a>01012     <a class="code" href="namespaceArmISA.html#aa704d806344cb853548d32c6a48b07e1">VfpSavedState</a> state = <a class="code" href="namespaceArmISA.html#a428af4a4a3cbeefeeae99b8fa3a20632">prepFpState</a>(<a class="code" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a>);
<a name="l01013"></a>01013     __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (op1), <span class="stringliteral">&quot;=m&quot;</span> (op2), <span class="stringliteral">&quot;=m&quot;</span> (state)
<a name="l01014"></a>01014                              : <span class="stringliteral">&quot;m&quot;</span> (op1), <span class="stringliteral">&quot;m&quot;</span> (op2), <span class="stringliteral">&quot;m&quot;</span> (state));
<a name="l01015"></a>01015     fpType dest = func(op1, op2);
<a name="l01016"></a>01016     __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (dest) : <span class="stringliteral">&quot;m&quot;</span> (dest));
<a name="l01017"></a>01017 
<a name="l01018"></a>01018     <span class="comment">// Get NAN behavior right. This varies between x86 and ARM.</span>
<a name="l01019"></a>01019     <span class="keywordflow">if</span> (std::isnan(dest)) {
<a name="l01020"></a>01020         <span class="keyword">const</span> uint64_t qnan =
<a name="l01021"></a>01021             single ? 0x7fc00000 : <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x7ff8000000000000);
<a name="l01022"></a>01022         <span class="keyword">const</span> <span class="keywordtype">bool</span> nan1 = std::isnan(op1);
<a name="l01023"></a>01023         <span class="keyword">const</span> <span class="keywordtype">bool</span> nan2 = std::isnan(op2);
<a name="l01024"></a>01024         <span class="keyword">const</span> <span class="keywordtype">bool</span> signal1 = nan1 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) &amp; qnan) != qnan);
<a name="l01025"></a>01025         <span class="keyword">const</span> <span class="keywordtype">bool</span> signal2 = nan2 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op2) &amp; qnan) != qnan);
<a name="l01026"></a>01026         <span class="keywordflow">if</span> ((!nan1 &amp;&amp; !nan2) || (defaultNan == 1)) {
<a name="l01027"></a>01027             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(qnan, junk);
<a name="l01028"></a>01028         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal1) {
<a name="l01029"></a>01029             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) | qnan, junk);
<a name="l01030"></a>01030         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal2) {
<a name="l01031"></a>01031             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op2) | qnan, junk);
<a name="l01032"></a>01032         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan1) {
<a name="l01033"></a>01033             dest = op1;
<a name="l01034"></a>01034         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan2) {
<a name="l01035"></a>01035             dest = op2;
<a name="l01036"></a>01036         }
<a name="l01037"></a>01037     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(dest)) {
<a name="l01038"></a>01038         feraiseexcept(<a class="code" href="namespaceArmISA.html#aee44a920445a79afd90562eb0968f8c2a4c138af0ce2d87fd62d1876f3ea44a4e">FeUnderflow</a>);
<a name="l01039"></a>01039     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((
<a name="l01040"></a>01040                 (single &amp;&amp; (dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(0x00800000, junk) ||
<a name="l01041"></a>01041                      dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(0x80800000, junk))) ||
<a name="l01042"></a>01042                 (!single &amp;&amp;
<a name="l01043"></a>01043                     (dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x0010000000000000), junk) ||
<a name="l01044"></a>01044                      dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x8010000000000000), junk)))
<a name="l01045"></a>01045                ) &amp;&amp; <a class="code" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a> != <a class="code" href="namespaceArmISA.html#a18dfa032073e1045ee46441e7c1d1dc3a8fab8bb29c064f88d12505f4e7d5b767">VfpRoundZero</a>) {
<a name="l01046"></a>01046         <span class="comment">/*</span>
<a name="l01047"></a>01047 <span class="comment">         * Correct for the fact that underflow is detected -before- rounding</span>
<a name="l01048"></a>01048 <span class="comment">         * in ARM and -after- rounding in x86.</span>
<a name="l01049"></a>01049 <span class="comment">         */</span>
<a name="l01050"></a>01050         fesetround(<a class="code" href="namespaceArmISA.html#a18702087a5c907c59544f0303248f398a1df23a17fd44329918e5d8643314efbb">FeRoundZero</a>);
<a name="l01051"></a>01051         __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (op1), <span class="stringliteral">&quot;=m&quot;</span> (op2)
<a name="l01052"></a>01052                                  : <span class="stringliteral">&quot;m&quot;</span> (op1), <span class="stringliteral">&quot;m&quot;</span> (op2));
<a name="l01053"></a>01053         fpType temp = func(op1, op2);
<a name="l01054"></a>01054         __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (temp) : <span class="stringliteral">&quot;m&quot;</span> (temp));
<a name="l01055"></a>01055         <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(temp)) {
<a name="l01056"></a>01056             dest = temp;
<a name="l01057"></a>01057         }
<a name="l01058"></a>01058     }
<a name="l01059"></a>01059     <a class="code" href="namespaceArmISA.html#abffe14667f17b8a2608a78d40163800c">finishVfp</a>(fpscr, state, flush);
<a name="l01060"></a>01060     <span class="keywordflow">return</span> dest;
<a name="l01061"></a>01061 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8b883fad84db432c4e6291c8db223e5e"></a><!-- doxytag: member="ArmISA::FpOp::dbl" ref="a8b883fad84db432c4e6291c8db223e5e" args="(uint32_t low, uint32_t high) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dbl </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>low</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>high</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00810"></a>00810     {
<a name="l00811"></a>00811         <span class="keywordtype">double</span> junk = 0.0;
<a name="l00812"></a>00812         <span class="keywordflow">return</span> <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>((uint64_t)low | ((uint64_t)high &lt;&lt; 32), junk);
<a name="l00813"></a>00813     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0a20a848b3881593f6250834f4c4e53d"></a><!-- doxytag: member="ArmISA::FpOp::dblHi" ref="a0a20a848b3881593f6250834f4c4e53d" args="(double val) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> dblHi </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00823"></a>00823     {
<a name="l00824"></a>00824         <span class="keywordflow">return</span> <a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(<a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>) &gt;&gt; 32;
<a name="l00825"></a>00825     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af317a029a04e1eb855f20b3c76aa2d79"></a><!-- doxytag: member="ArmISA::FpOp::dblLow" ref="af317a029a04e1eb855f20b3c76aa2d79" args="(double val) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a> dblLow </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>val</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00817"></a>00817     {
<a name="l00818"></a>00818         <span class="keywordflow">return</span> <a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(<a class="code" href="namespaceX86ISA.html#ae13bf1250853ff6b72aabe3c79b587cc">val</a>);
<a name="l00819"></a>00819     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad1ec33e89716d3410e023846aaab378e"></a><!-- doxytag: member="ArmISA::FpOp::doOp" ref="ad1ec33e89716d3410e023846aaab378e" args="(double op1) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double doOp </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>op1</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00804"></a>00804     {
<a name="l00805"></a>00805         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Unimplemented version of doOp called.\n&quot;</span>);
<a name="l00806"></a>00806     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a42bfa4e0c737bc1df68d12362d927535"></a><!-- doxytag: member="ArmISA::FpOp::doOp" ref="a42bfa4e0c737bc1df68d12362d927535" args="(double op1, double op2) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual double doOp </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>op1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>op2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00798"></a>00798     {
<a name="l00799"></a>00799         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Unimplemented version of doOp called.\n&quot;</span>);
<a name="l00800"></a>00800     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aec4d44856f9781717b36125acfcc45d3"></a><!-- doxytag: member="ArmISA::FpOp::doOp" ref="aec4d44856f9781717b36125acfcc45d3" args="(float op1) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual float doOp </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>op1</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00792"></a>00792     {
<a name="l00793"></a>00793         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Unimplemented version of doOp called.\n&quot;</span>);
<a name="l00794"></a>00794     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae6e7fab9137bf946035338c924967bde"></a><!-- doxytag: member="ArmISA::FpOp::doOp" ref="ae6e7fab9137bf946035338c924967bde" args="(float op1, float op2) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual float doOp </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>op1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>op2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00786"></a>00786     {
<a name="l00787"></a>00787         <a class="code" href="base_2misc_8hh.html#a1445e207e36c97ff84c54b47288cea19">panic</a>(<span class="stringliteral">&quot;Unimplemented version of doOp called.\n&quot;</span>);
<a name="l00788"></a>00788     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="add67ed9b4396f7bde492ceaaf6af403d"></a><!-- doxytag: member="ArmISA::FpOp::fpSqrt" ref="add67ed9b4396f7bde492ceaaf6af403d" args="(FPSCR fpscr, double x) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double fpSqrt </td>
          <td>(</td>
          <td class="paramtype">FPSCR&nbsp;</td>
          <td class="paramname"> <em>fpscr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>x</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00872"></a>00872     {
<a name="l00873"></a>00873 
<a name="l00874"></a>00874         <span class="keywordflow">return</span> <a class="code" href="classArmISA_1_1FpOp.html#a0129111f707a89446f721aafe6b11748">unaryOp</a>(fpscr,<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>,sqrt,fpscr.fz,fpscr.rMode);
<a name="l00875"></a>00875 
<a name="l00876"></a>00876     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9a613f482c9fae6ba0296c19fe21a40d"></a><!-- doxytag: member="ArmISA::FpOp::fpSqrt" ref="a9a613f482c9fae6ba0296c19fe21a40d" args="(FPSCR fpscr, float x) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">float fpSqrt </td>
          <td>(</td>
          <td class="paramtype">FPSCR&nbsp;</td>
          <td class="paramname"> <em>fpscr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>x</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00864"></a>00864     {
<a name="l00865"></a>00865 
<a name="l00866"></a>00866         <span class="keywordflow">return</span> <a class="code" href="classArmISA_1_1FpOp.html#a0129111f707a89446f721aafe6b11748">unaryOp</a>(fpscr,<a class="code" href="namespaceX86ISA.html#ab5f9a01fc40e47853ae9551b008afcbd">x</a>,sqrtf,fpscr.fz,fpscr.rMode);
<a name="l00867"></a>00867 
<a name="l00868"></a>00868     }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0bb9efaddc2b7ac41cd08d497657e092"></a><!-- doxytag: member="ArmISA::FpOp::processNans" ref="a0bb9efaddc2b7ac41cd08d497657e092" args="(FPSCR &amp;fpscr, bool &amp;done, bool defaultNan, fpType op1, fpType op2) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fpType processNans </td>
          <td>(</td>
          <td class="paramtype">FPSCR &amp;&nbsp;</td>
          <td class="paramname"> <em>fpscr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool &amp;&nbsp;</td>
          <td class="paramname"> <em>done</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>defaultNan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00883"></a>00883 {
<a name="l00884"></a>00884     done = <span class="keyword">true</span>;
<a name="l00885"></a>00885     fpType junk = 0.0;
<a name="l00886"></a>00886     fpType dest = 0.0;
<a name="l00887"></a>00887     <span class="keyword">const</span> <span class="keywordtype">bool</span> single = (<span class="keyword">sizeof</span>(fpType) == <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00888"></a>00888     <span class="keyword">const</span> uint64_t qnan =
<a name="l00889"></a>00889         single ? 0x7fc00000 : <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x7ff8000000000000);
<a name="l00890"></a>00890     <span class="keyword">const</span> <span class="keywordtype">bool</span> nan1 = std::isnan(op1);
<a name="l00891"></a>00891     <span class="keyword">const</span> <span class="keywordtype">bool</span> nan2 = std::isnan(op2);
<a name="l00892"></a>00892     <span class="keyword">const</span> <span class="keywordtype">bool</span> signal1 = nan1 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) &amp; qnan) != qnan);
<a name="l00893"></a>00893     <span class="keyword">const</span> <span class="keywordtype">bool</span> signal2 = nan2 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op2) &amp; qnan) != qnan);
<a name="l00894"></a>00894     <span class="keywordflow">if</span> (nan1 || nan2) {
<a name="l00895"></a>00895         <span class="keywordflow">if</span> (defaultNan) {
<a name="l00896"></a>00896             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(qnan, junk);
<a name="l00897"></a>00897         }  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal1) {
<a name="l00898"></a>00898             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) | qnan, junk);
<a name="l00899"></a>00899         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal2) {
<a name="l00900"></a>00900             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op2) | qnan, junk);
<a name="l00901"></a>00901         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan1) {
<a name="l00902"></a>00902             dest = op1;
<a name="l00903"></a>00903         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan2) {
<a name="l00904"></a>00904             dest = op2;
<a name="l00905"></a>00905         }
<a name="l00906"></a>00906         <span class="keywordflow">if</span> (signal1 || signal2) {
<a name="l00907"></a>00907             fpscr.ioc = 1;
<a name="l00908"></a>00908         }
<a name="l00909"></a>00909     } <span class="keywordflow">else</span> {
<a name="l00910"></a>00910         done = <span class="keyword">false</span>;
<a name="l00911"></a>00911     }
<a name="l00912"></a>00912     <span class="keywordflow">return</span> dest;
<a name="l00913"></a>00913 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a90767d472cab7e40d318351bf1aa8c12"></a><!-- doxytag: member="ArmISA::FpOp::ternaryOp" ref="a90767d472cab7e40d318351bf1aa8c12" args="(FPSCR &amp;fpscr, fpType op1, fpType op2, fpType op3, fpType(*func)(fpType, fpType, fpType), bool flush, bool defaultNan, uint32_t rMode) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fpType ternaryOp </td>
          <td>(</td>
          <td class="paramtype">FPSCR &amp;&nbsp;</td>
          <td class="paramname"> <em>fpscr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType(*)(fpType, fpType, fpType)&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>flush</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>defaultNan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>rMode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l00928"></a>00928 {
<a name="l00929"></a>00929     <span class="keyword">const</span> <span class="keywordtype">bool</span> single = (<span class="keyword">sizeof</span>(fpType) == <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l00930"></a>00930     fpType junk = 0.0;
<a name="l00931"></a>00931 
<a name="l00932"></a>00932     <span class="keywordflow">if</span> (flush &amp;&amp; (<a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(op1, op2) || <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(op3)))
<a name="l00933"></a>00933         fpscr.idc = 1;
<a name="l00934"></a>00934     <a class="code" href="namespaceArmISA.html#aa704d806344cb853548d32c6a48b07e1">VfpSavedState</a> state = <a class="code" href="namespaceArmISA.html#a428af4a4a3cbeefeeae99b8fa3a20632">prepFpState</a>(<a class="code" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a>);
<a name="l00935"></a>00935     __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (op1), <span class="stringliteral">&quot;=m&quot;</span> (op2), <span class="stringliteral">&quot;=m&quot;</span> (op3), <span class="stringliteral">&quot;=m&quot;</span> (state)
<a name="l00936"></a>00936                              :  <span class="stringliteral">&quot;m&quot;</span> (op1),  <span class="stringliteral">&quot;m&quot;</span> (op2),  <span class="stringliteral">&quot;m&quot;</span> (op3),  <span class="stringliteral">&quot;m&quot;</span> (state));
<a name="l00937"></a>00937     fpType dest = func(op1, op2, op3);
<a name="l00938"></a>00938     __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (dest) : <span class="stringliteral">&quot;m&quot;</span> (dest));
<a name="l00939"></a>00939 
<a name="l00940"></a>00940     <span class="keywordtype">int</span> fpClass = std::fpclassify(dest);
<a name="l00941"></a>00941     <span class="comment">// Get NAN behavior right. This varies between x86 and ARM.</span>
<a name="l00942"></a>00942     <span class="keywordflow">if</span> (fpClass == FP_NAN) {
<a name="l00943"></a>00943         <span class="keyword">const</span> uint64_t qnan =
<a name="l00944"></a>00944             single ? 0x7fc00000 : <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x7ff8000000000000);
<a name="l00945"></a>00945         <span class="keyword">const</span> <span class="keywordtype">bool</span> nan1 = std::isnan(op1);
<a name="l00946"></a>00946         <span class="keyword">const</span> <span class="keywordtype">bool</span> nan2 = std::isnan(op2);
<a name="l00947"></a>00947         <span class="keyword">const</span> <span class="keywordtype">bool</span> nan3 = std::isnan(op3);
<a name="l00948"></a>00948         <span class="keyword">const</span> <span class="keywordtype">bool</span> signal1 = nan1 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) &amp; qnan) != qnan);
<a name="l00949"></a>00949         <span class="keyword">const</span> <span class="keywordtype">bool</span> signal2 = nan2 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op2) &amp; qnan) != qnan);
<a name="l00950"></a>00950         <span class="keyword">const</span> <span class="keywordtype">bool</span> signal3 = nan3 &amp;&amp; ((<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op3) &amp; qnan) != qnan);
<a name="l00951"></a>00951         <span class="keywordflow">if</span> ((!nan1 &amp;&amp; !nan2 &amp;&amp; !nan3) || (defaultNan == 1)) {
<a name="l00952"></a>00952             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(qnan, junk);
<a name="l00953"></a>00953         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal1) {
<a name="l00954"></a>00954             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) | qnan, junk);
<a name="l00955"></a>00955         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal2) {
<a name="l00956"></a>00956             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op2) | qnan, junk);
<a name="l00957"></a>00957         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (signal3) {
<a name="l00958"></a>00958             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op3) | qnan, junk);
<a name="l00959"></a>00959         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan1) {
<a name="l00960"></a>00960             dest = op1;
<a name="l00961"></a>00961         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan2) {
<a name="l00962"></a>00962             dest = op2;
<a name="l00963"></a>00963         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan3) {
<a name="l00964"></a>00964             dest = op3;
<a name="l00965"></a>00965         }
<a name="l00966"></a>00966     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(dest)) {
<a name="l00967"></a>00967         feraiseexcept(<a class="code" href="namespaceArmISA.html#aee44a920445a79afd90562eb0968f8c2a4c138af0ce2d87fd62d1876f3ea44a4e">FeUnderflow</a>);
<a name="l00968"></a>00968     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((
<a name="l00969"></a>00969                 (single &amp;&amp; (dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(0x00800000, junk) ||
<a name="l00970"></a>00970                      dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(0x80800000, junk))) ||
<a name="l00971"></a>00971                 (!single &amp;&amp;
<a name="l00972"></a>00972                     (dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x0010000000000000), junk) ||
<a name="l00973"></a>00973                      dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x8010000000000000), junk)))
<a name="l00974"></a>00974                ) &amp;&amp; <a class="code" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a> != <a class="code" href="namespaceArmISA.html#a18dfa032073e1045ee46441e7c1d1dc3a8fab8bb29c064f88d12505f4e7d5b767">VfpRoundZero</a>) {
<a name="l00975"></a>00975         <span class="comment">/*</span>
<a name="l00976"></a>00976 <span class="comment">         * Correct for the fact that underflow is detected -before- rounding</span>
<a name="l00977"></a>00977 <span class="comment">         * in ARM and -after- rounding in x86.</span>
<a name="l00978"></a>00978 <span class="comment">         */</span>
<a name="l00979"></a>00979         fesetround(<a class="code" href="namespaceArmISA.html#a18702087a5c907c59544f0303248f398a1df23a17fd44329918e5d8643314efbb">FeRoundZero</a>);
<a name="l00980"></a>00980         __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (op1), <span class="stringliteral">&quot;=m&quot;</span> (op2), <span class="stringliteral">&quot;=m&quot;</span> (op3)
<a name="l00981"></a>00981                                  :  <span class="stringliteral">&quot;m&quot;</span> (op1),  <span class="stringliteral">&quot;m&quot;</span> (op2),  <span class="stringliteral">&quot;m&quot;</span> (op3));
<a name="l00982"></a>00982         fpType temp = func(op1, op2, op2);
<a name="l00983"></a>00983         __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (temp) : <span class="stringliteral">&quot;m&quot;</span> (temp));
<a name="l00984"></a>00984         <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(temp)) {
<a name="l00985"></a>00985             dest = temp;
<a name="l00986"></a>00986         }
<a name="l00987"></a>00987     }
<a name="l00988"></a>00988     <a class="code" href="namespaceArmISA.html#abffe14667f17b8a2608a78d40163800c">finishVfp</a>(fpscr, state, flush);
<a name="l00989"></a>00989     <span class="keywordflow">return</span> dest;
<a name="l00990"></a>00990 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a0129111f707a89446f721aafe6b11748"></a><!-- doxytag: member="ArmISA::FpOp::unaryOp" ref="a0129111f707a89446f721aafe6b11748" args="(FPSCR &amp;fpscr, fpType op1, fpType(*func)(fpType), bool flush, uint32_t rMode) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">fpType unaryOp </td>
          <td>(</td>
          <td class="paramtype">FPSCR &amp;&nbsp;</td>
          <td class="paramname"> <em>fpscr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType&nbsp;</td>
          <td class="paramname"> <em>op1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">fpType(*)(fpType)&nbsp;</td>
          <td class="paramname"> <em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>flush</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="Type_8hh.html#a435d1572bf3f880d55459d9805097f62">uint32_t</a>&nbsp;</td>
          <td class="paramname"> <em>rMode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><div class="fragment"><pre class="fragment"><a name="l01076"></a>01076 {
<a name="l01077"></a>01077     <span class="keyword">const</span> <span class="keywordtype">bool</span> single = (<span class="keyword">sizeof</span>(fpType) == <span class="keyword">sizeof</span>(<span class="keywordtype">float</span>));
<a name="l01078"></a>01078     fpType junk = 0.0;
<a name="l01079"></a>01079 
<a name="l01080"></a>01080     <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(op1))
<a name="l01081"></a>01081         fpscr.idc = 1;
<a name="l01082"></a>01082     <a class="code" href="namespaceArmISA.html#aa704d806344cb853548d32c6a48b07e1">VfpSavedState</a> state = <a class="code" href="namespaceArmISA.html#a428af4a4a3cbeefeeae99b8fa3a20632">prepFpState</a>(<a class="code" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a>);
<a name="l01083"></a>01083     __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (op1), <span class="stringliteral">&quot;=m&quot;</span> (state)
<a name="l01084"></a>01084                              : <span class="stringliteral">&quot;m&quot;</span> (op1), <span class="stringliteral">&quot;m&quot;</span> (state));
<a name="l01085"></a>01085     fpType dest = func(op1);
<a name="l01086"></a>01086     __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (dest) : <span class="stringliteral">&quot;m&quot;</span> (dest));
<a name="l01087"></a>01087 
<a name="l01088"></a>01088     <span class="comment">// Get NAN behavior right. This varies between x86 and ARM.</span>
<a name="l01089"></a>01089     <span class="keywordflow">if</span> (std::isnan(dest)) {
<a name="l01090"></a>01090         <span class="keyword">const</span> uint64_t qnan =
<a name="l01091"></a>01091             single ? 0x7fc00000 : <a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x7ff8000000000000);
<a name="l01092"></a>01092         <span class="keyword">const</span> <span class="keywordtype">bool</span> nan = std::isnan(op1);
<a name="l01093"></a>01093         <span class="keywordflow">if</span> (!nan || fpscr.dn == 1) {
<a name="l01094"></a>01094             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(qnan, junk);
<a name="l01095"></a>01095         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nan) {
<a name="l01096"></a>01096             dest = <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="namespaceArmISA.html#ad773e35e6eebe1fec525b1a67acfa787">fpToBits</a>(op1) | qnan, junk);
<a name="l01097"></a>01097         }
<a name="l01098"></a>01098     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(dest)) {
<a name="l01099"></a>01099         feraiseexcept(<a class="code" href="namespaceArmISA.html#aee44a920445a79afd90562eb0968f8c2a4c138af0ce2d87fd62d1876f3ea44a4e">FeUnderflow</a>);
<a name="l01100"></a>01100     } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((
<a name="l01101"></a>01101                 (single &amp;&amp; (dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(0x00800000, junk) ||
<a name="l01102"></a>01102                      dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(0x80800000, junk))) ||
<a name="l01103"></a>01103                 (!single &amp;&amp;
<a name="l01104"></a>01104                     (dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x0010000000000000), junk) ||
<a name="l01105"></a>01105                      dest == <a class="code" href="namespaceArmISA.html#a828474c1fbd138524af9b8d867e4d618">bitsToFp</a>(<a class="code" href="base_2types_8hh.html#adcc3cf526a71c0dfaae020d432c78b83">ULL</a>(0x8010000000000000), junk)))
<a name="l01106"></a>01106                ) &amp;&amp; <a class="code" href="namespaceArmISA.html#a6a8214ac21eb2991c2975c0380f64b82">rMode</a> != <a class="code" href="namespaceArmISA.html#a18dfa032073e1045ee46441e7c1d1dc3a8fab8bb29c064f88d12505f4e7d5b767">VfpRoundZero</a>) {
<a name="l01107"></a>01107         <span class="comment">/*</span>
<a name="l01108"></a>01108 <span class="comment">         * Correct for the fact that underflow is detected -before- rounding</span>
<a name="l01109"></a>01109 <span class="comment">         * in ARM and -after- rounding in x86.</span>
<a name="l01110"></a>01110 <span class="comment">         */</span>
<a name="l01111"></a>01111         fesetround(<a class="code" href="namespaceArmISA.html#a18702087a5c907c59544f0303248f398a1df23a17fd44329918e5d8643314efbb">FeRoundZero</a>);
<a name="l01112"></a>01112         __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (op1) : <span class="stringliteral">&quot;m&quot;</span> (op1));
<a name="l01113"></a>01113         fpType temp = func(op1);
<a name="l01114"></a>01114         __asm__ __volatile__ (<span class="stringliteral">&quot;&quot;</span> : <span class="stringliteral">&quot;=m&quot;</span> (temp) : <span class="stringliteral">&quot;m&quot;</span> (temp));
<a name="l01115"></a>01115         <span class="keywordflow">if</span> (flush &amp;&amp; <a class="code" href="namespaceArmISA.html#a6b67ea0518bf0aea3cb2797f9051d358">flushToZero</a>(temp)) {
<a name="l01116"></a>01116             dest = temp;
<a name="l01117"></a>01117         }
<a name="l01118"></a>01118     }
<a name="l01119"></a>01119     <a class="code" href="namespaceArmISA.html#abffe14667f17b8a2608a78d40163800c">finishVfp</a>(fpscr, state, flush);
<a name="l01120"></a>01120     <span class="keywordflow">return</span> dest;
<a name="l01121"></a>01121 }
</pre></div></p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>arch/arm/insts/<a class="el" href="vfp_8hh_source.html">vfp.hh</a></li>
<li>arch/arm/insts/<a class="el" href="vfp_8cc.html">vfp.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
