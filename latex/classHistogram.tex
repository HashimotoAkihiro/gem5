\hypertarget{classHistogram}{
\section{クラス Histogram}
\label{classHistogram}\index{Histogram@{Histogram}}
}


{\ttfamily \#include $<$Histogram.hh$>$}\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classHistogram_a0be7c28fa0c035b0409c970625b6ebe9}{Histogram} (int binsize=1, \hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} bins=50)
\item 
\hyperlink{classHistogram_a17481d27b81a3cc32c8a688e020ece88}{$\sim$Histogram} ()
\item 
void \hyperlink{classHistogram_a34a320889bb2239a3345be43348c95d1}{add} (\hyperlink{TypeDefines_8hh_aecfc3c54bd29ad5964e1c1c3ccbf89df}{int64} value)
\item 
void \hyperlink{classHistogram_a6972d61e24903eef8ec9dad439b69cdd}{add} (\hyperlink{classHistogram}{Histogram} \&hist)
\item 
void \hyperlink{classHistogram_a56d229242423dc417ab298e43fdef39f}{doubleBinSize} ()
\item 
void \hyperlink{classHistogram_ac8bb3912a3ce86b15842e79d0b421204}{clear} ()
\item 
void \hyperlink{classHistogram_ab376d229b7b9b610068bb5bb8150c3b2}{clear} (\hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} bins)
\item 
void \hyperlink{classHistogram_af93bb19bb9a576789fa3bd81bed3d26e}{clear} (int binsize, \hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} bins)
\item 
uint64\_\-t \hyperlink{classHistogram_a0b6868dbef44fc07f11d050eb59e5f7e}{size} () const 
\item 
\hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} \hyperlink{classHistogram_ae09c0cf5b67690adac0d882ffd3e40df}{getBins} () const 
\item 
int \hyperlink{classHistogram_a6bc601db303f3dfda909618c78ec02e7}{getBinSize} () const 
\item 
\hyperlink{TypeDefines_8hh_aecfc3c54bd29ad5964e1c1c3ccbf89df}{int64} \hyperlink{classHistogram_a6a790b6f2643bd10f3d74c41d9afefd6}{getTotal} () const 
\item 
uint64\_\-t \hyperlink{classHistogram_aeb3bc1d3b94443057568a6a04511cb4a}{getSquaredTotal} () const 
\item 
uint64\_\-t \hyperlink{classHistogram_abd462934da926cae3c5a17d71cd266d9}{getData} (int index) const 
\item 
\hyperlink{TypeDefines_8hh_aecfc3c54bd29ad5964e1c1c3ccbf89df}{int64} \hyperlink{classHistogram_a4704b6d6fba1fd2cca0790b79fa19279}{getMax} () const 
\item 
void \hyperlink{classHistogram_ae21abbf3b1ac14430fcb8e0cd64c9764}{printWithMultiplier} (std::ostream \&out, double multiplier) const 
\item 
void \hyperlink{classHistogram_a4f76274cefc18a95d39af1c3990880ef}{printPercent} (std::ostream \&out) const 
\item 
void \hyperlink{classHistogram_ac55fe386a101fbae38c716067c9966a0}{print} (std::ostream \&out) const 
\end{DoxyCompactItemize}
\subsection*{Private メソッド}
\begin{DoxyCompactItemize}
\item 
double \hyperlink{classHistogram_afe7c01ff325666636e278dc9a2a92ce1}{getStandardDeviation} () const 
\end{DoxyCompactItemize}
\subsection*{Private 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classstd_1_1vector}{std::vector}$<$ uint64\_\-t $>$ \hyperlink{classHistogram_a72cb4e620c90a68dcf5ff2e27232080d}{m\_\-data}
\item 
\hyperlink{TypeDefines_8hh_aecfc3c54bd29ad5964e1c1c3ccbf89df}{int64} \hyperlink{classHistogram_a9dbbdb7de023c9e3620bb2ce87952c35}{m\_\-max}
\item 
uint64\_\-t \hyperlink{classHistogram_a794f3b2a82f4b473977c033df87b3f49}{m\_\-count}
\item 
int \hyperlink{classHistogram_aaf8dca97f96bc3c08eeb39c6bfa922a1}{m\_\-binsize}
\item 
\hyperlink{Type_8hh_a435d1572bf3f880d55459d9805097f62}{uint32\_\-t} \hyperlink{classHistogram_a3ee3ad96f4970cc4f3b761c36f18d97b}{m\_\-largest\_\-bin}
\item 
\hyperlink{TypeDefines_8hh_aecfc3c54bd29ad5964e1c1c3ccbf89df}{int64} \hyperlink{classHistogram_a5afb7e042a0db65332d043743d6b5b75}{m\_\-sumSamples}
\item 
uint64\_\-t \hyperlink{classHistogram_a85d495b4b3972c42d6ababbb865c7260}{m\_\-sumSquaredSamples}
\end{DoxyCompactItemize}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classHistogram_a0be7c28fa0c035b0409c970625b6ebe9}{
\index{Histogram@{Histogram}!Histogram@{Histogram}}
\index{Histogram@{Histogram}!Histogram@{Histogram}}
\subsubsection[{Histogram}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Histogram} (int {\em binsize} = {\ttfamily 1}, \/  {\bf uint32\_\-t} {\em bins} = {\ttfamily 50})}}
\label{classHistogram_a0be7c28fa0c035b0409c970625b6ebe9}



\begin{DoxyCode}
38 {
39     m_binsize = binsize;
40     clear(bins);
41 }
\end{DoxyCode}
\hypertarget{classHistogram_a17481d27b81a3cc32c8a688e020ece88}{
\index{Histogram@{Histogram}!$\sim$Histogram@{$\sim$Histogram}}
\index{$\sim$Histogram@{$\sim$Histogram}!Histogram@{Histogram}}
\subsubsection[{$\sim$Histogram}]{\setlength{\rightskip}{0pt plus 5cm}$\sim${\bf Histogram} ()}}
\label{classHistogram_a17481d27b81a3cc32c8a688e020ece88}



\begin{DoxyCode}
44 {
45 }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classHistogram_a6972d61e24903eef8ec9dad439b69cdd}{
\index{Histogram@{Histogram}!add@{add}}
\index{add@{add}!Histogram@{Histogram}}
\subsubsection[{add}]{\setlength{\rightskip}{0pt plus 5cm}void add ({\bf Histogram} \& {\em hist})}}
\label{classHistogram_a6972d61e24903eef8ec9dad439b69cdd}



\begin{DoxyCode}
123 {
124     uint32_t t_bins = m_data.size();
125 
126     if (hist.getBins() != t_bins) {
127         if (m_count == 0) {
128             m_data.resize(hist.getBins());
129         } else {
130             fatal("Histograms with different number of bins "
131                   "cannot be combined!");
132         }
133     }
134 
135     m_max = max(m_max, hist.getMax());
136     m_count += hist.size();
137     m_sumSamples += hist.getTotal();
138     m_sumSquaredSamples += hist.getSquaredTotal();
139 
140     // Both histograms are log base 2.
141     if (hist.getBinSize() == -1 && m_binsize == -1) {
142         for (int j = 0; j < hist.getData(0); j++) {
143             add(0);
144         }
145 
146         for (uint32_t i = 1; i < t_bins; i++) {
147             for (int j = 0; j < hist.getData(i); j++) {
148                 add(1<<(i-1));  // account for the + 1 index
149             }
150         }
151     } else if (hist.getBinSize() >= 1 && m_binsize >= 1) {
152         // Both the histogram are linear.
153         // We are assuming that the two histograms have the same
154         // minimum value that they can store.
155 
156         while (m_binsize > hist.getBinSize()) hist.doubleBinSize();
157         while (hist.getBinSize() > m_binsize) doubleBinSize();
158 
159         assert(m_binsize == hist.getBinSize());
160 
161         for (uint32_t i = 0; i < t_bins; i++) {
162             m_data[i] += hist.getData(i);
163 
164             if (m_data[i] > 0) m_largest_bin = i;
165         }
166     } else {
167         fatal("Don't know how to combine log and linear histograms!");
168     }
169 }
\end{DoxyCode}
\hypertarget{classHistogram_a34a320889bb2239a3345be43348c95d1}{
\index{Histogram@{Histogram}!add@{add}}
\index{add@{add}!Histogram@{Histogram}}
\subsubsection[{add}]{\setlength{\rightskip}{0pt plus 5cm}void add ({\bf int64} {\em value})}}
\label{classHistogram_a34a320889bb2239a3345be43348c95d1}



\begin{DoxyCode}
88 {
89     assert(value >= 0);
90     m_max = max(m_max, value);
91     m_count++;
92 
93     m_sumSamples += value;
94     m_sumSquaredSamples += (value*value);
95 
96     uint32_t index;
97 
98     if (m_binsize == -1) {
99         // This is a log base 2 histogram
100         if (value == 0) {
101             index = 0;
102         } else {
103             index = floorLog2(value) + 1;
104             if (index >= m_data.size()) {
105                 index = m_data.size() - 1;
106             }
107         }
108     } else {
109         // This is a linear histogram
110         uint32_t t_bins = m_data.size();
111 
112         while (m_max >= (t_bins * m_binsize)) doubleBinSize();
113         index = value/m_binsize;
114     }
115 
116     assert(index < m_data.size());
117     m_data[index]++;
118     m_largest_bin = max(m_largest_bin, index);
119 }
\end{DoxyCode}
\hypertarget{classHistogram_af93bb19bb9a576789fa3bd81bed3d26e}{
\index{Histogram@{Histogram}!clear@{clear}}
\index{clear@{clear}!Histogram@{Histogram}}
\subsubsection[{clear}]{\setlength{\rightskip}{0pt plus 5cm}void clear (int {\em binsize}, \/  {\bf uint32\_\-t} {\em bins})}}
\label{classHistogram_af93bb19bb9a576789fa3bd81bed3d26e}



\begin{DoxyCode}
49 {
50     m_binsize = binsize;
51     clear(bins);
52 }
\end{DoxyCode}
\hypertarget{classHistogram_ab376d229b7b9b610068bb5bb8150c3b2}{
\index{Histogram@{Histogram}!clear@{clear}}
\index{clear@{clear}!Histogram@{Histogram}}
\subsubsection[{clear}]{\setlength{\rightskip}{0pt plus 5cm}void clear ({\bf uint32\_\-t} {\em bins})}}
\label{classHistogram_ab376d229b7b9b610068bb5bb8150c3b2}



\begin{DoxyCode}
56 {
57     m_largest_bin = 0;
58     m_max = 0;
59     m_data.resize(bins);
60     for (uint32_t i = 0; i < bins; i++) {
61         m_data[i] = 0;
62     }
63 
64     m_count = 0;
65     m_max = 0;
66     m_sumSamples = 0;
67     m_sumSquaredSamples = 0;
68 }
\end{DoxyCode}
\hypertarget{classHistogram_ac8bb3912a3ce86b15842e79d0b421204}{
\index{Histogram@{Histogram}!clear@{clear}}
\index{clear@{clear}!Histogram@{Histogram}}
\subsubsection[{clear}]{\setlength{\rightskip}{0pt plus 5cm}void clear ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_ac8bb3912a3ce86b15842e79d0b421204}



\begin{DoxyCode}
47 { clear(m_data.size()); }
\end{DoxyCode}
\hypertarget{classHistogram_a56d229242423dc417ab298e43fdef39f}{
\index{Histogram@{Histogram}!doubleBinSize@{doubleBinSize}}
\index{doubleBinSize@{doubleBinSize}!Histogram@{Histogram}}
\subsubsection[{doubleBinSize}]{\setlength{\rightskip}{0pt plus 5cm}void doubleBinSize ()}}
\label{classHistogram_a56d229242423dc417ab298e43fdef39f}



\begin{DoxyCode}
72 {
73     assert(m_binsize != -1);
74     uint32_t t_bins = m_data.size();
75 
76     for (uint32_t i = 0; i < t_bins/2; i++) {
77         m_data[i] = m_data[i*2] + m_data[i*2 + 1];
78     }
79     for (uint32_t i = t_bins/2; i < t_bins; i++) {
80         m_data[i] = 0;
81     }
82 
83     m_binsize *= 2;
84 }
\end{DoxyCode}
\hypertarget{classHistogram_ae09c0cf5b67690adac0d882ffd3e40df}{
\index{Histogram@{Histogram}!getBins@{getBins}}
\index{getBins@{getBins}!Histogram@{Histogram}}
\subsubsection[{getBins}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint32\_\-t} getBins () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_ae09c0cf5b67690adac0d882ffd3e40df}



\begin{DoxyCode}
52 { return m_data.size(); }
\end{DoxyCode}
\hypertarget{classHistogram_a6bc601db303f3dfda909618c78ec02e7}{
\index{Histogram@{Histogram}!getBinSize@{getBinSize}}
\index{getBinSize@{getBinSize}!Histogram@{Histogram}}
\subsubsection[{getBinSize}]{\setlength{\rightskip}{0pt plus 5cm}int getBinSize () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_a6bc601db303f3dfda909618c78ec02e7}



\begin{DoxyCode}
53 { return m_binsize; }
\end{DoxyCode}
\hypertarget{classHistogram_abd462934da926cae3c5a17d71cd266d9}{
\index{Histogram@{Histogram}!getData@{getData}}
\index{getData@{getData}!Histogram@{Histogram}}
\subsubsection[{getData}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t getData (int {\em index}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_abd462934da926cae3c5a17d71cd266d9}



\begin{DoxyCode}
56 { return m_data[index]; }
\end{DoxyCode}
\hypertarget{classHistogram_a4704b6d6fba1fd2cca0790b79fa19279}{
\index{Histogram@{Histogram}!getMax@{getMax}}
\index{getMax@{getMax}!Histogram@{Histogram}}
\subsubsection[{getMax}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int64} getMax () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_a4704b6d6fba1fd2cca0790b79fa19279}



\begin{DoxyCode}
57 { return m_max; }
\end{DoxyCode}
\hypertarget{classHistogram_aeb3bc1d3b94443057568a6a04511cb4a}{
\index{Histogram@{Histogram}!getSquaredTotal@{getSquaredTotal}}
\index{getSquaredTotal@{getSquaredTotal}!Histogram@{Histogram}}
\subsubsection[{getSquaredTotal}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t getSquaredTotal () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_aeb3bc1d3b94443057568a6a04511cb4a}



\begin{DoxyCode}
55 { return m_sumSquaredSamples; }
\end{DoxyCode}
\hypertarget{classHistogram_afe7c01ff325666636e278dc9a2a92ce1}{
\index{Histogram@{Histogram}!getStandardDeviation@{getStandardDeviation}}
\index{getStandardDeviation@{getStandardDeviation}!Histogram@{Histogram}}
\subsubsection[{getStandardDeviation}]{\setlength{\rightskip}{0pt plus 5cm}double getStandardDeviation () const\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_afe7c01ff325666636e278dc9a2a92ce1}



\begin{DoxyCode}
176 {
177     if (m_count <= 1)
178         return 0.0;
179 
180     double variance =
181         (double)(m_sumSquaredSamples - m_sumSamples * m_sumSamples / m_count)
182         / (m_count - 1);
183     return sqrt(variance);
184 }
\end{DoxyCode}
\hypertarget{classHistogram_a6a790b6f2643bd10f3d74c41d9afefd6}{
\index{Histogram@{Histogram}!getTotal@{getTotal}}
\index{getTotal@{getTotal}!Histogram@{Histogram}}
\subsubsection[{getTotal}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int64} getTotal () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_a6a790b6f2643bd10f3d74c41d9afefd6}



\begin{DoxyCode}
54 { return m_sumSamples; }
\end{DoxyCode}
\hypertarget{classHistogram_ac55fe386a101fbae38c716067c9966a0}{
\index{Histogram@{Histogram}!print@{print}}
\index{print@{print}!Histogram@{Histogram}}
\subsubsection[{print}]{\setlength{\rightskip}{0pt plus 5cm}void print (std::ostream \& {\em out}) const}}
\label{classHistogram_ac55fe386a101fbae38c716067c9966a0}
\hypertarget{classHistogram_a4f76274cefc18a95d39af1c3990880ef}{
\index{Histogram@{Histogram}!printPercent@{printPercent}}
\index{printPercent@{printPercent}!Histogram@{Histogram}}
\subsubsection[{printPercent}]{\setlength{\rightskip}{0pt plus 5cm}void printPercent (std::ostream \& {\em out}) const}}
\label{classHistogram_a4f76274cefc18a95d39af1c3990880ef}
\hypertarget{classHistogram_ae21abbf3b1ac14430fcb8e0cd64c9764}{
\index{Histogram@{Histogram}!printWithMultiplier@{printWithMultiplier}}
\index{printWithMultiplier@{printWithMultiplier}!Histogram@{Histogram}}
\subsubsection[{printWithMultiplier}]{\setlength{\rightskip}{0pt plus 5cm}void printWithMultiplier (std::ostream \& {\em out}, \/  double {\em multiplier}) const}}
\label{classHistogram_ae21abbf3b1ac14430fcb8e0cd64c9764}
\hypertarget{classHistogram_a0b6868dbef44fc07f11d050eb59e5f7e}{
\index{Histogram@{Histogram}!size@{size}}
\index{size@{size}!Histogram@{Histogram}}
\subsubsection[{size}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t size () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classHistogram_a0b6868dbef44fc07f11d050eb59e5f7e}



\begin{DoxyCode}
51 { return m_count; }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classHistogram_aaf8dca97f96bc3c08eeb39c6bfa922a1}{
\index{Histogram@{Histogram}!m\_\-binsize@{m\_\-binsize}}
\index{m\_\-binsize@{m\_\-binsize}!Histogram@{Histogram}}
\subsubsection[{m\_\-binsize}]{\setlength{\rightskip}{0pt plus 5cm}int {\bf m\_\-binsize}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_aaf8dca97f96bc3c08eeb39c6bfa922a1}
\hypertarget{classHistogram_a794f3b2a82f4b473977c033df87b3f49}{
\index{Histogram@{Histogram}!m\_\-count@{m\_\-count}}
\index{m\_\-count@{m\_\-count}!Histogram@{Histogram}}
\subsubsection[{m\_\-count}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t {\bf m\_\-count}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_a794f3b2a82f4b473977c033df87b3f49}
\hypertarget{classHistogram_a72cb4e620c90a68dcf5ff2e27232080d}{
\index{Histogram@{Histogram}!m\_\-data@{m\_\-data}}
\index{m\_\-data@{m\_\-data}!Histogram@{Histogram}}
\subsubsection[{m\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std::vector}$<$uint64\_\-t$>$ {\bf m\_\-data}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_a72cb4e620c90a68dcf5ff2e27232080d}
\hypertarget{classHistogram_a3ee3ad96f4970cc4f3b761c36f18d97b}{
\index{Histogram@{Histogram}!m\_\-largest\_\-bin@{m\_\-largest\_\-bin}}
\index{m\_\-largest\_\-bin@{m\_\-largest\_\-bin}!Histogram@{Histogram}}
\subsubsection[{m\_\-largest\_\-bin}]{\setlength{\rightskip}{0pt plus 5cm}{\bf uint32\_\-t} {\bf m\_\-largest\_\-bin}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_a3ee3ad96f4970cc4f3b761c36f18d97b}
\hypertarget{classHistogram_a9dbbdb7de023c9e3620bb2ce87952c35}{
\index{Histogram@{Histogram}!m\_\-max@{m\_\-max}}
\index{m\_\-max@{m\_\-max}!Histogram@{Histogram}}
\subsubsection[{m\_\-max}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int64} {\bf m\_\-max}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_a9dbbdb7de023c9e3620bb2ce87952c35}
\hypertarget{classHistogram_a5afb7e042a0db65332d043743d6b5b75}{
\index{Histogram@{Histogram}!m\_\-sumSamples@{m\_\-sumSamples}}
\index{m\_\-sumSamples@{m\_\-sumSamples}!Histogram@{Histogram}}
\subsubsection[{m\_\-sumSamples}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int64} {\bf m\_\-sumSamples}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_a5afb7e042a0db65332d043743d6b5b75}
\hypertarget{classHistogram_a85d495b4b3972c42d6ababbb865c7260}{
\index{Histogram@{Histogram}!m\_\-sumSquaredSamples@{m\_\-sumSquaredSamples}}
\index{m\_\-sumSquaredSamples@{m\_\-sumSquaredSamples}!Histogram@{Histogram}}
\subsubsection[{m\_\-sumSquaredSamples}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t {\bf m\_\-sumSquaredSamples}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classHistogram_a85d495b4b3972c42d6ababbb865c7260}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
mem/ruby/common/\hyperlink{Histogram_8hh}{Histogram.hh}\item 
mem/ruby/common/\hyperlink{Histogram_8cc}{Histogram.cc}\end{DoxyCompactItemize}
