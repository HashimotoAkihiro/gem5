\hypertarget{classSparcISA_1_1Interrupts}{
\section{クラス Interrupts}
\label{classSparcISA_1_1Interrupts}\index{SparcISA::Interrupts@{SparcISA::Interrupts}}
}


{\ttfamily \#include $<$interrupts.hh$>$}Interruptsに対する継承グラフ:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{classSparcISA_1_1Interrupts}
\end{center}
\end{figure}
\subsection*{Public 型}
\begin{DoxyCompactItemize}
\item 
typedef SparcInterruptsParams \hyperlink{classSparcISA_1_1Interrupts_a1480e28e439219daadcc82008890f5d7}{Params}
\end{DoxyCompactItemize}
\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{classSparcISA_1_1Interrupts_a2ab8c6aed9969bc58d6aa2427d442cc4}{setCPU} (\hyperlink{classBaseCPU}{BaseCPU} $\ast$\_\-cpu)
\item 
const \hyperlink{classSparcISA_1_1Interrupts_a1480e28e439219daadcc82008890f5d7}{Params} $\ast$ \hyperlink{classSparcISA_1_1Interrupts_acd3c3feb78ae7a8f88fe0f110a718dff}{params} () const 
\item 
\hyperlink{classSparcISA_1_1Interrupts_a3d148759405b99148e0c34750966edb1}{Interrupts} (\hyperlink{classSparcISA_1_1Interrupts_a1480e28e439219daadcc82008890f5d7}{Params} $\ast$p)
\item 
int \hyperlink{classSparcISA_1_1Interrupts_af15feb308e3a6ec0180955608ab53125}{InterruptLevel} (uint64\_\-t softint)
\item 
void \hyperlink{classSparcISA_1_1Interrupts_a24c6c4fbdc0605bcd015ce06f194e4b4}{post} (int int\_\-num, int index)
\item 
void \hyperlink{classSparcISA_1_1Interrupts_af60c3484087379d0330467d77f6cbaae}{clear} (int int\_\-num, int index)
\item 
void \hyperlink{classSparcISA_1_1Interrupts_a798729dca95209ecdc609807a653a2bf}{clearAll} ()
\item 
bool \hyperlink{classSparcISA_1_1Interrupts_af3c66fb49fec598cf78aaec29d764952}{checkInterrupts} (\hyperlink{classThreadContext}{ThreadContext} $\ast$tc) const 
\item 
\hyperlink{classRefCountingPtr}{Fault} \hyperlink{classSparcISA_1_1Interrupts_ae603c88d759977611d3bcc6e2deb61ae}{getInterrupt} (\hyperlink{classThreadContext}{ThreadContext} $\ast$tc)
\item 
void \hyperlink{classSparcISA_1_1Interrupts_a00892e9b06edcba6c3c27454d6235100}{updateIntrInfo} (\hyperlink{classThreadContext}{ThreadContext} $\ast$tc)
\item 
uint64\_\-t \hyperlink{classSparcISA_1_1Interrupts_a87abae3604f8bd69ae89e91881110a39}{get\_\-vec} (int int\_\-num)
\item 
void \hyperlink{classSparcISA_1_1Interrupts_a53e036786d17361be4c7320d39c99b84}{serialize} (std::ostream \&os)
\item 
void \hyperlink{classSparcISA_1_1Interrupts_af22e5d6d660b97db37003ac61ac4ee49}{unserialize} (\hyperlink{classCheckpoint}{Checkpoint} $\ast$cp, const std::string \&section)
\end{DoxyCompactItemize}
\subsection*{Private 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classBaseCPU}{BaseCPU} $\ast$ \hyperlink{classSparcISA_1_1Interrupts_a7a31ca9fefb2fe821f29a270678912db}{cpu}
\item 
uint64\_\-t \hyperlink{classSparcISA_1_1Interrupts_af921da626984c1144929206fb7c572e4}{interrupts} \mbox{[}NumInterruptTypes\mbox{]}
\item 
uint64\_\-t \hyperlink{classSparcISA_1_1Interrupts_a7bd80958fef7b80f720d1e764c63adb4}{intStatus}
\end{DoxyCompactItemize}


\subsection{型定義}
\hypertarget{classSparcISA_1_1Interrupts_a1480e28e439219daadcc82008890f5d7}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!Params@{Params}}
\index{Params@{Params}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{Params}]{\setlength{\rightskip}{0pt plus 5cm}typedef SparcInterruptsParams {\bf Params}}}
\label{classSparcISA_1_1Interrupts_a1480e28e439219daadcc82008890f5d7}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classSparcISA_1_1Interrupts_a3d148759405b99148e0c34750966edb1}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!Interrupts@{Interrupts}}
\index{Interrupts@{Interrupts}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{Interrupts}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Interrupts} ({\bf Params} $\ast$ {\em p})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a3d148759405b99148e0c34750966edb1}



\begin{DoxyCode}
70                            : SimObject(p), cpu(NULL)
71     {
72         clearAll();
73     }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classSparcISA_1_1Interrupts_af3c66fb49fec598cf78aaec29d764952}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!checkInterrupts@{checkInterrupts}}
\index{checkInterrupts@{checkInterrupts}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{checkInterrupts}]{\setlength{\rightskip}{0pt plus 5cm}bool checkInterrupts ({\bf ThreadContext} $\ast$ {\em tc}) const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_af3c66fb49fec598cf78aaec29d764952}



\begin{DoxyCode}
123     {
124         return intStatus;
125     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_af60c3484087379d0330467d77f6cbaae}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!clear@{clear}}
\index{clear@{clear}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{clear}]{\setlength{\rightskip}{0pt plus 5cm}void clear (int {\em int\_\-num}, \/  int {\em index})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_af60c3484087379d0330467d77f6cbaae}



\begin{DoxyCode}
102     {
103         DPRINTF(Interrupt, "Interrupt %d:%d cleared\n", int_num, index);
104         assert(int_num >= 0 && int_num < NumInterruptTypes);
105         assert(index >= 0 && index < 64);
106 
107         interrupts[int_num] &= ~(ULL(1) << index);
108         if (!interrupts[int_num])
109             intStatus &= ~(ULL(1) << int_num);
110     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_a798729dca95209ecdc609807a653a2bf}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!clearAll@{clearAll}}
\index{clearAll@{clearAll}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{clearAll}]{\setlength{\rightskip}{0pt plus 5cm}void clearAll ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a798729dca95209ecdc609807a653a2bf}



\begin{DoxyCode}
114     {
115         for (int i = 0; i < NumInterruptTypes; ++i) {
116             interrupts[i] = 0;
117         }
118         intStatus = 0;
119     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_a87abae3604f8bd69ae89e91881110a39}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!get\_\-vec@{get\_\-vec}}
\index{get\_\-vec@{get\_\-vec}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{get\_\-vec}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t get\_\-vec (int {\em int\_\-num})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a87abae3604f8bd69ae89e91881110a39}



\begin{DoxyCode}
188     {
189         assert(int_num >= 0 && int_num < NumInterruptTypes);
190         return interrupts[int_num];
191     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_ae603c88d759977611d3bcc6e2deb61ae}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!getInterrupt@{getInterrupt}}
\index{getInterrupt@{getInterrupt}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{getInterrupt}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Fault} getInterrupt ({\bf ThreadContext} $\ast$ {\em tc})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_ae603c88d759977611d3bcc6e2deb61ae}



\begin{DoxyCode}
129     {
130         HPSTATE hpstate = tc->readMiscRegNoEffect(MISCREG_HPSTATE);
131         PSTATE pstate = tc->readMiscRegNoEffect(MISCREG_PSTATE);
132 
133         // THESE ARE IN ORDER OF PRIORITY
134         // since there are early returns, and the highest
135         // priority interrupts should get serviced,
136         // it is v. important that new interrupts are inserted
137         // in the right order of processing
138         if (hpstate.hpriv) {
139             if (pstate.ie) {
140                 if (interrupts[IT_HINTP]) {
141                     // This will be cleaned by a HINTP write
142                     return new HstickMatch;
143                 }
144                 if (interrupts[IT_INT_VEC]) {
145                     // this will be cleared by an ASI read (or write)
146                     return new InterruptVector;
147                 }
148             }
149         } else {
150             if (interrupts[IT_TRAP_LEVEL_ZERO]) {
151                     // this is cleared by deasserting HPSTATE::tlz
152                     return new TrapLevelZero;
153             }
154             // HStick matches always happen in priv mode (ie doesn't matter)
155             if (interrupts[IT_HINTP]) {
156                 return new HstickMatch;
157             }
158             if (interrupts[IT_INT_VEC]) {
159                 // this will be cleared by an ASI read (or write)
160                 return new InterruptVector;
161             }
162             if (pstate.ie) {
163                 if (interrupts[IT_CPU_MONDO]) {
164                     return new CpuMondo;
165                 }
166                 if (interrupts[IT_DEV_MONDO]) {
167                     return new DevMondo;
168                 }
169                 if (interrupts[IT_SOFT_INT]) {
170                     int level = InterruptLevel(interrupts[IT_SOFT_INT]);
171                     return new InterruptLevelN(level);
172                 }
173 
174                 if (interrupts[IT_RES_ERROR]) {
175                     return new ResumableError;
176                 }
177             } // !hpriv && pstate.ie
178         }  // !hpriv
179         return NoFault;
180     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_af15feb308e3a6ec0180955608ab53125}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!InterruptLevel@{InterruptLevel}}
\index{InterruptLevel@{InterruptLevel}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{InterruptLevel}]{\setlength{\rightskip}{0pt plus 5cm}int InterruptLevel (uint64\_\-t {\em softint})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_af15feb308e3a6ec0180955608ab53125}



\begin{DoxyCode}
77     {
78         if (softint & 0x10000 || softint & 0x1)
79             return 14;
80 
81         int level = 15;
82         while (level > 0 && !(1 << level & softint))
83             level--;
84         if (1 << level & softint)
85             return level;
86         return 0;
87     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_acd3c3feb78ae7a8f88fe0f110a718dff}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!params@{params}}
\index{params@{params}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{params}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Params}$\ast$ params () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_acd3c3feb78ae7a8f88fe0f110a718dff}



\begin{DoxyCode}
66     {
67         return dynamic_cast<const Params *>(_params);
68     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_a24c6c4fbdc0605bcd015ce06f194e4b4}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!post@{post}}
\index{post@{post}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{post}]{\setlength{\rightskip}{0pt plus 5cm}void post (int {\em int\_\-num}, \/  int {\em index})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a24c6c4fbdc0605bcd015ce06f194e4b4}



\begin{DoxyCode}
91     {
92         DPRINTF(Interrupt, "Interrupt %d:%d posted\n", int_num, index);
93         assert(int_num >= 0 && int_num < NumInterruptTypes);
94         assert(index >= 0 && index < 64);
95 
96         interrupts[int_num] |= ULL(1) << index;
97         intStatus |= ULL(1) << int_num;
98     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_a53e036786d17361be4c7320d39c99b84}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!serialize@{serialize}}
\index{serialize@{serialize}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{serialize}]{\setlength{\rightskip}{0pt plus 5cm}void serialize (std::ostream \& {\em os})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a53e036786d17361be4c7320d39c99b84}



\begin{DoxyCode}
195     {
196         SERIALIZE_ARRAY(interrupts,NumInterruptTypes);
197         SERIALIZE_SCALAR(intStatus);
198     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_a2ab8c6aed9969bc58d6aa2427d442cc4}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!setCPU@{setCPU}}
\index{setCPU@{setCPU}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{setCPU}]{\setlength{\rightskip}{0pt plus 5cm}void setCPU ({\bf BaseCPU} $\ast$ {\em \_\-cpu})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a2ab8c6aed9969bc58d6aa2427d442cc4}



\begin{DoxyCode}
58     {
59         cpu = _cpu;
60     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_af22e5d6d660b97db37003ac61ac4ee49}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!unserialize@{unserialize}}
\index{unserialize@{unserialize}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{unserialize}]{\setlength{\rightskip}{0pt plus 5cm}void unserialize ({\bf Checkpoint} $\ast$ {\em cp}, \/  const std::string \& {\em section})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_af22e5d6d660b97db37003ac61ac4ee49}



\begin{DoxyCode}
202     {
203         UNSERIALIZE_ARRAY(interrupts,NumInterruptTypes);
204         UNSERIALIZE_SCALAR(intStatus);
205     }
\end{DoxyCode}
\hypertarget{classSparcISA_1_1Interrupts_a00892e9b06edcba6c3c27454d6235100}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!updateIntrInfo@{updateIntrInfo}}
\index{updateIntrInfo@{updateIntrInfo}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{updateIntrInfo}]{\setlength{\rightskip}{0pt plus 5cm}void updateIntrInfo ({\bf ThreadContext} $\ast$ {\em tc})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a00892e9b06edcba6c3c27454d6235100}



\begin{DoxyCode}
184     {}
\end{DoxyCode}


\subsection{変数}
\hypertarget{classSparcISA_1_1Interrupts_a7a31ca9fefb2fe821f29a270678912db}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!cpu@{cpu}}
\index{cpu@{cpu}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{cpu}]{\setlength{\rightskip}{0pt plus 5cm}{\bf BaseCPU}$\ast$ {\bf cpu}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a7a31ca9fefb2fe821f29a270678912db}
\hypertarget{classSparcISA_1_1Interrupts_af921da626984c1144929206fb7c572e4}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!interrupts@{interrupts}}
\index{interrupts@{interrupts}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{interrupts}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t {\bf interrupts}\mbox{[}NumInterruptTypes\mbox{]}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_af921da626984c1144929206fb7c572e4}
\hypertarget{classSparcISA_1_1Interrupts_a7bd80958fef7b80f720d1e764c63adb4}{
\index{SparcISA::Interrupts@{SparcISA::Interrupts}!intStatus@{intStatus}}
\index{intStatus@{intStatus}!SparcISA::Interrupts@{SparcISA::Interrupts}}
\subsubsection[{intStatus}]{\setlength{\rightskip}{0pt plus 5cm}uint64\_\-t {\bf intStatus}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classSparcISA_1_1Interrupts_a7bd80958fef7b80f720d1e764c63adb4}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
arch/sparc/\hyperlink{sparc_2interrupts_8hh}{interrupts.hh}\end{DoxyCompactItemize}
