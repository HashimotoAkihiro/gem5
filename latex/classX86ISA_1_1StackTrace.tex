\hypertarget{classX86ISA_1_1StackTrace}{
\section{クラス StackTrace}
\label{classX86ISA_1_1StackTrace}\index{X86ISA::StackTrace@{X86ISA::StackTrace}}
}


{\ttfamily \#include $<$stacktrace.hh$>$}\subsection*{Public メソッド}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classX86ISA_1_1StackTrace_a5a9b2e3bba2262e73b20f87325efd063}{StackTrace} ()
\item 
\hyperlink{classX86ISA_1_1StackTrace_a7c751415d8c87372fc7d24513309cf1b}{StackTrace} (\hyperlink{classThreadContext}{ThreadContext} $\ast$\hyperlink{classX86ISA_1_1StackTrace_a4455a4759e69e5ebe68ae7298cbcc37d}{tc}, \hyperlink{classRefCountingPtr}{StaticInstPtr} inst)
\item 
\hyperlink{classX86ISA_1_1StackTrace_adec953886bb73db4f2ec91ed12810135}{$\sim$StackTrace} ()
\item 
void \hyperlink{classX86ISA_1_1StackTrace_ac8bb3912a3ce86b15842e79d0b421204}{clear} ()
\item 
bool \hyperlink{classX86ISA_1_1StackTrace_a8d985300b138b6c5556ab17ed4df3b38}{valid} () const 
\item 
bool \hyperlink{classX86ISA_1_1StackTrace_aabb136846a5e22007e44db846652ddd5}{trace} (\hyperlink{classThreadContext}{ThreadContext} $\ast$\hyperlink{classX86ISA_1_1StackTrace_a4455a4759e69e5ebe68ae7298cbcc37d}{tc}, \hyperlink{classRefCountingPtr}{StaticInstPtr} inst)
\item 
const \hyperlink{classstd_1_1vector}{std::vector}$<$ \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} $>$ \& \hyperlink{classX86ISA_1_1StackTrace_aceb93ba31a3756aca859b4643efeeb46}{getstack} () const 
\item 
void \hyperlink{classX86ISA_1_1StackTrace_a70fdc8802b54b4244889a2d3553405d5}{dprintf} ()
\end{DoxyCompactItemize}
\subsection*{Static Public 変数}
\begin{DoxyCompactItemize}
\item 
static const int \hyperlink{classX86ISA_1_1StackTrace_a80f5e5d52e325fee3fb197c8a15ff3b9}{user} = 1
\item 
static const int \hyperlink{classX86ISA_1_1StackTrace_ace24bfe6928bff7f701824622aa9b36e}{console} = 2
\item 
static const int \hyperlink{classX86ISA_1_1StackTrace_a204dd651615bf73491349b6403571f10}{unknown} = 3
\end{DoxyCompactItemize}
\subsection*{Private メソッド}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{classX86ISA_1_1StackTrace_a8c9787d05f9c0e82dfcaf31cf0fd4b50}{isEntry} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} \hyperlink{namespaceX86ISA_ab705917f60c5566f9ce56a93f798b2e2}{addr})
\item 
bool \hyperlink{classX86ISA_1_1StackTrace_a875eea16b2891accc8cbec7eb6c36003}{decodePrologue} (\hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} sp, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} callpc, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} func, int \&size, \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} \&ra)
\item 
bool \hyperlink{classX86ISA_1_1StackTrace_ae56dad5982b67d8717714c383b6a59f8}{decodeSave} (\hyperlink{namespaceX86ISA_a7ceadb544bf9b4a10579b7466b0ac008}{MachInst} inst, int \&\hyperlink{namespaceX86ISA_aeeb02ad833ab76f3430553ef93213a6b}{reg}, int \&disp)
\item 
bool \hyperlink{classX86ISA_1_1StackTrace_a61ba7618f77dc6e62d7b0baf6273130c}{decodeStack} (\hyperlink{namespaceX86ISA_a7ceadb544bf9b4a10579b7466b0ac008}{MachInst} inst, int \&disp)
\item 
void \hyperlink{classX86ISA_1_1StackTrace_a46d6b95a2e5fdb75702cf45e39566645}{trace} (\hyperlink{classThreadContext}{ThreadContext} $\ast$\hyperlink{classX86ISA_1_1StackTrace_a4455a4759e69e5ebe68ae7298cbcc37d}{tc}, bool is\_\-call)
\end{DoxyCompactItemize}
\subsection*{Private 変数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classThreadContext}{ThreadContext} $\ast$ \hyperlink{classX86ISA_1_1StackTrace_a4455a4759e69e5ebe68ae7298cbcc37d}{tc}
\item 
\hyperlink{classstd_1_1vector}{std::vector}$<$ \hyperlink{base_2types_8hh_af1bb03d6a4ee096394a6749f0a169232}{Addr} $>$ \hyperlink{classX86ISA_1_1StackTrace_a8be39169db4f31c77f5188de23c602f1}{stack}
\end{DoxyCompactItemize}


\subsection{コンストラクタとデストラクタ}
\hypertarget{classX86ISA_1_1StackTrace_a5a9b2e3bba2262e73b20f87325efd063}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!StackTrace@{StackTrace}}
\index{StackTrace@{StackTrace}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{StackTrace}]{\setlength{\rightskip}{0pt plus 5cm}{\bf StackTrace} ()}}
\label{classX86ISA_1_1StackTrace_a5a9b2e3bba2262e73b20f87325efd063}



\begin{DoxyCode}
120         : tc(0), stack(64)
121     {
122     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a7c751415d8c87372fc7d24513309cf1b}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!StackTrace@{StackTrace}}
\index{StackTrace@{StackTrace}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{StackTrace}]{\setlength{\rightskip}{0pt plus 5cm}{\bf StackTrace} ({\bf ThreadContext} $\ast$ {\em tc}, \/  {\bf StaticInstPtr} {\em inst})}}
\label{classX86ISA_1_1StackTrace_a7c751415d8c87372fc7d24513309cf1b}



\begin{DoxyCode}
125         : tc(0), stack(64)
126     {
127         trace(_tc, inst);
128     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_adec953886bb73db4f2ec91ed12810135}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!$\sim$StackTrace@{$\sim$StackTrace}}
\index{$\sim$StackTrace@{$\sim$StackTrace}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{$\sim$StackTrace}]{\setlength{\rightskip}{0pt plus 5cm}$\sim${\bf StackTrace} ()}}
\label{classX86ISA_1_1StackTrace_adec953886bb73db4f2ec91ed12810135}



\begin{DoxyCode}
131     {
132     }
\end{DoxyCode}


\subsection{関数}
\hypertarget{classX86ISA_1_1StackTrace_ac8bb3912a3ce86b15842e79d0b421204}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!clear@{clear}}
\index{clear@{clear}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{clear}]{\setlength{\rightskip}{0pt plus 5cm}void clear ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_ac8bb3912a3ce86b15842e79d0b421204}



\begin{DoxyCode}
82         {
83             tc = 0;
84             stack.clear();
85         }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a875eea16b2891accc8cbec7eb6c36003}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!decodePrologue@{decodePrologue}}
\index{decodePrologue@{decodePrologue}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{decodePrologue}]{\setlength{\rightskip}{0pt plus 5cm}bool decodePrologue ({\bf Addr} {\em sp}, \/  {\bf Addr} {\em callpc}, \/  {\bf Addr} {\em func}, \/  int \& {\em size}, \/  {\bf Addr} \& {\em ra})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a875eea16b2891accc8cbec7eb6c36003}



\begin{DoxyCode}
167     {
168         size = 0;
169         ra = 0;
170 
171         for (Addr pc = func; pc < callpc; pc += sizeof(MachInst)) {
172             MachInst inst;
173             CopyOut(tc, (uint8_t *)&inst, pc, sizeof(MachInst));
174 
175             int reg, disp;
176             if (decodeStack(inst, disp)) {
177                 if (size) {
178                     // panic("decoding frame size again");
179                     return true;
180                 }
181                 size += disp;
182             } else if (decodeSave(inst, reg, disp)) {
183                 if (!ra && reg == ReturnAddressReg) {
184                     CopyOut(tc, (uint8_t *)&ra, sp + disp, sizeof(Addr));
185                     if (!ra) {
186                         // panic("no return address value pc=%#x\n", pc);
187                         return false;
188                     }
189                 }
190             }
191         }
192 
193         return true;
194     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_ae56dad5982b67d8717714c383b6a59f8}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!decodeSave@{decodeSave}}
\index{decodeSave@{decodeSave}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{decodeSave}]{\setlength{\rightskip}{0pt plus 5cm}bool decodeSave ({\bf MachInst} {\em inst}, \/  int \& {\em reg}, \/  int \& {\em disp})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_ae56dad5982b67d8717714c383b6a59f8}



\begin{DoxyCode}
154     {
155         reg = 0;
156         disp = 0;
157         return true;
158     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a61ba7618f77dc6e62d7b0baf6273130c}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!decodeStack@{decodeStack}}
\index{decodeStack@{decodeStack}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{decodeStack}]{\setlength{\rightskip}{0pt plus 5cm}bool decodeStack ({\bf MachInst} {\em inst}, \/  int \& {\em disp})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a61ba7618f77dc6e62d7b0baf6273130c}



\begin{DoxyCode}
147     {
148         disp = 0;
149         return true;
150     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a70fdc8802b54b4244889a2d3553405d5}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!dprintf@{dprintf}}
\index{dprintf@{dprintf}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{dprintf}]{\setlength{\rightskip}{0pt plus 5cm}void dprintf ()\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a70fdc8802b54b4244889a2d3553405d5}



\begin{DoxyCode}
105 {}
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_aceb93ba31a3756aca859b4643efeeb46}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!getstack@{getstack}}
\index{getstack@{getstack}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{getstack}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf std::vector}$<${\bf Addr}$>$\& getstack () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_aceb93ba31a3756aca859b4643efeeb46}



\begin{DoxyCode}
91 { return stack; }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a8c9787d05f9c0e82dfcaf31cf0fd4b50}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!isEntry@{isEntry}}
\index{isEntry@{isEntry}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{isEntry}]{\setlength{\rightskip}{0pt plus 5cm}bool isEntry ({\bf Addr} {\em addr})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a8c9787d05f9c0e82dfcaf31cf0fd4b50}



\begin{DoxyCode}
141     {
142         return false;
143     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_aabb136846a5e22007e44db846652ddd5}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!trace@{trace}}
\index{trace@{trace}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{trace}]{\setlength{\rightskip}{0pt plus 5cm}bool trace ({\bf ThreadContext} $\ast$ {\em tc}, \/  {\bf StaticInstPtr} {\em inst})\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_aabb136846a5e22007e44db846652ddd5}



\begin{DoxyCode}
111     {
112         if (!inst->isCall() && !inst->isReturn())
113             return false;
114 
115         if (valid())
116             clear();
117 
118         trace(tc, !inst->isReturn());
119         return true;
120     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a46d6b95a2e5fdb75702cf45e39566645}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!trace@{trace}}
\index{trace@{trace}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{trace}]{\setlength{\rightskip}{0pt plus 5cm}void trace ({\bf ThreadContext} $\ast$ {\em tc}, \/  bool {\em is\_\-call})\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a46d6b95a2e5fdb75702cf45e39566645}



\begin{DoxyCode}
136     {
137     }
\end{DoxyCode}
\hypertarget{classX86ISA_1_1StackTrace_a8d985300b138b6c5556ab17ed4df3b38}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!valid@{valid}}
\index{valid@{valid}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{valid}]{\setlength{\rightskip}{0pt plus 5cm}bool valid () const\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a8d985300b138b6c5556ab17ed4df3b38}



\begin{DoxyCode}
87 { return tc != NULL; }
\end{DoxyCode}


\subsection{変数}
\hypertarget{classX86ISA_1_1StackTrace_ace24bfe6928bff7f701824622aa9b36e}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!console@{console}}
\index{console@{console}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{console}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf console} = 2\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_ace24bfe6928bff7f701824622aa9b36e}
\hypertarget{classX86ISA_1_1StackTrace_a8be39169db4f31c77f5188de23c602f1}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!stack@{stack}}
\index{stack@{stack}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{stack}]{\setlength{\rightskip}{0pt plus 5cm}{\bf std::vector}$<${\bf Addr}$>$ {\bf stack}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a8be39169db4f31c77f5188de23c602f1}
\hypertarget{classX86ISA_1_1StackTrace_a4455a4759e69e5ebe68ae7298cbcc37d}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!tc@{tc}}
\index{tc@{tc}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{tc}]{\setlength{\rightskip}{0pt plus 5cm}{\bf ThreadContext}$\ast$ {\bf tc}\hspace{0.3cm}{\ttfamily  \mbox{[}private\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a4455a4759e69e5ebe68ae7298cbcc37d}
\hypertarget{classX86ISA_1_1StackTrace_a204dd651615bf73491349b6403571f10}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!unknown@{unknown}}
\index{unknown@{unknown}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{unknown}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf unknown} = 3\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a204dd651615bf73491349b6403571f10}
\hypertarget{classX86ISA_1_1StackTrace_a80f5e5d52e325fee3fb197c8a15ff3b9}{
\index{X86ISA::StackTrace@{X86ISA::StackTrace}!user@{user}}
\index{user@{user}!X86ISA::StackTrace@{X86ISA::StackTrace}}
\subsubsection[{user}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf user} = 1\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}
\label{classX86ISA_1_1StackTrace_a80f5e5d52e325fee3fb197c8a15ff3b9}


このクラスの説明は次のファイルから生成されました:\begin{DoxyCompactItemize}
\item 
arch/x86/\hyperlink{x86_2stacktrace_8hh}{stacktrace.hh}\item 
arch/x86/\hyperlink{x86_2stacktrace_8cc}{stacktrace.cc}\end{DoxyCompactItemize}
