<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>File&nbsp;GEM5&nbsp;Wrapper: クラス DramGen</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- 作成： Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>メインページ</span></a></li>
      <li><a href="pages.html"><span>関連ページ</span></a></li>
      <li><a href="modules.html"><span>モジュール</span></a></li>
      <li><a href="namespaces.html"><span>ネームスペース</span></a></li>
      <li class="current"><a href="annotated.html"><span>クラス</span></a></li>
      <li><a href="files.html"><span>ファイル</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>構成</span></a></li>
      <li><a href="classes.html"><span>構成索引</span></a></li>
      <li><a href="hierarchy.html"><span>クラス階層</span></a></li>
      <li><a href="functions.html"><span>構成メンバ</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>クラス DramGen</h1><!-- doxytag: class="DramGen" --><!-- doxytag: inherits="RandomGen" -->
<p><code>#include &lt;<a class="el" href="generators_8hh_source.html">generators.hh</a>&gt;</code></p>
<div class="dynheader">
DramGenに対する継承グラフ</div>
<div class="dynsection">
 <div class="center">
  <img src="classDramGen.gif" usemap="#DramGen_map" alt=""/>
  <map id="DramGen_map" name="DramGen_map">
<area href="classRandomGen.html" alt="RandomGen" shape="rect" coords="0,56,80,80"/>
<area href="classBaseGen.html" alt="BaseGen" shape="rect" coords="0,0,80,24"/>
</map>
 </div>
</div>

<p><a href="classDramGen-members.html">すべてのメンバ一覧</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public メソッド</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#afc7f569fe1b2004371d6c159a9bdcba7">DramGen</a> (const std::string &amp;<a class="el" href="classBaseGen.html#a1b003dc5cfce1a4d8f9a0c4b9b589045">_name</a>, <a class="el" href="request_8hh.html#ac366b729262fd8e7cbd3283da6f775cf">MasterID</a> master_id, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> _duration, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> start_addr, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> end_addr, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> _blocksize, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> min_period, <a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a> max_period, uint8_t read_percent, <a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> data_limit, unsigned int num_seq_pkts, unsigned int page_size, unsigned int nbr_of_banks_DRAM, unsigned int nbr_of_banks_util, unsigned int addr_mapping)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classPacket.html">PacketPtr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a938aa9841a9a62a776afbd0768af5379">getNextPacket</a> ()</td></tr>
<tr><td colspan="2"><h2>Private 変数</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a3904e98c281ec13010eaf9fe0671cda4">numSeqPkts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a0bb77b4ba61e408313e1118250f9278c">addr</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a0a5d2b9bad523ef4f6c613e9955c461d">pageSize</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#aad527c6f300f25a1ee8484deaba3d63c">nbrOfBanksDRAM</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#ad0a8571226776987fe09f08baf268a06">nbrOfBanksUtil</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>説明</h2>
<p>DRAM specific generator is for issuing request with variable page hit length and bank utilization. Currently assumes a single channel, single rank configuration. </p>
<hr/><h2>コンストラクタとデストラクタ</h2>
<a class="anchor" id="afc7f569fe1b2004371d6c159a9bdcba7"></a><!-- doxytag: member="DramGen::DramGen" ref="afc7f569fe1b2004371d6c159a9bdcba7" args="(const std::string &amp;_name, MasterID master_id, Tick _duration, Addr start_addr, Addr end_addr, Addr _blocksize, Tick min_period, Tick max_period, uint8_t read_percent, Addr data_limit, unsigned int num_seq_pkts, unsigned int page_size, unsigned int nbr_of_banks_DRAM, unsigned int nbr_of_banks_util, unsigned int addr_mapping)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classDramGen.html">DramGen</a> </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="request_8hh.html#ac366b729262fd8e7cbd3283da6f775cf">MasterID</a>&nbsp;</td>
          <td class="paramname"> <em>master_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>_duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>start_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>end_addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>_blocksize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>min_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#a5c8ed81b7d238c9083e1037ba6d61643">Tick</a>&nbsp;</td>
          <td class="paramname"> <em>max_period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>read_percent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&nbsp;</td>
          <td class="paramname"> <em>data_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>num_seq_pkts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>page_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>nbr_of_banks_DRAM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>nbr_of_banks_util</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&nbsp;</td>
          <td class="paramname"> <em>addr_mapping</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Create a DRAM address sequence generator.</p>
<dl><dt><b>引数:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>_name</em>&nbsp;</td><td>Name to use for status and debug </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>master_id</em>&nbsp;</td><td>MasterID set on each request </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_duration</em>&nbsp;</td><td>duration of this state before transitioning </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>start_addr</em>&nbsp;</td><td>Start address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>end_addr</em>&nbsp;</td><td>End address </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>_blocksize</em>&nbsp;</td><td>Size used for transactions injected </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>min_period</em>&nbsp;</td><td>Lower limit of random inter-transaction time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>max_period</em>&nbsp;</td><td>Upper limit of random inter-transaction time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>read_percent</em>&nbsp;</td><td>Percent of transactions that are reads </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>data_limit</em>&nbsp;</td><td>Upper limit on how much data to read/write </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>num_seq_pkts</em>&nbsp;</td><td>Number of packets per stride, each of _blocksize </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>page_size</em>&nbsp;</td><td>Page size (bytes) used in the DRAM </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nbr_of_banks_DRAM</em>&nbsp;</td><td>Total number of banks in DRAM </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>nbr_of_banks_util</em>&nbsp;</td><td>Number of banks to utilized, for N banks, we will use banks: 0-&gt;(N-1) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>addr_mapping</em>&nbsp;</td><td><a class="el" href="classAddress.html">Address</a> mapping to be used, 0: RoCoRaBaCh, 1: RoRaBaCoCh/RoRaBaChCo assumes single channel and single rank system </td></tr>
  </table>
  </dd>
</dl>

<p><div class="fragment"><pre class="fragment"><a name="l00349"></a>00349         : <a class="code" href="classRandomGen.html#adee762769ba5fd3bc9fe1224c8f7ee78">RandomGen</a>(<a class="code" href="classBaseGen.html#a1b003dc5cfce1a4d8f9a0c4b9b589045">_name</a>, master_id, _duration, start_addr, end_addr,
<a name="l00350"></a>00350           _blocksize, min_period, max_period, read_percent, data_limit),
<a name="l00351"></a>00351           <a class="code" href="classDramGen.html#a3904e98c281ec13010eaf9fe0671cda4">numSeqPkts</a>(num_seq_pkts), <a class="code" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a>(0),
<a name="l00352"></a>00352           <a class="code" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a>(<span class="keyword">true</span>), <a class="code" href="classDramGen.html#a0a5d2b9bad523ef4f6c613e9955c461d">pageSize</a>(page_size),
<a name="l00353"></a>00353           <a class="code" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a>(<a class="code" href="intmath_8hh.html#ad61f5307b84292529da332fee695614e">floorLog2</a>(page_size / _blocksize)),
<a name="l00354"></a>00354           <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a>(<a class="code" href="intmath_8hh.html#ad61f5307b84292529da332fee695614e">floorLog2</a>(nbr_of_banks_DRAM)),
<a name="l00355"></a>00355           <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a>(<a class="code" href="intmath_8hh.html#ad61f5307b84292529da332fee695614e">floorLog2</a>(_blocksize)),
<a name="l00356"></a>00356           <a class="code" href="classDramGen.html#aad527c6f300f25a1ee8484deaba3d63c">nbrOfBanksDRAM</a>(nbr_of_banks_DRAM),
<a name="l00357"></a>00357           <a class="code" href="classDramGen.html#ad0a8571226776987fe09f08baf268a06">nbrOfBanksUtil</a>(nbr_of_banks_util), <a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a>(addr_mapping)
<a name="l00358"></a>00358     {
<a name="l00359"></a>00359         <span class="keywordflow">if</span> (<a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> != 1 &amp;&amp; <a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> != 0) {
<a name="l00360"></a>00360             <a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> = 1;
<a name="l00361"></a>00361             <a class="code" href="base_2misc_8hh.html#a8224a361dddd2ad59b411982e5ea746f">warn</a>(<span class="stringliteral">&quot;Unknown address mapping specified, using RoRaBaCoCh\n&quot;</span>);
<a name="l00362"></a>00362         }
<a name="l00363"></a>00363     }
</pre></div></p>

</div>
</div>
<hr/><h2>関数</h2>
<a class="anchor" id="a938aa9841a9a62a776afbd0768af5379"></a><!-- doxytag: member="DramGen::getNextPacket" ref="a938aa9841a9a62a776afbd0768af5379" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classPacket.html">PacketPtr</a> getNextPacket </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get the next generated packet.</p>
<dl class="return"><dt><b>戻り値:</b></dt><dd>A packet to be sent at the current tick </dd></dl>

<p><a class="el" href="classRandomGen.html#a938aa9841a9a62a776afbd0768af5379">RandomGen</a>を再定義しています。</p>

<p><div class="fragment"><pre class="fragment"><a name="l00179"></a>00179 {
<a name="l00180"></a>00180     <span class="comment">// if this is the first of the packets in series to be generated,</span>
<a name="l00181"></a>00181     <span class="comment">// start counting again</span>
<a name="l00182"></a>00182     <span class="keywordflow">if</span> (<a class="code" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a> == 0) {
<a name="l00183"></a>00183         <a class="code" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a> = <a class="code" href="classDramGen.html#a3904e98c281ec13010eaf9fe0671cda4">numSeqPkts</a>;
<a name="l00184"></a>00184 
<a name="l00185"></a>00185         <span class="comment">// choose if we generate a read or a write here</span>
<a name="l00186"></a>00186         <a class="code" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a> = <a class="code" href="classRandomGen.html#af72793641cb115852317a23ca19dc514">readPercent</a> != 0 &amp;&amp;
<a name="l00187"></a>00187             (<a class="code" href="classRandomGen.html#af72793641cb115852317a23ca19dc514">readPercent</a> == 100 ||
<a name="l00188"></a>00188              <a class="code" href="random_8cc.html#afc426934ee11701464501fa46e24e041">random_mt</a>.<a class="code" href="classRandom.html#a0fd6fb9d84d010276df0648c266e563f">random</a>&lt;uint8_t&gt;(0, 100) &lt; <a class="code" href="classRandomGen.html#af72793641cb115852317a23ca19dc514">readPercent</a>);
<a name="l00189"></a>00189 
<a name="l00190"></a>00190         assert((<a class="code" href="classRandomGen.html#af72793641cb115852317a23ca19dc514">readPercent</a> == 0 &amp;&amp; !<a class="code" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a>) ||
<a name="l00191"></a>00191                (<a class="code" href="classRandomGen.html#af72793641cb115852317a23ca19dc514">readPercent</a> == 100 &amp;&amp; <a class="code" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a>) ||
<a name="l00192"></a>00192                <a class="code" href="classRandomGen.html#af72793641cb115852317a23ca19dc514">readPercent</a> != 100);
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         <span class="comment">// start by picking a random address in the range</span>
<a name="l00195"></a>00195         <a class="code" href="classDramGen.html#a0bb77b4ba61e408313e1118250f9278c">addr</a> = <a class="code" href="random_8cc.html#afc426934ee11701464501fa46e24e041">random_mt</a>.<a class="code" href="classRandom.html#a0fd6fb9d84d010276df0648c266e563f">random</a>&lt;<a class="code" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a>&gt;(<a class="code" href="classRandomGen.html#a6aeb968ddd05c079215ef147ed22708a">startAddr</a>, <a class="code" href="classRandomGen.html#a1f198116a3da3ee4d73abf4760f70815">endAddr</a> - 1);
<a name="l00196"></a>00196 
<a name="l00197"></a>00197         <span class="comment">// round down to start address of a block, i.e. a DRAM burst</span>
<a name="l00198"></a>00198         <a class="code" href="classDramGen.html#a0bb77b4ba61e408313e1118250f9278c">addr</a> -= addr % <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>;
<a name="l00199"></a>00199 
<a name="l00200"></a>00200         <span class="comment">// pick a random bank</span>
<a name="l00201"></a>00201         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_bank =
<a name="l00202"></a>00202             <a class="code" href="random_8cc.html#afc426934ee11701464501fa46e24e041">random_mt</a>.<a class="code" href="classRandom.html#a0fd6fb9d84d010276df0648c266e563f">random</a>&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;(0, <a class="code" href="classDramGen.html#ad0a8571226776987fe09f08baf268a06">nbrOfBanksUtil</a> - 1);
<a name="l00203"></a>00203 
<a name="l00204"></a>00204         <span class="comment">// next, inser the bank bits at the right spot, and align the</span>
<a name="l00205"></a>00205         <span class="comment">// address to achieve the required hit length, this involves</span>
<a name="l00206"></a>00206         <span class="comment">// finding the appropriate start address such that all</span>
<a name="l00207"></a>00207         <span class="comment">// sequential packets target successive columns in the same</span>
<a name="l00208"></a>00208         <span class="comment">// page</span>
<a name="l00209"></a>00209 
<a name="l00210"></a>00210         <span class="comment">// for example, if we have a stride size of 192B, which means</span>
<a name="l00211"></a>00211         <span class="comment">// for LPDDR3 where burstsize = 32B we have numSeqPkts = 6,</span>
<a name="l00212"></a>00212         <span class="comment">// the address generated previously can be such that these</span>
<a name="l00213"></a>00213         <span class="comment">// 192B cross the page boundary, hence it needs to be aligned</span>
<a name="l00214"></a>00214         <span class="comment">// so that they all belong to the same page for page hit</span>
<a name="l00215"></a>00215         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> columns_per_page = <a class="code" href="classDramGen.html#a0a5d2b9bad523ef4f6c613e9955c461d">pageSize</a> / <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>;
<a name="l00216"></a>00216 
<a name="l00217"></a>00217         <span class="comment">// pick a random column, but ensure that there is room for</span>
<a name="l00218"></a>00218         <span class="comment">// numSeqPkts sequential columns in the same page</span>
<a name="l00219"></a>00219         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_col =
<a name="l00220"></a>00220             <a class="code" href="random_8cc.html#afc426934ee11701464501fa46e24e041">random_mt</a>.<a class="code" href="classRandom.html#a0fd6fb9d84d010276df0648c266e563f">random</a>&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt;(0, columns_per_page - <a class="code" href="classDramGen.html#a3904e98c281ec13010eaf9fe0671cda4">numSeqPkts</a>);
<a name="l00221"></a>00221 
<a name="l00222"></a>00222         <span class="keywordflow">if</span> (<a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> == 1) {
<a name="l00223"></a>00223             <span class="comment">// assuming block bits, then page bits, then bank bits</span>
<a name="l00224"></a>00224             <a class="code" href="bitfield_8hh.html#a00870999cf02f3961e51279ceb09d1bc">replaceBits</a>(addr, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a> + <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a> - 1,
<a name="l00225"></a>00225                         <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a>, new_bank);
<a name="l00226"></a>00226             <a class="code" href="bitfield_8hh.html#a00870999cf02f3961e51279ceb09d1bc">replaceBits</a>(addr, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a> - 1, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a>, new_col);
<a name="l00227"></a>00227         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> == 0) {
<a name="l00228"></a>00228             <span class="comment">// assuming bank bits in the bottom</span>
<a name="l00229"></a>00229             <a class="code" href="bitfield_8hh.html#a00870999cf02f3961e51279ceb09d1bc">replaceBits</a>(addr, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a> - 1, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a>, new_bank);
<a name="l00230"></a>00230             <a class="code" href="bitfield_8hh.html#a00870999cf02f3961e51279ceb09d1bc">replaceBits</a>(addr, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a> + <a class="code" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a> - 1,
<a name="l00231"></a>00231                         <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a>, new_col);
<a name="l00232"></a>00232         }
<a name="l00233"></a>00233     } <span class="keywordflow">else</span> {
<a name="l00234"></a>00234         <span class="comment">// increment the column by one</span>
<a name="l00235"></a>00235         <span class="keywordflow">if</span> (<a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> == 1)
<a name="l00236"></a>00236             <span class="comment">// column bits in the bottom, so just add a block</span>
<a name="l00237"></a>00237             addr += <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>;
<a name="l00238"></a>00238         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a> == 0) {
<a name="l00239"></a>00239             <span class="comment">// column bits are above the bank bits, so increment the column bits</span>
<a name="l00240"></a>00240             <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> new_col = ((addr / <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a> / <a class="code" href="classDramGen.html#aad527c6f300f25a1ee8484deaba3d63c">nbrOfBanksDRAM</a>) %
<a name="l00241"></a>00241                                     (<a class="code" href="classDramGen.html#a0a5d2b9bad523ef4f6c613e9955c461d">pageSize</a> / <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>)) + 1;
<a name="l00242"></a>00242             <a class="code" href="bitfield_8hh.html#a00870999cf02f3961e51279ceb09d1bc">replaceBits</a>(addr, <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a> + <a class="code" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a> - 1,
<a name="l00243"></a>00243                         <a class="code" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a> + <a class="code" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a>, new_col);
<a name="l00244"></a>00244         }
<a name="l00245"></a>00245     }
<a name="l00246"></a>00246 
<a name="l00247"></a>00247     <a class="code" href="trace_8hh.html#aefe58fddf89e41edd783bf4c3e31d2c3">DPRINTF</a>(<a class="code" href="classTrafficGen.html">TrafficGen</a>, <span class="stringliteral">&quot;DramGen::getNextPacket: %c to addr %x, &quot;</span>
<a name="l00248"></a>00248             <span class="stringliteral">&quot;size %d, countNumSeqPkts: %d, numSeqPkts: %d\n&quot;</span>,
<a name="l00249"></a>00249             <a class="code" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a> ? <span class="charliteral">&apos;r&apos;</span> : <span class="charliteral">&apos;w&apos;</span>, addr, <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>, <a class="code" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a>, <a class="code" href="classDramGen.html#a3904e98c281ec13010eaf9fe0671cda4">numSeqPkts</a>);
<a name="l00250"></a>00250 
<a name="l00251"></a>00251     <span class="comment">// create a new request packet</span>
<a name="l00252"></a>00252     <a class="code" href="classPacket.html">PacketPtr</a> pkt = <a class="code" href="classBaseGen.html#ae4f945239fa7bde755f55122f661f467">getPacket</a>(addr, <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>,
<a name="l00253"></a>00253                               <a class="code" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a> ? <a class="code" href="classMemCmd.html#a2afce0a47a93eee73a314d53e4890153a96120c772a9cb695fe62ca81ec93a53b">MemCmd::ReadReq</a> : <a class="code" href="classMemCmd.html#a2afce0a47a93eee73a314d53e4890153aa5ec34a7e56b23ff12c9b819519d168a">MemCmd::WriteReq</a>);
<a name="l00254"></a>00254 
<a name="l00255"></a>00255     <span class="comment">// add the amount of data manipulated to the total</span>
<a name="l00256"></a>00256     <a class="code" href="classRandomGen.html#a708cc056d3a52d0f8f5a2cceffdc6d99">dataManipulated</a> += <a class="code" href="classRandomGen.html#aebddb11d20f173e7a5ec2c9f2f591171">blocksize</a>;
<a name="l00257"></a>00257 
<a name="l00258"></a>00258     <span class="comment">// subtract the number of packets remained to be generated</span>
<a name="l00259"></a>00259     --<a class="code" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a>;
<a name="l00260"></a>00260 
<a name="l00261"></a>00261     <span class="comment">// return the generated packet</span>
<a name="l00262"></a>00262     <span class="keywordflow">return</span> pkt;
<a name="l00263"></a>00263 }
</pre></div></p>

</div>
</div>
<hr/><h2>変数</h2>
<a class="anchor" id="a0bb77b4ba61e408313e1118250f9278c"></a><!-- doxytag: member="DramGen::addr" ref="a0bb77b4ba61e408313e1118250f9278c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="base_2types_8hh.html#af1bb03d6a4ee096394a6749f0a169232">Addr</a> <a class="el" href="classDramGen.html#a0bb77b4ba61e408313e1118250f9278c">addr</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classAddress.html">Address</a> of request </p>

</div>
</div>
<a class="anchor" id="ad03c09dad8f497cd0d9fb1a58500acab"></a><!-- doxytag: member="DramGen::addrMapping" ref="ad03c09dad8f497cd0d9fb1a58500acab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classDramGen.html#ad03c09dad8f497cd0d9fb1a58500acab">addrMapping</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="classAddress.html">Address</a> mapping to be used </p>

</div>
</div>
<a class="anchor" id="a501bda29f816788d3bba6d280d6fdc94"></a><!-- doxytag: member="DramGen::bankBits" ref="a501bda29f816788d3bba6d280d6fdc94" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#a501bda29f816788d3bba6d280d6fdc94">bankBits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of bank bits in DRAM address </p>

</div>
</div>
<a class="anchor" id="a5f384954184da222f096688b1a3cc7a5"></a><!-- doxytag: member="DramGen::blockBits" ref="a5f384954184da222f096688b1a3cc7a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#a5f384954184da222f096688b1a3cc7a5">blockBits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of block bits in DRAM address </p>

</div>
</div>
<a class="anchor" id="afe76fc6f68d7bc6df6e5757cbc74d949"></a><!-- doxytag: member="DramGen::countNumSeqPkts" ref="afe76fc6f68d7bc6df6e5757cbc74d949" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned int <a class="el" href="classDramGen.html#afe76fc6f68d7bc6df6e5757cbc74d949">countNumSeqPkts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Track number of sequential packets generated for a request </p>

</div>
</div>
<a class="anchor" id="a1ba0c9f9857ad696d8c3cd03de468fae"></a><!-- doxytag: member="DramGen::isRead" ref="a1ba0c9f9857ad696d8c3cd03de468fae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="classDramGen.html#a1ba0c9f9857ad696d8c3cd03de468fae">isRead</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Remember type of requests to be generated in series </p>

</div>
</div>
<a class="anchor" id="aad527c6f300f25a1ee8484deaba3d63c"></a><!-- doxytag: member="DramGen::nbrOfBanksDRAM" ref="aad527c6f300f25a1ee8484deaba3d63c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#aad527c6f300f25a1ee8484deaba3d63c">nbrOfBanksDRAM</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of banks in DRAM </p>

</div>
</div>
<a class="anchor" id="ad0a8571226776987fe09f08baf268a06"></a><!-- doxytag: member="DramGen::nbrOfBanksUtil" ref="ad0a8571226776987fe09f08baf268a06" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#ad0a8571226776987fe09f08baf268a06">nbrOfBanksUtil</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of banks to be utilized for a given configuration </p>

</div>
</div>
<a class="anchor" id="a3904e98c281ec13010eaf9fe0671cda4"></a><!-- doxytag: member="DramGen::numSeqPkts" ref="a3904e98c281ec13010eaf9fe0671cda4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#a3904e98c281ec13010eaf9fe0671cda4">numSeqPkts</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of sequential DRAM packets to be generated per cpu request </p>

</div>
</div>
<a class="anchor" id="a91979f75432119c425a60258ae2fae8f"></a><!-- doxytag: member="DramGen::pageBits" ref="a91979f75432119c425a60258ae2fae8f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#a91979f75432119c425a60258ae2fae8f">pageBits</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Number of page bits in DRAM address </p>

</div>
</div>
<a class="anchor" id="a0a5d2b9bad523ef4f6c613e9955c461d"></a><!-- doxytag: member="DramGen::pageSize" ref="a0a5d2b9bad523ef4f6c613e9955c461d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned int <a class="el" href="classDramGen.html#a0a5d2b9bad523ef4f6c613e9955c461d">pageSize</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Page size of DRAM </p>

</div>
</div>
<hr/>このクラスの説明は次のファイルから生成されました:<ul>
<li>cpu/testers/traffic_gen/<a class="el" href="generators_8hh_source.html">generators.hh</a></li>
<li>cpu/testers/traffic_gen/<a class="el" href="generators_8cc.html">generators.cc</a></li>
</ul>
</div>
<hr size="1"/><address style="text-align: right;"><small>File&nbsp;GEM5&nbsp;Wrapperに対して25 May 2015に生成されました。&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
